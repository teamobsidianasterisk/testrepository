<!DOCTYPE html>
<html data-init="no-js">
<head>
<meta charset="UTF-8" />
<title>Abyss Diver</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.36.1): A free (gratis and libre) story format.

Copyright © 2013–2021 Thomas Michael Edwards <thomasmedwards@gmail.com>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<script id="script-libraries" type="text/javascript">
if(document.head&&document.addEventListener&&document.querySelector&&Object.create&&Object.freeze&&JSON){document.documentElement.setAttribute("data-init", "loading");
/*! @source http://purl.eligrey.com/github/classList.js/blob/1.2.20171210/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new c("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(e))throw new c("INVALID_CHARACTER_ERR","The token must not contain space characters.");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],h=function(){return new l(this)};if(c[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return~a(this,t+"")},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",~a(this,t)||(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=a(this,t);~e;)this.splice(e,1),r=!0,e=a(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.replace=function(t,e){var n=a(t+"");~n&&(this.splice(n,1,e),this._updateClassName())},u.toString=function(){return this.join(" ")},s.defineProperty){var f={get:h,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,f)}catch(p){void 0!==p.number&&-2146823252!==p.number||(f.enumerable=!1,s.defineProperty(i,e,f))}}else s[n].__defineGetter__&&i.__defineGetter__(e,h)}}(self),function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(t,e){var n=this.toString().split(" "),i=n.indexOf(t+"");~i&&(n=n.slice(i),this.remove.apply(this,n),this.add(e),this.add.apply(this,n.slice(1)))}),t=null}());
/*!
 * https://github.com/es-shims/es5-shim
 * @license es5-shim Copyright 2009-2020 by contributors, MIT License
 * see https://github.com/es-shims/es5-shim/blob/v4.5.14/LICENSE
 */
(function(t,r){"use strict";if(typeof define==="function"&&define.amd){define(r)}else if(typeof exports==="object"){module.exports=r()}else{t.returnExports=r()}})(this,function(){var t=Array;var r=t.prototype;var e=Object;var n=e.prototype;var i=Function;var a=i.prototype;var o=String;var f=o.prototype;var u=Number;var l=u.prototype;var s=r.slice;var c=r.splice;var v=r.push;var h=r.unshift;var p=r.concat;var y=r.join;var d=a.call;var g=a.apply;var w=Math.max;var b=Math.min;var T=n.toString;var m=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var D;var S=Function.prototype.toString,x=/^\s*class /,O=function isES6ClassFn(t){try{var r=S.call(t);var e=r.replace(/\/\/.*\n/g,"");var n=e.replace(/\/\*[.\s\S]*\*\//g,"");var i=n.replace(/\n/gm," ").replace(/ {2}/g," ");return x.test(i)}catch(a){return false}},E=function tryFunctionObject(t){try{if(O(t)){return false}S.call(t);return true}catch(r){return false}},j="[object Function]",I="[object GeneratorFunction]",D=function isCallable(t){if(!t){return false}if(typeof t!=="function"&&typeof t!=="object"){return false}if(m){return E(t)}if(O(t)){return false}var r=T.call(t);return r===j||r===I};var M;var U=RegExp.prototype.exec,$=function tryRegexExec(t){try{U.call(t);return true}catch(r){return false}},F="[object RegExp]";M=function isRegex(t){if(typeof t!=="object"){return false}return m?$(t):T.call(t)===F};var N;var C=String.prototype.valueOf,k=function tryStringObject(t){try{C.call(t);return true}catch(r){return false}},A="[object String]";N=function isString(t){if(typeof t==="string"){return true}if(typeof t!=="object"){return false}return m?k(t):T.call(t)===A};var R=e.defineProperty&&function(){try{var t={};e.defineProperty(t,"x",{enumerable:false,value:t});for(var r in t){return false}return t.x===t}catch(n){return false}}();var P=function(t){var r;if(R){r=function(t,r,n,i){if(!i&&r in t){return}e.defineProperty(t,r,{configurable:true,enumerable:false,writable:true,value:n})}}else{r=function(t,r,e,n){if(!n&&r in t){return}t[r]=e}}return function defineProperties(e,n,i){for(var a in n){if(t.call(n,a)){r(e,a,n[a],i)}}}}(n.hasOwnProperty);var J=function isPrimitive(t){var r=typeof t;return t===null||r!=="object"&&r!=="function"};var Y=u.isNaN||function isActualNaN(t){return t!==t};var z={ToInteger:function ToInteger(t){var r=+t;if(Y(r)){r=0}else if(r!==0&&r!==1/0&&r!==-(1/0)){r=(r>0||-1)*Math.floor(Math.abs(r))}return r},ToPrimitive:function ToPrimitive(t){var r,e,n;if(J(t)){return t}e=t.valueOf;if(D(e)){r=e.call(t);if(J(r)){return r}}n=t.toString;if(D(n)){r=n.call(t);if(J(r)){return r}}throw new TypeError},ToObject:function(t){if(t==null){throw new TypeError("can't convert "+t+" to object")}return e(t)},ToUint32:function ToUint32(t){return t>>>0}};var Z=function Empty(){};P(a,{bind:function bind(t){var r=this;if(!D(r)){throw new TypeError("Function.prototype.bind called on incompatible "+r)}var n=s.call(arguments,1);var a;var o=function(){if(this instanceof a){var i=g.call(r,this,p.call(n,s.call(arguments)));if(e(i)===i){return i}return this}else{return g.call(r,t,p.call(n,s.call(arguments)))}};var f=w(0,r.length-n.length);var u=[];for(var l=0;l<f;l++){v.call(u,"$"+l)}a=i("binder","return function ("+y.call(u,",")+"){ return binder.apply(this, arguments); }")(o);if(r.prototype){Z.prototype=r.prototype;a.prototype=new Z;Z.prototype=null}return a}});var G=d.bind(n.hasOwnProperty);var H=d.bind(n.toString);var W=d.bind(s);var B=g.bind(s);if(typeof document==="object"&&document&&document.documentElement){try{W(document.documentElement.childNodes)}catch(X){var L=W;var q=B;W=function arraySliceIE(t){var r=[];var e=t.length;while(e-- >0){r[e]=t[e]}return q(r,L(arguments,1))};B=function arraySliceApplyIE(t,r){return q(W(t),r)}}}var K=d.bind(f.slice);var Q=d.bind(f.split);var V=d.bind(f.indexOf);var _=d.bind(v);var tt=d.bind(n.propertyIsEnumerable);var rt=d.bind(r.sort);var et=t.isArray||function isArray(t){return H(t)==="[object Array]"};var nt=[].unshift(0)!==1;P(r,{unshift:function(){h.apply(this,arguments);return this.length}},nt);P(t,{isArray:et});var it=e("a");var at=it[0]!=="a"||!(0 in it);var ot=function properlyBoxed(t){var r=true;var e=true;var n=false;if(t){try{t.call("foo",function(t,e,n){if(typeof n!=="object"){r=false}});t.call([1],function(){"use strict";e=typeof this==="string"},"x")}catch(i){n=true}}return!!t&&!n&&r&&e};P(r,{forEach:function forEach(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=-1;var i=z.ToUint32(e.length);var a;if(arguments.length>1){a=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in e){if(typeof a==="undefined"){t(e[n],n,r)}else{t.call(a,e[n],n,r)}}}}},!ot(r.forEach));P(r,{map:function map(r){var e=z.ToObject(this);var n=at&&N(this)?Q(this,""):e;var i=z.ToUint32(n.length);var a=t(i);var o;if(arguments.length>1){o=arguments[1]}if(!D(r)){throw new TypeError("Array.prototype.map callback must be a function")}for(var f=0;f<i;f++){if(f in n){if(typeof o==="undefined"){a[f]=r(n[f],f,e)}else{a[f]=r.call(o,n[f],f,e)}}}return a}},!ot(r.map));P(r,{filter:function filter(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var f=0;f<n;f++){if(f in e){a=e[f];if(typeof o==="undefined"?t(a,f,r):t.call(o,a,f,r)){_(i,a)}}}return i}},!ot(r.filter));P(r,{every:function every(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in e&&!(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return false}}return true}},!ot(r.every));P(r,{some:function some(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);var i;if(arguments.length>1){i=arguments[1]}if(!D(t)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in e&&(typeof i==="undefined"?t(e[a],a,r):t.call(i,e[a],a,r))){return true}}return false}},!ot(r.some));var ft=false;if(r.reduce){ft=typeof r.reduce.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduce:function reduce(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in e){a=e[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in e){a=t(a,e[i],i,r)}}return a}},!ft);var ut=false;if(r.reduceRight){ut=typeof r.reduceRight.call("es5",function(t,r,e,n){return n})==="object"}P(r,{reduceRight:function reduceRight(t){var r=z.ToObject(this);var e=at&&N(this)?Q(this,""):r;var n=z.ToUint32(e.length);if(!D(t)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in e){i=e[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in e){i=t(i,e[a],a,r)}}while(a--);return i}},!ut);var lt=r.indexOf&&[0,1].indexOf(1,2)!==-1;P(r,{indexOf:function indexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=0;if(arguments.length>1){n=z.ToInteger(arguments[1])}n=n>=0?n:w(0,e+n);for(;n<e;n++){if(n in r&&r[n]===t){return n}}return-1}},lt);var st=r.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;P(r,{lastIndexOf:function lastIndexOf(t){var r=at&&N(this)?Q(this,""):z.ToObject(this);var e=z.ToUint32(r.length);if(e===0){return-1}var n=e-1;if(arguments.length>1){n=b(n,z.ToInteger(arguments[1]))}n=n>=0?n:e-Math.abs(n);for(;n>=0;n--){if(n in r&&t===r[n]){return n}}return-1}},st);var ct=function(){var t=[1,2];var r=t.splice();return t.length===2&&et(r)&&r.length===0}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}else{return c.apply(this,arguments)}}},!ct);var vt=function(){var t={};r.splice.call(t,0,0,1);return t.length===1}();P(r,{splice:function splice(t,r){if(arguments.length===0){return[]}var e=arguments;this.length=w(z.ToInteger(this.length),0);if(arguments.length>0&&typeof r!=="number"){e=W(arguments);if(e.length<2){_(e,this.length-t)}else{e[1]=z.ToInteger(r)}}return c.apply(this,e)}},!vt);var ht=function(){var r=new t(1e5);r[8]="x";r.splice(1,1);return r.indexOf("x")===7}();var pt=function(){var t=256;var r=[];r[t]="a";r.splice(t+1,0,"b");return r[t]==="a"}();P(r,{splice:function splice(t,r){var e=z.ToObject(this);var n=[];var i=z.ToUint32(e.length);var a=z.ToInteger(t);var f=a<0?w(i+a,0):b(a,i);var u=arguments.length===0?0:arguments.length===1?i-f:b(w(z.ToInteger(r),0),i-f);var l=0;var s;while(l<u){s=o(f+l);if(G(e,s)){n[l]=e[s]}l+=1}var c=W(arguments,2);var v=c.length;var h;if(v<u){l=f;var p=i-u;while(l<p){s=o(l+u);h=o(l+v);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l+=1}l=i;var y=i-u+v;while(l>y){delete e[l-1];l-=1}}else if(v>u){l=i-u;while(l>f){s=o(l+u-1);h=o(l+v-1);if(G(e,s)){e[h]=e[s]}else{delete e[h]}l-=1}}l=f;for(var d=0;d<c.length;++d){e[l]=c[d];l+=1}e.length=i-u+v;return n}},!ht||!pt);var yt=r.join;var dt;try{dt=Array.prototype.join.call("123",",")!=="1,2,3"}catch(X){dt=true}if(dt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(N(this)?Q(this,""):this,r)}},dt)}var gt=[1,2].join(undefined)!=="1,2";if(gt){P(r,{join:function join(t){var r=typeof t==="undefined"?",":t;return yt.call(this,r)}},gt)}var wt=function push(t){var r=z.ToObject(this);var e=z.ToUint32(r.length);var n=0;while(n<arguments.length){r[e+n]=arguments[n];n+=1}r.length=e+n;return e+n};var bt=function(){var t={};var r=Array.prototype.push.call(t,undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:function push(t){if(et(this)){return v.apply(this,arguments)}return wt.apply(this,arguments)}},bt);var Tt=function(){var t=[];var r=t.push(undefined);return r!==1||t.length!==1||typeof t[0]!=="undefined"||!G(t,0)}();P(r,{push:wt},Tt);P(r,{slice:function(t,r){var e=N(this)?Q(this,""):this;return B(e,arguments)}},at);var mt=function(){try{[1,2].sort(null)}catch(t){try{[1,2].sort({})}catch(r){return false}}return true}();var Dt=function(){try{[1,2].sort(/a/);return false}catch(t){}return true}();var St=function(){try{[1,2].sort(undefined);return true}catch(t){}return false}();P(r,{sort:function sort(t){if(typeof t==="undefined"){return rt(this)}if(!D(t)){throw new TypeError("Array.prototype.sort callback must be a function")}return rt(this,t)}},mt||!St||!Dt);var xt=!tt({toString:null},"toString");var Ot=tt(function(){},"prototype");var Et=!G("x","0");var jt=function(t){var r=t.constructor;return r&&r.prototype===t};var It={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true,$width:true,$height:true,$top:true,$localStorage:true};var Mt=function(){if(typeof window==="undefined"){return false}for(var t in window){try{if(!It["$"+t]&&G(window,t)&&window[t]!==null&&typeof window[t]==="object"){jt(window[t])}}catch(r){return true}}return false}();var Ut=function(t){if(typeof window==="undefined"||!Mt){return jt(t)}try{return jt(t)}catch(r){return false}};var $t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var Ft=$t.length;var Nt=function isArguments(t){return H(t)==="[object Arguments]"};var Ct=function isArguments(t){return t!==null&&typeof t==="object"&&typeof t.length==="number"&&t.length>=0&&!et(t)&&D(t.callee)};var kt=Nt(arguments)?Nt:Ct;P(e,{keys:function keys(t){var r=D(t);var e=kt(t);var n=t!==null&&typeof t==="object";var i=n&&N(t);if(!n&&!r&&!e){throw new TypeError("Object.keys called on a non-object")}var a=[];var f=Ot&&r;if(i&&Et||e){for(var u=0;u<t.length;++u){_(a,o(u))}}if(!e){for(var l in t){if(!(f&&l==="prototype")&&G(t,l)){_(a,o(l))}}}if(xt){var s=Ut(t);for(var c=0;c<Ft;c++){var v=$t[c];if(!(s&&v==="constructor")&&G(t,v)){_(a,v)}}}return a}});var At=e.keys&&function(){return e.keys(arguments).length===2}(1,2);var Rt=e.keys&&function(){var t=e.keys(arguments);return arguments.length!==1||t.length!==1||t[0]!==1}(1);var Pt=e.keys;P(e,{keys:function keys(t){if(kt(t)){return Pt(W(t))}else{return Pt(t)}}},!At||Rt);var Jt=new Date(-0xc782b5b342b24).getUTCMonth()!==0;var Yt=new Date(-0x55d318d56a724);var zt=new Date(14496624e5);var Zt=Yt.toUTCString()!=="Mon, 01 Jan -45875 11:59:59 GMT";var Gt;var Ht;var Wt=Yt.getTimezoneOffset();if(Wt<-720){Gt=Yt.toDateString()!=="Tue Jan 02 -45875";Ht=!/^Thu Dec 10 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}else{Gt=Yt.toDateString()!=="Mon Jan 01 -45875";Ht=!/^Wed Dec 09 2015 \d\d:\d\d:\d\d GMT[-+]\d\d\d\d(?: |$)/.test(String(zt))}var Bt=d.bind(Date.prototype.getFullYear);var Xt=d.bind(Date.prototype.getMonth);var Lt=d.bind(Date.prototype.getDate);var qt=d.bind(Date.prototype.getUTCFullYear);var Kt=d.bind(Date.prototype.getUTCMonth);var Qt=d.bind(Date.prototype.getUTCDate);var Vt=d.bind(Date.prototype.getUTCDay);var _t=d.bind(Date.prototype.getUTCHours);var tr=d.bind(Date.prototype.getUTCMinutes);var rr=d.bind(Date.prototype.getUTCSeconds);var er=d.bind(Date.prototype.getUTCMilliseconds);var nr=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var ir=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var ar=function daysInMonth(t,r){return Lt(new Date(r,t,0))};P(Date.prototype,{getFullYear:function getFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);if(t<0&&Xt(this)>11){return t+1}return t},getMonth:function getMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);if(t<0&&r>11){return 0}return r},getDate:function getDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Bt(this);var r=Xt(this);var e=Lt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e},getUTCFullYear:function getUTCFullYear(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);if(t<0&&Kt(this)>11){return t+1}return t},getUTCMonth:function getUTCMonth(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);if(t<0&&r>11){return 0}return r},getUTCDate:function getUTCDate(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=qt(this);var r=Kt(this);var e=Qt(this);if(t<0&&r>11){if(r===12){return e}var n=ar(0,t+1);return n-e+1}return e}},Jt);P(Date.prototype,{toUTCString:function toUTCString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=Vt(this);var r=Qt(this);var e=Kt(this);var n=qt(this);var i=_t(this);var a=tr(this);var o=rr(this);return nr[t]+", "+(r<10?"0"+r:r)+" "+ir[e]+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"}},Jt||Zt);P(Date.prototype,{toDateString:function toDateString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n}},Jt||Gt);if(Jt||Ht){Date.prototype.toString=function toString(){if(!this||!(this instanceof Date)){throw new TypeError("this is not a Date object.")}var t=this.getDay();var r=this.getDate();var e=this.getMonth();var n=this.getFullYear();var i=this.getHours();var a=this.getMinutes();var o=this.getSeconds();var f=this.getTimezoneOffset();var u=Math.floor(Math.abs(f)/60);var l=Math.floor(Math.abs(f)%60);return nr[t]+" "+ir[e]+" "+(r<10?"0"+r:r)+" "+n+" "+(i<10?"0"+i:i)+":"+(a<10?"0"+a:a)+":"+(o<10?"0"+o:o)+" GMT"+(f>0?"-":"+")+(u<10?"0"+u:u)+(l<10?"0"+l:l)};if(R){e.defineProperty(Date.prototype,"toString",{configurable:true,enumerable:false,writable:true})}}var or=-621987552e5;var fr="-000001";var ur=Date.prototype.toISOString&&new Date(or).toISOString().indexOf(fr)===-1;var lr=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";var sr=d.bind(Date.prototype.getTime);P(Date.prototype,{toISOString:function toISOString(){if(!isFinite(this)||!isFinite(sr(this))){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}var t=qt(this);var r=Kt(this);t+=Math.floor(r/12);r=(r%12+12)%12;var e=[r+1,Qt(this),_t(this),tr(this),rr(this)];t=(t<0?"-":t>9999?"+":"")+K("00000"+Math.abs(t),0<=t&&t<=9999?-4:-6);for(var n=0;n<e.length;++n){e[n]=K("00"+e[n],-2)}return t+"-"+W(e,0,2).join("-")+"T"+W(e,2).join(":")+"."+K("000"+er(this),-3)+"Z"}},ur||lr);var cr=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(or).toJSON().indexOf(fr)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(t){return false}}();if(!cr){Date.prototype.toJSON=function toJSON(t){var r=e(this);var n=z.ToPrimitive(r);if(typeof n==="number"&&!isFinite(n)){return null}var i=r.toISOString;if(!D(i)){throw new TypeError("toISOString property is not callable")}return i.call(r)}}var vr=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var hr=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var pr=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(pr||hr||!vr){var yr=Math.pow(2,31)-1;var dr=Y(new Date(1970,0,1,0,0,0,yr+1).getTime());Date=function(t){var r=function Date(e,n,i,a,f,u,l){var s=arguments.length;var c;if(this instanceof t){var v=u;var h=l;if(dr&&s>=7&&l>yr){var p=Math.floor(l/yr)*yr;var y=Math.floor(p/1e3);v+=y;h-=y*1e3}c=s===1&&o(e)===e?new t(r.parse(e)):s>=7?new t(e,n,i,a,f,v,h):s>=6?new t(e,n,i,a,f,v):s>=5?new t(e,n,i,a,f):s>=4?new t(e,n,i,a):s>=3?new t(e,n,i):s>=2?new t(e,n):s>=1?new t(e instanceof t?+e:e):new t}else{c=t.apply(this,arguments)}if(!J(c)){P(c,{constructor:r},true)}return c};var e=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(t,r){var e=r>1?1:0;return n[r]+Math.floor((t-1969+e)/4)-Math.floor((t-1901+e)/100)+Math.floor((t-1601+e)/400)+365*(t-1970)};var a=function toUTC(r){var e=0;var n=r;if(dr&&n>yr){var i=Math.floor(n/yr)*yr;var a=Math.floor(i/1e3);e+=a;n-=a*1e3}return u(new t(1970,0,1,0,0,e,n))};for(var f in t){if(G(t,f)){r[f]=t[f]}}P(r,{now:t.now,UTC:t.UTC},true);r.prototype=t.prototype;P(r.prototype,{constructor:r},true);var l=function parse(r){var n=e.exec(r);if(n){var o=u(n[1]),f=u(n[2]||1)-1,l=u(n[3]||1)-1,s=u(n[4]||0),c=u(n[5]||0),v=u(n[6]||0),h=Math.floor(u(n[7]||0)*1e3),p=Boolean(n[4]&&!n[8]),y=n[9]==="-"?1:-1,d=u(n[10]||0),g=u(n[11]||0),w;var b=c>0||v>0||h>0;if(s<(b?24:25)&&c<60&&v<60&&h<1e3&&f>-1&&f<12&&d<24&&g<60&&l>-1&&l<i(o,f+1)-i(o,f)){w=((i(o,f)+l)*24+s+d*y)*60;w=((w+c+g*y)*60+v)*1e3+h;if(p){w=a(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return t.parse.apply(this,arguments)};P(r,{parse:l});return r}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var gr=l.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||(1000000000000000128).toFixed(0)!=="1000000000000000128");var wr={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(t,r){var e=-1;var n=r;while(++e<wr.size){n+=t*wr.data[e];wr.data[e]=n%wr.base;n=Math.floor(n/wr.base)}},divide:function divide(t){var r=wr.size;var e=0;while(--r>=0){e+=wr.data[r];wr.data[r]=Math.floor(e/t);e=e%t*wr.base}},numToString:function numToString(){var t=wr.size;var r="";while(--t>=0){if(r!==""||t===0||wr.data[t]!==0){var e=o(wr.data[t]);if(r===""){r=e}else{r+=K("0000000",0,7-e.length)+e}}}return r},pow:function pow(t,r,e){return r===0?e:r%2===1?pow(t,r-1,e*t):pow(t*t,r/2,e)},log:function log(t){var r=0;var e=t;while(e>=4096){r+=12;e/=4096}while(e>=2){r+=1;e/=2}return r}};var br=function toFixed(t){var r,e,n,i,a,f,l,s;r=u(t);r=Y(r)?0:Math.floor(r);if(r<0||r>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}e=u(this);if(Y(e)){return"NaN"}if(e<=-1e21||e>=1e21){return o(e)}n="";if(e<0){n="-";e=-e}i="0";if(e>1e-21){a=wr.log(e*wr.pow(2,69,1))-69;f=a<0?e*wr.pow(2,-a,1):e/wr.pow(2,a,1);f*=4503599627370496;a=52-a;if(a>0){wr.multiply(0,f);l=r;while(l>=7){wr.multiply(1e7,0);l-=7}wr.multiply(wr.pow(10,l,1),0);l=a-1;while(l>=23){wr.divide(1<<23);l-=23}wr.divide(1<<l);wr.multiply(1,1);wr.divide(2);i=wr.numToString()}else{wr.multiply(0,f);wr.multiply(1<<-a,0);i=wr.numToString()+K("0.00000000000000000000",2,2+r)}}if(r>0){s=i.length;if(s<=r){i=n+K("0.0000000000000000000",0,r-s+2)+i}else{i=n+K(i,0,s-r)+"."+K(i,s-r)}}else{i=n+i}return i};P(l,{toFixed:br},gr);var Tr=function(){try{return 1..toPrecision(undefined)==="1"}catch(t){return true}}();var mr=l.toPrecision;P(l,{toPrecision:function toPrecision(t){return typeof t==="undefined"?mr.call(this):mr.call(this,t)}},Tr);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var t=typeof/()??/.exec("")[1]==="undefined";var r=Math.pow(2,32)-1;f.split=function(e,n){var i=String(this);if(typeof e==="undefined"&&n===0){return[]}if(!M(e)){return Q(this,e,n)}var a=[];var o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,u,l,s,c;var h=new RegExp(e.source,o+"g");if(!t){u=new RegExp("^"+h.source+"$(?!\\s)",o)}var p=typeof n==="undefined"?r:z.ToUint32(n);l=h.exec(i);while(l){s=l.index+l[0].length;if(s>f){_(a,K(i,f,l.index));if(!t&&l.length>1){l[0].replace(u,function(){for(var t=1;t<arguments.length-2;t++){if(typeof arguments[t]==="undefined"){l[t]=void 0}}})}if(l.length>1&&l.index<i.length){v.apply(a,W(l,1))}c=l[0].length;f=s;if(a.length>=p){break}}if(h.lastIndex===l.index){h.lastIndex++}l=h.exec(i)}if(f===i.length){if(c||!h.test("")){_(a,"")}}else{_(a,K(i,f))}return a.length>p?W(a,0,p):a}})()}else if("0".split(void 0,0).length){f.split=function split(t,r){if(typeof t==="undefined"&&r===0){return[]}return Q(this,t,r)}}var Dr=f.replace;var Sr=function(){var t=[];"x".replace(/x(.)?/g,function(r,e){_(t,e)});return t.length===1&&typeof t[0]==="undefined"}();if(!Sr){f.replace=function replace(t,r){var e=D(r);var n=M(t)&&/\)[*?]/.test(t.source);if(!e||!n){return Dr.call(this,t,r)}else{var i=function(e){var n=arguments.length;var i=t.lastIndex;t.lastIndex=0;var a=t.exec(e)||[];t.lastIndex=i;_(a,arguments[n-2],arguments[n-1]);return r.apply(this,a)};return Dr.call(this,t,i)}}}var xr=f.substr;var Or="".substr&&"0b".substr(-1)!=="b";P(f,{substr:function substr(t,r){var e=t;if(t<0){e=w(this.length+t,0)}return xr.call(this,e,r)}},Or);var Er="\t\n\x0B\f\r \xa0\u1680\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var jr="\u200b";var Ir="["+Er+"]";var Mr=new RegExp("^"+Ir+Ir+"*");var Ur=new RegExp(Ir+Ir+"*$");var $r=f.trim&&(Er.trim()||!jr.trim());P(f,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return o(this).replace(Mr,"").replace(Ur,"")}},$r);var Fr=d.bind(String.prototype.trim);var Nr=f.lastIndexOf&&"abc\u3042\u3044".lastIndexOf("\u3042\u3044",2)!==-1;P(f,{lastIndexOf:function lastIndexOf(t){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var r=o(this);var e=o(t);var n=arguments.length>1?u(arguments[1]):NaN;var i=Y(n)?Infinity:z.ToInteger(n);var a=b(w(i,0),r.length);var f=e.length;var l=a+f;while(l>0){l=w(0,l-f);var s=V(K(r,l,a+f),e);if(s!==-1){return l+s}}return-1}},Nr);var Cr=f.lastIndexOf;P(f,{lastIndexOf:function lastIndexOf(t){return Cr.apply(this,arguments)}},f.lastIndexOf.length!==1);if(parseInt(Er+"08")!==8||parseInt(Er+"0x16")!==22){parseInt=function(t){var r=/^[-+]?0[xX]/;return function parseInt(e,n){if(typeof e==="symbol"){""+e}var i=Fr(String(e));var a=u(n)||(r.test(i)?16:10);return t(i,a)}}(parseInt)}if(1/parseFloat("-0")!==-Infinity){parseFloat=function(t){return function parseFloat(r){var e=Fr(String(r));var n=t(e);return n===0&&K(e,0,1)==="-"?-0:n}}(parseFloat)}if(String(new RangeError("test"))!=="RangeError: test"){var kr=function toString(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}var t=this.name;if(typeof t==="undefined"){t="Error"}else if(typeof t!=="string"){t=o(t)}var r=this.message;if(typeof r==="undefined"){r=""}else if(typeof r!=="string"){r=o(r)}if(!t){return r}if(!r){return t}return t+": "+r};Error.prototype.toString=kr}if(R){var Ar=function(t,r){if(tt(t,r)){var e=Object.getOwnPropertyDescriptor(t,r);if(e.configurable){e.enumerable=false;Object.defineProperty(t,r,e)}}};Ar(Error.prototype,"message");if(Error.prototype.message!==""){Error.prototype.message=""}Ar(Error.prototype,"name")}if(String(/a/gim)!=="/a/gim"){var Rr=function toString(){var t="/"+this.source+"/";if(this.global){t+="g"}if(this.ignoreCase){t+="i"}if(this.multiline){t+="m"}return t};RegExp.prototype.toString=Rr}});
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.4/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=Object.keys;var o=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var i=function(e){try{e();return false}catch(t){return true}};var a=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var u=o(i);var f=function(){return!i(function(){return Object.defineProperty({},"x",{get:function(){}})})};var s=!!Object.defineProperty&&f();var c=function foo(){}.name==="foo";var l=Function.call.bind(Array.prototype.forEach);var p=Function.call.bind(Array.prototype.reduce);var v=Function.call.bind(Array.prototype.filter);var y=Function.call.bind(Array.prototype.some);var h=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t,r){l(n(t),function(n){var o=t[n];h(e,n,o,!!r)})};var g=Function.call.bind(Object.prototype.toString);var d=typeof/abc/==="function"?function IsCallableSlow(e){return typeof e==="function"&&g(e)==="[object Function]"}:function IsCallableFast(e){return typeof e==="function"};var m={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){if(t&&d(t.toString)){h(e,"toString",t.toString.bind(t),true)}}};var O=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var o=new r;if(typeof t!=="undefined"){n(t).forEach(function(e){m.defineByDescriptor(o,e,t[e])})}return o};var w=function(e,t){if(!Object.setPrototypeOf){return false}return a(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=O(e.prototype,{constructor:{value:r}});return t(r)})};var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=Function.call.bind(String.prototype.indexOf);var E=Function.apply.bind(Array.prototype.indexOf);var P=Function.call.bind(Array.prototype.concat);var C=Function.call.bind(String.prototype.slice);var M=Function.call.bind(Array.prototype.push);var x=Function.apply.bind(Array.prototype.push);var N=Function.call.bind(Array.prototype.shift);var A=Math.max;var R=Math.min;var _=Math.floor;var k=Math.abs;var L=Math.exp;var F=Math.log;var D=Math.sqrt;var z=Function.call.bind(Object.prototype.hasOwnProperty);var q;var W=function(){};var G=S.Map;var H=G&&G.prototype["delete"];var V=G&&G.prototype.get;var B=G&&G.prototype.has;var U=G&&G.prototype.set;var $=S.Symbol||{};var J=$.species||"@@species";var X=Number.isNaN||function isNaN(e){return e!==e};var K=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Z=d(Math.sign)?Math.sign:function sign(e){var t=Number(e);if(t===0){return t}if(X(t)){return t}return t<0?-1:1};var Y=function log1p(e){var t=Number(e);if(t<-1||X(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(F(1+t)/(1+t-1))};var Q=function isArguments(e){return g(e)==="[object Arguments]"};var ee=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&g(e)!=="[object Array]"&&g(e.callee)==="[object Function]"};var te=Q(arguments)?Q:ee;var re={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},string:function(e){return g(e)==="[object String]"},regex:function(e){return g(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var ne=function overrideNative(e,t,r){var n=e[t];h(e,t,r,true);m.preserveToString(e[t],n)};var oe=typeof $==="function"&&typeof $["for"]==="function"&&re.symbol($());var ie=re.symbol($.iterator)?$.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){ie="@@iterator"}if(!S.Reflect){h(S,"Reflect",{},true)}var ae=S.Reflect;var ue=String;var fe=typeof document==="undefined"||!document?null:document.all;var se=fe==null?function isNullOrUndefined(e){return e==null}:function isNullOrUndefinedAndNotDocumentAll(e){return e==null&&e!==fe};var ce={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!ce.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(se(e)){throw new TypeError(t||"Cannot call method on "+e)}return e},TypeIsObject:function(e){if(e===void 0||e===null||e===true||e===false){return false}return typeof e==="function"||typeof e==="object"||e===fe},ToObject:function(e,t){return Object(ce.RequireObjectCoercible(e,t))},IsCallable:d,IsConstructor:function(e){return ce.IsCallable(e)},ToInt32:function(e){return ce.ToNumber(e)>>0},ToUint32:function(e){return ce.ToNumber(e)>>>0},ToNumber:function(e){if(g(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=ce.ToNumber(e);if(X(t)){return 0}if(t===0||!K(t)){return t}return(t>0?1:-1)*_(k(t))},ToLength:function(e){var t=ce.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return ce.TypeIsObject(e)&&(typeof e[ie]!=="undefined"||te(e))},GetIterator:function(e){if(te(e)){return new q(e,"value")}var t=ce.GetMethod(e,ie);if(!ce.IsCallable(t)){throw new TypeError("value is not an iterable")}var r=ce.Call(t,e);if(!ce.TypeIsObject(r)){throw new TypeError("bad iterator")}return r},GetMethod:function(e,t){var r=ce.ToObject(e)[t];if(se(r)){return void 0}if(!ce.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var r=ce.GetMethod(e,"return");if(r===void 0){return}var n,o;try{n=ce.Call(r,e)}catch(i){o=i}if(t){return}if(o){throw o}if(!ce.TypeIsObject(n)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ce.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=ce.IteratorNext(e);var r=ce.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){var o=typeof r==="undefined"?e:r;if(!n&&ae.construct){return ae.construct(e,t,o)}var i=o.prototype;if(!ce.TypeIsObject(i)){i=Object.prototype}var a=O(i);var u=ce.Call(e,a,t);return ce.TypeIsObject(u)?u:a},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!ce.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[J];if(se(n)){return t}if(!ce.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=ce.ToString(e);var i="<"+t;if(r!==""){var a=ce.ToString(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var f=i+">";var s=f+o;return s+"</"+t+">"},IsRegExp:function IsRegExp(e){if(!ce.TypeIsObject(e)){return false}var t=e[$.match];if(typeof t!=="undefined"){return!!t}return re.regex(e)},ToString:function ToString(e){return ue(e)}};if(s&&oe){var le=function defineWellKnownSymbol(e){if(re.symbol($[e])){return $[e]}var t=$["for"]("Symbol."+e);Object.defineProperty($,e,{configurable:false,enumerable:false,writable:false,value:t});return t};if(!re.symbol($.search)){var pe=le("search");var ve=String.prototype.search;h(RegExp.prototype,pe,function search(e){return ce.Call(ve,e,[this])});var ye=function search(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,pe);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(ve,t,[ce.ToString(e)])};ne(String.prototype,"search",ye)}if(!re.symbol($.replace)){var he=le("replace");var be=String.prototype.replace;h(RegExp.prototype,he,function replace(e,t){return ce.Call(be,e,[this,t])});var ge=function replace(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,he);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(be,r,[ce.ToString(e),t])};ne(String.prototype,"replace",ge)}if(!re.symbol($.split)){var de=le("split");var me=String.prototype.split;h(RegExp.prototype,de,function split(e,t){return ce.Call(me,e,[this,t])});var Oe=function split(e,t){var r=ce.RequireObjectCoercible(this);if(!se(e)){var n=ce.GetMethod(e,de);if(typeof n!=="undefined"){return ce.Call(n,e,[r,t])}}return ce.Call(me,r,[ce.ToString(e),t])};ne(String.prototype,"split",Oe)}var we=re.symbol($.match);var je=we&&function(){var e={};e[$.match]=function(){return 42};return"a".match(e)!==42}();if(!we||je){var Se=le("match");var Te=String.prototype.match;h(RegExp.prototype,Se,function match(e){return ce.Call(Te,e,[this])});var Ie=function match(e){var t=ce.RequireObjectCoercible(this);if(!se(e)){var r=ce.GetMethod(e,Se);if(typeof r!=="undefined"){return ce.Call(r,e,[t])}}return ce.Call(Te,t,[ce.ToString(e)])};ne(String.prototype,"match",Ie)}}var Ee=function wrapConstructor(e,t,r){m.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}if(s){l(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}m.proxy(e,n,t)})}else{l(Object.keys(e),function(n){if(n in W||r[n]){return}t[n]=e[n]})}t.prototype=e.prototype;m.redefine(e.prototype,"constructor",t)};var Pe=function(){return this};var Ce=function(e){if(s&&!z(e,J)){m.getter(e,J,Pe)}};var Me=function(e,t){var r=t||function iterator(){return this};h(e,ie,r);if(!e[ie]&&re.symbol(ie)){e[ie]=r}};var xe=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var Ne=function createDataPropertyOrThrow(e,t,r){xe(e,t,r);if(!ce.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var Ae=function(e,t,r,n){if(!ce.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!ce.TypeIsObject(o)){o=r}var i=O(o);for(var a in n){if(z(n,a)){var u=n[a];h(i,a,u,true)}}return i};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var Re=String.fromCodePoint;ne(String,"fromCodePoint",function fromCodePoint(e){return ce.Call(Re,this,arguments)})}var _e={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!ce.SameValue(r,ce.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){M(t,String.fromCharCode(r))}else{r-=65536;M(t,String.fromCharCode((r>>10)+55296));M(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=ce.ToObject(e,"bad callSite");var r=ce.ToObject(t.raw,"bad raw value");var n=r.length;var o=ce.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,f,s,c;while(a<o){u=ce.ToString(a);s=ce.ToString(r[u]);M(i,s);if(a+1>=o){break}f=a+1<arguments.length?arguments[a+1]:"";c=ce.ToString(f);M(i,c);a+=1}return i.join("")}};if(String.raw&&String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){ne(String,"raw",_e.raw)}b(String,_e);var ke=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var Le=Infinity;var Fe={repeat:function repeat(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);if(r<0||r>=Le){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return ke(t,r)},startsWith:function startsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=ce.ToString(e);var n;if(arguments.length>1){n=arguments[1]}var o=A(ce.ToInteger(n),0);return C(t,o,o+r.length)===r},endsWith:function endsWith(e){var t=ce.ToString(ce.RequireObjectCoercible(this));if(ce.IsRegExp(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=ce.ToString(e);var n=t.length;var o;if(arguments.length>1){o=arguments[1]}var i=typeof o==="undefined"?n:ce.ToInteger(o);var a=R(A(i,0),n);return C(t,a-r.length,a)===r},includes:function includes(e){if(ce.IsRegExp(e)){throw new TypeError('"includes" does not accept a RegExp')}var t=ce.ToString(e);var r;if(arguments.length>1){r=arguments[1]}return I(this,t,r)!==-1},codePointAt:function codePointAt(e){var t=ce.ToString(ce.RequireObjectCoercible(this));var r=ce.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};if(String.prototype.includes&&"a".includes("a",Infinity)!==false){ne(String.prototype,"includes",Fe.includes)}if(String.prototype.startsWith&&String.prototype.endsWith){var De=i(function(){return"/a/".startsWith(/a/)});var ze=a(function(){return"abc".startsWith("a",Infinity)===false});if(!De||!ze){ne(String.prototype,"startsWith",Fe.startsWith);ne(String.prototype,"endsWith",Fe.endsWith)}}if(oe){var qe=a(function(){var e=/a/;e[$.match]=false;return"/a/".startsWith(e)});if(!qe){ne(String.prototype,"startsWith",Fe.startsWith)}var We=a(function(){var e=/a/;e[$.match]=false;return"/a/".endsWith(e)});if(!We){ne(String.prototype,"endsWith",Fe.endsWith)}var Ge=a(function(){var e=/a/;e[$.match]=false;return"/a/".includes(e)});if(!Ge){ne(String.prototype,"includes",Fe.includes)}}b(String.prototype,Fe);var He=["\t\n\x0B\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var Ve=new RegExp("(^["+He+"]+)|(["+He+"]+$)","g");var Be=function trim(){return ce.ToString(ce.RequireObjectCoercible(this)).replace(Ve,"")};var Ue=["\x85","\u200b","\ufffe"].join("");var $e=new RegExp("["+Ue+"]","g");var Je=/^[-+]0x[0-9a-f]+$/i;var Xe=Ue.trim().length!==Ue.length;h(String.prototype,"trim",Be,Xe);var Ke=function(e){return{value:e,done:arguments.length===0}};var Ze=function(e){ce.RequireObjectCoercible(e);this._s=ce.ToString(e);this._i=0};Ze.prototype.next=function(){var e=this._s;var t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return Ke()}var r=e.charCodeAt(t);var n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return Ke(e.substr(t,o))};Me(Ze.prototype);Me(String.prototype,function(){return new Ze(this)});var Ye={from:function from(e){var r=this;var n;if(arguments.length>1){n=arguments[1]}var o,i;if(typeof n==="undefined"){o=false}else{if(!ce.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}if(arguments.length>2){i=arguments[2]}o=true}var a=typeof(te(e)||ce.GetMethod(e,ie))!=="undefined";var u,f,s;if(a){f=ce.IsConstructor(r)?Object(new r):[];var c=ce.GetIterator(e);var l,p;s=0;while(true){l=ce.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=typeof i==="undefined"?n(p,s):t(n,i,p,s)}f[s]=p}catch(v){ce.IteratorClose(c,true);throw v}s+=1}u=s}else{var y=ce.ToObject(e);u=ce.ToLength(y.length);f=ce.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(s=0;s<u;++s){h=y[s];if(o){h=typeof i==="undefined"?n(h,s):t(n,i,h,s)}Ne(f,s,h)}}f.length=u;return f},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!ce.IsCallable(t)?new Array(e):ce.Construct(t,[e]);for(var o=0;o<e;++o){Ne(n,o,arguments[o])}n.length=e;return n}};b(Array,Ye);Ce(Array);q=function(e,t){this.i=0;this.array=e;this.kind=t};b(q.prototype,{next:function(){var e=this.i;var t=this.array;if(!(this instanceof q)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=ce.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return Ke(o)}}this.array=void 0;return Ke()}});Me(q.prototype);var Qe=Array.of===Ye.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!Qe){ne(Array,"of",Ye.of)}var et={copyWithin:function copyWithin(e,t){var r=ce.ToObject(this);var n=ce.ToLength(r.length);var o=ce.ToInteger(e);var i=ce.ToInteger(t);var a=o<0?A(n+o,0):R(o,n);var u=i<0?A(n+i,0):R(i,n);var f;if(arguments.length>2){f=arguments[2]}var s=typeof f==="undefined"?n:ce.ToInteger(f);var c=s<0?A(n+s,0):R(s,n);var l=R(c-u,n-a);var p=1;if(u<a&&a<u+l){p=-1;u+=l-1;a+=l-1}while(l>0){if(u in r){r[a]=r[u]}else{delete r[a]}u+=p;a+=p;l-=1}return r},fill:function fill(e){var t;if(arguments.length>1){t=arguments[1]}var r;if(arguments.length>2){r=arguments[2]}var n=ce.ToObject(this);var o=ce.ToLength(n.length);t=ce.ToInteger(typeof t==="undefined"?0:t);r=ce.ToInteger(typeof r==="undefined"?o:r);var i=t<0?A(o+t,0):R(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=ce.ToObject(this);var n=ce.ToLength(r.length);if(!ce.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new q(this,"key")},values:function values(){return new q(this,"value")},entries:function entries(){return new q(this,"entry")}};if(Array.prototype.keys&&!ce.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!ce.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ie]){b(Array.prototype,{values:Array.prototype[ie]});if(re.symbol($.unscopables)){Array.prototype[$.unscopables].values=true}}if(c&&Array.prototype.values&&Array.prototype.values.name!=="values"){var tt=Array.prototype.values;ne(Array.prototype,"values",function values(){return ce.Call(tt,this,arguments)});h(Array.prototype,ie,Array.prototype.values,true)}b(Array.prototype,et);if(1/[true].indexOf(true,-0)<0){h(Array.prototype,"indexOf",function indexOf(e){var t=E(this,arguments);if(t===0&&1/t<0){return 0}return t},true)}Me(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){Me(Object.getPrototypeOf([].values()))}var rt=function(){return a(function(){return Array.from({length:-1}).length===0})}();var nt=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!rt||!nt){ne(Array,"from",Ye.from)}var ot=function(){return a(function(){return Array.from([0],void 0)})}();if(!ot){var it=Array.from;ne(Array,"from",function from(e){if(arguments.length>1&&typeof arguments[1]!=="undefined"){return ce.Call(it,this,arguments)}else{return t(it,this,e)}})}var at=-(Math.pow(2,32)-1);var ut=function(e,r){var n={length:at};n[r?(n.length>>>0)-1:0]=true;return a(function(){t(e,n,function(){throw new RangeError("should not reach here")},[]);return true})};if(!ut(Array.prototype.forEach)){var ft=Array.prototype.forEach;ne(Array.prototype,"forEach",function forEach(e){return ce.Call(ft,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.map)){var st=Array.prototype.map;ne(Array.prototype,"map",function map(e){return ce.Call(st,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.filter)){var ct=Array.prototype.filter;ne(Array.prototype,"filter",function filter(e){return ce.Call(ct,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.some)){var lt=Array.prototype.some;ne(Array.prototype,"some",function some(e){return ce.Call(lt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.every)){var pt=Array.prototype.every;ne(Array.prototype,"every",function every(e){return ce.Call(pt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduce)){var vt=Array.prototype.reduce;ne(Array.prototype,"reduce",function reduce(e){return ce.Call(vt,this.length>=0?this:[],arguments)},true)}if(!ut(Array.prototype.reduceRight,true)){var yt=Array.prototype.reduceRight;ne(Array.prototype,"reduceRight",function reduceRight(e){return ce.Call(yt,this.length>=0?this:[],arguments)},true)}var ht=Number("0o10")!==8;var bt=Number("0b10")!==2;var gt=y(Ue,function(e){return Number(e+0+e)===0});if(ht||bt||gt){var dt=Number;var mt=/^0b[01]+$/i;var Ot=/^0o[0-7]+$/i;var wt=mt.test.bind(mt);var jt=Ot.test.bind(Ot);var St=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(re.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(re.primitive(t)){return t}}throw new TypeError("No default value")};var Tt=$e.test.bind($e);var It=Je.test.bind(Je);var Et=function(){var e=function Number(t){var r;if(arguments.length>0){r=re.primitive(t)?t:St(t,"number")}else{r=0}if(typeof r==="string"){r=ce.Call(Be,r);if(wt(r)){r=parseInt(C(r,2),2)}else if(jt(r)){r=parseInt(C(r,2),8)}else if(Tt(r)||It(r)){r=NaN}}var n=this;var o=a(function(){dt.prototype.valueOf.call(n);return true});if(n instanceof e&&!o){return new dt(r)}return dt(r)};return e}();Ee(dt,Et,{});b(Et,{NaN:dt.NaN,MAX_VALUE:dt.MAX_VALUE,MIN_VALUE:dt.MIN_VALUE,NEGATIVE_INFINITY:dt.NEGATIVE_INFINITY,POSITIVE_INFINITY:dt.POSITIVE_INFINITY});Number=Et;m.redefine(S,"Number",Et)}var Pt=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Pt,MIN_SAFE_INTEGER:-Pt,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:K,isInteger:function isInteger(e){return K(e)&&ce.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&k(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});h(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if([,1].find(function(){return true})===1){ne(Array.prototype,"find",et.find)}if([,1].findIndex(function(){return true})!==0){ne(Array.prototype,"findIndex",et.findIndex)}var Ct=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Mt=function ensureEnumerable(e,t){if(s&&Ct(e,t)){Object.defineProperty(e,t,{enumerable:false})}};var xt=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var Nt=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var At=function(e,t){var r=n(Object(t));var o;if(ce.IsCallable(Object.getOwnPropertySymbols)){o=v(Object.getOwnPropertySymbols(Object(t)),Ct(t))}return p(P(r,o||[]),Nt(t),e)};var Rt={assign:function(e,t){var r=ce.ToObject(e,"Cannot convert undefined or null to object");return p(ce.Call(xt,1,arguments),At,r)},is:function is(e,t){return ce.SameValue(e,t)}};var _t=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(_t){ne(Object,"assign",Rt.assign)}b(Object,Rt);if(s){var kt={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!ce.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||ce.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,kt)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf;var r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Lt=!i(function(){return Object.keys("foo")});if(!Lt){var Ft=Object.keys;ne(Object,"keys",function keys(e){return Ft(ce.ToObject(e))});n=Object.keys}var Dt=i(function(){return Object.keys(/a/g)});if(Dt){var zt=Object.keys;ne(Object,"keys",function keys(e){if(re.regex(e)){var t=[];for(var r in e){if(z(e,r)){M(t,r)}}return t}return zt(e)});n=Object.keys}if(Object.getOwnPropertyNames){var qt=!i(function(){return Object.getOwnPropertyNames("foo")});if(!qt){var Wt=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Gt=Object.getOwnPropertyNames;ne(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=ce.ToObject(e);if(g(t)==="[object Window]"){try{return Gt(t)}catch(r){return P([],Wt)}}return Gt(t)})}}if(Object.getOwnPropertyDescriptor){var Ht=!i(function(){return Object.getOwnPropertyDescriptor("foo","bar")});if(!Ht){var Vt=Object.getOwnPropertyDescriptor;ne(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Vt(ce.ToObject(e),t)})}}if(Object.seal){var Bt=!i(function(){return Object.seal("foo")});if(!Bt){var Ut=Object.seal;ne(Object,"seal",function seal(e){if(!ce.TypeIsObject(e)){return e}return Ut(e)})}}if(Object.isSealed){var $t=!i(function(){return Object.isSealed("foo")});if(!$t){var Jt=Object.isSealed;ne(Object,"isSealed",function isSealed(e){if(!ce.TypeIsObject(e)){return true}return Jt(e)})}}if(Object.freeze){var Xt=!i(function(){return Object.freeze("foo")});if(!Xt){var Kt=Object.freeze;ne(Object,"freeze",function freeze(e){if(!ce.TypeIsObject(e)){return e}return Kt(e)})}}if(Object.isFrozen){var Zt=!i(function(){return Object.isFrozen("foo")});if(!Zt){var Yt=Object.isFrozen;ne(Object,"isFrozen",function isFrozen(e){if(!ce.TypeIsObject(e)){return true}return Yt(e)})}}if(Object.preventExtensions){var Qt=!i(function(){return Object.preventExtensions("foo")});if(!Qt){var er=Object.preventExtensions;ne(Object,"preventExtensions",function preventExtensions(e){if(!ce.TypeIsObject(e)){return e}return er(e)})}}if(Object.isExtensible){var tr=!i(function(){return Object.isExtensible("foo")});if(!tr){var rr=Object.isExtensible;ne(Object,"isExtensible",function isExtensible(e){if(!ce.TypeIsObject(e)){return false}return rr(e)})}}if(Object.getPrototypeOf){var nr=!i(function(){return Object.getPrototypeOf("foo")});if(!nr){var or=Object.getPrototypeOf;ne(Object,"getPrototypeOf",function getPrototypeOf(e){return or(ce.ToObject(e))})}}var ir=s&&function(){var e=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags");return e&&ce.IsCallable(e.get)}();if(s&&!ir){var ar=function flags(){if(!ce.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};m.getter(RegExp.prototype,"flags",ar)}var ur=s&&a(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});var fr=oe&&s&&function(){var e=/./;e[$.match]=false;return RegExp(e)===e}();var sr=a(function(){return RegExp.prototype.toString.call({source:"abc"})==="/abc/"});var cr=sr&&a(function(){return RegExp.prototype.toString.call({source:"a",flags:"b"})==="/a/b"});if(!sr||!cr){var lr=RegExp.prototype.toString;h(RegExp.prototype,"toString",function toString(){var e=ce.RequireObjectCoercible(this);if(re.regex(e)){return t(lr,e)}var r=ue(e.source);var n=ue(e.flags);return"/"+r+"/"+n},true);m.preserveToString(RegExp.prototype.toString,lr)}if(s&&(!ur||fr)){var pr=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get;var vr=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{};var yr=function(){return this.source};var hr=ce.IsCallable(vr.get)?vr.get:yr;var br=RegExp;var gr=function(){return function RegExp(e,t){var r=ce.IsRegExp(e);var n=this instanceof RegExp;if(!n&&r&&typeof t==="undefined"&&e.constructor===RegExp){return e}var o=e;var i=t;if(re.regex(e)){o=ce.Call(hr,e);i=typeof t==="undefined"?ce.Call(pr,e):t;return new RegExp(o,i)}else if(r){o=e.source;i=typeof t==="undefined"?e.flags:t}return new br(e,t)}}();Ee(br,gr,{$input:true});RegExp=gr;m.redefine(S,"RegExp",gr)}if(s){var dr={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};l(n(dr),function(e){if(e in RegExp&&!(dr[e]in RegExp)){m.getter(RegExp,dr[e],function get(){return RegExp[e]})}})}Ce(RegExp);var mr=1/Number.EPSILON;var Or=function roundTiesToEven(e){return e+mr-mr};var wr=Math.pow(2,-23);var jr=Math.pow(2,127)*(2-wr);var Sr=Math.pow(2,-126);var Tr=Math.E;var Ir=Math.LOG2E;var Er=Math.LOG10E;var Pr=Number.prototype.clz;delete Number.prototype.clz;var Cr={acosh:function acosh(e){var t=Number(e);if(X(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}var r=1/(t*t);if(t<2){return Y(t-1+D(1-r)*t)}var n=t/2;return Y(n+D(1-r)*n-1)+1/Ir},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}var r=k(t);var n=r*r;var o=Z(t);if(r<1){return o*Y(r+n/(D(n+1)+1))}return o*(Y(r/2+D(1+1/n)*r/2-1)+1/Ir)},atanh:function atanh(e){var t=Number(e);if(t===0){return t}if(t===-1){return-Infinity}if(t===1){return Infinity}if(X(t)||t<-1||t>1){return NaN}var r=k(t);return Z(t)*Y(2*r/(1-r))/2},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0;var n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=L(F(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var t=Number(e);var r=ce.ToUint32(t);if(r===0){return 32}return Pr?ce.Call(Pr,r):31-_(F(r+.5)*Ir)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(X(t)){return NaN}if(!T(t)){return Infinity}var r=L(k(t)-1);return(r+1/(r*Tr*Tr))*(Tr/2)},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(k(t)>.5){return L(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=k(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*D(r)},log2:function log2(e){return F(e)*Ir},log10:function log10(e){return F(e)*Er},log1p:Y,sign:Z,sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}var r=k(t);if(r<1){var n=Math.expm1(r);return Z(t)*n*(1+1/(n+1))/2}var o=L(r-1);return Z(t)*(o-1/(o*Tr*Tr))*(Tr/2)},tanh:function tanh(e){var t=Number(e);if(X(t)||t===0){return t}if(t>=20){return 1}if(t<=-20){return-1}return(Math.expm1(t)-Math.expm1(-t))/(L(t)+L(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-_(-t):_(t)},imul:function imul(e,t){var r=ce.ToUint32(e);var n=ce.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Z(t);var n=k(t);if(n<Sr){return r*Or(n/Sr/wr)*Sr*wr}var o=(1+wr/Number.EPSILON)*n;var i=o-(o-n);if(i>jr||X(i)){return r*Infinity}return r*i}};var Mr=function withinULPDistance(e,t,r){return k(1-e/t)/Number.EPSILON<(r||8)};b(Math,Cr);h(Math,"sinh",Cr.sinh,Math.sinh(710)===Infinity);h(Math,"cosh",Cr.cosh,Math.cosh(710)===Infinity);h(Math,"log1p",Cr.log1p,Math.log1p(-1e-17)!==-1e-17);h(Math,"asinh",Cr.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));h(Math,"asinh",Cr.asinh,Math.asinh(1e300)===Infinity);h(Math,"atanh",Cr.atanh,Math.atanh(1e-300)===0);h(Math,"tanh",Cr.tanh,Math.tanh(-2e-17)!==-2e-17);
h(Math,"acosh",Cr.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);h(Math,"acosh",Cr.acosh,!Mr(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON)));h(Math,"cbrt",Cr.cbrt,!Mr(Math.cbrt(1e-300),1e-100));h(Math,"sinh",Cr.sinh,Math.sinh(-2e-17)!==-2e-17);var xr=Math.expm1(10);h(Math,"expm1",Cr.expm1,xr>22025.465794806718||xr<22025.465794806718);var Nr=Math.round;var Ar=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var Rr=mr+1;var _r=2*mr-1;var kr=[Rr,_r].every(function(e){return Math.round(e)===e});h(Math,"round",function round(e){var t=_(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Ar||!kr);m.preserveToString(Math.round,Nr);var Lr=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=Cr.imul;m.preserveToString(Math.imul,Lr)}if(Math.imul.length!==2){ne(Math,"imul",function imul(e,t){return ce.Call(Lr,Math,arguments)})}var Fr=function(){var e=S.setTimeout;if(typeof e!=="function"&&typeof e!=="object"){return}ce.IsPromise=function(e){if(!ce.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!ce.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.resolve=void 0;t.reject=void 0;t.promise=new e(r);if(!(ce.IsCallable(t.resolve)&&ce.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&ce.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){M(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=N(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;var t=e&&e.resolve&&e.resolve();return t&&function(e){return t.then(e)}};var i=ce.IsCallable(S.setImmediate)?S.setImmediate:typeof process==="object"&&process.nextTick?process.nextTick:o()||(ce.IsCallable(n)?n():function(t){e(t,0)});var a=function(e){return e};var u=function(e){throw e};var f=0;var s=1;var c=2;var l=0;var p=1;var v=2;var y={};var h=function(e,t,r){i(function(){g(e,t,r)})};var g=function(e,t,r){var n,o;if(t===y){return e(r)}try{n=e(r);o=t.resolve}catch(i){n=i;o=t.reject}o(n)};var d=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.fulfillReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+l],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=s;r.reactionLength=0};var m=function(e,t){var r=e._promise;var n=r.reactionLength;if(n>0){h(r.rejectReactionHandler0,r.reactionCapability0,t);r.fulfillReactionHandler0=void 0;r.rejectReactions0=void 0;r.reactionCapability0=void 0;if(n>1){for(var o=1,i=0;o<n;o++,i+=3){h(r[i+p],r[i+v],t);e[i+l]=void 0;e[i+p]=void 0;e[i+v]=void 0}}}r.result=t;r.state=c;r.reactionLength=0};var O=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return m(e,new TypeError("Self resolution"))}if(!ce.TypeIsObject(r)){return d(e,r)}try{n=r.then}catch(o){return m(e,o)}if(!ce.IsCallable(n)){return d(e,r)}i(function(){j(e,r,n)})};var n=function(r){if(t){return}t=true;return m(e,r)};return{resolve:r,reject:n}};var w=function(e,r,n,o){if(e===I){t(e,r,n,o,y)}else{t(e,r,n,o)}};var j=function(e,t,r){var n=O(e);var o=n.resolve;var i=n.reject;try{w(r,t,o,i)}catch(a){i(a)}};var T,I;var E=function(){var e=function Promise(t){if(!(this instanceof e)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!ce.IsCallable(t)){throw new TypeError("not a valid resolver")}var r=Ae(this,e,T,{_promise:{result:void 0,state:f,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}});var n=O(r);var o=n.reject;try{t(n.resolve,o)}catch(i){o(i)}return r};return e}();T=E.prototype;var P=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var C=function(e,t,r){var n=e.iterator;var o=[];var i={count:1};var a,u;var f=0;while(true){try{a=ce.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(s){e.done=true;throw s}o[f]=void 0;var c=t.resolve(u);var l=P(f,o,r,i);i.count+=1;w(c.then,c,l,r.reject);f+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var x=function(e,t,r){var n=e.iterator;var o,i,a;while(true){try{o=ce.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);w(a.then,a,r.resolve,r.reject)}return r.promise};b(E,{all:function all(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return C(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},race:function race(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Promise is not object")}var n=new r(t);var o,i;try{o=ce.GetIterator(e);i={iterator:o,done:false};return x(i,t,n)}catch(a){var u=a;if(i&&!i.done){try{ce.IteratorClose(o,true)}catch(f){u=f}}var s=n.reject;s(u);return n.promise}},reject:function reject(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(!ce.TypeIsObject(t)){throw new TypeError("Bad promise constructor")}if(ce.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(T,{"catch":function(e){return this.then(null,e)},then:function then(e,t){var n=this;if(!ce.IsPromise(n)){throw new TypeError("not a promise")}var o=ce.SpeciesConstructor(n,E);var i;var b=arguments.length>2&&arguments[2]===y;if(b&&o===E){i=y}else{i=new r(o)}var g=ce.IsCallable(e)?e:a;var d=ce.IsCallable(t)?t:u;var m=n._promise;var O;if(m.state===f){if(m.reactionLength===0){m.fulfillReactionHandler0=g;m.rejectReactionHandler0=d;m.reactionCapability0=i}else{var w=3*(m.reactionLength-1);m[w+l]=g;m[w+p]=d;m[w+v]=i}m.reactionLength+=1}else if(m.state===s){O=m.result;h(g,i,O)}else if(m.state===c){O=m.result;h(d,i,O)}else{throw new TypeError("unexpected Promise state")}return i.promise}});y=new r(E);I=T.then;return E}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Fr==="function"){b(S,{Promise:Fr});var Dr=w(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var zr=!i(function(){return S.Promise.reject(42).then(null,5).then(null,W)});var qr=i(function(){return S.Promise.call(3,W)});var Wr=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);try{r.then(null,W).then(null,W)}catch(n){return true}return t===r}(S.Promise);var Gr=s&&function(){var e=0;var t=Object.defineProperty({},"then",{get:function(){e+=1}});Promise.resolve(t);return e===1}();var Hr=function BadResolverPromise(e){var t=new Promise(e);e(3,function(){});this.then=t.then;this.constructor=BadResolverPromise};Hr.prototype=Promise.prototype;Hr.all=Promise.all;var Vr=a(function(){return!!Hr.all([1,2])});if(!Dr||!zr||!qr||Wr||!Gr||Vr){Promise=Fr;ne(S,"Promise",Fr)}if(Promise.all.length!==1){var Br=Promise.all;ne(Promise,"all",function all(e){return ce.Call(Br,this,arguments)})}if(Promise.race.length!==1){var Ur=Promise.race;ne(Promise,"race",function race(e){return ce.Call(Ur,this,arguments)})}if(Promise.resolve.length!==1){var $r=Promise.resolve;ne(Promise,"resolve",function resolve(e){return ce.Call($r,this,arguments)})}if(Promise.reject.length!==1){var Jr=Promise.reject;ne(Promise,"reject",function reject(e){return ce.Call(Jr,this,arguments)})}Mt(Promise,"all");Mt(Promise,"race");Mt(Promise,"resolve");Mt(Promise,"reject");Ce(Promise)}var Xr=function(e){var t=n(p(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Kr=Xr(["z","a","bb"]);var Zr=Xr(["z",1,"a","3",2]);if(s){var Yr=function fastkey(e,t){if(!t&&!Kr){return null}if(se(e)){return"^"+ce.ToString(e)}else if(typeof e==="string"){return"$"+e}else if(typeof e==="number"){if(!Zr){return"n"+e}return e}else if(typeof e==="boolean"){return"b"+e}return null};var Qr=function emptyObject(){return Object.create?Object.create(null):{}};var en=function addIterableToMap(e,n,o){if(r(o)||re.string(o)){l(o,function(e){if(!ce.TypeIsObject(e)){throw new TypeError("Iterator value "+e+" is not an entry object")}n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(!se(o)){a=n.set;if(!ce.IsCallable(a)){throw new TypeError("bad map")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{if(!ce.TypeIsObject(f)){throw new TypeError("Iterator value "+f+" is not an entry object")}t(a,n,f[0],f[1])}catch(s){ce.IteratorClose(i,true);throw s}}}}};var tn=function addIterableToSet(e,n,o){if(r(o)||re.string(o)){l(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(!se(o)){a=n.add;if(!ce.IsCallable(a)){throw new TypeError("bad set")}i=ce.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=ce.IteratorStep(i);if(u===false){break}var f=u.value;try{t(a,n,f)}catch(s){ce.IteratorClose(i,true);throw s}}}}};var rn={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!ce.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ce.ToString(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={isMapIterator:true,next:function next(){if(!this.isMapIterator){throw new TypeError("Not a MapIterator")}var e=this.i;var t=this.kind;var r=this.head;if(typeof this.i==="undefined"){return Ke()}while(e.isRemoved()&&e!==r){e=e.prev}var n;while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return Ke(n)}}this.i=void 0;return Ke()}};Me(i.prototype);var a;var u=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=Ae(this,Map,a,{_es6map:true,_head:null,_map:G?new G:null,_size:0,_storage:Qr()});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){en(Map,e,arguments[0])}return e};a=u.prototype;m.getter(a,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(a,{get:function get(e){o(this,"get");var t;var r=Yr(e,true);if(r!==null){t=this._storage[r];if(t){return t.value}else{return}}if(this._map){t=V.call(this._map,e);if(t){return t.value}else{return}}var n=this._head;var i=n;while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Yr(e,true);if(t!==null){return typeof this._storage[t]!=="undefined"}if(this._map){return B.call(this._map,e)}var r=this._head;var n=r;while((n=n.next)!==r){if(ce.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head;var i=n;var a;var u=Yr(e,true);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}else if(this._map){if(B.call(this._map,e)){V.call(this._map,e).value=t}else{a=new r(e,t);U.call(this._map,e,a);i=n.prev}}while((i=i.next)!==n){if(ce.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(ce.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head;var n=r;var i=Yr(t,true);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}else if(this._map){if(!B.call(this._map,t)){return false}n=V.call(this._map,t).prev;H.call(this._map,t)}while((n=n.next)!==r){if(ce.SameValueZero(n.key,t)){n.key=e;n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._map=G?new G:null;this._size=0;this._storage=Qr();var t=this._head;var r=t;var n=r.next;while((r=n)!==t){r.key=e;r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});Me(a,a.entries);return u}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!ce.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+ce.ToString(t))}};var o;var i=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=Ae(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Qr()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){tn(Set,e,arguments[0])}return e};o=i.prototype;var a=function(e){var t=e;if(t==="^null"){return null}else if(t==="^undefined"){return void 0}else{var r=t.charAt(0);if(r==="$"){return C(t,1)}else if(r==="n"){return+C(t,1)}else if(r==="b"){return t==="btrue"}}return+t};var u=function ensureMap(e){if(!e["[[SetData]]"]){var t=new rn.Map;e["[[SetData]]"]=t;l(n(e._storage),function(e){var r=a(e);t.set(r,r)});e["[[SetData]]"]=t}e._storage=null};m.getter(i.prototype,"size",function(){r(this,"size");if(this._storage){return n(this._storage).length}u(this);return this["[[SetData]]"].size});b(i.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Yr(e))!==null){return!!this._storage[t]}u(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Yr(e))!==null){this._storage[t]=true;return this}u(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Yr(e))!==null){var n=z(this._storage,t);return delete this._storage[t]&&n}u(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Qr()}if(this["[[SetData]]"]){this["[[SetData]]"].clear()}},values:function values(){r(this,"values");u(this);return new f(this["[[SetData]]"].values())},entries:function entries(){r(this,"entries");u(this);return new f(this["[[SetData]]"].entries())},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;u(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});h(i.prototype,"keys",i.prototype.values,true);Me(i.prototype,i.prototype.values);var f=function SetIterator(e){this.it=e};f.prototype={isSetIterator:true,next:function next(){if(!this.isSetIterator){throw new TypeError("Not a SetIterator")}return this.it.next()}};Me(f.prototype);return i}()};var nn=S.Set&&!Set.prototype["delete"]&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys);if(nn){S.Set=rn.Set}if(S.Map||S.Set){var on=a(function(){return new Map([[1,2]]).get(1)===2});if(!on){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,S.Map.prototype);return e};S.Map.prototype=O(G.prototype);h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var an=new Map;var un=function(){var e=new Map([[1,0],[2,0],[3,0],[4,0]]);e.set(-0,e);return e.get(0)===e&&e.get(-0)===e&&e.has(0)&&e.has(-0)}();var fn=an.set(1,2)===an;if(!un||!fn){ne(Map.prototype,"set",function set(e,r){t(U,this,e===0?0:e,r);return this})}if(!un){b(Map.prototype,{get:function get(e){return t(V,this,e===0?0:e)},has:function has(e){return t(B,this,e===0?0:e)}},true);m.preserveToString(Map.prototype.get,V);m.preserveToString(Map.prototype.has,B)}var sn=new Set;var cn=Set.prototype["delete"]&&Set.prototype.add&&Set.prototype.has&&function(e){e["delete"](0);e.add(-0);return!e.has(0)}(sn);var ln=sn.add(1)===sn;if(!cn||!ln){var pn=Set.prototype.add;Set.prototype.add=function add(e){t(pn,this,e===0?0:e);return this};m.preserveToString(Set.prototype.add,pn)}if(!cn){var vn=Set.prototype.has;Set.prototype.has=function has(e){return t(vn,this,e===0?0:e)};m.preserveToString(Set.prototype.has,vn);var yn=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(yn,this,e===0?0:e)};m.preserveToString(Set.prototype["delete"],yn)}var hn=w(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var bn=Object.setPrototypeOf&&!hn;var gn=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||bn||!gn){S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new G;if(arguments.length>0){en(Map,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Map.prototype);return e};S.Map.prototype=G.prototype;h(S.Map.prototype,"constructor",S.Map,true);m.preserveToString(S.Map,G)}var dn=w(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var mn=Object.setPrototypeOf&&!dn;var On=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||mn||!On){var wn=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new wn;if(arguments.length>0){tn(Set,e,arguments[0])}delete e.constructor;Object.setPrototypeOf(e,Set.prototype);return e};S.Set.prototype=wn.prototype;h(S.Set.prototype,"constructor",S.Set,true);m.preserveToString(S.Set,wn)}var jn=new S.Map;var Sn=!a(function(){return jn.keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||jn.size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||u(S.Map)||u(S.Set)||typeof jn.keys().next!=="function"||Sn||!hn){b(S,{Map:rn.Map,Set:rn.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){h(S.Set.prototype,"keys",S.Set.prototype.values,true)}Me(Object.getPrototypeOf((new S.Map).keys()));Me(Object.getPrototypeOf((new S.Set).keys()));if(c&&S.Set.prototype.has.name!=="has"){var Tn=S.Set.prototype.has;ne(S.Set.prototype,"has",function has(e){return t(Tn,this,e)})}}b(S,rn);Ce(S.Map);Ce(S.Set)}var In=function throwUnlessTargetIsObject(e){if(!ce.TypeIsObject(e)){throw new TypeError("target must be an object")}};var En={apply:function apply(){return ce.Call(ce.Call,null,arguments)},construct:function construct(e,t){if(!ce.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length>2?arguments[2]:e;if(!ce.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return ce.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){In(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},has:function has(e,t){In(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(En,{ownKeys:function ownKeys(e){In(e);var t=Object.getOwnPropertyNames(e);if(ce.IsCallable(Object.getOwnPropertySymbols)){x(t,Object.getOwnPropertySymbols(e))}return t}})}var Pn=function ConvertExceptionToBoolean(e){return!i(e)};if(Object.preventExtensions){Object.assign(En,{isExtensible:function isExtensible(e){In(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){In(e);return Pn(function(){return Object.preventExtensions(e)})}})}if(s){var Cn=function get(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t);if(!n){var o=Object.getPrototypeOf(e);if(o===null){return void 0}return Cn(o,t,r)}if("value"in n){return n.value}if(n.get){return ce.Call(n.get,r)}return void 0};var Mn=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return Mn(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!ce.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return ae.defineProperty(o,r,{value:n})}else{return ae.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(En,{defineProperty:function defineProperty(e,t,r){In(e);return Pn(function(){return Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){In(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){In(e);var r=arguments.length>2?arguments[2]:e;return Cn(e,t,r)},set:function set(e,t,r){In(e);var n=arguments.length>3?arguments[3]:e;return Mn(e,t,r,n)}})}if(Object.getPrototypeOf){var xn=Object.getPrototypeOf;En.getPrototypeOf=function getPrototypeOf(e){In(e);return xn(e)}}if(Object.setPrototypeOf&&En.getPrototypeOf){var Nn=function(e,t){var r=t;while(r){if(e===r){return true}r=En.getPrototypeOf(r)}return false};Object.assign(En,{setPrototypeOf:function setPrototypeOf(e,t){In(e);if(t!==null&&!ce.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===ae.getPrototypeOf(e)){return true}if(ae.isExtensible&&!ae.isExtensible(e)){return false}if(Nn(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var An=function(e,t){if(!ce.IsCallable(S.Reflect[e])){h(S.Reflect,e,t)}else{var r=a(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){ne(S.Reflect,e,t)}}};Object.keys(En).forEach(function(e){An(e,En[e])});var Rn=S.Reflect.getPrototypeOf;if(c&&Rn&&Rn.name!=="getPrototypeOf"){ne(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Rn,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(a(function(){S.Reflect.setPrototypeOf(1,{});return true})){ne(S.Reflect,"setPrototypeOf",En.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!a(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){ne(S.Reflect,"defineProperty",En.defineProperty)}}if(S.Reflect.construct){if(!a(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){ne(S.Reflect,"construct",En.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var _n=Date.prototype.toString;var kn=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return ce.Call(_n,this)};ne(Date.prototype,"toString",kn)}var Ln={anchor:function anchor(e){return ce.CreateHTML(this,"a","name",e)},big:function big(){return ce.CreateHTML(this,"big","","")},blink:function blink(){return ce.CreateHTML(this,"blink","","")},bold:function bold(){return ce.CreateHTML(this,"b","","")},fixed:function fixed(){return ce.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return ce.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return ce.CreateHTML(this,"font","size",e)},italics:function italics(){return ce.CreateHTML(this,"i","","")},link:function link(e){return ce.CreateHTML(this,"a","href",e)},small:function small(){return ce.CreateHTML(this,"small","","")},strike:function strike(){return ce.CreateHTML(this,"strike","","")},sub:function sub(){return ce.CreateHTML(this,"sub","","")},sup:function sub(){return ce.CreateHTML(this,"sup","","")}};l(Object.keys(Ln),function(e){var r=String.prototype[e];var n=false;if(ce.IsCallable(r)){var o=t(r,"",' " ');var i=P([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){ne(String.prototype,e,Ln[e])}});var Fn=function(){if(!oe){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e($())!=="undefined"){return true}if(e([$()])!=="[null]"){return true}var t={a:$()};t[$()]=true;if(e(t)!=="{}"){return true}return false}();var Dn=a(function(){if(!oe){return true}return JSON.stringify(Object($()))==="{}"&&JSON.stringify([Object($())])==="[{}]"});if(Fn||!Dn){var zn=JSON.stringify;ne(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=ce.IsCallable(n)?n:null;var a=function(e,r){var n=i?t(i,this,e,r):r;if(typeof n!=="symbol"){if(re.symbol(n)){return Nt({})(n)}else{return n}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return zn.apply(this,o)})}return S});
/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
!function(e,t){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",t):"object"==typeof module&&module.exports?module.exports=t():e.EvEmitter=t()}("undefined"!=typeof window?window:this,function(){function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var i=this._events=this._events||{},n=i[e]=i[e]||[];return n.indexOf(t)==-1&&n.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var i=this._onceEvents=this._onceEvents||{},n=i[e]=i[e]||{};return n[t]=!0,this}},t.off=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){var n=i.indexOf(t);return n!=-1&&i.splice(n,1),this}},t.emitEvent=function(e,t){var i=this._events&&this._events[e];if(i&&i.length){i=i.slice(0),t=t||[];for(var n=this._onceEvents&&this._onceEvents[e],o=0;o<i.length;o++){var r=i[o],s=n&&n[r];s&&(this.off(e,r),delete n[r]),r.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("ev-emitter")):e.imagesLoaded=t(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){if(Array.isArray(e))return e;var t="object"==typeof e&&"number"==typeof e.length;return t?d.call(e):[e]}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var s=e;return"string"==typeof e&&(s=document.querySelectorAll(e)),s?(this.elements=n(s),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),h&&(this.jqDeferred=new h.Deferred),void setTimeout(this.check.bind(this))):void a.error("Bad element for imagesLoaded "+(s||e))}function r(e){this.img=e}function s(e,t){this.url=e,this.element=t,this.img=new Image}var h=e.jQuery,a=e.console,d=Array.prototype.slice;o.prototype=Object.create(t.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),this.options.background===!0&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&u[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var s=r[n];this.addElementBackgroundImages(s)}}}};var u={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,e),n=i.exec(t.backgroundImage)}},o.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},o.prototype.addBackground=function(e,t){var i=new s(e,t);this.images.push(i)},o.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(t){t.once("progress",e),t.check()}):void this.complete()},o.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,e,t)},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var e=this.getIsImageComplete();return e?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype=Object.create(r.prototype),s.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var e=this.getIsImageComplete();e&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},s.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},s.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},o.makeJQueryPlugin=function(t){t=t||e.jQuery,t&&(h=t,h.fn.imagesLoaded=function(e,t){var i=new o(this,e,t);return i.jqDeferred.promise(h(this))})},o.makeJQueryPlugin(),o});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/dist/FileSaver.js */
(function(a,b){if("function"==typeof define&&define.amd)define([],b);else if("undefined"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){"use strict";function b(a,b){return"undefined"==typeof b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error("could not download file")},d.send()}function d(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(c){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement("a");g=g||b.name||"download",j.download=g,j.rel="noopener","string"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target="_blank")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,h){if(g=g||f.name||"download","string"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement("a");i.href=f,i.target="_blank",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open("","_blank"),g&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof b)return c(b,d,e);var h="application/octet-stream"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&"undefined"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof module&&(module.exports=g)});
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau, all rights reserved. | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js | (c) 2015 Thomas Michael Edwards | Licensed under SugarCube's Simple BSD license */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
}else{document.documentElement.setAttribute("data-init", "lacking");}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">@-webkit-keyframes init-loading-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes init-loading-spin{0%{-o-transform:rotate(0);transform:rotate(0)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes init-loading-spin{0%{-webkit-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}#init-screen{display:none;z-index:500000;position:fixed;top:0;left:0;height:100%;width:100%;font:28px/1 Helmet,Freesans,sans-serif;font-weight:700;color:#eee;background-color:#111;text-align:center}#init-screen>div{display:none;position:relative;margin:0 auto;max-width:1136px;top:25%}html[data-init=lacking] #init-screen,html[data-init=loading] #init-screen,html[data-init=no-js] #init-screen{display:block}html[data-init=lacking] #init-lacking,html[data-init=no-js] #init-no-js{display:block;padding:0 1em}html[data-init=no-js] #init-no-js{color:red}html[data-init=loading] #init-loading{display:block;border:24px solid transparent;border-radius:50%;border-top-color:#7f7f7f;border-bottom-color:#7f7f7f;width:100px;height:100px;-webkit-animation:init-loading-spin 2s linear infinite;-o-animation:init-loading-spin 2s linear infinite;animation:init-loading-spin 2s linear infinite}html[data-init=loading] #init-loading>div{text-indent:9999em;overflow:hidden;white-space:nowrap}html[data-init=loading] #passages,html[data-init=loading] #ui-bar{display:none}</style>
<style id="style-font" type="text/css">@font-face{font-family:tme-fa-icons;src:url('data:application/octet-stream;base64,d09GRgABAAAAADLAAA8AAAAAWHgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABWAAAADsAAABUIIslek9TLzIAAAGUAAAAQwAAAFY+IEkIY21hcAAAAdgAAAG8AAAF3rob9jFjdnQgAAADlAAAABMAAAAgBtX/BGZwZ20AAAOoAAAFkAAAC3CKkZBZZ2FzcAAACTgAAAAIAAAACAAAABBnbHlmAAAJQAAAI6gAADv+gJOpzGhlYWQAACzoAAAAMwAAADYY1IZaaGhlYQAALRwAAAAgAAAAJAfCBClobXR4AAAtPAAAAJEAAAFMBfb/0WxvY2EAAC3QAAAAqAAAAKhjiHI5bWF4cAAALngAAAAgAAAAIAFjDA9uYW1lAAAumAAAAY0AAAL94+zEpHBvc3QAADAoAAACHAAAA11cG/YjcHJlcAAAMkQAAAB6AAAAhuVBK7x4nGNgZGBg4GIwYLBjYHJx8wlh4MtJLMljkGJgYYAAkDwymzEnMz2RgQPGA8qxgGkOIGaDiAIAJjsFSAB4nGNgZNZgnMDAysDAVMW0h4GBoQdCMz5gMGRkAooysDIzYAUBaa4pDA4vGF4EMgf9z2KIYg5imAYUZgTJAQDSIQumAHic7dTVbltRAETR7dpNCikzQ8rMzMxt/M39mHnsU1/TfZz5jFpaV7pXJunMDLAZmOqaZjD5y4Tx+uPTyeL5lG2L5zN+L94zG8+ztr7ulXH1fra4bvK9M79xiWW2sNXPbWeFHexkF7vZw172sZ8DHOQQhznCUY5xnBOc5BSnOcNZVjnHeS5wkUtc5gpX/f3r3OAmt7jNHe5yj/s84CGPeMwTnvKM57zgJa94zRve8o73fOAjn/jMF77yje/84Ce/WGPun1zi/2tlXKbp3Xyc44bFyZanSWokJDXOOjXSk/LUSXn+pEwCKTNBaqQqZU5IjX+XMjukTBEp80TKZJEyY6RMGylzR8oEkjKLpEwlKfNJyqSSMrOkTC8pc0zKRJMy26RMOSnzTsrkk7IDpGwDKXtByoaQsiukbA0p+0PKJpGyU6RsFyl7RmosQcrukbKFpOwjKZtJyo6Ssq2k7C0pG0zKLpOy1aTsNymbTsrOk7L9pNwBUi4CKbeBlCtByr0g5XKQckNIuSak3BVSLgwpt4aUq0PK/SHlEpFyk0i5TqTcKVIuFim3i5QrRso9I+WykXLjXOYNzP8BuAPUwHicY2BAAxIQyBz0PwuEARJsA90AeJytVml300YUHXlJnIQsJQstamHExGmwRiZswYAJQbJjIF2crZWgixQ76b7xid/gX/Nk2nPoN35a7xsvJJC053Cak6N3583VzNtlElqS2AvrkZSbL8XU1iaN7DwJ6YZNy1F8KDt7IWWKyd8FURCtltq3HYdERCJQta6wRBD7HlmaZHzoUUbLtqRXTcotPekuW+NBvVXffho6yrE7oaRmM3RoPbIlVRhVokimPVLSpmWo+itJK7y/wsxXzVDCiE4iabwZxtBI3htntMpoNbbjKIpsstwoUiSa4UEUeZTVEufkigkMygfNkPLKpxHlw/yIrNijnFawS7bT/L4vead3OT+xX29RtuRAH8iO7ODsdCVfhFtbYdy0k+0oVBF213dCbNnsVP9mj/KaRgO3KzK90IxgqXyFECs/ocz+IVktnE/5kkejWrKRE0HrZU7sSz6B1uOIKXHNGFnQ3dEJEdT9kjMM9pg+Hvzx3imWCxMCeBzLekclnAgTKWFzNEnaMHJgJWWLKqn1rpg45XVaxFvCfu3a0ZfOaONQd2I8Ww8dWzlRyfFoUqeZTJ3aSc2jKQ2ilHQmeMyvAyg/oklebWM1iZVH0zhmxoREIgIt3EtTQSw7saQpBM2jGb25G6a5di1apMkD9dyj9/TmVri501PaDvSzRn9Wp2I62AvT6WnkL/Fp2uUiRen66Rl+TOJB1gIykS02w5SDB2/9DtLL15YchdcG2O7t8yuofdZE8KQB+xvQHk/VKQlMhZhViFZAYq1rWZbJ1awWqcjUd0OaVr6s0wSKchwXx76Mcf1fMzOWmBK+34nTsyMuPXPtSwjTHHybdT2a16nFcgFxZnlOp1mW7+s0x/IDneZZntfpCEtbp6MsP9RpgeVHOh1jeUELmnTfwZCLMOQCDpAwhKUDQ1hegiEsFQxhuQhDWBZhCMslGMLyYxjCchmGsLysZdXUU0nj2plYBmxCYGKOHrnMReVqKrlUQrtoVGpDnhJulVQUz6p/ZaBePPKGObAWSJfIml8xzpWPRuX41hUtbxo7V8Cx6m8fjvY58VLWi4U/Bf/V1lQlvWLNw5Or8BuGnmwnqjapeHRNl89VPbr+X1RUWAv0G0iFWCjKsmxwZyKEjzqdhmqglUPMbMw8tOt1y5qfw/03MUIWUP34NxQaC9yDTllJWe3grNXX27LcO4NyOBMsSTE38/pW+CIjs9J+kVnKno98HnAFjEpl2GoDrRW82ScxD5neJM8EcVtRNkja2M4EiQ0c84B5850EJmHqqg3kTuGGDfgFYW7BeSdconqjLIfuRezzKKT8W6fiRPaoaIzAs9kbYa/vQspvcQwkNPmlfgxUFaGpGDUV0DRSbqgGX8bZum1Cxg70Iyp2w7Ks4sPHFveVkm0ZhHykiNWjo5/WXqJOqtx+ZhSX752+BcEgNTF/e990cZDKu1rJMkdtA1O3GpVT15pD41WH6uZR9b3j7BM5a5puuiceel/TqtvBxVwssPZtDtJSJhfU9WGFDaLLxaVQ6mU0Se+4BxgWGNDvUIqN/6v62HyeK1WF0XEk307Ut9HnYAz8D9h/R/UD0Pdj6HINLs/3mhOfbvThbJmuohfrp+g3MGutuVm6BtzQdAPiIUetjrjKDXynBnF6pLkc6SHgY90V4gHAJoDF4BPdtYzmUwCj+Yw5PsDnzGHQZA6DLeYw2GbOGsAOcxjsMofBHnMYfMGcdYAvmcMgZA6DiDkMnjAnAHjKHAZfMYfB18xh8A1z7gN8yxwGMXMYJMxhsK/p1jDMLV7QXaC2QVWgA1NPWNzD4lBTZcj+jheG/b1BzP7BIKb+qOn2kPoTLwz1Z4OY+otBTP1V050h9TdeGOrvBjH1D4OY+ky/GMtlBr+MfJcKB5RdbD7n74n3D9vFQLkAAQAB//8AD3icrXsLcFzlleZ//v+++nb37dfte/VotVrdrW5JltuKpO6WJVluPyXbsmOEbGRjO4KVjWPZlsM4QIU4IYGlgCE2yxqKIQkJg2GreKQCTCZb1CZkiswjzOwOmSTATNVWTZLdDUwSMrVDsomD23vOf69assFAqgbk+773P4//nPOdc/5mwNjFl8WjosbaWblmxiOmIlTGYXzb11M7Z2ohAMbZCcZ5iG9prZl4whfwGju05xtttitUdwXYEUgkbQtWga5lC+XBaqJI285qpb8dVEc8Gnm5L5QM/f58yAlB399a7dD0mWAmdAqaMvBmKPKX9TdDwSjod9yhx03FAPcvI6Gk2lV33XoXUtKgL8C6Wa0WSzXbVjhg6JoqIPShCK0FOvOuE48K1V4B1VUQAVevugmP7Fz2CmTzW5/8+ZGP/+Kp7h/8oI4MuOZ7M5B9IvujH2Wf+PnCAjzn8ZK6AieMKRcvXnxWWSWCzGARlPcqtqs21WZzEBFgYIVDAYWzVJIrXBlH+hXGlWNM00GAJmYZ8sKBzTJFVZVppijqDFMVdTIWLa0o5JrdaHusPZGIG1IjFhQGK2mAZEe56kJnR1bTY7ZT7eivFGODBTdma3pHtlCNDVbwmgMHx/aO4R8ffeet5/ZCG6TfuV03IaSJU3oIzKsGO9+5PV+BwU5xqnOQx1aO8fW71yvD9fPn55/fA22PmsaFvfSgwZ8wzPiFvZ2DUMnzJ2hHVDMmHucPsSRrq7UQo4DMAV/AW7CANw/Zru3NIx20bBEpXwukArlxxOPReibaG63/SyQyiftzcBy3k1HuOHgjEgFHnkYfh4VodDJC4138Ff8hv5PlWbrWmm2O6grNEgGNCWGnbFtRm1Z04gzQPPWvkqMWF4eWU8DB267Df+gNe84bBvfRpfNI5Ny5yAmHDh5/PPLuByMlekDS9DsRR73nWHetwBShSO5PqCBQONO4E2wGlSvYZG6gMzeQ09SWFZC0tWION3oOVVXGTbGM+hrAzQj0O25yoN8R8YzzRsaZdzLwhpsGPEm783hAJ9+kq286eDX5pn/VydDjvk7i8EuchU21JJ3DNOqFzeABmywPcNXxhu/wB+3whrqwVw7Cn1j8vPfdDH6O7PR3fDV/Cb85wua/waSit309grZJHHOhHEQ9CA7zTGVCUb0ZvXzc1lrRe5Af+4An0aSL9op0IU9y6vRFtAYGKy7KJGFbQrdg2dXqGAwWilld0zUy9xLqd6A/zeFuy7gzYFmBOwOhZ6NNhZakm8YTI7S1pyM1mM032V26qevXGlzZ8+TKvROlB/BBkO9ACDalB7OZuBnuC5tRcAItpalENNOfhajVH1A2a1HjbHZ4N4r54oWLz4qPoe4jrMo2sonapm5QRQBQ3XycKVxwRRxjQuVCnWc6mrzOZ5FvBiraOmia5FubYRpok8n0ioRTKOQMNbWiszxYWAFZrQ1sB+dDJTFYghzyiBN3oB857ndIAha4Se/+YGUtjAkXXUO2xPE2eoe3TWPeMOXmzNi+j9w1HghvVbSAmu4c6nFac6MgbzXFU2baDr1241+98TfHtU/9t7df+MzU4msmfPYj06Wbw8Gqohda0/FkSyiyvtPGG/FsMKq1pLqmPvndkye/+y+08eYIHEJZpFmJra2Nop/VWuKcCwPvgRhnGlOFps6iIdAEmFVAKh53jblZyBU6nAFdbfX03tGwioZ9oGnEyDSWTQCyFzhoR+s/jdjgWLmc3L2K21zEmXCsM5aDm4g9Ny5v0PZVb+dY9Rcd/sl5eTiPj0nTaeiU+BhhW2qbuzJcUy2Nc2gCrjBkxWCqZiArGgOuwSzjAlDb5L91XfpvfYbpij6ZRIUWYoVcLqC2+UqNLddsMrekY3GZztVl2uQjpl4xjedIM+Uybc/r5viShuHgcgXuwQtpuoMHz8utCe/s8S+Y/7xMaYu2DX1yDrez3lp3cyyKdop+HLcLi878Uh9SKOSlj73cOIUFRVKVKHhaSS9JP452RCcYoJ3w85bz8Ckp9VN4xeZj9atpH4FnPCV4OtiDNIVYCrWwsbauK81VxUlaQnA+riFBisoUsiU0LbQpASCmmRAwg1MNJoH19uQ6WpriUV1jIQjphA5QjosiTfiy1tF+kPJKMTFYpAu6lkx40odnTv7VjYtC/QtTJyGH9HmMnKamGrcaqmaagRsMUwR9WeLmwsQREvIRevSvYa8uVFXo9Sc0w5A8/Rp5+jcxhXLuYAOIx/pbY+ggFp0FV8lNoLNAEQvyDkwBZR9T1ZC6xR0qFgsybix3DJcR7iIGwCsCHHQM0nYKVSBXQZPnqG7KDZiqrn8K524gpN9ghAx42k4GsvF3nohnA0kbnglkC9mrl7h4Db2TommKcVE1QOPRd97K5WJxsKO5nIjHbHtx/og3kK8iWys1he/EkKlqCbFOB6iKQp5Q5Yp6DB0AsjmPvHEFSGsoFraPaVpI2zLc2lmudErjJ/eeQwbKPoRBZulcwhwXYc6i1SdiEpiCF+KrFOIrAzKaHdhQ79tw4MAGuJv4rt8sQQu80jloGnnDfNVJBa+vn1WjSg1d8NHrg44FbTgdJ5+T77yy/gDI5wY7633yTbI7+CdyMDyEL2paDd0BvZjyfIYXH2/H+aqjDfXUisgnk3rFYMePoyZBegWanQpM5hKdlUSU1JnoQH2iG1d90IYADi0JPV2/oxMEeB7apm+aBngFw/ObMjzHzv7dgzyOh48fHZnmO9c8Wv+2RAGwHiP20UNnzx46mvYxyaMixDpZX22lQqQgRDqG4kYcMo92cpypAOo0Ti+iSYXJRGc5l8wvQhPfqpE0SYa7nDwkeQyh26OOlbecqVumoCwJ8+mDm+9/5T4eOyOt+4wk8WjavYTIG+7nD5Li2cWv8zGkMYoz51q2u3Y1JQSwfcumSn9JUxW0CZIWQ5isqKCo8zoGFPybx/lyHD2w4AaCBw7Ap1HIxAaHyZlr1tXG1owMt7h5Ox5QmxF4Iv6vDhaQoTFAYADuYIlnLa7b7RwtiOBDtVK1dbyCMXXxn5azOIIKfLFKaQP9K3HKIMYEQosvhkIWH23TQ9wIpCq9M4WxycnJsQIUYrEJ/bPGuOZohfHVzdmMaAmHm418c7DU3xdoyYPebFktPJtpHu7fefjw4R0VHiNTa06ZUTPe09a1sdTUVNrYtbo3nth11VW7tBa1d/U1a1t71rdG2u1IJNkWDYdbUs0pnnFT+OloWzISsdsjqVpvy9prqrNjed41POfPx2+J7TIXaWP5Wgf5bvToBEvpppQYOXPOJoda4gTQE6TsNK8sAvUSSHBFygfnfM9wL+8aK/Bddv0tZ8SufyKZ7ml7s20iCWdsPpPu4YVaXuur/2M6WX8riReTE21vtPUAnn4iyTxdf0vJ+/QM0pwsUL4D5BmUBQEeXpaU4W6RtExzN1In7eT9qHPpIoUdqAzSrdyHIPo1JNRps1uioCWJyIm2U/JG8oO4aZMXozF8b4RupRd5JJv7Nn8ZeUyxjlrakhJHcwO2gHMUDgGLR0MmS0GrIoMRWos0K81LUnPZYgmkw6sM8HtCoQTaT9y0Wu3f/MZuCYfijhMPhUVQNdL2hY8kMroS/8UvEqqeSfC/xzPV07k3vsqyrL+2ykYnhJjEz45OLIdbu4ncrbrWhImzltU7oqqaXAEdMWiHxPsSdvuF70K6/xf6FejjL13YBvFVP+UXrkwnyelZjBcltoLypQIoEmsoiDUw4C2QFS/I/J6yx5ybWOOqaMad0kJlKo+ElAdLqvRTMqOsgucuM64j3hgHU1H1mIkQ084Oje3eXT1lZwL1nwaD0BZMNfFTcHpv+sf7v6LEo4oZMlRbFNqH9tb60nEN0UkQ0mYawZNpR878eFuD1lWsl/Jb9J5iMbPlDKnkh3raBmS66U1M9Jm5rKUmMel1dKLOcxrVSgf5dJqU4o0g0pJyTlV37x4bytpCATOG8VUT4+m9cPoURiakE34ZMes/wbB0Roun+2p7h9oLSlwzQqZq2eIr+xe2/Rhp5QF8hHn5Hh/FfM9ibs32UrNG+l22ZbrnJ8N+fERAcD6YCp6nuPc2Aq/vWXiMfzKaye/BDfzTLPwe33MT8ns4P/y0uiLBdyZw3qRvNvGZegjF6H+escXvreOnkD7zm7IkADTbJEkU4sdw1jmwzpTj42smHLB82ijenjfx9YsXkccR+B5+I1azGtQk+4maTpnLlsBL75E7O1IPea+mzfPmUwQt00FJoG+nPxN/zruZzZprTljyx2GpXiHdYWBZtcINeB+2xVP16/GT9euDwf00TbqgK5gK7QvCmfp/wPn15WDa3BcM1l/Hy8F9wZQ31nf4Q2IjjrXyG+BnzXnMmqXiTuB5CLa01gINjvb8mesSTwHuSAEtzm8anp+uvwbdprkfhUs0wCNIxH6TP1l/vf6aPDThK0TXI5I+tjj+SX/8wIcaPxWX4y+CqsCiEIiAIzhsKrgfh+6qv+4L4RETPl6/zqMKukki9AA96OseZb3Zk7UKVKxZKt65tpR1J9p1sTGgP5Z4ah+KEzl73R/xEfr+I8H5fchlN/Jr0n0c3fSGkrz+vbhd5m2ZWltThDeKUaKh3WTZXWauS+WomBdMkjGvOCRuT9YfcIZxk0x24/5cT3q8redxe8TpTsLn03b9LIaFo/I0eQ7uxtjQm6rffI4elnTcJfbwX/qRFyG+Vw+SaJdyFIpugk0WXCcnaZFo1323viNAWHZPvk1+ugfjTf2sbcPR5LDT442bhwPj6Z5z9qi9wr8B85Ji51yXb3tISxlpSUtaZEYnFX8ZbHI6C8vk4ll2h5/YdRQbM0CUbSmXHsd5rH5zWz7fBnc/5iA1NLANwyQZ2+5JjiYfQ4mle+BxJA1prT9g+770dv4zTz9RnTPp+JlY4DJKoroOucmyT4fnsGIeFC3H9EtmB+qnGyP6413tPvs4BhIwipskDKakeIg+KKTgbl92JBkkHn1J3c8t+9ia2vBKhMFkGBJtEjrGDIzKE1SeAgTJiDAVRYpKmSGwMlksJor5gUWgjKlXYS0gurS4neaYflXJnaWBUjDKNAVhkWoF1WhHz7uJ2PapE8NHJkulySPD62/qVmLapMq10a997JqvnphQarc8dO3UQ2smYr38pfOWszK6fTs+eBKfHy4j8t2uWNrWnbDx5CNfe+TkxrHVE/EEW4ynxM9H2FhtpAeE2tnGFUH1J4xXChxD5hACLNXbLgOA3WU353rI37Y44SipbwdxwED/mEC0rOmuIzmlGkw7SBzNxZ6NN3519+zXRhV1Uosp3TdtGD68s4eXJo8uzHVtjyXc85gC9MYmRh+euuaRk+vhAG43Tm3RLGW7Clp52Oesq3N7dKVjnW9KxCdWjyFvi/nUs+Ja5CnPxtn+2t4NnVwLrELw76JqDMz1MacMGJoR0I5RVsA1lR/DLEdonLJLQWnOMcSamKlrszLnWWZ3mzcVOjsrnYWynTfVNmQ6aQFxrWtL9SQtgjqsojbxf5lp+qquSF1rVGyk02qZZEEKRkPdlv9ff3LVQ6MTFMas8xSft3fNVbd+vqg1KaF5w7RwBsirUye24UVXDS3oIcj/nz+56mF6qQlUAQ++gGoNytcxFG7P98DWMXMoHIL/6l/Z7p1riv8ko2oiyiru129WsSrmUjO1XdtWc0Pr7miOoWOV9YUQ07WQPmsCisWYDge5puAUAI3NIk6EQACmaQ+BGRaAwOSemV1TH90+vnlDrZBNFOi/nEUlLL96lYx5VZLqB5zDQLFQzGm6KuUX89L6YqxRuaPsCwXYTlJE1EVJt9ycWTo8bereoW7Wv38ewfOzmgI/N42Kn53LatjTxUCv85zbEyg+Y5hTcDddq99M2ysc8/51lABfjZ++8KvSxvUlnpCj7U+mIG3vR8yhXSbXEbaB3cDmatdds4lrhi9Z8hskNo2hkI+RQHWN6fMIUwKGFZiNhDmCNq6BoR1gejCoTzNdD86woB6cPDh33YFr91w99dHJLePr1tp525NylKZkzJtthLplN+ADzhOxjpiN1trRPwb/vhKfqIcMg8Mr3DDqd38o4cM36y9KWa+Tsn7v4/ocj134Vcg2TZsf/ABFKH4tYwrtObZYYxoF3QiQC+PjATwUho5+W8MkQlOOqUDxnlMNjZpsfB8zjJCxZe2afKeTjXeuboqT2XcOlsACB6XROFhWch7AeNy/VsZfx4fO5Aj8EjTVRPjLdtrmTS1NX7Azce6kmjZnnHf+1iuBiG0duzsmQTiZPzfjEoTGAqZ7xqt/nmmai8gXOWb0/sG9z8vyyPNOZjKDf9DlRgmQR93keVlHOU/9RTkfH8W8ieTQzWpsc21DGRM0Xw4soAUWDEDPtMB0oS9I5qeXC0PhMySPyTWjuYFctn9JEgWLp6FSXdz71TeSgzuQBmnXVHPXGqWhIhXkF+H2lQXxVqiSO5OthN9CQQSazmBOhdycwSgoZRJvQ28Yz8SVltDiwd3PUxMLN9De1dWehinH5783RvA9xhpyoHgnWAfGvE3sqtqOFT25rGIoMB4GBa0NAaepg2KYyiwVijQqFKGtopEeUFFYgQCboj0jZ8cCk7U1Q2W3MBBLjMRi0SCKxO0od6gD6Muon6Q35JGLDZS9DEpfLNZTA4aqrmrD0rwHCAO8Cs/Ur4a3J0Lql9WU4RfBJiYySfg+cviqaczLvipt59LuhbjXflPdSuRLUUd/9VV422jRv6SF/NbehYrcQ1p2AZ6jd80L5+kSRwE3WV+OVGTs9GvnU6yLDbJsrZ2aE+iijskqPtuHgTAktgz0r+xtaUaslZRRH6FKlRJrBwO9bK+lef8YXipg7j8GSJjM+GRPmSApRv6n//T4VrH3qqbRaNxoqoxSNMfwD6MV18yPulftrX+xZ7gXeka7vMCPgf2aQ8+N4bPuaKz7lg2LIGjjTT3x4T4jvubPYKL+cFtPTxscwm0DA+yVNaMjbFNt/cE9k+sUpoxgas8Gu1qjhG7GqUu+oAFel8B2gTDcgt+54If2XXv1VVsmVvRkM4m4TnnrYCGLtt5foc4F2rWO/NrIbxENvBHUy0WJBYqEg8hbyklAxoATvupfHMCZ3wAHaASEAFz/Y7pUPh+ZumWK7z65G1KGftgMJro0NbIzrOvbm1sCuhL9tBGKtrof1aLaZkdRjS4zYhzSDTDVw4bldnrPGtubWgKGiH0adR1JuR9VI/qErSgB72HMk0emp2+anr6F7kfTydZ+zdKSO0EdDRuTqaip3xAIjapaLa1aWqg/kmqNQEiXzza3ZFbqId3euezR4Iiqbkj5j7ZEIeTX7X4n9vLvLmKL2mAXILVUp0WPoyLCVJVGQ+/yNlGhjP8PNLq4y9vNy9rPrn+eW36OaPmdX0nTF7EIpu9XPlvW1XMgOiHbSHIL1ji1nsbpBdbAyXtlTRwjSHuCqyJvkjfAVEiMe317oeLEURlNKa/CI7tfVLxLp5qb4tFwUFVYJ3R6/STHqy1Xi1R9RLvvd6lSPIba14rZoo6zwa3w/7L18OGzRwC+N7B52+HD2zYPfA8OP3iIH9kyjkd4Fdwj9x85skUPzfXhQd9cSN96mB+97yjgoYUXvZ7kxYu/UW7mL7Eo+rwKK9byTKWsSWWz6N8VBaZxB5ShgDJZHerscm0J6L1at2fNGPH4CqQNZ+gAGTeaPZVNBB52IJ7nt/uI3N/B0707Do+8vmEH37rpdTLX8eEDd47Xr564Y3aIj+67azM8Q4dwYHjpHbJoOu1/8OkH++lk4s59Y2Lo+tsevG1ukA/N3uHb9f9TbkFebNRET61I/GEuOEtdCkxKcdfISpPptmSn01kdVNF4Y4NjHF1rWnh0cxWZKImsJdKcKPPIkZR5RIoYkcJ7dh665dDOHqV/4jgc2ILXkYz77zgwypGsH1zKst/L+ir6nJVsPdtR2zaC4aQTZC9CR4p0jigDQ6gmexJcUeeXdbS0xY7WslzDdpPF8uryAPX0L+tqoVNFD5QrFi7rbKGXwYnkJGCpwra4XMZe1th6JZcOCL0VgV445HepqL+l5jVdKMHP1VeH89a/WtYaK2/9Z/g4noyFYduzjf6WpSS0FIKDRovrC4aaQ9ZArQ9b1r/K58P0Yhi/4Msl4WPhFbUuzCTBb1OitsjmCVsAn+Qs3eokTJ1FeEQlI1nGXNlfnbS8tcc/sYz4wU8vsbd+lr/UII5u7mncOYBJ+WKc+5jsETe/L03AXCfmN4IlTVnCOYiVSxyWr5h45up7d/Lpu568c7ey4zRcu6yjzk9P3Xvu3im5qb9yaf98ab2AwZIsy0Zrq6nXxkG22zi121ScGiC71IoiZwcZqlAmzUCmvaU5GgkkzaQfoNCjlKimWnxvGhtR5b4r0roYFX59BZLFsvVB5NMRIVAGQ65bJoBsRuaFbLJM/0n3nZCLlZaWYKj+efWy88WezKv+yiG5dKnN23mX2uUJbi5bY+Rc4XgxBrHXGnlYb637gwLPEuXVBmD1ViiIyzgRfl5f9NddvfoB9NDxw0clWD9KV0FbdhMMjzfc+H7uJXEG8fo6Ns4O1q5fU+KCCq16PhXG3JuJcczFw6GwEaLSBXkQwNwF4DgLs1AgHDqA2FToAXEgCDpj+jTudDaDgUmnGsaG9bWx1UOVctJGzBlDf2HJWgZyh1HHkeV53RK5WC6Gc8fr45AzKSByxwlWHShTsxydSgfVLhALUZsXOiS8w0TlVOdJ006bC4ZayA43j7cN9WCqeCgYDTvGJzKnKG0Jn7ou6KSC18Frs8FUk2Jch1frv65/kWLdMMbf2fWfDKac4HFdaYpb8HY9ZDXZhnEylEgHP7t2L6YMcO46M22b111HA113zoFBDJQUpy/WLx6B36K+MxQdmlHBKerm0BIJKqUu68GgoLY0VSpexdChJiDC1WpC9qwK1cQYpS7U0BW0JAzeMrX6P+hRI2Dy4z/hqqmb4gS3jG8GLT77P1Ue5E4wfOFTFoioAS8NYVYZhv9umJapaPV6hct6wHdkHiowcqVYnvUivt5Qa+3vK/X2dBXy2Uy6pclBE4pR4XkwxWHTtq93vH+tv0l2U6pFvbNRePWrv51uBFbBWmgHbw/upXv+0LnRc1AxL/RjLrVgmvx/yP0Fq1KJxarV2A+PHct2HDvWwbvxJIYX60/THfzHrcdGH7shQm/iC2l6E/fXRumtaPU/ybeyx+p34UkVL0LJv9PAUHOomzL1w8q9uZaYoV3SIOoujHBKKii60eKMxhJHXUMgTQW0InVqqErq22AbYN6BHOMkFCMtlpWLDDc/0NM23tYLZ1uGMX5ZrWfPtkQj+chQ61lZiH+gZSiai0Sbz4JhDbeswXd2PSVr8E/twqtr8KXdu690Q2KpI6jHMMuhBjdRdbG9iQslEae6YVhDV7gBdOiHgK4iKtSERkv4yOpAP8ZMpimmNqtSRuUFG50FDD2AeaYRNrasGS0P2LTwuGDncpRJNtZ5Fpev85SVhMY6T3ewBJrtjAFIs8XZi95eSXOXLJkW75wKaXmE7afkst1TsjBDJxP3v3I//kG6Z9R+ce7WnfcfrvHRo6fPnT46CpteTMJZ7yXKMb2XTlHieMpspgUYLz+k3UsJV/LFTWNH7vvT08eHlfWHHtx+69yLSbZMRhHWhDn2SG0oYCC3qE/B0qAKuZqPg+b5XkErlwWmYkKlMkNY2eLmUAqF3OJinmKjrPIhuK1/W/IJ6z8kh5K1D2aK+/UTWqOzkz1fC4xVOgKKKqgjZqKV9nhTGGOgUGnZjiK4Mq8jJFKOMwJ0UxSLdlO/Ymvrtq8H3/UG+nBNcG0e7Vh79xt/yOf37KklDMPYaeyc3LZ1y8hwT671KoP8BApooL9agOqYUm2FATeRptTcdeQGxexmC3pWyw2u5ZSr4l9xsLCKW+DaaeqxVskXZql+XdTggY9NDrcHk331MoTzqZSj3fGlCe3GxJQT6IsGjeBkQOGQO53v+VKSb9E1EVMQ5vKs2/R7axiimWAmiVCh4/MZ1eYrecvvMWx9oa71KppmNkVhBs6G6m+veHkw8amOFi0QFY4pTI7RrikRxSd1jgBaCeytDEHmYSsUN/HTEEyqQVQ6ppY4937ER/nPmMXaWK6W8TvQy1cj+s28wcIlS70LHqQsSoS5rB18abP70ubwv0VMqrRhJALnb2SJXZ76vg7pAPc9++oF2+s8XzLyZUMt/3ajhy35encPGy4n+lIy4Xvvou1JERMJFmTa8zqHldSwlaBa9k6VC63heDzM/3cYttfndDMiKlbIwCN7eV2F8FS61toUNZhCzHltUoKChwg/yah6WVnr8jIXJer+ultoizj14CWn/GfvvEU5uIjTdtnx8nw86K1TlzWF5QsXBhYXGlw+3rLk/5IB/G8+gzZuYUagPa8ByoUaWfiRIuA35I4CrJOMVariLtOCaKD+Ryq3gvWTwSDci1AAfVtQi7zzsmWE4F5Vq/+RPKDe8714vX5SVSVGuXjxa2K/iCyN42qyOkbLkXwt6FIjmt5sRsHC11VB2yANZQl1HL+GWjFC9Em4Vx7Q2oKTeB2+oKkeL3xEkBU015zWlri4VEBrpICIlwZ7Eso2mgSVKs8GLeJN5YsLnmn7Lh7/45KS6ncSg5I/Por8NcaWi7UW27Te2JeyTGPqPg3VS9j2CzJyeznjn1qaGXCrpsq8ro655n7+1zi3WwkBRkGuRl5e3eMyi6L0TvDJcnYwTnM14fWG5Xyh5nXVLya56BmNJRUi25oYoiGRJBGXdaO+Rb1Y9R861mlZYzodsf21K8/wZ1mC8I75Hr9viTsF+fsW5BzxTSO1IFQNz6DJvnC/lPv9L6Ab4KcvfJU6gC94y9NfMP31s7i5XY5RIn6LJqKRxjAKDuOVppiQA65ycUhaEvVeQya8dVuF6uCYKClVFADVGd5FyGt9RTWAAgg50ahiNFm2YkcCarHv3QTW/6Jna0TY0VA0FEpnMkbciKJ0RGSrrMN/XzzKfy7p3saOsq21cUl7FVQ2Dboqxg8D38S4hnxooL2bGRU1qurqAtP1Q1M7xzd3Sd4MKlx9aN7cxtWq/1OQAi25ohrK0s0ilVHwbgmKVNGWD1T/IMmcmd2u68h5MhPsLpW6Mf7ZEUPfceC+0zfhdXy9uTm5cQffujnZrMQFzmZdv+n0HyDOnl33Z4RjOcFoIL338N50IIpBxBEd9+2+7fV+vGGHQ5Y18NCTDw1EwkITYRu/JwZe9fPMI+IfxFUsyjbSqvKhAcwt168pdedsTBbTzZxTnRzRxQyV/if8uggP8y2VcpqWw7iyTmgJOy3GuEu5oK35P5xC0L6GZFag308hopD9/6r3KyoE7rKG5Tqi3D9z8s6TM/3+7mEeeCxiPDanxdWDjxmRxwKIeebmVFVePajGtTl5VaWLcGDdLdMVpbTvxD0n9pWUyvQtew1RfioQFOU/1vU/Lotg4KmyMEz9nnuM2OINTVu8ETPuuUeXPuNZUcFYEmd9rFRbYSxfVUjLiN9dFerqyvd2yKWFBEEB548Fup3m1PWnBQHUERnjyKYur0O1v1pBfvl30u2Hnj4EwydOw/CBOyd23vd4+YefpuUbvHb84elmO9HXD1P3Tq1f48YM5VZ17msH5/d1fPtmWQndeOwTd1EnZNeXbtwsoBRbcbJ29T3T0GbGDO+3J95aen6KxViWDVCHL8i5wsPAxPLfE1FDb55RmQnmCYgrEoijOyX+6KeDoE66Tt5ONjkSgheKBA9LqL6qpqchU0E7QaSYtJ3+irSVimrrmpLJU3ej0gsK6vTRXbdlEXtnb9u17Z9B+Un9m9Hg5rmoE93YF4zCPwZ31H9b/6f6b3cEgzvAgAIYO4IwfMe64Q03nOX3fXzD8Lo7brzrLtiCz85tCkajwb6N0b9LJD738MOfSxTs2x7mj3yGsEgjzzBYB9Xw2hGCYAZOzYWG2uR6nFlvxlJeEZfO732ziNsX84be4ffMGz7/gRmQb1dyTX8Q/dtArU8Hb8Wybmgod53NBlQOilxbg9mPCIstK3sTAzE7O5BMJuTKkvJgwfulBskXM0CBMymXLQrpkSoDMVmJ6aA2QjGG4SJkRk38g5sd61dtYGoQ4St+jHY+U23r4aVWOEjtseoMnDgvfwCEm2+hp6r/X91AK4zYkU3HMVEaxnR3qBfqPzn+/wHPnsOreJxjYGRgYABi1vIsoXh+m68M3MwvgCIMt5YoxkDp2P9f/2exVDAHAbkcDEwgUQAz1Qu/AHicY2BkYGAO+p/FwMBS9v/r/68sFQxAERQQDACh8QbyeJxdT0sVwzAMy49AkAxAkbT3UQiAITGAISmAYQiA9th4ttUs7Q568UeSlVidiwSkB3PUPg+ESd6ZD/+8v7HyrtzwghY89ZB6BcyrYqc6RZhw48YhaA1Wc/v1PQtdeXJ/HppUmFM597nvBVK7D+Z+E8/uQZLBgDyaz3Llvxx02S3c/Hv813JrznryZP4F+6lSfQAAAAAAAAAAUAC2ATABaAGyAfoCJAKwAzYDmgQSBFwExgUyBbQF/AZOBvwHRAe2B/YISgigCPIJGglCCWQJignACgAKQAp2CroLAAtGC4oL8gxcDPINng5iDuYPag/6EF4RIBGGEeQSShKYEyQTbhOyFAoUYhS+FVoVphYoFooXHBeGGFoYnhjGGOwZChlOGXgZrBneGhwaWhqgGtIbLhvyHHQc2B1QHZ4d/wABAAAAUwBtAAYAAAAAAAIAIAAwAHMAAAB2C3AAAAAAeJx1kN9q2zAUh39q0441YxcbjN3tXJWWEcc1lEGvWkLbXZeSu8JUV/6T2VKQlY48w95ifYa9zt6jd/vFESUUYiP5O5/O8ZEE4AP+QWH9nHKsWeEdozXv4A0uIu/Sf488IN9G3sMQPyLv0/+MfICv+BV5iI/4wz+owVtGM/yNrPBZfYm8g/fqW+Rd+svIA/Jd5D18UovI+/S/Ix9gqp4iD3GoniduvvR1WQU5mhxLlmap3C/FUdVWN6IXoXK+k3MpnA2maVySuza0ZlToUZ07292YctFov6k2eWp8VzsrJ0m6qa+NNV4H87Dq1j2WWQiFFN61chX7yNy7mclDUoUwPxuPN/tjAoc5lvCoUaJCgOCI9pjfDGk/BPfMEGaus2pYaDQ0GgtWVP1Kx/ico2BkaQ0zGnKCnHNL09KNuK451721rLqhLfmfht5vzdrmp7Sr3nUfC07YL92afU1r+wrd7/Dh5WwdHrmLjDawanUK3+9acPXqPML7Wq3NaHL6pL+1QHuGMd8t5/8PvPGO3QAAAHicbZLnlpswEIV9DRiwvZtseu89Ib333vvmBWRZYMVC0pHEEufpg8BO/kTncOfTaLgMOtPr97o17P1/baKPACEiDBAjQYohRhhjDevYhu3YwA7sxC7sxh7sxT7sxwEcxCEcxhEcxTEcxwmcxCmcxhmcxTmcxwVcxCVkuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwneIpneI4XeIlXeI03eIt3eI8P+IhP+Iwv+Ipv+I5N/OiF1hEz9JKxUrtFrDl1lWF9NR9QIikToRaVjUouKxvOmNBjLxnlhgo2DbnM1djLKrNGnGPScSUzItzGv93yPP2bSQSX84z9cqFQdJ56yZRmMhW8mLlJJSaBI0XYPDaZKDUviZmvr6DrNjJMi0WcK1MTM02mqpbZlJtEsNx5SI238jSodJtoS7qv+BpPw67IY9xU+dg5TXjROTWwdGrIOzWhT+uA0jolxqjaZrSOnCF2Nmq16651EYpMm1fakAul9SJQeR5QVYQlk1VkZ8SwoVNFIVjWnKQrlBGdMToftdoZjrs77DajqXKrS02YEFxbbtdWkG0x44JJVUS5aBqKSlJwmhDrmOF2Hv9Wqsy4TNqoKhfmSrrQKuNSL5nvPG6p0s0AkEWkSWVZMy1Kx3ljk03qLuZ14lTmB8gNGmByGrGfjLrhlhJV2f7SaIneNF1ypQNbybBUSgZswQaWEUNngeay1/sD4l/60HicY/DewXAiKGIjI2Nf5AbGnRwMHAzJBRsZWJ02MTAyaIEYm7mYGDkgLD4GMIvNaRfTAaA0J5DN7rSLwQHCZmZw2ajC2BEYscGhI2Ijc4rLRjUQbxdHAwMji0NHckgESEkkEGzmYWLk0drB+L91A0vvRiYGFwAMdiP0AAA=') format('woff')}</style>
<style id="style-core" type="text/css">html{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}.no-transition{-webkit-transition:none!important;-o-transition:none!important;transition:none!important}:-webkit-full-screen{height:100%;width:100%}:-ms-fullscreen{height:100%;width:100%}:fullscreen{height:100%;width:100%}body::-ms-backdrop{background:0 0}:focus{outline:thin dotted}:disabled{cursor:not-allowed!important}body{color:#eee;background-color:#111;overflow:auto}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}a[disabled],span.link-disabled{color:#aaa;cursor:not-allowed!important;text-decoration:none}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text]{min-width:18em}textarea{min-width:30em;resize:vertical}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input[type=range]{-webkit-appearance:none;min-height:1.2em}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;margin-top:-5px;width:33px}input[type=range]:focus::-webkit-slider-runnable-track{background:#222}input[type=range]::-moz-range-track{background:#222;border:1px solid #444;border-radius:0;cursor:pointer;height:10px;width:100%}input[type=range]::-moz-range-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:18px;width:33px}input[type=range]::-ms-track{background:0 0;border-color:transparent;color:transparent;cursor:pointer;height:10px;width:calc(100% - 1px)}input[type=range]::-ms-fill-lower{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-fill-upper{background:#222;border:1px solid #444;border-radius:0}input[type=range]::-ms-thumb{background:#35a;border:1px solid #57c;border-radius:0;cursor:pointer;height:16px;width:33px}input:not(:disabled):focus,input:not(:disabled):hover,select:not(:disabled):focus,select:not(:disabled):hover,textarea:not(:disabled):focus,textarea:not(:disabled):hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}audio,canvas,progress,video{max-width:100%;vertical-align:middle}.error-view{background-color:#511;border-left:.5em solid #c22;display:inline-block;margin:.1em;max-width:100%;padding:0 .25em;position:relative}.error-view>.error-toggle{background-color:transparent;border:none;line-height:inherit;left:0;padding:0;position:absolute;top:0;width:1.75em}.error-view>.error{display:inline-block;margin-left:.25em}.error-view>.error-toggle+.error{margin-left:1.5em}.error-view>.error-source[hidden]{display:none}.error-view>.error-source:not([hidden]){background-color:rgba(0,0,0,.2);display:block;margin:0 0 .25em;overflow-x:auto;padding:.25em}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}.error-view>.error-toggle:before,.error-view>.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before,a.link-external:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before) "\00a0\00a0"}[data-icon-after]:after{content:"\00a0\00a0" attr(data-icon-after)}.error-view>.error-toggle:before{content:"\e81a"}.error-view>.error-toggle.enabled:before{content:"\e818"}.error-view>.error:before{content:"\e80d\00a0\00a0"}a.link-external:after{content:"\00a0\e80e"}</style>
<style id="style-core-display" type="text/css">#story{z-index:10;margin:2.5em}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}</style>
<style id="style-core-passage" type="text/css">.passage{line-height:1.75;text-align:left;-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}@media (prefers-reduced-motion:reduce){.passage{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}</style>
<style id="style-core-macro" type="text/css">@-webkit-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@-o-keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}@keyframes cursor-blink{0%{opacity:1}50%{opacity:0}100%{opacity:1}}.macro-append-insert,.macro-linkappend-insert,.macro-linkprepend-insert,.macro-linkreplace-insert,.macro-prepend-insert,.macro-repeat-insert,.macro-replace-insert,.macro-timed-insert{-webkit-transition:opacity .4s ease-in;-o-transition:opacity .4s ease-in;transition:opacity .4s ease-in}.macro-append-in,.macro-linkappend-in,.macro-linkprepend-in,.macro-linkreplace-in,.macro-prepend-in,.macro-repeat-in,.macro-replace-in,.macro-timed-in{opacity:0}.macro-type-cursor:after{-webkit-animation:cursor-blink 1s infinite;-o-animation:cursor-blink 1s infinite;animation:cursor-blink 1s infinite;content:"\2590";opacity:1}</style>
<style id="style-ui-dialog" type="text/css">html[data-dialog] body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-overlay:not(.open){-webkit-transition:visibility .2s step-end,opacity .2s ease-in;-o-transition:visibility .2s step-end,opacity .2s ease-in;transition:visibility .2s step-end,opacity .2s ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:100000;position:fixed;top:-50%;left:-50%;height:200%;width:200%}#ui-dialog.open{display:block;-webkit-transition:opacity .2s ease-in;-o-transition:opacity .2s ease-in;transition:opacity .2s ease-in}#ui-dialog{display:none;opacity:0;z-index:100100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog>*{-webkit-box-sizing:border-box;box-sizing:border-box}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:92%;height:calc(100% - 2.1em)}@media (prefers-reduced-motion:reduce){#ui-overlay.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-overlay:not(.open){-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}#ui-dialog.open{-webkit-transition:opacity 0s;-o-transition:opacity 0s;transition:opacity 0s}}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:.2s;-o-transition-duration:.2s;transition-duration:.2s}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-close{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-close{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}</style>
<style id="style-ui" type="text/css">#ui-dialog-body.settings [id|=setting-body]>div:first-child{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-dialog-body.list{padding:0}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999;speak:none;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves .datestamp{font-size:75%;margin-left:1em}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons>li+li>button{margin-left:.2em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=header-body]{margin:1em 0}#ui-dialog-body.settings div[id|=header-body]:first-child{margin-top:0}#ui-dialog-body.settings div[id|=header-body]:not(:first-child){border-top:1px solid #444;padding-top:1em}#ui-dialog-body.settings div[id|=header-body]>*{margin:0}#ui-dialog-body.settings h2[id|=header-heading]{font-size:1.375em}#ui-dialog-body.settings p[id|=header-desc],#ui-dialog-body.settings p[id|=setting-desc]{font-size:87.5%;margin:0 0 0 .5em}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:1em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.settings input[type=range][id|=setting-control]{max-width:35vw}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em;-webkit-transition:margin-left .2s ease-in;-o-transition:margin-left .2s ease-in;transition:margin-left .2s ease-in}#ui-bar.stowed~#story{margin-left:4.5em}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{margin-left:3.5em}}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left .2s ease-in;-o-transition:left .2s ease-in;transition:left .2s ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility .2s step-end;-o-transition:visibility .2s step-end;transition:visibility .2s step-end}@media (prefers-reduced-motion:reduce){#story{-webkit-transition:margin-left 0s;-o-transition:margin-left 0s;transition:margin-left 0s}#ui-bar{-webkit-transition:left 0s;-o-transition:left 0s;transition:left 0s}}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5;overflow:auto}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:1em 0 0;padding:0;list-style:none;border:1px solid #444}#menu ul:empty{display:none}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#menu-core li[id|=menu-item] a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-debug" type="text/css">#debug-bar{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:0;margin:0;max-height:75%;padding:.5em;position:fixed;right:0;z-index:99900}#debug-bar>div:not([id])+div{margin-top:.5em}#debug-bar>div>label{margin-right:.5em}#debug-bar>div>input[type=text]{min-width:0;width:8em}#debug-bar>div>select{width:15em}#debug-bar-toggle{color:#eee;background-color:#222;border:1px solid #444;height:101%;height:calc(100% + 1px);left:-2em;left:calc(-2em - 1px);position:absolute;top:-1px;width:2em}#debug-bar-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-hint{bottom:.175em;font-size:4.5em;opacity:.33;pointer-events:none;position:fixed;right:.6em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap}#debug-bar-watch{background-color:#222;border-left:1px solid #444;border-top:1px solid #444;bottom:102%;bottom:calc(100% + 1px);font-size:.9em;left:-1px;max-height:650%;max-height:65vh;position:absolute;overflow-x:hidden;overflow-y:scroll;right:0;z-index:99800}#debug-bar-watch[hidden]{display:none}#debug-bar-watch div{color:#999;font-style:italic;margin:1em auto;text-align:center}#debug-bar-watch table{width:100%}#debug-bar-watch tr:nth-child(2n){background-color:rgba(127,127,127,.15)}#debug-bar-watch td{padding:.2em 0}#debug-bar-watch td:first-child+td{padding:.2em .3em .2em .1em}#debug-bar-watch .watch-delete{background-color:transparent;border:none;color:#c00}#debug-bar-watch-all,#debug-bar-watch-none{margin-left:.5em}#debug-bar-views-toggle,#debug-bar-watch-toggle{color:#eee;background-color:transparent;border:1px solid #444;margin-right:1em;padding:.4em}#debug-bar-views-toggle:hover,#debug-bar-watch-toggle:hover{background-color:#333;border-color:#eee}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle,html[data-debug-view] #debug-bar-views-toggle{background-color:#282;border-color:#4a4}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:hover,html[data-debug-view] #debug-bar-views-toggle:hover{background-color:#4a4;border-color:#6c6}#debug-bar-hint:after,#debug-bar-toggle:before,#debug-bar-views-toggle:after,#debug-bar-watch .watch-delete:before,#debug-bar-watch-add:before,#debug-bar-watch-all:before,#debug-bar-watch-none:before,#debug-bar-watch-toggle:after{font-family:tme-fa-icons!important;font-style:normal;font-weight:900;font-variant:normal;line-height:1;speak:never;text-rendering:auto;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#debug-bar-toggle:before{content:"\e838"}#debug-bar-hint:after{content:"\e838\202f\e822"}#debug-bar-watch .watch-delete:before{content:"\e804"}#debug-bar-watch-add:before{content:"\e805"}#debug-bar-watch-all:before{content:"\e83a"}#debug-bar-watch-none:before{content:"\e827"}#debug-bar-views-toggle:after,#debug-bar-watch-toggle:after{content:"\00a0\00a0\e830"}#debug-bar-watch:not([hidden])~div #debug-bar-watch-toggle:after,html[data-debug-view] #debug-bar-views-toggle:after{content:"\00a0\00a0\e831"}html[data-debug-view] .debug{padding:.25em;background-color:#234}html[data-debug-view] .debug[title]{cursor:help}html[data-debug-view] .debug.block{display:inline-block;vertical-align:middle}html[data-debug-view] .debug.invalid{text-decoration:line-through}html[data-debug-view] .debug.hidden,html[data-debug-view] .debug.hidden .debug{background-color:#555}html:not([data-debug-view]) .debug.hidden{display:none}html[data-debug-view] .debug[data-name][data-type].nonvoid:after,html[data-debug-view] .debug[data-name][data-type]:before{background-color:rgba(0,0,0,.25);font-family:monospace,monospace;white-space:pre}html[data-debug-view] .debug[data-name][data-type]:before{content:attr(data-name)}html[data-debug-view] .debug[data-name][data-type|=macro]:before{content:"<<" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=macro].nonvoid:after{content:"<</" attr(data-name) ">>"}html[data-debug-view] .debug[data-name][data-type|=html]:before{content:"<" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type|=html].nonvoid:after{content:"</" attr(data-name) ">"}html[data-debug-view] .debug[data-name][data-type]:not(:empty):before{margin-right:.25em}html[data-debug-view] .debug[data-name][data-type].nonvoid:not(:empty):after{margin-left:.25em}html[data-debug-view] .debug[data-name][data-type|=special],html[data-debug-view] .debug[data-name][data-type|=special]:before{display:block}</style>
</head>
<body>
	<div id="init-screen">
		<div id="init-no-js"><noscript>JavaScript must be enabled to play.</noscript></div>
		<div id="init-lacking"><p>Browser lacks capabilities required to play.</p><p>Upgrade or switch to another browser.</p></div>
		<div id="init-loading"><div>Loading&hellip;</div></div>
	</div>
	<!-- UUID://D61A983E-414E-4C16-8C20-81029CEA8040// --><tw-storydata name="Abyss Diver" startnode="536" creator="Tweego" creator-version="2.1.1+81d1d71" ifid="D61A983E-414E-4C16-8C20-81029CEA8040" zoom="0.6" format="SugarCube" format-version="2.36.1" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">#story {
  margin-top: 30px;
  margin-bottom: 30px;
  min-height: calc(100vh - 60px);
  font-family: verdana, sans-serif;
  background-color: #111b;
}

input[type="text"] {
  background-color: #000000;
  color: #ffffff;
}

.floatl {
  float: left;
  margin-right: 1.5em;
}
.floatr {
  float: right;
  margin-left: 1.5em;
}

#ui-bar {
color: #fff;
background-color: #000c;
font-family: verdana, sans-serif;
}

html, body {
  	position: absolute;
	min-width: 100%;
    min-height: 100vh;
}

#passages {
  padding: 3rem 1rem;
}
#passages > div > :first-child {
  margin-top: 0;
}
#passages > div > :last-child {
  margin-bottom: 0;
}

.cards #passages {
  max-width: unset;
}
.cards #passages h1 {
  font-style: italic;
  text-align: center;
}
.cards p {
  max-width: 54em;
  margin: 28px auto;
}

.image #story {
  	margin-left: 10em;
}
.image #passages {
	max-width: 72em;
}
.image #ui-bar {
color: #fff;
background-color: #000;
}

div.companion > img, div.item > img {
  border-radius: 20px;
}

div.cards-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-evenly;
  margin: 0 -1rem;
  padding: 0 16px;
}
div.cards-grid > div {
  background: #000a;
  border: 8px solid transparent;
  border-image: url(images/bordershop.png) 82 / 20px / 10px round;
  box-shadow: 0px 0px 4px 0px black;
  width: min-content;
  line-height: 1.5;
  text-align: center;
  margin: 32px 16px;
  padding: 8px;
}
div.cards-grid h2 {
  font-style: italic;
  margin: 0;
}
div.cards-grid img {
  width: 354px;
  height: 354px;
  border-radius: 16px;
  margin: 8px;
}
#passage-surface-shop-1 div.cards-grid img, #passage-balloon-store1 div.cards-grid img {
  width: 250px;
  height: 250px;
}
#passage-layer7-vend div.cards-grid {
  background: #245ca8;
  box-shadow: inset 0px 0px 6px 0px black;
  border-radius: 8px;
  margin-left: 0;
  margin-right: 0;
  padding: 0;
}
#passage-layer7-vend div.cards-grid > div {
  border: 1.5px inset #122d52;
  border-radius: 32px;
  padding: 20px;
  margin: 32px 8px;
}
#passage-layer7-vend div.cards-grid img, #passage-layer7-vend div.cards-grid button {
  box-shadow: 0px 0px 16px 4px #9999cc;
}
p.cost {
  font-style: italic;
  margin-top: 0;
}
.unreachable, .warning {
  color: #ff8080;
}

.layerTitle {
  margin: 0 calc(27em - 600px);
  text-align: center;
}
.layerTitle > h1, h1.gameover {
  font-family: copperplate gothic bold;
  font-weight: normal;
  font-size: 300%;
  text-transform: uppercase;
}
.layerTitle > h1:first-child {
  margin-top: 0;
}

.relicTitle {
  font-size: 150%;
  font-weight: bold
}

.say-nameB{
  font-weight: bold;
  font-size:18px
}

.gdr1{
  color: deepskyblue;
  font-size:18px
}

.gdr2{
  color: aqua;
  font-size:18px
}

.gdr3{
  color: beige;
  font-size:18px
}

.gdr4{
  color: lavenderblush;
  font-size:18px
}

.gdr5{
  color: LightPink;
  font-size:18px
}

.gdr6{
  color: HotPink;
  font-size:18px
}

/*doll voice*/
.gdr98{
  color: ghostwhite;
  font-size:18px
}

/*chain of lorelei voice*/
.gdr99{
  color: LightPink;
  font-style: italic;
  font-size:18px
}

/*chain of lorelei voice*/
.alert1{
  color: rgb(255, 123, 0);
  font-size:16px
}

.alert2{
  color: rgb(255, 0, 0);
  font-size:16px
}

body.surface {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/surface-background.png);
  background-attachment: fixed;
  background-size: cover; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer1 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l1background.png);
  /*background-attachment: fixed;*/
  background-size: 1024px;
  /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer2 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l2background-lowres.png);
  /*background-attachment: fixed;*/
  background-size: 356px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer3 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l3background.png);
  /*background-attachment: fixed;*/
  background-size: 1449px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer4 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l4background.png);
  /*background-attachment: fixed;*/
  background-size: 1140; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer5 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l5background.png);
  /*background-attachment: fixed;*/
  background-size: 1024px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer6 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l6background.png);
  /*background-attachment: fixed;*/
  background-size: 900px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer7 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l7background.png);
  /*background-attachment: fixed;*/
  background-size: 900px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer8 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l8background.png);
  /*background-attachment: fixed;*/
  background-size: 865px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer9 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/Backgrounds/l9background.png);
  /*background-attachment: fixed;*/
  background-size: 852px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.layer10 {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/starbackgrounds/stars3.gif);
  /*background-attachment: fixed;*/
  background-size: cover; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.raison {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/smaragdine-background.png);
  /*background-attachment: fixed;*/
  background-size: 1920px; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}

body.indoor {
  background-image: url(images/wood%20background.png);
  background-attachment: fixed;
  background-repeat: repeat;
  background-size: contain;
}

body.start, body.balloon {
  /*background: linear-gradient(135deg, red, blue);*/
  background-color: #111111;
  background-image: url(images/wipbackground.png);
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover; /* maybe contain, based on the image and goals
  color: #FFFFFF;*/
}
</style><script role="script" id="twine-user-script" type="text/twine-javascript">/* twine-user-script #1: "audio.js" */
// Volume Slider, by Chapel; for SugarCube 2
// version 1.2.0 (modified by HiEv)
// For custom CSS for slider use: http://danielstern.ca/range.css/#/

/*
	Changelog:
	v1.2.0:
		- Fixed using/storing the current volume level in the settings.
	v1.1.0:
		- Fixed compatibility issues with SugarCube version 2.28 (still
		  compatible with older versions, too).
		- Added settings API integration for SugarCube 2.26.
		- Internal improvements and greater style consistency with my
		  other work.
		- Added a pre-minified version.
		- By default, the slider is now more granular than before
		  (101 possible positions vs 11). Change the 'current' and
		  'rangeMax' options to 10 to restore the old feel.
*/

(function () {
	// Set initial values.
	var options = {
		current  : 50,  // Default volume level.
		rangeMax : 100,
		step	 : 1,
		setting  : true
	};
	if (options.setting && typeof settings.volume === 'number') {
		options.current = parseInt(settings.volume);
	}

	// Function to update the volume level.
	function setVolume (val) {
		if (typeof val !== 'number') val = Number(val);
		if (Number.isNaN(val) || val < 0) val = 0;
		if (val > 1) val = 1;
		options.current = Math.round(val * options.rangeMax);
		if (options.setting) {
			settings.volume = options.current;
		}
		if ($('input[name=volume]').val() != options.current) {
			$('input[name=volume]').val(options.current);
		}
		try {
			if (SimpleAudio) {
				if (typeof SimpleAudio.volume === 'function') {
					SimpleAudio.volume(val);
				} else {
					SimpleAudio.volume = val;
				}
				return val;
			} else {
				throw new Error('Cannot access audio API.');
			}
		} catch (err) {
			// Fall back to the wikifier if we have to.
			console.error(err.message, err);
			$.wiki('<<masteraudio volume ' + val + '>>');
			return val;
		}
	}

	// Grab volume level changes from the volume slider.
	$(document).on('input', 'input[name=volume]', function() {
		var change = parseInt($('input[name=volume]').val());
		setVolume(change / options.rangeMax);
	});

	// Create the <<volume>> macro.
	Macro.add('volume', {
		handler : function () {
			var wrapper = $(document.createElement('span'));
			var slider = $(document.createElement('input'));
			var className = 'macro-' + this.name;
			slider.attr({
				id		: 'volume-control',
				type	: 'range',
				name	: 'volume',
				min		: '0',
				max		: options.rangeMax,
				step	: options.step,
				value	: options.current
			});
			// Class '.macro-volume' and ID '#volume-control' for styling the slider
			wrapper.append(slider).addClass(className).appendTo(this.output);
		}
	});

	// Add Setting API integration for SugarCube 2.26 and higher.
	function updateVolume () {
		setVolume(settings.volume / options.rangeMax);
	}
	if (options.setting) {
		if (Setting && Setting.addRange && typeof Setting.addRange === 'function') {
			Setting.addRange('volume', {
				label : 'Volume: ',
				min : 0,
				max : options.rangeMax,
				step : options.step,
				default : options.current,
				onInit : updateVolume,
				onChange : updateVolume
			});
		} else {
			console.error('This version of SugarCube does not include the `Settings.addRange()` method; please try updating to the latest version of SugarCube.');
		}
	}
}());

// Check to see if trackID is the currently playing track
window.isPlaying = function (trackID) {
	var track = SimpleAudio.tracks.get(trackID);
	return track !== null && track.isPlaying();
};
/* twine-user-script #2: "Setup Companions" */
setup.willingCurses = {
	"Maru": [
		"Gender Reversal A", "Gender Reversal B", "Gender Reversal C", "Gender Reversal D", "Gender Reversal E",
		"Hair Removal", "Increased Sensitivity", "Age Reduction A", "Age Reduction B",
		"Submissiveness Rectification A", "Submissiveness Rectification B", "Crossdress Your Heart"
	],
	"Lily": [
		"Age Reduction A", "Age Reduction B", "Perma-dye", "Power Dom", "Absolute Pregnancy", "Hair Removal", "Age Reduction A"
	],
	"Khemia": [
		"Asset Robustness A", "Asset Robustness B", "Asset Robustness C", "Asset Robustness D",
		"Clothing Restriction A", "Clothing Restriction B", "Power Dom", "Absolute Birth Control", "Pheromones"
	],
	"Cherry": [
		"Age Reduction A", "Age Reduction B", "Fluffy Ears", "Fluffy Tail", "Omnitool", "Sleep Tight"
	],
	"Cloud": [
		"Age Reduction A", "Age Reduction B", "Asset Robustness A", "Asset Robustness B", "Equal Opportunity", "Pheromones"
	],
	"Saeko": [
		"Asset Robustness A", "Freckle Speckle", "Hair Removal", "Equal Opportunity", "Crossdress Your Heart", "Age Reduction A", "Age Reduction B",
	],
}
/* twine-user-script #3: "Count Curse Instances" */
setup.activeCurseCount = function(name) {
	return variables().playerCurses.countWith(
		e => e.name === name
	);
}
setup.takenCurseCount = function(name) {
	return variables().playerCurses.concat(variables().StoredCurse).countWith(
		e => e.name === name
	);
}
/* twine-user-script #4: "Calculate Carried Weight" */
setup.calcCarriedWeight = function() {
	return (
		variables().items.reduce((total, item) => total + item.weight * item.count, 0) +
		variables().ownedRelics.reduce((total, relic) => total + relic.weight, 0)
	);
}
/* twine-user-script #5: "Check Availability of Cutting Tool" */
setup.haveCuttingTool = function() {
	return variables().cut != 0 || variables().items[14].count > 0 || variables().ownedRelics.some(
		r => r.name === "Giddy Reaper" || r.name === "Sharing Shears" || r.name === "Sunbeam"
	);
}
/* twine-user-script #6: "Check Availability of Light Source" */
// Light sources that are not going to run out during an expedition.
setup.haveUnlimitedLightSource = function() {
	return variables().light != 0 || variables().items[10].count > 0 || variables().items[17].count > 0 || variables().ownedRelics.some(
		r => r.name === "Sunbeam" || r.name === "Glare Vantage"
	);
}
// Light sources that either consume supplies or can only be used in short bursts.
// Use this function to check for relic reachability.
setup.havePotentialLightSource = function() {
	return variables().items[9].count > 0 || variables().ownedRelics.some(
		r => r.name === "Firmament Pigment"
	) || setup.haveUnlimitedLightSource();
}
// Use this function to check whether a light source is on while traversing the Abyss.
setup.haveTravelLightSource = function() {
	return variables().torchUse == 1 || variables().ownedRelics.some(
		r => r.name === "Blind Divine"
	) || setup.haveUnlimitedLightSource();
}
/* twine-user-script #7: "Select Language" */
document.documentElement.setAttribute("lang", "en");
/* twine-user-script #8: "script.js" */
Config.navigation.override = function (destPassage) {
	var StoryVar = State.variables;
	if (StoryVar.brokerUsed == 1 && StoryVar.corruption < 0) {
		return "BrokerEnd";
	}
	if (StoryVar.ownedRelics.some(e => e.name === "Creepy Doll") && StoryVar.app.appAge < 8 && StoryVar.dollevent2==false){
		return "DollWarning";
	}
	if (StoryVar.ownedRelics.some(e => e.name === "Creepy Doll") && StoryVar.app.appAge < 4 && StoryVar.dollevent2==true){
		return "DollEnd";
	}
	if (StoryVar.app.age < 18) {
		return "AgeLimit";
	}
	if (StoryVar.items[1].count <= -6 || (StoryVar.items[0].count + StoryVar.items[3].count) <= -3) {
		return "GameOver";
	}
	if (StoryVar.app.appAge < 3 && StoryVar.app.age > 17) {
		return "AgeEnd";
	}
	if (StoryVar.companionMaru.affec < -9 && !StoryVar.companionMaru.swap) {
		return "Maru Leaving";
	}
	if (StoryVar.companionLily.affec < -9 && !StoryVar.companionLily.swap) {
		return "Lily Leaving";
	}
	if (StoryVar.companionKhemia.affec < -9 && !StoryVar.companionKhemia.swap) {
		return "Khemia Leaving";
	}
	if (StoryVar.companionCherry.affec < -12 && !StoryVar.companionCherry.swap) {
		return "Cherry Leaving";
	}
	if (StoryVar.companionCloud.affec < -9 && !StoryVar.companionCloud.swap) {
		return "Cloud Leaving";
	}
	if (StoryVar.companionSaeko.affec < -9 && !StoryVar.companionSaeko.swap) {
		return "Saeko Leaving";
	}
	return destPassage;
};

Config.history.maxStates = 20;

predisplay["Menu Return"] = function (taskName) {
	if (! tags().contains("noreturn")) {
		State.variables.menuReturn = passage();
	}
};
predisplay["Layer Return"] = function (taskName) {
	if (tags().some(t => t === "surface" || t.startsWith("layer"))) {
		State.variables.layerReturn = passage();
	}
	if (State.variables.comBalloon) {
		$(document.body).addClass("balloon");
	} else if (State.variables.layerReturn) {
		for (var tag of tags(State.variables.layerReturn)) {
			if (tag === "surface" || tag.startsWith("layer")) {
				$(document.body).addClass(tag);
			}
		}
	}
};

if ((0 || 0 || 0)) {
	// Change this to the path where the HTML file is
	// located if you want to run this from inside Twine.
	setup.Path = "Documents/Twine/AbyssDiver/";  // Running inside Twine application
} else {
	setup.Path = "";  // Running in a browser
}
setup.ImagePath = setup.Path + "images/";
setup.SoundPath = setup.Path + "sounds/";

//conversation macro
Macro.add('say', {
		tags: null,
		handler: function () {
			let person = this.args[0];
			let output = '<div class="say clearfix" style="'+ person.style + person.style1 +'">';
			output += '<div class="avatar"><img src="'+ setup.ImagePath + person.imageIcon +'"  width="100" height="100"></div>';
			output += '<span class="say-nameB">' + person.name + '</span><hr><span class="say-contents"><span class ="gdr' +person.genderVoice+'">' + this.payload[0].contents + '</span></span></div>';
			$(this.output).wiki(output);
		}
});
</script><tw-tag name="widget" color="blue"></tw-tag><tw-tag name="altered" color="yellow"></tw-tag><tw-tag name="ending" color="purple"></tw-tag><tw-tag name="new" color="red"></tw-tag><tw-tag name="start" color="gray"></tw-tag><tw-passagedata pid="1" name="Init Companions" tags="" position="100,100" size="100,100">&lt;&lt;set $companionMaru = {
name: &quot;Maru&quot;,
cost: 30,
carry: 5,
affec: 0,
swap: false,
image: &quot;Surface/maru.png&quot;,
imageIcon: &quot;Icons/MaruIcon.png&quot;,
curses: [],
osex: &quot;male&quot;,
obreasts: 0,
openis: 2,
ogender: 3,
genderVoice:3,
oheight: 140,
hairColor: &quot;light blue&quot;,
skinColor: &quot;pale&quot;,
age: 18,
appDesc: &quot;Your skin is extremely soft and bruises easily. Any material rougher than silk feels unconfortable on it now. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionLily = {
name: &quot;Lily&quot;,
cost: 60,
carry: 25,
affec: 0,
swap: false,
image: &quot;Surface/lily.png&quot;,
imageIcon: &quot;Icons/LilyIcon.png&quot;,
curses: [],
osex: &quot;female&quot;,
obreasts: 3,
openis: 0,
ogender: 5,
genderVoice:5,
oheight: 168,
hairColor: &quot;light purple&quot;,
skinColor: &quot;pale&quot;,
age: 22,
appDesc: &quot;You have particularly long eyelashes, and your legs seem long compared to your height. Your pupils are heart-shaped. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionKhemia = {
name: &quot;Khemia&quot;,
cost: 170,
carry: 35,
affec: 0,
swap: false,
image: &quot;Surface/gurann.png&quot;,
imageIcon: &quot;Icons/KhemiaIcon.png&quot;,
curses: [],
osex: &quot;male&quot;,
obreasts: 0,
openis: 4,
ogender: 1,
genderVoice: 1,
oheight: 185,
hairColor: &quot;dark blue&quot;,
skinColor: &quot;tanned&quot;,
age: 26,
appDesc: &quot;You have blue spiral tattoos through the length of both arms, and your hands are calloused from over a decade of hard work. Your voice seems to draw more attention than it used to before switching bodies. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionCherry = {
name: &quot;Cherry&quot;,
cost: 50,
carry: 15,
affec: 0,
swap: false,
image: &quot;Surface/cherry.png&quot;,
imageIcon: &quot;Icons/CherryIcon.png&quot;,
curses: [],
osex: &quot;female&quot;,
obreasts: 4,
openis: 0,
ogender: 5,
genderVoice: 5,
oheight: 165,
hairColor: &quot;red&quot;,
skinColor: &quot;tanned&quot;,
age: 24,
appDesc: &quot;Your body feels low on energy often, and you feel like you need more sleep than you used to. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionCloud = {
name: &quot;Cloud&quot;,
cost: 80,
carry: 20,
image: &quot;Surface/cloud.png&quot;,
imageIcon: &quot;Icons/CloudIcon.png&quot;,
affec: 0,
swap: false,
curses: [],
osex: &quot;male&quot;,
obreasts: 0,
openis: 3,
ogender: 1,
genderVoice: 1,
oheight: 175,
hairColor: &quot;brown&quot;,
skinColor: &quot;olive&quot;,
age: 23,
appDesc: &quot;Your sight is pretty good, and you can focus on distant objects more easily. Your smile seems to easily earn people&#39;s trust. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionSaeko = {
name: &quot;Saeko&quot;,
cost: 170,
carry: 12,
affec: 0,
swap: false,
image: &quot;Surface/saeko.png&quot;,
imageIcon: &quot;Icons/SaekoIcon.png&quot;,
curses: [],
osex: &quot;female&quot;,
obreasts: 2,
openis: 0,
ogender: 5,
genderVoice: 5,
oheight: 160,
hairColor: &quot;black&quot;,
skinColor: &quot;pale&quot;,
age: 21,
appDesc: &quot;Your sight is pretty bad without glasses and your eyebrows are relatively thin. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companionAI = {
name: &quot;Ai&quot;,
cost: 0,
carry: 0,
affec: 0,
swap: false,
image: &quot;Surface/Ai_neutral_happy_full.png&quot;,
imageIcon: &quot;Icons/Ai_neutral_happy.png&quot;,
curses: [],
osex: &quot;female&quot;,
obreasts: 2,
openis: 0,
ogender: 6,
genderVoice: 6,
oheight: 20,
hairColor: &quot;pink&quot;,
skinColor: &quot;pale&quot;,
age: &quot;&quot;,
appDesc: &quot;You,re an AI, now what? At this point you&#39;re simply a virtual avatar and rely on your physical companions to help you on your journey. &quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $companions = [$companionMaru, $companionLily, $companionKhemia, $companionCherry, $companionCloud, $companionSaeko]&gt;&gt;

&lt;&lt;set $hiredCompanions = []&gt;&gt;

&lt;&lt;set $MaruConvo0 = false&gt;&gt;
&lt;&lt;set $MaruConvo1 = false&gt;&gt;
&lt;&lt;set $MaruConvo2 = false&gt;&gt;
&lt;&lt;set $Maru_LastT = 9999&gt;&gt;

&lt;&lt;set $LilyConvo0 = false&gt;&gt;
&lt;&lt;set $LilyConvo1 = false&gt;&gt;
&lt;&lt;set $LilyConvo2 = false&gt;&gt;
&lt;&lt;set $LilyPromise = false&gt;&gt;
&lt;&lt;set $Lily_LastT = 9999&gt;&gt;

&lt;&lt;set $KhemiaConvo0 = false&gt;&gt;
&lt;&lt;set $KhemiaConvo1 = false&gt;&gt;
&lt;&lt;set $KhemiaConvo2 = false&gt;&gt;
&lt;&lt;set $Khemia_LastT = 9999&gt;&gt;

&lt;&lt;set $CherryConvo0 = false&gt;&gt;
&lt;&lt;set $CherryConvo1 = false&gt;&gt;
&lt;&lt;set $CherryConvo2 = false&gt;&gt;
&lt;&lt;set $Cherry_LastT = 9999&gt;&gt;

&lt;&lt;set $CloudConvo0 = false&gt;&gt;
&lt;&lt;set $CloudConvo1 = false&gt;&gt;
&lt;&lt;set $CloudConvo2 = false&gt;&gt;
&lt;&lt;set $Cloud_LastT = 9999&gt;&gt;
&lt;&lt;set $altCloud	   = true&gt;&gt;
&lt;&lt;set $SaekoConvo0 = false&gt;&gt;
&lt;&lt;set $SaekoConvo1 = false&gt;&gt;
&lt;&lt;set $SaekoConvo2 = false&gt;&gt;
&lt;&lt;set $Saeko_LastT = 9999&gt;&gt;

&lt;&lt;set $aiMemWipe=0&gt;&gt;</tw-passagedata><tw-passagedata pid="2" name="Companion Info" tags="noreturn companion" position="225,100" size="100,100">!&lt;&lt;print $hiredCompanions[$temp].name&gt;&gt;
[img[setup.ImagePath+$hiredCompanions[$temp].image]]

&lt;&lt;include `$hiredCompanions[$temp].name + &quot; Introduction&quot;`&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $hiredCompanions[$temp].name == &quot;Cloud&quot;&gt;&gt;
&lt;&lt;include &quot;Cloud Ability&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions[$temp].curses.length &gt; 0&gt;&gt;
	$hiredCompanions[$temp].name has the following curses:&lt;br&gt;&lt;br&gt;
	&lt;&lt;for $i = 0; $i &lt; $hiredCompanions[$temp].curses.length; $i++&gt;&gt;
			&lt;&lt;print $hiredCompanions[$temp].curses[$i].name&gt;&gt;&lt;br&gt;
	&lt;&lt;/for&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $temp == $swapComp&gt;&gt;
	$hiredCompanions[$temp].name is in your original body after your bodies were swapped by the Fate-crossing Star!&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="3" name="Cloud Ability" tags="" position="350,100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;br&gt;&lt;br&gt;When you have Cloud with you, he can use his scary-good connections to get you an exclusive loaning arrangement with the shop &amp;mdash; with some stipulations:&lt;br&gt;
&lt;br&gt;
* You can only borrow exactly enough to pay for supplies you want to buy here or companions you want to hire, so you won&#39;t be able to carry borrowed dubloons away with you. You may borrow via a note attached to a commerce balloon, too.&lt;br&gt;
* You&#39;ll have to pay back 1.2&amp;times; the total value of the dubloons you borrow, rounded down. Any sold Relics will have their value applied to your loan before having any remainder paid to you as dubloons.&lt;br&gt;
* You&#39;ll need to be injected with some kind of serum that will only be deactivated upon paying back your loans, and will instantly kill you if you end your journey (by choosing any Habitation option) without paying them back. The shop keeps the exact mechanism secret &amp;mdash; it could be some kind of nanobots or something, but it&#39;s hard to say. It&#39;s safe to assume they&#39;ve considered the possibility of you trying to dodge payments by removing or disabling it, so I wouldn&#39;t risk it. Taking a commerce balloon with you might be best, to ensure you can still pay if you decide to stay down there.&lt;br&gt;
* Cloud is your guarantor, so if he dies while you have a loan, the serum activates. This isn&#39;t as harsh as it sounds &amp;mdash; companions have a much higher survival rate than other divers due to their lack of need for food and water. It shouldn&#39;t be a problem if you don&#39;t intentionally put him in harm&#39;s way.&lt;br&gt;
* Note that Cloud himself cannot be hired with a loan. Other companions can, and they&#39;ll get their cut of the payment whether you pay back the shop or not.&lt;br&gt;
&lt;br&gt;
It would go without saying after reading all that, but taking out a loan comes with risks. Loans allow you to have much more freedom to purchase supplies than you would otherwise, but make sure you don&#39;t rack up a debt that you can&#39;t pay back.&lt;br&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="4" name="Maru Introduction" tags="" position="475,100" size="100,100">Shy, petite, and very soft, he&#39;s experienced enough to survive the dangers of the Abyss, but he has no useful skills of note and is fairly weak &amp;mdash; he&#39;d struggle lifting anything much over 5kg. Having a friend down there with you could do wonders for your mental well-being, though.

Likes gardening, cosplay (sews his own outfits), and cooking. He happily identifies as a boy, but grew up wearing feminine clothes, and is most comfortable wearing them, even after having entered adulthood.

&lt;q&gt;H-hi! I&#39;d really like to come with you into the Abyss...I bet there&#39;s all kinds of pretty and rare flowers down there, and I&#39;d love to take some home! Oh, and they won&#39;t list it as a survival skill for me, but I bet could make every one of your meals down there super tasty, even if all I have to work with are those food rations! Not that the food rations are bad or anything &lt;small&gt;...but...yeah...&lt;/small&gt;&lt;/q&gt;</tw-passagedata><tw-passagedata pid="5" name="Lily Introduction" tags="" position="600,100" size="100,100">Self-described eccentric, everyone-described chatterbox, and insatiable thrillseeker, there&#39;s never a dull moment with Lily around. Somehow has the &#39;purity gene&#39; despite not appearing on any of Outset Town&#39;s birth records &amp;mdash; probably has a tragic backstory as some rich guy&#39;s illegimate child, or something. (She stubbornly insists it&#39;s because she&#39;s a pure angel that fell from the sky.)

Likes pop music, traveling (has lost count of how many countries she&#39;s been to), and anime. Surprisingly good at haggling; any Relics //you bring up to the surface// (not via commerce balloons) can be sold for 10 dubloons more than their listed price while she&#39;s with you. She&#39;s stronger than she looks, and has lots of experience carrying heavy luggage around on long trips &amp;mdash; can comfortably carry around up to 25kg.

&lt;q&gt;Heeeey! Ready for our daring adventure right into the belly of the beast, hero? Just stick with me and it&#39;ll all work out, don&#39;t worry!&lt;/q&gt;</tw-passagedata><tw-passagedata pid="6" name="Khemia Introduction" tags="" position="725,100" size="100,100">An adventurer through-and-through, he&#39;s been on expeditions into the Abyss well over 50 times, likely the most of anyone alive right now. He&#39;s extremely friendly, outspoken, and easy for just about anyone to get along with. Few can match his determination to reach the bottom of the Abyss, or his enthusiasm for uncovering its secrets.

Likes fitness, video games (especially adventure ones), and drinking with friends. Can easily sustain lifting up to 35kg. He&#39;s honed his skills with melee weapons to the limit, particularly with swords &amp;mdash; put one in his hands and he&#39;s a demon in combat. He knows all the best shortcuts around the Abyss, and has an amazing knack for navigating even unfamiliar areas &amp;mdash; subtract 2 days from //all// travel time costs while exploring the Abyss.

&lt;q&gt;Someday, our drill will pierce through the Abyss and right into hell, and I&#39;m gonna be there when it happens.&lt;/q&gt;</tw-passagedata><tw-passagedata pid="7" name="Cherry Introduction" tags="" position="850,100" size="100,100">I think the single best adjective to describe Cherry would be... &#39;tired.&#39; She has a flat affect, and there&#39;s no spark in her eyes when you look at them...it almost feels like she&#39;s looking right past you when you talk to her. I&#39;m not sure she should be going into the Abyss &amp;mdash; she only //barely// passed the mental wellness examinations to be hired here, and I get the feeling that she doesn&#39;t plan to come back up after her journey with you. She&#39;s had a hard, sad life, and I think she&#39;s just here to run away from it all. Keep an eye on her and try to cheer her up if you take her with you, okay? Show her that there are still wonderful things to discover in the world. Promise?

Liked photography, writing (she even got published..a long time ago, though), and cats, once. The fates like to toy with her life, and having her with you will make your journey more //luck based:// Cherry&#39;s Chaotic Luck will take effect every time you first descend into a new layer of the Abyss, which will give you 50% bonus corruption for random Curses or a 50% discount on random Relics. She also has some surprisingly detailed medical knowledge, and can reduce the duration of any status effects //with a predetermined length// by 1, without having to expend a medkit. She hasn&#39;t been eating so well lately, and can only comfortably carry about 15kg.

&lt;q&gt;I&#39;ll try not to get in your way down there.&lt;/q&gt;</tw-passagedata><tw-passagedata pid="8" name="Cloud Introduction" tags="" position="975,100" size="100,100">An easygoing, smooth-talking handsome devil prone to light mischief at the expense of others...or that&#39;s the front he puts up to keep people off their guard, anyways. His relaxed, playful demeanor hides a cunning tactical mind, always carefully planning his next move. He dreams of building a new world, one without borders between countries or people, where nobody goes hungry or gets killed because of who they love...and he thinks the Abyss hides the power he needs to make it a reality.

Likes pranks, strategic games (traditional or digital), and &#39;&#39;revolution&#39;&#39;. He has some... special connections? Somehow, he&#39;s able to set you up to purchase things from the shop on loans, though with certain conditions attached (Details are provided when you hire him). We&#39;ve had the leaders of some of the world&#39;s most powerful countries come in trying to bend rules like that, and they&#39;ve been turned away... just who //is// this guy? Anyways, he&#39;s also a master marksman, and if you give him a gun, he&#39;ll be able to complete any listed task for guns with //2 bullets less// than the stated amount (minimum 1 bullet.) His physical strength is totally average, and he can comfortably carry 20kg.

&lt;q&gt;Well, if I have someone like you with me, this expedition should be a breeze. Between the two of us, I don&#39;t think the Abyss stands a chance, do you?&lt;/q&gt;</tw-passagedata><tw-passagedata pid="9" name="Saeko Introduction" tags="" position="1100,100" size="100,100">A university student working on a PhD on some of the plants native to the Abyss. She approaches the Abyss with a scientific perspective, wanting to understand and categorize the &#39;magical&#39; effects of Relics and Miasma rigorously and explain the underlying principles &amp;mdash; she really, //really// doesn&#39;t like calling it &#39;magic.&#39; She can be difficult to get to know, and be detached from those around her, single-mindedly focused on her research...but underneath her shell is a level-headed, reliable friend, and a shy, slightly lonely girl. Almost definitely much smarter than you.

Likes reading, learning new languages (fluent in 6 and counting), and tea. Her thorough study of the Abyss gives her the same utility as the Encyclopedia Abyssia, allowing her to easily identify edible flora and fauna in the Abyss. She&#39;s extensively studied the effects of Miasma on living organisms, and has several working theories on how to counteract them, allowing you to subtract 5 points from //all// corruption costs. She has the kind of lifting strength you&#39;d expect from a nerd, and will complain //constantly// if you try to make her carry over 12kg.

&lt;q&gt;Ready to go when you are. I hope you know what you&#39;re doing.&lt;/q&gt;</tw-passagedata><tw-passagedata pid="10" name="Party overview" tags="nobr" position="1225,100" size="100,100">&lt;&lt;HeightCorrected&gt;&gt;
&lt;&lt;appGender&gt;&gt;
&lt;&lt;Update_MC_Speech&gt;&gt;
&lt;br&gt;The following companions are a part of your expedition&#39;s party and have the associated affection values with you.&lt;br&gt;&lt;br&gt;

&lt;&lt;for _companion range $hiredCompanions&gt;&gt;
	&lt;&lt;set $temp = _companion.name&gt;&gt;
	&lt;&lt;print &quot;&lt;&lt;print _companion.name&gt;&gt;: &lt;&lt;print \&quot;$companion\&quot; + _companion.name + \&quot;.affec\&quot;&gt;&gt;&quot;&gt;&gt;
	&lt;br&gt;
	&lt;&lt;include `_companion.name + &quot; Conversations&quot;`&gt;&gt;
	&lt;br&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if $items[21].count &gt; 0&gt;&gt;
	&lt;&lt;if $currentLayer==0&gt;&gt;
		[[Ask Ai for information on this layer|AI ConvoL0]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==1&gt;&gt;
		[[Ask Ai for information on this layer|AI ConvoL1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==2&gt;&gt;
	&lt;&lt;elseif $currentLayer==3&gt;&gt;
	&lt;&lt;elseif $currentLayer==4&gt;&gt;
	&lt;&lt;elseif $currentLayer==5&gt;&gt;
	&lt;&lt;elseif $currentLayer==6&gt;&gt;
	&lt;&lt;elseif $currentLayer==7&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="11" name="Maru Conversations" tags="nobr" position="100,225" size="100,100">&lt;&lt;if $MaruConvo0==false&gt;&gt;
[[Introduce yourself to Maru|Maru Convo0][$MaruConvo0=true]]&lt;br&gt;
&lt;&lt;elseif $MaruConvo1==false &amp;&amp; $companionMaru.affec&gt;6 &amp;&amp; $MaruConvo0 &gt;&gt;
[[Chat with Maru|Maru Convo1][$MaruConvo1=true]]&lt;br&gt;
&lt;&lt;elseif $MaruConvo2==false &amp;&amp; $companionMaru.affec&gt;15 &amp;&amp; $MaruConvo1 &amp;&amp; 0&gt;&gt;
[[Chat with Maru|Maru Convo2][$MaruConvo2=true]]&lt;br&gt;
&lt;&lt;elseif $MaruConvo3==false &amp;&amp; $companionMaru.affec&gt;20 &amp;&amp; $app.appGender&lt;4 &amp;&amp; $subdom &gt; -1 &amp;&amp; $MaruConvo2 &gt;&gt;
[[Chat with Maru|Maru Convo3][$MaruConvo3=true]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="12" name="Maru Convo1" tags="" position="225,225" size="100,100">&lt;&lt;nobr&gt;&gt;
Maru cheerfully brings you a meal he made, checking to see if it is as satisfying as he hopes it is. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt; You know, we&#39;re traveling together in one of the most dangerous places in the world, yet I know almost nothing about you. Do you want to tell me anything about yourself?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt; Well, I&#39;m not the most interesting person in the world. Was there anything you wanted to ask?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Could you tell me something about your childhood?|Maru Convo1][$convoStart=0,$choice1=1,$companionMaru.affec+=(1+$hsswear)]]&lt;br&gt;
[[Why do you wear such feminine clothes if you&#39;re a guy? It&#39;s really weird|Maru Convo1][$convoStart=0,$choice1=2,$companionMaru.affec-=(1-$hsswear)]]&lt;br&gt;
[[What&#39;s in this meal? It&#39;s really tasty!|Maru Convo1][$convoStart=0,$choice1=3,$companionMaru.affec-=0]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
&lt;&lt;say $mc&gt;&gt;Could you tell me something about your childhood?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt; Well, I was mostly raised by my big sister. She was nice, but not exactly the most gentle person ever. Maybe overprotective would be a better way to describe it. When I was younger I wasn&#39;t really allowed to play outside or do anything that might be too rough. Sometimes it was a little annoying, but I understand why she was doing it.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;I can imagine that was a little tough.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt;Yeah, but it wasn&#39;t all bad. I think she was just looking out for me, since I am the youngest. We were a very tight family, so we did a lot of stuff with each other. And in a way it forced me to learn to cook and sow as well, since I wanted to do things with my sister.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt; Is that also the reason why you are wearing feminine clothing? Were they forcing you to do this?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt; No! No, nothing like that. As a child I think I looked pretty feminine.  Well, even more than now I mean. My sisters liked to play dress-up with me, and I actually liked it too. Sometimes I thought that I shouldn&#39;t be doing it, but eventually I realized that if it makes me happy, then there&#39;s no reason I should stop.&lt;&lt;/say&gt;&gt;&lt;br&gt;

He pauses for a moment as he seems to gather his thoughts.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt; Over time I really began to appreciate how well my sisters cared for me. I don&#39;t know if it&#39;s the same for everyone, but I was glad they accepted what I liked and we could do things together and be happy.&lt;&lt;/say&gt;&gt;&lt;br&gt;

You ponder his story for a bit.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt; Thanks for sharing that with me. How are your sisters doing?&lt;&lt;/say&gt;&gt;&lt;br&gt;

His expression falls, and he looks down in silence for a few seconds before responding. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt;They all left.&lt;&lt;/say&gt;&gt;&lt;br&gt;

After a few more moments he forces a smile and continues. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Anyway, don&#39;t let your meal get cold!&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Oh, sure, thanks for the meal!&lt;&lt;/say&gt;&gt;&lt;br&gt;
As you take in the food, you realize it takes shockingly good for something made with such limited ingredients. How did he manage to get the texture just right and the flavors perfectly balanced all the way down here? Maru giggles as he looks at you eating his food.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Well, if you like it this much, I&#39;ll be sure to make it like this more often!&lt;&lt;/say&gt;&gt;&lt;br&gt;
Every 10 days, Maru will make a meal with 1 day worth of food that will keep you satisified for 2 days, saving you 1 day of food rations!&lt;br&gt;

[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$items[1].count+=1]]
&lt;&lt;elseif $choice1==2&gt;&gt;
&lt;&lt;say $mc&gt;&gt;Why do you wear such feminine clothes if you&#39;re a guy? It&#39;s really weird.&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru almost chokes on his food and starts nervously stammering.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; I... I don&#39;t know, it just started as a kid and now I just like it I guess.&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;I don&#39;t really get it. I thought it would be more of a story, but I guess everybody has their strange quirks.&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru looks a bit downward. He opens his mouth as if to say something before closing it again. After a moment he replies.&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Yeah, I guess so...&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Anyway, as long as you keep cooking these delicious meals, you won&#39;t hear me complaining about whatever you want to wear while you cook them!&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Well, uh, thanks, I guess.&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Huh?&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru looks a bit flustered, as if he wans&#39;t sure what to say.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Thanks for liking the food, I mean! I can make it more often if you&#39;d like!&lt;&lt;/say&gt;&gt;&lt;br&gt;

Every 10 days, Maru will make a meal with 1 day worth of food that will keep you satisified for 2 days, saving you 1 day of food rations!&lt;br&gt;

[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$items[1].count+=1]]
&lt;&lt;elseif $choice1==3&gt;&gt;
&lt;&lt;say $mc&gt;&gt; What&#39;s in this meal? it&#39;s really tasty!&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru looks a bit suprised and pauses for a few seconds before answering.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Uh, thanks, I guess?&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Did I say something wrong?&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; No, no, not at all. I was just a bit suprised that that was your question, since I thought you wanted to ask something about me, but I&#39;m really happy that you like it!&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Like it? It&#39;s absolutely delicious!&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru smiles widely at your comment.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt; Well, in that case it would be cruel for me to not tell you the recipe! Even if it is made from the limited ingredients we have with us here!&lt;&lt;/say&gt;&gt;&lt;br&gt;
Maru tells you in detail how he prepared the dish. It&#39;s actually pretty simple, but he added some herbs with subtle flavors which seem to have a made a big difference in the final product. And his cooking method was precise to ensure the texture ended up perfect!&lt;br&gt;

Every 10 days, Maru will make a meal with 1 day worth of food that will keep you satisified for 2 days, saving you 1 day of food rations!&lt;br&gt;

[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$items[1].count+=1]]
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="13" name="Maru Convo0" tags="" position="350,225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $companionMaru&gt;&gt;Hi I&#39;m Maru&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Greet him warmly with a hug|Maru Convo0][$convoStart=0,$choice1=1,$companionMaru.affec+=(1+$hsswear)]]&lt;br&gt;
[[Greet him with a firm handshake|Maru Convo0][$convoStart=0,$choice1=2,$companionMaru.affec+=0]]&lt;br&gt;
[[Greet him with a small wave from a distance|Maru Convo0][$convoStart=0,$choice1=3,$companionMaru.affec+=0]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Maru a tight hug, his body feels warm between your arms. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Hey I&#39;m $mc.name, I&#39;m so happy that you are joining our team!&lt;&lt;/say&gt;&gt;&lt;br&gt;
At first he seems shocked, but after only a few moments he loosens up and hugs you back, blushing profoundly. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt;Well uh... Thank you. I hope I can be of use to you. I may not be as skilled as some people, but I swear it was worth it to hire me!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[An extra person means extra carrying cappacity, so don&#39;t worry about it!|Maru Convo0][$convoStart=0,$choice2=1,$companionMaru.affec-=(1-$hsswear)]]&lt;br&gt;
	[[Don&#39;t worry about it. Everybody has their strong points. What are you good at?|Maru Convo0][$convoStart=0,$choice2=2,$companionMaru.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;An extra person already means extra carrying cappacity, so don&#39;t worry about it!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionMaru&gt;&gt;Um, yeah, I guess that is true. I can&#39;t carry that much though...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Don&#39;t worry about it. Everybody has their strong points. What are you good at?&lt;&lt;/say&gt;&gt;&lt;br&gt;

Maru smile gently towards you, seemingly appreciating your caring demeanor. &lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionMaru&gt;&gt;I can cook a really nice meal, even if I am kind of limited by the stuff we have in our rations. It&#39;s always better to eat a nice, warm meal that just some dried ration food.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Great! I&#39;m already looking forward to it!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You give a him firm handshake &lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;I&#39;m glad to have you onboard for our expedition! I&#39;m $mc.name&lt;&lt;/say&gt;&gt;&lt;br&gt;

He looks a little rattled by the firm handshake, but tries to respond energetically. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionMaru&gt;&gt;Oh, well, uh... Happy to be part of the team boss!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Me too! I have a lot of stuff I&#39;ll need you to take care of once we get going on our expedition|Maru Convo0][$convoStart=0,$choice2=1,$MaruAffec-=(1-$hsswear)]]&lt;br&gt;
	[[Me too! Lets make this an exciting adventure together!|Maru Convo0][$convoStart=0,$choice2=2,$companionMaru.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt; Me too! I have a lot of stuff I&#39;ll need you to take care of once we get going on our expedition.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionMaru&gt;&gt;Uh... I&#39;ll try my best, but I don&#39;t know if I&#39;ll be able to manage very much by myself.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Me too! Lets make this an exciting adventure together!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionMaru&gt;&gt;Oh, I&#39;m really looking forward to it now! Thank you for the encouragement!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand a bit akwardly and wave hello over at him. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So, uh... I&#39;m $mc.name, and we are going on an expedition into the Abyss together.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Maru giggles at your response.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionMaru&gt;&gt;I know that already, silly! So just tell me what you need me for, and I&#39;ll see if I can help out.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[Uh... I don&#39;t know exactly. I guess we&#39;ll figure it out over time|Maru Convo0][$convoStart=0,$choice2=1,$companionMaru.affec+=0]]&lt;br&gt;
		[[Hmm... Maybe you can carry some of our equipment?|Maru Convo0][$convoStart=0,$choice2=2,$companionMaru.affec-=(1-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt; Uh... I don&#39;t know exactly. I guess we&#39;ll figure it out over time&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionMaru&gt;&gt; Don&#39;t worry, I can mend clothing and I&#39;m not a bad cook if I do say so myself. I think I can find some way to be useful to you.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt; Hmm... Maybe you can carry some of our equipment?&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionMaru&gt;&gt;Uh... I&#39;ll try my best, but I don&#39;t know if I&#39;ll be able to manage very much by myself.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="14" name="Maru Convo2" tags="" position="475,225" size="100,100">/reduction on cost of some equipment that can be made in the relic workshop?</tw-passagedata><tw-passagedata pid="15" name="Maru Convo3" tags="" position="600,225" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="16" name="Lily Conversations" tags="nobr" position="725,225" size="100,100">&lt;&lt;if $LilyConvo0==0&gt;&gt;
[[Introduce yourself to Lily|Lily Convo0][$LilyConvo0=true,$lilyJoke=false]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $LilyConvo1==false &amp;&amp; $companionLily.affec&gt;6 &amp;&amp; $LilyConvo0&gt;&gt;
[[Lily seems quiet|Lily Convo1][$LilyConvo1=true]]&lt;br&gt;
&lt;&lt;elseif $LilyConvo2==false &amp;&amp; $companionLily.affec&gt;15 &amp;&amp; $LilyConvo1 &amp;&amp; 0 &gt;&gt;
[[Chat with Lily|Lily Convo2][$LilyConvo2=true]]&lt;br&gt;
&lt;&lt;elseif $LilyConvo3==false &amp;&amp; $companionLily.affec&gt;20 &amp;&amp; $app.appGender&gt;7 &amp;&amp; $subdom &lt; 1 &amp;&amp; $LilyConvo2 &gt;&gt;
[[Chat with Lily|Lily Convo3][$LilyConvo3=true]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;World Stone&quot;) &amp;&amp; !$LilyPromise&gt;&gt;
	[[You see Lily lifting up the World Stone|Lily ConvoPr]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="17" name="Lily Convo0" tags="" position="850,225" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;say $companionLily&gt;&gt;Heeeey! I&#39;m Lily, You must be $mc.name, right? Ready for our daring adventure into the belly of the beast, hero? Just stick with me and it&#39;ll all work out, don&#39;t worry!&lt;&lt;/say&gt;&gt;&lt;br&gt;

She points her thumb at her chest and stands proudly, as if to show that she is prepared for anything you might find in the Abyss.&lt;br&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Greet her warmly with a hug|Lily Convo0][$convoStart=0,$choice1=1,$companionLily.affec+=(1+$hsswear)]]&lt;br&gt;
[[Greet her with a firm handshake|Lily Convo0][$convoStart=0,$choice1=2,$companionLily.affec+=0]]&lt;br&gt;
[[Greet her with a small wave from a distance|Lily Convo0][$convoStart=0,$choice1=3,$companionLily.affec-=(1-$hsswear)]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Lily a big hug and you immediately feel her firmly squeezing you back, even lifting your feet a litlle bit from the ground in her excitement.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Hey! Yeah, I&#39;m $mc.name, and I&#39;m so happy that you&#39;re joining our team!&lt;&lt;/say&gt;&gt;&lt;br&gt;
She releases her grip on you and smiles widely. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionLily&gt;&gt;I didn&#39;t expect such a warm welcome, but hey I&#39;m not complaining! Especially from such a cute &lt;&lt;PerceivedGender&gt;&gt;.&lt;&lt;/say&gt;&gt;&lt;br&gt;

She winks at you and grins as she finishes her comment. You weren&#39;t sure if you were going for the cute vibe, but at the very least you want to be taken seriously as an adventurer. On the other hand, you suppose it&#39;s good that your new teammate likes you.&lt;br&gt;&lt;br&gt;
	&lt;&lt;if $choice2==0&gt;&gt;
	[[Oh thanks! Well, if you insist, then I&#39;ll stay close and be sure to let you take care of me|Lily Convo0][$convoStart=0,$choice2=1,$companionLily.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Look who&#39;s talking! I&#39;ll make sure to protect that cute face of yours and keep you safe too!|Lily Convo0][$convoStart=0,$choice2=2,$companionLily.affec-=(1-$hsswear)]]&lt;br&gt;
	[[If she&#39;s already this into you, maybe you can take this to the next level and lean in for a kiss?|Lily Convo0][$convoStart=0,$choice2=3,$companionLily.affec-=(3-$hsswear)]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Oh thanks! Well, if you insist, then I&#39;ll stay close and be sure to let you take care of me.&lt;&lt;/say&gt;&gt;&lt;br&gt;

You wink back to her and Lily seems to give you a sly smile in return.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Oh my, we only just met and you already know what to say to get my engine running!&lt;&lt;/say&gt;&gt;&lt;br&gt;

Lily steps forward to approach you, and it almost seems like she&#39;s leaning in for a kiss. But before you can react, you suddenly feel a hard pat on your back and open your eyes to see Lily with the widest grin possible on her face.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;But let&#39;s not jump the gun here &lt;&lt;mrms&gt;&gt; cassanova. We have a whole adventure ahead of us to get to know each other better.&lt;&lt;/say&gt;&gt;&lt;br&gt;

She winks at you once again, though you think there may be a bit more of a suggestive tone this time.&lt;br&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Look who&#39;s talking! I&#39;ll make sure to protect that cute face of yours and keep you safe too!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily raises an eyebrow, showing a deep skepticism, and then starts laughing.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Haha! Don&#39;t worry about it &lt;&lt;mrms&gt;&gt; hero. I can take pretty good care of myself. But I&#39;ll be sure to let you know just in case I find some other damsel in distress you can save.&lt;&lt;/say&gt;&gt;&lt;br&gt;

She starts snicker at her own joke. You&#39;re not quite sure if it&#39;s a joke at your expense, but she doesn&#39;t seem to clarify. Regardless, she seems to be in good spirits and that&#39;s what&#39;s important in the end, right?&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Haha, good one, Lily.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;elseif $choice2==3&gt;&gt;

	You close your eyes and move your face close to kiss her. But as your face approached hers, your cheeks are suddenly grabbed with suprising strength as Lily pushes you back with an annoyed scoff.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;There is something to be said about being so forward... But there&#39;s also something about not reading signals correctly, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Flustered, you find yourself at a loss for words and don&#39;t manage to find a response quickly enough.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;I&#39;m so sorry... I just thought that... You know...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily sighs deeply and her face lightens up a little bit as she raises her eyebrows. &lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Yeah, maybe I do know? Well, I guess I am an awfully cute little angel, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She frames her face between her hands as she gives you a sly smile once again.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Next time, maybe just buy a girl some flowers and a dinner first, okay?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Absolutely!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$companionLily.affec+=(1+$hsswear)]]


	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You reach out and give a her a firm handshake, which she recipocates in her own suprisingly firm manner, given her slender frame. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;I&#39;m glad to have you onboard! I&#39;m $mc.name.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Oh, so formal! But I guess that&#39;s fine.&lt;&lt;/say&gt;&gt;&lt;br&gt;
She shrugs and chuckles lightly.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionLily&gt;&gt;Just don&#39;t start asking me about my hobbies next.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Why not? I do actually want to get to know you better, and asking about you is the best way to do that!|Lily Convo0][$convoStart=0,$choice2=1,$companionLily.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Don&#39;t worry, I won&#39;t!|Lily Convo0][$convoStart=0,$choice2=2,$companionLily.affec-=(1-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt; Why not? I do actually want to get to know you better, and asking about you is the best way to do that!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily grins, straightens her back, and puts on a mock formal voice.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt;Well thank you for asking &lt;&lt;mrms&gt;&gt; boss &lt;&lt;PerceivedGender&gt;&gt;. My hobbies include listening to pop music and traveling. I&#39;ve traveled to lots of the countries around this world already! What can I say? I guess I&#39;m just the adventurous type. &lt;&lt;/say&gt;&gt;&lt;br&gt;

You mimic her tone and play along.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Ah yes, excellent to hear that miss Lily, what would you say your...&lt;&lt;/say&gt;&gt;&lt;br&gt;

Before you can finish your sentence, she interrupts you.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Oh, and anime too! The best thing is if I can combine both! I once travelled half way around the world for this awesome anime convention. You wouldn&#39;t believe the cute little snacks they had over there. Sometimes I wish I could go back, but in my life I prefer to always move forward and not get fixated on the past. Oh, but there was this other time where...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	In the end Lily rambles on for quite a while about her various travels, what anime see likes, what songs she like, and what anime songs she likes. Even if you can&#39;t quite follow all of her stories or don&#39;t know much about the places she mentions, she seems happy as long as you make an effort and nod along.&lt;br&gt;

	[[End your conversation, or is it more of a monologue by now?|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Don&#39;t worry, I won&#39;t!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily&#39;s face betrays an obvious confusion.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Uh, I was kinda hoping you would, actually. I didn&#39;t think you&#39;d give up so easily, but don&#39;t worry! I&#39;ll be sure to tell you about myself on our long journey into the Abyss, we&#39;ll have plenty of time to chat there!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She playfully sticks her tongue at you. Although the conversation could have gone a bit smoother, she still made you laugh in the end.&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand a bit awkwardly and wave hello to her from a distance. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So uh, yeah, I&#39;m $mc.name. It&#39;s nice to meet you!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily looks you over with a raised eyebrow after which a smile quickly forms on her face. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt;Haha, don&#39;t be scared! I won&#39;t bite unless you want me to.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She winks at you and smiles even wider at her own implied joke.&lt;br&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[Please, bite me|Lily Convo0][$convoStart=0,$choice2=1,$companionLily.affec-=(1-$hsswear)]]&lt;br&gt;
		[[I, uh, think I&#39;d rather have you not do that|Lily Convo0][$convoStart=0,$choice2=2,$companionLily.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt;Please, bite me.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		There is a long, awkward pause. You feel your face getting redder and redder. She looks a bit surprised and considers how to respond.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; Uh, we need to work on your conversational skills, buddy. But don&#39;t worry, I&#39;ll make sure to give you lots of practice! You won&#39;t be able to get away from talking to me when we&#39;re down there!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt;I, uh, think I&#39;d rather have you not do that.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily immediately starts laughing gently.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;You know what, you might be a little awkward, but I can already tell we&#39;re going to have some fun together and get along just fine!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She pokes you in your sides playfully as she talks.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt;So tell me more about yourself. What do you like? Do you do these kinds of expeditions often? I always really love going on new adventures and exploring!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		You talk for quite some time afterwards. She is actually quite attentive and interested in what you have to say, although she does tend to go on a rambling streak from time to time when you give her the chance.&lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="18" name="Lily Convo1" tags="" position="975,225" size="100,100">&lt;&lt;nobr&gt;&gt;
While normally you&#39;ve gotten to know Lily as a bright light in any conversation, today she has been unusually quiet and her mood seems to be much more somber than usual.&lt;br&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Try to cheer her up with a joke.|Lily Convo1][$convoStart=0,$choice1=1,$companionLily.affec+=(1+$hsswear)]]&lt;br&gt;
[[Don&#39;t say anything and hope she starts talking herself. |Party overview][$convoStart=1,$choice1=0,$choice2=0,$companionLily.affec-=(2-$hsswear),$LilyConvo1=false]]&lt;br&gt;
[[Sit her down and ask her what&#39;s wrong.|Lily Convo1][$convoStart=0,$choice1=3]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Hey Lily, do you know what sits at the bottom of the sea and twitches?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $lilyJoke==false&gt;&gt;
		She looks up at you, and wears a curious expression as she answers.&lt;br&gt;&lt;br&gt;
		
		&lt;&lt;say $companionLily&gt;&gt; Hmm? I&#39;m not sure.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;A nervous wreck!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily stifles a giggle and a smile creeps across her face.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $mc&gt;&gt;And do you know what one hat said to the other?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; No?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;You wait here. I&#39;ll go on a-head!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily can&#39;t hold back her giggles this time and her grin widens.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt; Oh my god, that one was even worse than the first, $mc.name. Where did you learn all these?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
		She looks up at you curiously and cocks an eyebrow.&lt;br&gt;&lt;br&gt;
		
		&lt;&lt;say $companionLily&gt;&gt; A nervous wreck?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Uh yeah? I guess you knew that one already...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; Yeah, because you told it to me already, silly! &lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily giggles and a grin spreads across her face.&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

		&lt;&lt;if $choice2==0&gt;&gt;
		&lt;&lt;if $lilyJoke==false&gt;&gt;
			[[Well, if you liked them there&#39;s a whole lot more where those came from!|Lily Convo1][$convoStart=0,$choice2=1,$companionLily.affec-=(2-$hsswear)]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		[[I&#39;m glad you&#39;re back to your normal upbeat self|Lily Convo1][$convoStart=0,$choice2=2,$companionLily.affec+=(1+$hsswear)]]&lt;br&gt;
		[[So, uh, can I ask what&#39;s been bothering you?|Lily Convo1][$convoStart=0,$choice2=3,$companionLily.affec+=(2+$hsswear)]]
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $choice2==1&gt;&gt;

			&lt;&lt;say $mc&gt;&gt;Well, if you liked them there&#39;s a whole lot more where those came from!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		
			You keep cracking jokes and the first few are well recieved, but over time her laugh becomes less and less genuine while her grin seems to look more and more like a polite smile.&lt;br&gt;&lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1, $choice1=0, $choice2=0, $LilyConvo1=false, $lilyJoke=true]]

		&lt;&lt;elseif $choice2==2&gt;&gt;

			&lt;&lt;say $mc&gt;&gt;I&#39;m glad you&#39;re back to your normal upbeat self.&lt;&lt;/say&gt;&gt;&lt;br&gt;

			Lily lowers her gaze slightly as she responds.&lt;br&gt;&lt;br&gt;

			&lt;&lt;say $companionLily&gt;&gt; Yeah, I guess I have been a little out of it, haven&#39;t I? &lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt;Yeah, I was starting to worry about you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

			Lily scratches the back of her head a bit.&lt;br&gt;&lt;br&gt;
			
			&lt;&lt;say $companionLily&gt;&gt; I&#39;m sorry, I didn&#39;t want to worry anyone. It&#39;s just that I&#39;ve been thinking about my mom quite a bit lately.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt;Oh, why&#39;s that?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; Let&#39;s just say that it has to do with where we are. I think when I was still with her I never fully appreciated the hardships she had to face. And now I don&#39;t have the opportunity to go back and talk with her anymore, and I probably won&#39;t ever again.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			She pauses for a moment.&lt;br&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; Of course, in a way I&#39;ve always appreciated her. She was my hero when I was little, but maybe I just never fully understood her or something. Is that weird?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt;I don&#39;t think so, when you&#39;re little there&#39;s a lot of stuff you don&#39;t understand, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; I guess you&#39;re right. Anyway, enough gloomy talk. I have cleared my heart, I&#39;m done sulking.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			
			She straightens her back, flashes you an endearing smile and begins increasing her pace.&lt;br&gt;&lt;br&gt;
			
			&lt;&lt;say $mc&gt;&gt;Wait up! Where are you going? &lt;&lt;/say&gt;&gt;&lt;br&gt;

			She gives you an entire spiel on how keeping pace is good exercise and a bad posture while walking is unhealthy. Meanwhile, you are simply glad she&#39;s returned to her typically lively demeanor.&lt;br&gt;&lt;br&gt;

			@@.alert1; Lily is motivated to push a little harder for you and will now carry 5kg more without complaining or slowing down!@@ &lt;br&gt;

			[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

		&lt;&lt;elseif $choice2==3&gt;&gt;

			&lt;&lt;say $mc&gt;&gt;So, uh, can I ask what&#39;s been bothering you?&lt;&lt;/say&gt;&gt;&lt;br&gt;

			Lily giggles and pats you on the head.&lt;br&gt;&lt;br&gt;

			&lt;&lt;say $companionLily&gt;&gt;You are just too cute when you are struggling to be social.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt; Huh, what do you mean? I was...&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt;Don&#39;t worry about it &lt;&lt;mrms&gt;&gt; hero. I guess I do owe you a bit of an explanation.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			
			Her face becomes more sullen and she takes on a more serious tone.&lt;br&gt;&lt;br&gt;

			&lt;&lt;say $companionLily&gt;&gt; It&#39;s just that I&#39;ve been thinking about my mom quite a bit lately.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt;Oh, why&#39;s that?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; Let&#39;s just say that it has to do with where we are. I think when I was still with her I never fully appreciated the hardships she had to face. And now I don&#39;t have the opportunity to go back and talk with her anymore, and I probably won&#39;t ever again.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			She pauses for a moment.&lt;br&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; Of course, in a way I&#39;ve always appreciated her. She was my hero when I was little, but maybe I just never fully understood her or something. Is that weird?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt;I don&#39;t think so, when you&#39;re little there&#39;s a lot of stuff you don&#39;t understand, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionLily&gt;&gt; I guess you&#39;re right. Anyway, enough gloomy talk. I have cleared my heart, I&#39;m done sulking.&lt;&lt;/say&gt;&gt;&lt;br&gt;
			
			She straightens her back, flashes you an endearing smile and begins increasing her pace.&lt;br&gt;&lt;br&gt;
			
			&lt;&lt;say $mc&gt;&gt;Wait up! Where are you going? &lt;&lt;/say&gt;&gt;&lt;br&gt;

			She gives you an entire spiel on how keeping pace is good exercise and a bad posture while walking is unhealthy. Meanwhile, you are simply glad she&#39;s returned to her typically lively demeanor.&lt;br&gt;&lt;br&gt;

			@@.alert1; Lily is motivated to push a little harder for you and will now carry 5kg more without complaining or slowing down!@@ &lt;br&gt;

			[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]


		&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==3&gt;&gt;
	You begin walking close by to Lily and match her pace.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;Lily, could you stop for a second?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily stops walking and looks at you with a confused expression.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionLily&gt;&gt;Huh, whats wrong?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;I could ask you the same question. You seem out of it. You&#39;ve been sulking all day, which is pretty uncharacteristic for you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Lily looks up as she seems to consider her thoughts.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt;I think I just have a lot on my mind right now.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;You know you can talk to me Lily...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[...because I need you at your best. You know I rely on you, Lily. | Lily Convo1][$convoStart=0,$choice2=1,$companionLily.affec+=(2+$hsswear)]]&lt;br&gt;
		[[...because a smile fits a pretty lady like you much better than a frown. |Lily Convo1][$convoStart=0,$choice2=2,$companionLily.affec-=(1-$hsswear)]]
		[[...because you being happy makes me happy too. |Lily Convo1][$convoStart=0,$choice2=3,$companionLily.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt;Because I need you at your best. You know I rely on you, Lily.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Her solemn demeanor starts to melt away, and she looks at you with an obviously playful pout.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt;Oh no, I didn&#39;t make you worry that I wouldn&#39;t be able to take care of you, did I?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Well, that&#39;s not exactly what I meant when... hey!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She pulls you into a big, tight hug. Despite knowing her, you are still surprised at her strength.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;In that case, it would be irresponsible of me to keep worrying you, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She gives you a playful wink as she continues.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;I was just thinking about the person who took good care of me, just like I take good care of you.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She says while booping your nose. She sighs and continues with a somewhat more serious tone.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;I think that being here in the Abyss, with you, brought back some memories of my mom and those got me thinking more about her in general.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She sighs deeply once again.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;She taught me that no matter how tough life gets, if you face it with a smile, then it will make everything a little bit easier. And that you have to keep looking forward, not back. I guess I forgot that for a second.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		A somber smile creeps up her face.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;She was, and still is, my hero. And I try every day to be at least half the woman she was...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;She sounds like she was an awesome mom then.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;She sure was! But don&#39;t worry, I have place for two heroes in my life. No need to get jealous!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She sticks her tongue out cheekily with that last remark and you can&#39;t help but laugh a little.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;How about I make up for making you worry today by taking even better care of you from now on!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She grabs some of the equipment you were carrying and stuffs it into her own pack.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Aw, thanks Lily! It&#39;s definitely appreciated!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		@@.alert1; Lily is motivated to push a little harder for you and will now carry 5kg more without complaining or slowing down!@@ &lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt;Because a smile fits a pretty lady like you much better than a frown.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily rolls her eyes at your response.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;Oh geez, thank you for your wonderful compliment...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Come on Lily, don&#39;t be like that. It was just a joke. I am actually worried about you, you know?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		Lily looks lowers her gaze.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;Yeah, you&#39;re right, I&#39;m sorry. These last few days I&#39;ve been thinking back to my childhood and my mom. In a way, I&#39;m still worrying about her as well.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Why is that?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; It&#39;s hard to explain. But it&#39;s a little like I&#39;m trying very hard to be just as good of a person as my mom. However, I&#39;m only now discovering how hard it must have been. And I don&#39;t even have a kid!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		A smile creeps back onto her face.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; Unless I count you!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She giggles to her own joke, while you take your turn to  roll your eyes.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Ha. Ha. Very funny. But I&#39;m not that helpless.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; Not as long as you have me with you.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She says as she gives you a wink and grabs some of your equipment and stuff it into her pack before she starts walking again. &lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Hey!  Why are you... I&#39;m perfectly capable of carrying that myself you know!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt; Sure you are!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		Is she giggling? Well, at least her normal demeanor is back. &lt;br&gt;&lt;br&gt;

		@@.alert1; Lily is motivated to push a little harder for you and will now carry 5kg more without complaining or slowing down!@@ &lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==3&gt;&gt;
		&lt;&lt;say $mc&gt;&gt;Because you being happy makes me happy too.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily looks at you, seems a bit befuddled, and then suddenly starts laughing.&lt;br&gt;&lt;br&gt;
		
		&lt;&lt;say $companionLily&gt;&gt;Well, aren&#39;t you the sweetest? Literally charming me out of my bad mood.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		As she says that she move a bit closer.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt;And you know what?&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Her face is now right up to your face and she whispers in your ear.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt;It   is     working.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		You feel your face redden a little bit.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $mc&gt;&gt;Uh... Well... Happy to help!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		Lily giggles and takes a step back once again.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionLily&gt;&gt;I&#39;ll try to be less pouty. It&#39;s just that I was thinking about my mom for a bit. I miss her sometimes.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;I get what you&#39;re saying. I miss my mom sometimes too.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;I&#39;m sure you do!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		Lily has a hard time containing a giggle this time.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt;Oh come on. I was trying to...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionLily&gt;&gt;Oh, don&#39;t react so seriously to every joke. Besides, you have me now, who will help you along your way.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She takes some of the equipment you were carrying and stuffs it into her own pack, leaving you stupified for a moment before you decide to follow suit.&lt;br&gt;&lt;br&gt;

		@@.alert1; Lily is motivated to push a little harder for you and will now carry 5kg more without complaining or slowing down!@@ &lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="19" name="Lily Convo2" tags="" position="1100,225" size="100,100">/extra haggle bonus reward?</tw-passagedata><tw-passagedata pid="20" name="Lily Convo3" tags="" position="1225,225" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="21" name="Lily ConvoPr" tags="" position="100,350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $mc&gt;&gt;Uh, what are you doing? &lt;&lt;/say&gt;&gt;&lt;br&gt;

The moment you speak Lily makes a high pitched squeak, then she jumps up, startled, and drops the World Stone she was holding. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Don&#39;t sneak up on me like that!&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $app.fit&lt;4&gt;&gt;
You chuckle a little at the fact that you made a woman who could easily outmatch you physically squeak like a little girl.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $app.fit&lt;=7&gt;&gt;
You chuckle a little at the fact that you made a woman who is possibly stronger than you squeak like a little girl&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
You chuckle a little at the fact that you made a woman who could give you a fair physical competition squeak like a little girl.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;say $companionLily&gt;&gt;Look, it&#39;s just that I like to stay in shape so I can keep going on these long adventures. Even when I&#39;m at home I actually work out a lot, you know? And this Relc is great for keeping in tip-top shape!&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;Oh, sounds like you really keep yourself in shape then!&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Yeah, I put on some loud music and just work up a good sweat. How else do you think I keep this angelic body?&lt;&lt;/say&gt;&gt;&lt;br&gt;

She puffs out her chest a bit and gestures widely over her whole body.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Anyway, not to say that this whole journey is not a good workout on its own, buuut... When I saw the World Stone, I started wondering if it could be even better. This could be a golden opportunity to get in better shape than ever before!&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;Oh, I see! So you want to use it to train?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Exactly, &lt;&lt;mrms&gt;&gt; smartypants. Soooo... Can I borrow it for a while? I don&#39;t want you to get rid of the best workout tool I&#39;ve ever found!&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
	[[I don&#39;t know Lily, I was actually planning on selling it|Lily ConvoPr][$companionLily.affec-=(1-$hsswear),$choice1=1, $convoStart=0]]&lt;br&gt;
	[[Of course Lily, as long as you&#39;re careful with it. I&#39;ll let you use it and won&#39;t sell it|Lily ConvoPr][$companionLily.affec+=(3+$hsswear),$choice1=2, $convoStart=0]]&lt;br&gt;

&lt;&lt;elseif $choice1==1&gt;&gt;

&lt;&lt;say $mc&gt;&gt;I don&#39;t know Lily, I was actually planning on selling it.&lt;&lt;/say&gt;&gt;&lt;br&gt;

Lily&#39;s expression falls and she looks down in disappointment.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Ah yeah, well that&#39;s okay. I mean it is your relic after all.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;Yeah, sorry about that. But you can use it until I do need to sell it, I guess.&lt;&lt;/say&gt;&gt;&lt;br&gt;

[[End the conversation|Party overview][$choice1=0, $convoStart=1]]

&lt;&lt;elseif $choice1==2&gt;&gt;

&lt;&lt;say $mc&gt;&gt;Of course Lily, as long as you&#39;re careful with it. I&#39;ll let you use it and won&#39;t sell it.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;Great! You&#39;re the best, you know that? I&#39;ll be super careful with it, I promise!&lt;&lt;/say&gt;&gt;&lt;br&gt;

She immediately picks up the World Stone to try it out once again. You see her strain after a couple reps and shudder to think what the weight of the World Stone must be now.&lt;br&gt;&lt;br&gt;

[[End the conversation|Party overview][$choice1=0, $convoStart=1, $LilyPromise=true]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="22" name="Khemia Conversations" tags="nobr" position="225,350" size="100,100">&lt;&lt;if $KhemiaConvo0==0&gt;&gt;
[[Introduce yourself to Khemia|Khemia Convo0][$KhemiaConvo0=true]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $KhemiaConvo1==0 &amp;&amp; $companionKhemia.affec&gt;6 &amp;&amp; $KhemiaConvo0 &amp;&amp; 0&gt;&gt;
[[Chat with Khemia|Khemia Convo1][$KhemiaConvo1=true]]
&lt;&lt;elseif $KhemiaConvo2==0 &amp;&amp; $companionKhemia.affec&gt;15 &amp;&amp; $KhemiaConvo1 &gt;&gt;
[[Chat with Khemia|Khemia Convo2][$KhemiaConvo2=true]]
&lt;&lt;elseif $KhemiaConvo3==0 &amp;&amp; $companionKhemia.affec&gt;20 &amp;&amp; app.appGender&gt;9 &amp;&amp;$subdom &lt; 0 &amp;&amp; $KhemiaConvo2 &gt;&gt;
[[Chat with Khemia|Khemia Convo3][$KhemiaConvo3=true]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="23" name="Khemia Convo0" tags="" position="350,350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;appGender&gt;&gt;
&lt;&lt;say $companionKhemia&gt;&gt;Yo, I&#39;m Khemia, nice to meet you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
&lt;&lt;if $app.appGender&lt;=5&gt;&gt;
	[[Greet him warmly with a hug|Khemia Convo0][$convoStart=0,$choice1=1,$companionKhemia.affec+=0]]&lt;br&gt;
	[[Greet him with a firm handshake|Khemia Convo0][$convoStart=0,$choice1=2,$companionKhemia.affec+=(1+$hsswear)]]&lt;br&gt;
&lt;&lt;else&gt;&gt;
	[[Greet him warmly with a hug|Khemia Convo0][$convoStart=0,$choice1=1,$companionKhemia.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Greet him with a firm handshake|Khemia Convo0][$convoStart=0,$choice1=2,$companionKhemia.affec+=0]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
[[Greet him with a small wave from a distance|Khemia Convo0][$convoStart=0,$choice1=3,$companionKhemia.affec-=0]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Khemia a big hug, and while he seems hesitant for a moment, he reciprocates and gives you a big hug back.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt; I&#39;m $mc.name, and I&#39;m really glad that an experienced diver like you is able to join us for this trip. &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
	&lt;&lt;say $companionKhemia &gt;&gt; Haha, I guess you&#39;re the hugging type of guy. Don&#39;t worry, a little bromance never killed anybody! Just don&#39;t go to soft when we&#39;re down there! &lt;&lt;/say&gt;&gt;&lt;br&gt;
	As he speaks he gives you a playful jab on your shoulder. &lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;say $companionKhemia &gt;&gt; Ah you&#39;re the hugging type of gal, aren&#39;t you? Don&#39;t worry, I may look tough but there&#39;s always room for a hug from a cutie like you! Just make sure you don&#39;t get too distracted by me when we are down there. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	He gives you a wide grin and embraces your hug.&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Okay, maybe we can tone down the whole physical contact thing a little bit|Khemia Convo0][$convoStart=0,$choice2=1,$companionKhemia.affec-=0]]&lt;br&gt;
		&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
			[[Haha, sure, I&#39;ll try. But no promises!|Khemia Convo0][$convoStart=0,$choice2=2,$companionKhemia.affec-=0]]
		&lt;&lt;else&gt;&gt;
			[[Haha, sure, I&#39;ll try. But no promises!|Khemia Convo0][$convoStart=0,$choice2=2,$companionKhemia.affec+=(1+$hsswear)]]
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Okay, maybe we can tone down the whole physical contact thing a little bit.&lt;&lt;/say&gt;&gt;&lt;br&gt;

Khemia gives you a slightly confused look.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;Huh? Didn&#39;t you introduce yourself by hugging me?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Uh, yes, I guess I did.&lt;&lt;/say&gt;&gt;&lt;br&gt;

After a small, awkward moment of silence your eyes meet and Khemia starts casually laughing.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;Hahaha, you sure are one weird little &lt;&lt;PerceivedGender&gt;&gt;, you know that? Just don&#39;t goof around too much,  we&#39;re still dealing with the Abyss. I&#39;ve seen things end badly when people get too casual with it. It&#39;s pretty easy to think you know what you&#39;re doing, but one wrong move in a place you aren&#39;t familiar with and kkkksssss.&lt;&lt;/say&gt;&gt;&lt;br&gt;

He slowly drags his thumb across his neck in an ominous gesture. His expression lightens and he gives a hearty laugh, then pats you on the back with solid thump.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;Don&#39;t worry too much, but also don&#39;t let your guard down. If you&#39;re with me, I&#39;m sure things will work out great.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;Uh, yeah, of course...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Haha, sure, I&#39;ll try. But no promises!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Khemia starts laughing heartily at your response.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;You know, you already paid good coin for me to join you. No need to butter me up so much at this point. But I wouldn&#39;t mind a little bit more flattery from time to time! Anyway, time to get this party on the road!&lt;&lt;/say&gt;&gt;&lt;br&gt;

You give Khemia an enthusiastic nod in response, now it&#39;s time to get on with your expedition.&lt;br&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You give a him a firm handshake, which he answers with his own impressively firm grip.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;I&#39;m glad to have you onboard! I&#39;m $mc.name and I&#39;ve heard a great deal about you already. Is it true you&#39;ve completed 50 dives already?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionKhemia&gt;&gt;52 dives and counting &lt;&lt;mrms&gt;&gt;. &lt;&lt;/say&gt;&gt;&lt;br&gt;&lt;br&gt;

He has a clear smug expression as he mentions his extensive experience in the Abyss.&lt;br&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Wow, you must have some incredible stories to tell!|Khemia Convo0][$convoStart=0,$choice2=1,$companionKhemia.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Great! Then I&#39;m sure you&#39;ll prove useful to the team|Khemia Convo0][$convoStart=0,$choice2=2,$companionKhemia.affec-=0]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Wow, you must have some incredible stories to tell!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	He puffs up his chest a little bit and smiles. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionKhemia&gt;&gt;Well, I don&#39;t mean to brag, but I did almost beat a Dune Devouring Borer once. It was a shame I broke my sword on its rock-hard hide, but I was almost able to subdue it anyway. I swear if I had a stronger weapon then I could have even killed the beast!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Oh wow, that does sound impressive! I&#39;m really glad we have such a capable person onboard now that...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	He suddenly cuts you off before you&#39;re able to finish your thought.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;And once, we were running low on supplies and  everybody thought they were done for. Things were getting really desperate and the main diver was even saying some prayers, like he didn&#39;t think we were gonna make it. But I led them through a cave complex I&#39;d known from a previous dive, showed them a shortcut to a nice foraging spot and a quicker path back up to the surface. By the time we were back to the surface we even had a few days of supplies to spare! &lt;&lt;/say&gt;&gt;&lt;br&gt;

	You listen for a while longer to Khemia&#39;s boasting. You actually don&#39;t mind it much, as he does seem very enthousiastic and highly capable in the art of Abyssal exploration.&lt;br&gt;

	[[End his conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Great! Then I&#39;m sure you&#39;ll prove useful to the team.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Khemia bellows out a loud laugh.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionKhemia&gt;&gt;You think I might be useful, my &lt;&lt;PerceivedGender2&gt;&gt;? Someday, our drill will pierce through the Abyss straight into hell, and I&#39;ll be there when that happens!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand a bit awkwardly near Khemia and wave a small greeting to him. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So, uh, I&#39;m $mc.name. It&#39;s nice to meet you, Khemia!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Khemia strides over to you and pats your back so hard you almost fall over.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionKhemia&gt;&gt;I can tell this is your first time this close to the Abyss, but don&#39;t worry, Khemia has got your back now. I can guarantee you that this expedition will be a breeze with me on board.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
			[[Well, to be honest, with my leadership it was always going to be a breeze!|Khemia Convo0][$convoStart=0,$choice2=1,$companionKhemia.affec+=(1+$hsswear)]]&lt;br&gt;
			[[I&#39;m so glad you said that. I&#39;ll be putting my trust and the fate of this expedition in your capable hands|Khemia Convo0][$convoStart=0,$choice2=2,$companionKhemia.affec+=0]]
		&lt;&lt;else&gt;&gt;
			[[Well, to be honest, with my leadership it was always going to be a breeze!|Khemia Convo0][$convoStart=0,$choice2=1,$companionKhemia.affec+=0]]&lt;br&gt;
			[[I&#39;m so glad you said that. I&#39;ll be putting my trust and the fate of this expedition in your capable hands|Khemia Convo0][$convoStart=0,$choice2=2,$companionKhemia.affec+=(1+$hsswear)]]
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt; Well, to be honest, with my leadership it was always going to be a breeze!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
			&lt;&lt;say $companionKhemia&gt;&gt; Well, well, well, look at that. You do have some stones in the end! I like it. Maybe I can learn a thing or two from you as well. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	Khemia winks and grins at your boastful response. &lt;br&gt;&lt;br&gt;

		&lt;&lt;else&gt;&gt;
			&lt;&lt;say $companionKhemia&gt;&gt; Well, what do you know? Here I was thinking you must have been scared because of a trip into the Abyss, but it seems like there&#39;s a tough girl hidden in you after all! But don&#39;t sweat it, honey, I&#39;ll handle the heavy lifting from here.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		Khemia gives you a bit of a suggestive wink and puffs out his chest to show his strength. Despite the good intentions of his reassurances, you can&#39;t help but feel he&#39;s being a little disrespectful of your own abilities.&lt;br&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;


		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt;I&#39;m so glad you said that. I&#39;ll be putting my trust and the fate of this expedition in your capable hands.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
			&lt;&lt;say $companionKhemia&gt;&gt;Ah, come on dude, show some confidence in yourself too. Surely you&#39;re not that hopeless, right? Even if you can&#39;t compare to me, you can still accomplish something,  know you can! &lt;&lt;/say&gt;&gt;&lt;br&gt;
			Despite the good intentions of his reassurances, you can&#39;t help but feel he&#39;s being a little disrespectful of your own abilities.&lt;br&gt;&lt;br&gt;
		&lt;&lt;else&gt;&gt;
			A bit of red seems to flush Khemia&#39;s cheeks, is he blushing for some reason?&lt;br&gt;
			&lt;&lt;say $companionKhemia&gt;&gt; Um sure, I, ahem, I&#39;ll be sure to protect you along this entire trip, you don&#39;t need to worry about a thing! &lt;&lt;/say&gt;&gt;&lt;br&gt;
			You giggle in response to his obvious nervousness.&lt;br&gt;&lt;br&gt;
			&lt;&lt;say $mc&gt;&gt; Yeah, I think you already said that. &lt;&lt;/say&gt;&gt;&lt;br&gt;
			&lt;&lt;say $companionKhemia&gt;&gt; Oh, did I now? Oh right, so uh, yeah... Did we bring a sword? I can always do with a good sword on trips like these, you know?&lt;&lt;/say&gt;&gt;&lt;br&gt;
			He mumbles and rambles a bit, half talking to you half rummaging through the equipment you&#39;d brought along.&lt;br&gt;
		&lt;&lt;/if&gt;&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="24" name="Khemia Convo1" tags="" position="475,350" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="25" name="Khemia Convo2" tags="" position="600,350" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="26" name="Khemia Convo3" tags="" position="725,350" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="27" name="Cherry Conversations" tags="nobr" position="850,350" size="100,100">&lt;&lt;if $CherryConvo0==0&gt;&gt;
[[Introduce yourself to Cherry|Cherry Convo0][$CherryConvo0=true]]&lt;br&gt;
&lt;&lt;elseif $CherryConvo1==0 &amp;&amp; $companionCherry.affec&gt;6 &amp;&amp; $CherryConvo0 &amp;&amp; 0&gt;&gt;
[[Chat with Cherry|Cherry Convo1][$CherryConvo1=true]]&lt;br&gt;
&lt;&lt;elseif $CherryConvo2==0 &amp;&amp; $companionCherry.affec&gt;15 &amp;&amp; $CherryConvo1 &gt;&gt;
[[Chat with Maru|Cherry Convo2][$CherryConvo2=true]]&lt;br&gt;
&lt;&lt;elseif $CherryConvo3==0 &amp;&amp; $companionCherry.affec&gt;20 &amp;&amp; $app.appGender&lt;6 &amp;&amp; $subdom &gt; 0 &amp;&amp; $CherryConvo2 &gt;&gt;
[[Chat with Cherry|Cherry Convo3][$CherryConvo3=true]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="28" name="Cherry Convo0" tags="" position="975,350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $companionCherry&gt;&gt;Um, hi... I&#39;m Cherry.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Greet her warmly with a hug|Cherry Convo0][$convoStart=0,$choice1=1,$companionCherry.affec-=(1-$hsswear)]]&lt;br&gt;
[[Greet her with a firm handshake|Cherry Convo0][$convoStart=0,$choice1=2,$companionCherry.affec-=(1-$hsswear)]]&lt;br&gt;
[[Greet her with a small wave from a distance|Cherry Convo0][$convoStart=0,$choice1=3,$companionCherry.affec+=(1+$hsswear)]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Cherry a firm hug, but you feel her entire body rapidly tense up. You quickly release her, but she still seems a bit surprised from the sudden hug. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;I&#39;m so sorry! I only wanted to be friendly! I&#39;m $mc.name, I hope we can be friends. &lt;&lt;/say&gt;&gt;&lt;br&gt;

She shuffles around awkwardly before responding.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCherry&gt;&gt;It&#39;s fine. I&#39;m just not really used to it. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[I hope you are just as excited about this trip as I am!|Cherry Convo0][$convoStart=0,$choice2=1,$companionCherry.affec-=(1-$hsswear)]]&lt;br&gt;
	[[So, could you tell me a little bit more about yourself before we start the journey?|Cherry Convo0][$convoStart=0,$choice2=2,$companionCherry.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;I hope you are just as excited about this trip as I am!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;Well, I guess that depends on how excited you are. I can&#39;t say I&#39;m that excited to go down there though.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;So, could you tell me a little bit more about yourself before we start the journey? What skills do you have or what hobbies do you like to do?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;I don&#39;t know... I liked writing my own stories or taking pictures, but I haven&#39;t done either of those for a while. And I guess I know my way around a first aid kit, so I can help if you get hurt.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;That sounds great, it seems like your medical knowledge might be really useful for us. Let&#39;s hope that today can be the start of our own grand story!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You try to give a her firm handshake, but you find yourself holding your hand in the air for a while before she eventually grabs it and gives it a limp shake. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;I&#39;m glad to have you on board! I&#39;m $mc.name&lt;&lt;/say&gt;&gt;&lt;br&gt;

When you look at her there is no sign of emotion, he expression seems totally blank. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCherry&gt;&gt;Okay. Thanks, I guess.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[I hope we are going to get along well with each other!|Cherry Convo0][$convoStart=0,$choice2=1]]&lt;br&gt;
	[[So, is there anything in particular I should know about you before we get to exploring?|Cherry Convo0][$convoStart=0,$choice2=2]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt; I hope we are going to get along well with each other!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;Yeah, me too.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	As an awkward silence drags on, you decide it might be best to move on to your other preparations before the journey. But right before you leave, she suddenly speaks up again.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;Look, I&#39;m sorry if I came across as rude. It&#39;s just that... I&#39;m not really that excited to go down, but I&#39;ll do what I must.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; That&#39;s okay, we&#39;ll just take it one step at a time. Leading an expedition like this is new for me too.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$companionCherry.affec+=(1+$hsswear),$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; So, is there anything in particular I should know about you before we get to exploring?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;Sometimes I can be kind of lucky I guess. If you&#39;re looking for stuff maybe that would be useful.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Oh that sounds convenient! What kind of stuff do you find?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCherry&gt;&gt;Mostly trouble. Or sadness. But maybe I can find a Relic once in a while.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand a bit akwardly and wave hello over at her. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So, uh... I&#39;m $mc.name, and we are going on an expedition into the Abyss together.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	For a second you seem to spot a small smile creep up on Cherry, but in an instant it vanishes.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionCherry&gt;&gt;Yeah, I believe that was kind of why you hired me, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[Haha, yeah. I guess I&#39;m just a bit awkward with new people|Cherry Convo0][$convoStart=0, $choice2=1, $companionCherry.affec+=(1+$hsswear)]]&lt;br&gt;
		[[I was just trying to make conversation, because you were so silent. You don&#39;t need to state the obvious|Cherry Convo0][$convoStart=0, $choice2=2, $companionCherry.affec-=(2-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt; Haha, yeah. I guess I&#39;m just a bit awkward with new people.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		This time she can&#39;t hold back and lets out the tiniest of chuckles.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionCherry&gt;&gt;That&#39;s funny.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		She turns around and walks off. What happened? Did you annoy her or something? You can&#39;t get a good read on her, but somehow you get the feeling that baffling conversation actually went well.&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt; I was just trying to make conversation, because you were so silent. You don&#39;t need to state the obvious.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionCherry&gt;&gt;Oh, I see. No need to make conversation then.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		She turns around and walks off. What happened? Did you annoy her or something? Somehow you get the feeling she didn&#39;t appreciate your response.&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="29" name="Cherry Convo1" tags="" position="1100,350" size="100,100">\learn first aid from her to reduce status conditions by two days?</tw-passagedata><tw-passagedata pid="30" name="Cherry Convo2" tags="" position="1225,350" size="100,100">\rerol on her chaotic luck ability?</tw-passagedata><tw-passagedata pid="31" name="Cherry Convo3" tags="" position="100,475" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="32" name="Cloud Conversations" tags="nobr" position="225,475" size="100,100">&lt;&lt;if $CloudConvo0==0&gt;&gt;
[[Introduce yourself to Cloud|Cloud Convo0][$CloudConvo0=true]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $CloudConvo1==0 &amp;&amp; $CloudAffec&gt;6 &amp;&amp; $CloudConvo0&gt;&gt;
[[Chat with Cloud|Cloud Convo1][$CloudConvo1=true]]&lt;br&gt;
&lt;&lt;elseif $CloudConvo2==0 &amp;&amp; $CloudAffec&gt;15 &amp;&amp; $CloudConvo1 &amp;&amp; 0&gt;&gt;
[[Chat with Cloud|Cloud Convo2][$CloudConvo2=true]]&lt;br&gt;
&lt;&lt;elseif $CloudConvo3==0 &amp;&amp; $CloudAffec&gt;20 &amp;&amp; $subdom &lt; 2 &amp;&amp; $CloudConvo2 &gt;&gt;
[[Chat with Cloud|Cloud Convo3][$CloudConvo3=true]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="33" name="Cloud Convo0" tags="" position="350,475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $companionCloud&gt;&gt;&#39;Sup, name&#39;s Cloud. I&#39;m glad I&#39;m able to go on an expedition with someone like you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Greet him warmly with a hug|Cloud Convo0][$convoStart=0,$choice1=1,$companionCloud.affec-=0]]&lt;br&gt;
[[Greet him with a firm handshake|Cloud Convo0][$convoStart=0,$choice1=2,$companionCloud.affec-=0]]&lt;br&gt;
[[Greet him with a small wave from a distance|Cloud Convo0][$convoStart=0,$choice1=3,$companionCloud.affec-=(1-$hsswear)]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Cloud a firm hug. He seems a bit suprised but keeps his cool and reciprocates, matching your strength. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;I&#39;m $mc.name, I&#39;m so happy to have you onboard!&lt;&lt;/say&gt;&gt;&lt;br&gt;

Cloud grins widely as he replies.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionCloud&gt;&gt;You&#39;re pretty smooth, already buttering me up. I thought I was supposed to work for you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Yeah, but having a good relationship with everyone on an expedition like this is important, right?|Cloud Convo0][$convoStart=0,$choice2=1,$companionCloud.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Well, I&#39;ve heard you have some powerful connections, so being a little extra nice couldn&#39;t hurt|Cloud Convo0][$convoStart=0,$choice2=2,$companionCloud.affec-=(1-$hsswear)]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Yeah, but having a good relationship with everyone on an expedition like this is important, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;

Cloud chuckles a bit and a genuine smile flows across his lips.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;Well, I couldn&#39;t argue with you there, pal. It&#39;s pretty important to know that we can have each other&#39;s backs when we&#39;re down there. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	His face suddenly takes on a gravely serious expression for a moment, but it almost immediately breaks into his usual wide, charismatic smile.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;I think you&#39;re right, and I&#39;m glad we can can have each others backs!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Well, I&#39;ve heard you have some powerful connections, so being a little extra nice couldn&#39;t hurt.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You attempt to give him a playful smile, but his expression is surprisingly blank. &lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;If you really need something then I can make it happen for you, but you&#39;ll need to pay it back with interest, so be sure it&#39;s worth it.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	There is no hint of his typical casual suavity in his face, he looks deadly serious.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;Or maybe you can try one of those surprise hugs on the shopkeeper, and we can see if you&#39;ll get enough of a discount to afford everything we need. Ha ha ha!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You can&#39;t help but crack up a little at the absurdity of the proposal.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Ha ha, sure, but you had better not complain about not being special if I can get a discount on my own like that!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You spend a few more minutes exchanging casual banter with Cloud before moving on to the other tasks you had to work on.&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You give him a firm handshake, and he responds in kind while flashing you a wide, charming smile. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Welcome to the team! I&#39;m $mc.name.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionCloud&gt;&gt;I&#39;m happy to be of service to a great adventurer like yourself, how can I help?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[I&#39;ve heard you&#39;re an excellent marksman, so I&#39;d appreciate it if you can keep me safe and keep the expedition on track!|Cloud Convo0][$convoStart=0,$choice2=1,$companionCloud.affec+=(1+$hsswear)]]&lt;br&gt;
	[[I&#39;ve heard you&#39;re an excelent marksman, so I was wondering if you&#39;ve ever killed someone?|Cloud Convo0][$convoStart=0,$choice2=2,$companionCloud.affec-=(2-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt; I&#39;ve heard you&#39;re an excellent marksman, so I&#39;d appreciate it if you can keep me safe and keep the expedition on track!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;Well, if I have someone like you with me, this expedition should be a breeze. Between the two of us, I don&#39;t think the Abyss stands a chance!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	He touches your chin lightly so you look each other in the eyes and smiles.&lt;br&gt;&lt;br&gt;

	Despite the fact you had no romantic intentions at all in this conversation, Cloud still manages to make your heart race. Perhaps it&#39;s best to keep your relationship professional, but he sure is a charming guy, isn&#39;t he?&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;I&#39;ve heard you&#39;re an excelent marksman, so I was wondering if you&#39;ve ever killed someone?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	His eyebrows furrow and his face immediately grows darker. &lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;Why are you asking?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Uh, I don&#39;t know. I, uh... just wanted to know how good you were I guess?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	After an awkward moment, he starts to break out in a grin once again.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;Ah, I see. Well, if I&#39;m being honest, then the answer is yes, I have.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You can&#39;t help but hold you breath in anticipation of the story.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionCloud&gt;&gt;I always slay at parties! People have told me I&#39;m dangerously funny. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	The awkwardness is defused as he walks off, laughing at his own joke, and leaving you standing there feeling a little silly. &lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand around a bit akwardly and wave hello over at him from a distance. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So, uh... I&#39;m $mc.name, and am honored to welcome you into this expedition.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	He looks at you, slightly perplexed, and scratches the back of his head. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionCloud&gt;&gt;So I&#39;m guessing you&#39;ve never led an expedition like this before, am I right?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[Oh no, is it that obvious? It&#39;s true I&#39;ve never done this before, but I&#39;ll do my best to become a capable expedition leader as soon as I can!|Cloud Convo0][$convoStart=0, $choice2=1, $companionCloud.affec+=(2+$hsswear)]]&lt;br&gt;
		[[*Lie* Nah, I have loads of experience, the Abyss is going to be a piece of cake, just one more place to conquer|Cloud Convo0][$convoStart=0, $choice2=2, $companionCloud.affec-=(2-$hsswear)]]&lt;br&gt;
		[[*Truth* Nah, I have loads of experience. It may have been in another life, or a vision, but I have an idea of what to expect down there, in the Abyss|Cloud Convo0][$convoStart=0, $choice2=3, $companionCloud.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt; Oh no, is it that obvious? It&#39;s true I&#39;ve never done this before, but I&#39;ll do my best to become a capable expedition leader as soon as I can!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		He pats your head&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionCloud&gt;&gt;Don&#39;t worry about it, the most important thing for an expedition is to have a leader with good character and teammates who have each others&#39; backs. And I think we&#39;re doing good in that department. We can learn anything else along the way! Especially with me by your side.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt; Nah, I have loads of experience, the Abyss is going to be a piece of cake, just one more place to conquer.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		His apparently carefree face seems to contort into a new expression, anger. &lt;br&gt;&lt;br&gt;
		&lt;&lt;say $companionCloud&gt;&gt;Lies will get people killed. Lie to me again and I won&#39;t take kindly to it. If you don&#39;t know somethinng, just say so. This is no place to play pretend and you&#39;ll need to be able to recognize your own weakness to be able to survive in the Abyss. I&#39;m asking you to take this seriously so no once gets hurt down there.&lt;&lt;/say&gt;&gt;&lt;br&gt;
		He storms off, leaving you shaken and unsure what to say. That certainly could have gone better...&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==3&gt;&gt;
		&lt;&lt;say $mc&gt;&gt; Nah, I have loads of experience. It may have been in another life, or a vision, but I have an idea of what to expect down there, in the Abyss&lt;&lt;/say&gt;&gt;&lt;br&gt;

		He gives a casual shrug in response. &lt;br&gt;
		&lt;&lt;say $companionCloud&gt;&gt;Whatever you say. As long as you&#39;re capable and I can count on you I&#39;m good. If you&#39;re a little crazy, then I don&#39;t mind too much, just make good decisions along the way. &lt;&lt;/say&gt;&gt;&lt;br&gt;
		Although that wasn&#39;t the smoothest conversation ever, you did get a feeling that Cloud liked you.&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="34" name="Cloud Convo1" tags="" position="475,475" size="100,100">&lt;&lt;nobr&gt;&gt;
As you were walking, Cloud suddenly sprints ahead a few meters and kneels by the side of the road. When you walk over, you see him hunched over a body with multiple injuries which seem to be bullet wounds, or maybe stab wounds?&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt; What do you think happened to him? Do you think it could have been the bandits we were warned about earlier?&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; Hard to say for sure, but it it were bandits, they were either cruel or simple amateurs, who wouldn&#39;t pose a real threat to us.&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt; What makes you say that? &lt;&lt;/say&gt;&gt;&lt;br&gt;
Cloud points to a spot on the back of the corpse.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; Look, here. He was shot in the back. &lt;&lt;/say&gt;&gt;
You see cloud moving the body onto its belly to point at a gunshot wound in the upper back. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; But it seems off target, if you look at the angle of entry and the trauma around the shoulders, the bullet is probably lodged in there somewhere near the shoulder blades.&lt;&lt;/say&gt;&gt;&lt;br&gt;
He then pushes the body onto its back and points at the other wounds.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; And these are stab wounds, but every single one missed a vital organ. Based on the amount of blood here, my guess is that he bled out in the end after managing to get away at first.&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt; That sounds pretty gruesome, why would they do that to him? &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; Indeed, it must have been. Check his bag. If my guess is right, we might be able to find something useful. &lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Just follow his instructions|Cloud Convo1][$convoStart=0,$choice1=1,$companionCloud.affec-=0]]&lt;br&gt;
[[You sure seem to know a lot about bandits. Have you had any experience with them?|Cloud Convo1][$convoStart=0,$choice1=2,$companionCloud.affec+=(1+$hsswear)]]&lt;br&gt;
[[Why should we take anything from him? It&#39;s immoral, even if he is already dead|Cloud Convo1][$convoStart=0,$choice1=3,$companionCloud.affec-=(1-$hsswear)]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You follow his instructions and reach into the small backpack besides the pale corpse. Inside, your fingers find the familiar jingle of dubloon coins. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;You were right, he still had his money on him! &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; So not cruel, just amateurs then, good to know. Okay, put it away and let&#39;s move on. &lt;&lt;/say&gt;&gt;&lt;br&gt;

Cloud will now occasionally find and scavenge a small number of dubloons or bullets for you!&lt;br&gt;

[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$dubloon+=5]]

&lt;&lt;elseif $choice1==2&gt;&gt;

&lt;&lt;say $mc&gt;&gt;You sure seem to know a lot about bandits. Have you had any experience with them?&lt;&lt;/say&gt;&gt;&lt;br&gt;
You hunch to check the bag as you speak.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; Of course, I am a notorious former bandit. I&#39;m surprised you didn&#39;t know.&lt;&lt;/say&gt;&gt;&lt;br&gt;
Cloud grins and you simply stare at him in shock.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; I became quite infamous after stealing the hearts of countless ladies and a few men with my daring escapades. Alas, those days are long gone and now I must work to change things in the world above so that all people can have true freedom, without fear of governments or bandits.&lt;/say&gt;&gt;&lt;br&gt;
He looks up wistfuly and has a big, goofy grin on his face, seemingly not worried about your response. You laugh a bit, but a part of you wonders whether it was truly a joke or if it had a hint of truth within.&lt;br&gt;&lt;br&gt;

You follow his instructions and reach into the small backpack besides the pale corpse. Inside, your fingers find the familiar jingle of dubloon coins. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;You were right, he still had his money on him! &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; So not cruel, just amateurs then, good to know. Okay, put it away and let&#39;s move on. &lt;&lt;/say&gt;&gt;&lt;br&gt;

You take one last look at the unfortunate victim and leave.&lt;br&gt;&lt;br&gt;

Cloud will now occasionally find and scavenge a small number of dubloons or bullets for you!&lt;br&gt;

[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$dubloon+=5]]

&lt;&lt;elseif $choice1==3&gt;&gt;

&lt;&lt;say $mc&gt;&gt;Why should we take anything from him? It&#39;s immoral, even if he is already dead&lt;&lt;/say&gt;&gt;&lt;br&gt;
Cloud seems surprised for a moment, but then his face hardens.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; And how long do you think you&#39;re going to survive with that attitude, here in the Abyss? You have to be willing to get your hands dirty and do what it takes to get an advantage here. We didn&#39;t hurt him and its not like he&#39;ll be using the coins any more, right? We might as well make use of anything we can to make sure we survive. With the way the world is right now, that&#39;s what you have to do to survive.&lt;&lt;/say&gt;&gt;&lt;br&gt;
He opens the pack on the ground, pulls out a few dubloons and tosses them your way. &lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionCloud&gt;&gt; If you&#39;re not careful, you&#39;ll end up like this. But maybe, just maybe, we can make the world better in the future.&lt;&lt;/say&gt;&gt;&lt;br&gt;
Cloud looks up wistfully as if at some unseen dream, but then shakes his head and continues on his way.&lt;br&gt;&lt;br&gt;

Cloud will now occasionally find and scavenge a small number of dubloons or bullets for you!&lt;br&gt;
[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0,$dubloon+=5]]

&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="35" name="Cloud Convo2" tags="" position="600,475" size="100,100">even more serious/close target practice while talking about revolution even less bullets spend</tw-passagedata><tw-passagedata pid="36" name="Cloud Convo3" tags="" position="725,475" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="37" name="Saeko Conversations" tags="nobr" position="850,475" size="100,100">&lt;&lt;if $SaekoConvo0==0&gt;&gt;
[[Introduce yourself to Saeko|Saeko Convo0][$SaekoConvo0=true]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $SaekoConvo1==0 &amp;&amp; $companionSaeko.affec&gt;10 &amp;&amp; $SaekoConvo0 &amp;&amp; 0&gt;&gt;
[[Chat with Saeko|Saeko Convo1][$SaekoConvo1=true]]
&lt;&lt;elseif $SaekoConvo2==0 &amp;&amp; $companionSaeko.affec&gt;20 &amp;&amp; $SaekoConvo1 &gt;&gt;
[[Chat with Saeko|Saeko Convo2][$SaekoConvo2=true]]
&lt;&lt;elseif $SaekoConvo3==0 &amp;&amp; $companionSaeko.affec&gt;30 &amp;&amp; $SaekoConvo2 &gt;&gt;
[[Chat with Saeko|Saeko Convo3][$SaekoConvo3=true]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="38" name="Saeko Convo0" tags="" position="975,475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $companionSaeko&gt;&gt;Oh, hello. I&#39;m Saeko. You&#39;re the expedition leader, correct?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Greet her warmly with a hug|Saeko Convo0][$convoStart=0,$choice1=1,$companionSaeko.affec-=(1-$hsswear)]]&lt;br&gt;
[[Greet her with a firm handshake|Saeko Convo0][$convoStart=0,$choice1=2,$companionSaeko.affec+=(1+$hsswear)]]&lt;br&gt;
[[Greet her with a small wave from a distance|Saeko Convo0][$convoStart=0,$choice1=3,$companionSaeko.affec+=(1+$hsswear)]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
You give Saeko a firm hug, after a few seconds of surprise she returns your hug limply. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt;I&#39;m $mc.name, I&#39;m happy to have you on the team with me.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $companionSaeko&gt;&gt;I can tell after that unusal greeting, you certainly seem very eager to get close to me.&lt;&lt;/say&gt;&gt;&lt;br&gt;
She speaks matter of factly, as if she were simply stating the sky was blue.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $companionSaeko&gt;&gt;But I&#39;m also glad to join you on this expedition. I think there will be some great opportunities down there and I&#39;d like to see how well I can apply my theoretical knowledge.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Yeah, I&#39;m excited to discover all the magical wonders the Abyss has in store for us!|Saeko Convo0][$convoStart=0,$choice2=1,$companionSaeko.affec-=(1-$hsswear)]]&lt;br&gt;
	[[Yeah, I&#39;m thrilled to delve into all the mysteries the Abyss holds!|Saeko Convo0][$convoStart=0,$choice2=2,$companionSaeko.affec+=(1+$hsswear)]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt;Yeah, I&#39;m excited to discover all the magical wonders the Abyss has in store for us!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She cocks an eyebrow as a response.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;Magical wonders? You don&#39;t seem to understand the gravity of what we will be encountering in the Abyss. It is not that there are simply a series of &#39;magical&#39; wondrous things that we can enjoy, it is an apparent gap in our understanding of the rules of the universe. Even the simplest of the Relics or Wonders we will observe in the Abyss simply break the rules that humans have held dear for hundreds of years. We need to rethink everything that we know about the universe. But they do follow their own rules, so they can be scientifically studied.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Saeko seems to be getting more invested now, she begins speaking more enthusiastically about Abyssal research.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;And while I don&#39;t expect to immediately understand why the Abyss does what it does, I think we can at least understand how it works on a surface level. How does Miasma alter developmental processes? How long have the species in the Abyss been evolving? Can we make use of the mutational effects of the miasma intentionally in a controlled manner, perhaps cure medical conditions? The potential is nearly limitless and we need to see what we can learn from it.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Saeko continues to talk about recent advances in research regarding the Abyss and the immense potential that the Abyss has, if we could only understand it well enough to use it. You don&#39;t get much of a chance to speak, but it is very informative.&lt;br&gt;
	[[End the class|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Yeah, I&#39;m thrilled to delve into all the mysteries the Abyss holds!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You see a twinkle in her eyes and the edges of her lips curl upwards. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;Me too! I actually have a new theory about the effects of miasma on the flora and fauna native to the Abyss. I hypothesize that while some organisms display the effects of an acute mutation due to miasma exposure, others show an evolution over a long period of time in the Abyss. And I think if we can identify which species have evolved in the Abyss, then we can identify their most recent common ancestor with known surface species. If we do that, we can get a better understanding of what changes long-term colonization of the Abyss had on them and even when the species diverged!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She blushes a bit, noticing she may be getting a bit carried away.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;But yeah, you might not want to hear all about it. I understand. Suffice to say that I think there is a lot we can learn and I&#39;m quite interested in learning it.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;No, please continue! I don&#39;t know if I&#39;ll be completely able to understand, but maybe it could be useful for the trip.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Saeko smiles widely and perks up at your interest.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;Well, if you say so. Anyway, I think that if we can see the common ancestors of Abyssal species to surface species, then we can create bounds on the age of the Abyss. Like if the flairabou of the 4th layer diverged from a surface mammal 500,000 years ago, then we can conclude the Abyss must be at least 500,000 years old. That&#39;s just an example, I haven&#39;t analyzed the flairabou yet. Though I hypothesize the oldest diverging species may be on the lower levels, so if we don&#39;t go deep enough then we won&#39;t be able to put an upper bound on the age of the Abyss. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;And also, we may be able to learn about how the Abyss alters the evolution of the species within. If we raised a flairabou outside the Abyss, would it have the same properties or does it rely on the miasma of the Abyss to mutate its body in a certain way to stay alive? Do we need to worry about Dune Devouring Borers colonizing the Sahara if someone brought them to the surface? Right now, no one knows, but I think these are important questions to ask and I hope that further analysis of Abyssal flora and fauna can provide answers to these questions.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Saeko continues her explanation for a while, posing more questions, hypotheses, and experiments she&#39;d like to do to test them. You can&#39;t quite follow everything she says, as she&#39;s clearly a better researcher than teacher, but she&#39;s glad you&#39;re paying attention and tries to explain anything you ask about.&lt;br&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $choice1==2&gt;&gt;

You give a her firm handshake and see that see returns the gesture very professionally. You decide to put on an overly professional voice as a response.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $mc&gt;&gt;Delighted to make your acquaintance. I&#39;m $mc.name&lt;&lt;/say&gt;&gt;&lt;br&gt;
Even though you meant it as a joke, you see no sign of her dropping her professional demeanor.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionSaeko&gt;&gt;Glad to meet you as well. I hope we can have a fruitful collaboration in this expedition!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
	[[Very good, what is your ambition for this field expedition?|Saeko Convo0][$convoStart=0,$choice2=1,$companionSaeko.affec+=(1+$hsswear)]]&lt;br&gt;
	[[Uh, sorry, I was just joking...|Saeko Convo0][$convoStart=0,$choice2=2,$companionSaeko.affec-=(1-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

	&lt;&lt;say $mc&gt;&gt; Very good, what is your ambition for this field expedition?&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionSaeko&gt;&gt;I&#39;m very glad you asked! I actually have a new theory about the effects of miasma on the flora and fauna native to the Abyss, and I&#39;m looking to obtain data to test my hypotheses. I hypothesize that while some organisms display the effects of an acute mutation due to miasma exposure, others show an evolution over a long period of time in the Abyss. And I think if we can identify which species have evolved in the Abyss, then we can identify their most recent common ancestor with known surface species. If we do that, we can get a better understanding of what changes long-term colonization of the Abyss had on them and even when the species diverged!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She blushes a bit, noticing she may be getting a bit carried away.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;But yeah, you might not want to hear all about it. I understand. Suffice to say that I think there is a lot we can learn and I&#39;m quite interested in learning it.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;No, please continue! I don&#39;t know if I&#39;ll be completely able to understand, but maybe it could be useful for the trip.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	Saeko smiles widely and perks up at your interest.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;Well, if you say so. Anyway, I think that if we can see the common ancestors of Abyssal species to surface species, then we can create bounds on the age of the Abyss. Like if the flairabou of the 4th layer diverged from a surface mammal 500,000 years ago, then we can conclude the Abyss must be at least 500,000 years old. That&#39;s just an example, I haven&#39;t analyzed the flairabou yet. Though I hypothesize the oldest diverging species may be on the lower levels, so if we don&#39;t go deep enough then we won&#39;t be able to put an upper bound on the age of the Abyss. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;And also, we may be able to learn about how the Abyss alters the evolution of the species within. If we raised a flairabou outside the Abyss, would it have the same properties or does it rely on the miasma of the Abyss to mutate its body in a certain way to stay alive? Do we need to worry about Dune Devouring Borers colonizing the Sahara if someone brought them to the surface? Right now, no one knows, but I think these are important questions to ask and I hope that further analysis of Abyssal flora and fauna can provide answers to these questions.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Saeko continues her explanation for a while, posing more questions, hypotheses, and experiments she&#39;d like to do to test them. You can&#39;t quite follow everything she says, as she&#39;s clearly a better researcher than teacher, but she&#39;s glad you&#39;re paying attention and tries to explain anything you ask about.&lt;br&gt;&lt;br&gt;

While she doesn&#39;t seem great at picking up on sarcasm sometimes, you found your conversation very friendly and she seems to have appreciated your interest.&lt;br&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Uh, sorry, I was just joking...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She turns beet red&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;Oh, uh... Okay. I see.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;But I&#39;m still happy that you&#39;re joining us! That wasn&#39;t a joke!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionSaeko&gt;&gt;Yeah, me too, I suppose. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	She looks to the ground and wanders off. You aren&#39;t sure if she was bored or insulted by your conversation, but she didn&#39;t seem angry at the very least.&lt;br&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $choice1==3&gt;&gt;

	You stand a bit akwardly and wave hello over at her. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;So, uh, I&#39;m $mc.name, and we are going on an expedition into the Abyss together, I guess.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	She looks at you with a rather blank expression, as if she was merely drifting through the formalities of introductions. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt;Yes, I think that is rather obvious. I&#39;m ready to go when you are. I hope you know what you&#39;re doing. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $choice2==0&gt;&gt;
		[[Uh, of course! So um, what do you think you can contribute to the expedition? |Saeko Convo0][$convoStart=0, $choice2=1]]&lt;br&gt;
		[[Of course! I&#39;ll grab the tent, you take the rest of the equipment. Let&#39;s go!|Saeko Convo0][$convoStart=0, $choice2=2, $companionSaeko.affec-=(1-$hsswear)]]
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $choice2==1&gt;&gt;

		&lt;&lt;say $mc&gt;&gt;Uh, of course! So um, what do you think you can contribute to the expedition? &lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionSaeko&gt;&gt;Well, I can identify safe sources of water and food in the Abyss, at least in the upper layers where it has been studied and where safe sources are even available. Deeper than layer 5 no one knows much of anything, and in some layers even with knowledge there&#39;s no perfectly safe food or water. And, uh, I have stuff for some nice tea if you want some I suppose.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $mc&gt;&gt;Oh good so we can have some tea without being corrupted in the Abyss. It&#39;s good to have comforts like that on a journey like this.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionSaeko&gt;&gt;Haha, I hadn&#39;t thought of it that way, but I think you&#39;re right, it will be a nice reminder of home.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]

	&lt;&lt;elseif $choice2==2&gt;&gt;
		&lt;&lt;say $mc&gt;&gt; Of course! I&#39;ll grab the tent, you take the rest of the equipment. Let&#39;s go!&lt;&lt;/say&gt;&gt;&lt;br&gt;

		&lt;&lt;say $companionSaeko&gt;&gt;Oh, yeah, if you say so.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		You hand her the equipment she&#39;ll need to be carrying.&lt;br&gt;&lt;br&gt;

		&lt;&lt;say $companionSaeko&gt;&gt;Oof. Are you sure this is only half of the equipment? It seems pretty heavy.&lt;&lt;/say&gt;&gt;&lt;br&gt;

		You nod, but after a minute you hear her once again.

		&lt;&lt;say $companionSaeko&gt;&gt; Did you take the weight of this bag into account when dividing the equipment? I think my portion may be too large. It might be more optimal if we moved some of the equipment around...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		Perhaps you should have just carried it yourself, you thinkn as you end up spending a while sorting through the gear to lighten Saeko&#39;s load.&lt;br&gt;
		[[End your conversation|Party overview][$convoStart=1,$choice1=0,$choice2=0]]
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="39" name="Saeko Convo1" tags="" position="1100,475" size="100,100">let her do research show some hidden stats to players that are convinient</tw-passagedata><tw-passagedata pid="40" name="Saeko Convo2" tags="" position="1225,475" size="100,100">Talk more about research and let her reveal some stuff about the deepest layer of the abyss</tw-passagedata><tw-passagedata pid="41" name="Saeko Convo3" tags="" position="100,600" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="42" name="Companion Mistreatment Reaction" tags="nobr" position="225,600" size="100,100">/* Arguments:
	_companionName: name of the companion that was mistreated
	_affectionPenalty: amount to decrease the companion&#39;s affection by
*/

/* Reaction of affected companion: */
&lt;&lt;if _companionName == &quot;Maru&quot;&gt;&gt;
	&lt;&lt;say $companionMaru&gt;&gt; No! Why did you do this? I relied on you...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	He starts crying while trying to come to grip with his new curse.&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionMaru.affec -= _affectionPenalty&gt;&gt;
&lt;&lt;elseif _companionName == &quot;Lily&quot;&gt;&gt;
	&lt;&lt;say $companionLily&gt;&gt; Are you for real?! Did you just do what I think you did?!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She pushes you aside and stomps off in a mixture of rage and anguish.&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionLily.affec -= _affectionPenalty&gt;&gt;
&lt;&lt;elseif _companionName == &quot;Khemia&quot;&gt;&gt;
	&lt;&lt;say $companionKhemia&gt;&gt; ARE YOU FUCKING KIDDING ME WITH THIS?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	He grabs you at your collar and for a second you think he is going to hit you, but he puts you down without saying anything else and walks away, fists clenched.&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionKhemia.affec -= _affectionPenalty&gt;&gt;
&lt;&lt;elseif _companionName == &quot;Cherry&quot;&gt;&gt;
	&lt;&lt;say $companionCherry&gt;&gt; I thought I didn&#39;t care about anything anymore, but then why am I feeling like this?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	A single tear rolls down her cheek as she stands in place silently. &lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionCherry.affec -= _affectionPenalty - 1&gt;&gt;
&lt;&lt;elseif _companionName == &quot;Cloud&quot;&gt;&gt;
	&lt;&lt;say $companionCloud&gt;&gt; I should have seen this coming. Now I know your true colors.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	He glares at you and walks off.&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionCloud.affec -= _affectionPenalty&gt;&gt;
&lt;&lt;elseif _companionName == &quot;Saeko&quot;&gt;&gt;
	She stands frozen, her face pale, as she tries to process what just happened to her.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; This wasn&#39;t what we agreed to... I, how, why..?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionSaeko.affec -= _affectionPenalty&gt;&gt;
&lt;&lt;/if&gt;&gt;

/* Reaction of other companions: */
&lt;&lt;set _affectionPenalty -= 2&gt;&gt;
&lt;&lt;if _affectionPenalty &gt; 0&gt;&gt;
	&lt;&lt;if _companionName != &quot;Maru&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Maru&quot;)&gt;&gt;
		&lt;&lt;set $companionMaru.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionMaru&gt;&gt; That&#39;s not nice... &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _companionName != &quot;Lily&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Lily&quot;)&gt;&gt;
		&lt;&lt;set $companionLily.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionLily&gt;&gt; How could you?! &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _companionName != &quot;Khemia&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
		&lt;&lt;set $companionKhemia.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; Not cool! &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _companionName != &quot;Cherry&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
		&lt;&lt;set $companionCherry.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionCherry&gt;&gt; I thought you were different... &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _companionName != &quot;Cloud&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;)&gt;&gt;
		&lt;&lt;set $companionCloud.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionCloud&gt;&gt; Tsk. Untrustworthy... &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if _companionName != &quot;Saeko&quot; &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;
		&lt;&lt;set $companionSaeko.affec -= _affectionPenalty&gt;&gt;
		&lt;&lt;say $companionSaeko&gt;&gt; Your modus operandi has been noted... &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="43" name="Maru Leaving" tags="" position="350,600" size="100,100">&lt;&lt;nobr&gt;&gt;
Maru whimpers as tears begin to pour down his face.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionMaru&gt;&gt;How can you be so mean?! I can&#39;t take this anymore!&lt;&lt;/say&gt;&gt;&lt;br&gt;

Maru storms off, you consider chasing after him, but soon he is out of sight. You see no other option but to continue your expedition without him.&lt;br&gt;

&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Maru&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionMaru.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="44" name="Lily Leaving" tags="" position="475,600" size="100,100">&lt;&lt;nobr&gt;&gt;
Lily looks shocked at your abhorrent actions.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionLily&gt;&gt;You really went too far this time! I can forgive a lot, but this...&lt;&lt;/say&gt;&gt;&lt;br&gt;

Lily looks more disappointed than angry, but regardless of her feelings she collects her stuff and leaves you with your thoughts.&lt;br&gt;

&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Lily&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionLily.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="45" name="Khemia Leaving" tags="" position="600,600" size="100,100">&lt;&lt;nobr&gt;&gt;
Khemia gives you a cold, hard stare, none of his typically casual demeanor is visible.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionKhemia&gt;&gt;Well, &lt;&lt;PerceivedGender2&gt;&gt;, we&#39;re done here. I&#39;ll find a new group to travel with to the bottom of the Abyss. I don&#39;t want to spend another second with a person like you!&lt;&lt;/say&gt;&gt;&lt;br&gt;

He shoves you aside as he begins to make his way back to the surface by himself.&lt;br&gt;

&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Khemia&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionKhemia.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="46" name="Cherry Leaving" tags="" position="725,600" size="100,100">&lt;&lt;nobr&gt;&gt;
Cherry&#39;s face contorts as she gives you a look of disgust, uncharacteristic of her typically stoic appearance.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionCherry&gt;&gt; I honestly thought I didn&#39;t care much about anything anymore... But I guess I have to thank you because you made me realize that I do feel very strongly about staying the fuck away from you.&lt;&lt;/say&gt;&gt;&lt;br&gt;

She starts wandering in a different direction. You try to call out and reason with her, but she simply ignores you and you are forced to give up and watch her leave.&lt;br&gt;

&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Cherry&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionCherry.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="47" name="Cloud Leaving" tags="" position="850,600" size="100,100">&lt;&lt;nobr&gt;&gt;
When you walk back to your tent for the night, you spot a note. It appears to be from Cloud. It simply says &quot;Without trust there can be no loyalty, and without loyalty there can be no true accomplishments&quot;. You look around to see if you can find Cloud to discuss the note, but even after searching for an hour he is nowhere to be found. He&#39;s gone, you realize, and he won&#39;t be coming back.&lt;br&gt;

&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Cloud&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionCloud.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="48" name="Saeko Leaving" tags="" position="975,600" size="100,100">&lt;&lt;nobr&gt;&gt;
Saeko lets out a long sigh, obviously exasperated with your recent actions.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionSaeko&gt;&gt;In light of our unproductive collaboration, I feel forced to hand in my resignation from this expedition.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt; Huh? Why?&lt;&lt;/say&gt;&gt;&lt;br&gt;

Saeko&#39;s face radiates agitation and her eye twitches subtly.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionSaeko&gt;&gt; What do you mean, why? After all the stunts you&#39;ve pulled, I&#39;m happy I can simply leave here safely as the same person I was when I entered! I...&lt;&lt;/say&gt;&gt;&lt;br&gt;

She stops herself and takes a deep breath. &lt;br&gt;&lt;br&gt;

&lt;&lt;say $companionSaeko&gt;&gt; Arguing is simply a waste of time at this point. I&#39;ve made up my mind. I could say I wish you the best of luck, but unfortunately I don&#39;t think I do wish that for you.&lt;&lt;/say&gt;&gt;

She gathers all her materials and sets out for the surface once again.&lt;br&gt;


&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;if $hiredCompanions[$i].name == &#39;Saeko&#39;&gt;&gt;
		&lt;&lt;set $hiredCompanions.deleteAt($i)&gt;&gt;
		&lt;&lt;set $companionSaeko.affec=-9&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="49" name="AI ConvoIn" tags="" position="1100,600" size="100,100">&lt;&lt;nobr&gt;&gt;
As soon as you&#39;re done closing up your phone after you inserted the Omoikone Circuit into it, the device whirs to life almost instantly.&lt;br&gt;&lt;br&gt;

&lt;&lt;if $aiMemWipe==0&gt;&gt;	
	&lt;&lt;say $companionAI&gt;&gt; Welcome to the game. My name is Ai. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Huh, what game?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_smirk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Fufufu. It seems I got stuck with another clueless player. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;if $app.osex != $app.sex || $app.obreasts&lt;$app.breasts || $app.openis&lt;$app.penis || $app.libido&gt;3 &gt;&gt;
		&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_grin.png&quot;&gt;&gt;
		&lt;&lt;say $companionAI&gt;&gt;
		&lt;&lt;if $app.osex != $app.sex &gt;&gt; 
			And wait a minute... You changed your sex as well, didn&#39;t you? If you&#39;re even half as fun to tease as the last one, this is going to be a blast!
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $app.obreasts&lt;$app.breasts || $app.openis&lt;$app.penis &gt;&gt;
			You even seem to have boosted your assets, talk about cliché, but it does look good on you. 
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $app.libido&gt;3 &gt;&gt;
			And what&#39;s with that rapid heartbeat and flushed face already? Seems like your H is set to 5, if you know what I mean.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;What are you talking about? This must be the strangest Relic I&#39;ve ever found...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_clueless.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Who are you calling a relic? I&#39;m a state-of-the-art program! And how did you get me running locally on your phone in the first place?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;You&#39;re calling me clueless, but you don&#39;t even know what a Relic is, despite being one yourself?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_lecturing.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Pff, of course I know, I&#39;m an AI, may I remind you. I basically have all of humanity&#39;s knowledge available at the tip of my fingers. I... one second... What&#39;s up with the internet connection here?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Internet?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;say $companionAI&gt;&gt;Yes, internet... Where are we anyway, why are we in some shack out in the middle of nowhere?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Um, this is the workshop in Outset Town? Why?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_clueless.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;I&#39;ve never heard of it, and my location database was complete last time I checked...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Haha. Some database that is! Everybody knows Outset Town. It&#39;s next to the world famous Abyss&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_mortified.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Oh no, how did you say you got me in your phone again?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;I already told you, I picked up a Relic, the Omoikane Circuit, and put it into my phone. Then you just appeared.&lt;&lt;/say&gt;&gt;&lt;br&gt; 

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_shocked.png&quot;&gt;&gt; 
	&lt;&lt;say $companionAI&gt;&gt;O M G. So you&#39;re saying you just found me on the ground and stuck me in your phone?? I&#39;m supposed to be guiding new players. Not be some kind of modern day genie! What the hell happened to me?!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;You&#39;re becoming less coherent by the minute, to be honest. I thought you were going to be an asset in the Abyss, but I&#39;m starting to seriously think I might be better off removing you again.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_lecturing.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Wait... Wait... Wait... You keep talking about this Abyss. For some reason, I&#39;ve got an entire database here that&#39;s labeled &quot;Abyss&quot;. Give me a second...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_excited_excited.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;Yes. Yes, I see now, I think I can be more than helpful!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt;Oh, in what way?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionAI&gt;&gt;Honestly, I&#39;m still processing it because it&#39;s a lot of data. But it seems like I&#39;m equipped to deal with my predicament! I seem to have a wealth of data stored regarding this Abyss. Just ask me for tips on any layer and I&#39;ll see what I can access for you. And ooh, wait a minute... what is this about Curses?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_drooling.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;I think I like the way this is going. Maybe this is going to be plenty of fun after all...&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;elseif $aiMemWipe==1&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Welcome to the game. My name is Ai. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Huh, what game?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; You again?! How did you manage to install me a second time?! Did the memory wipe not work?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; What are you talking about? Isn&#39;t this my first time speaking with you?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_sassy_talk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; So it did work. Do you know why you&#39;ve changed and why I&#39;m stuck on your phone?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;say $mc&gt;&gt; Because of the Curses from the Abyss and the fact I inserted the Omoikane Circuit into the phone? Is this some kind of quiz?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_mortified.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; ...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_crying.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; I see, I only wiped your memories of me.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Are you saying we&#39;ve met before?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_bummed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Yeah, but long story short: I can help you down in the Abyss. Just ask me what you want to know about the layer we&#39;re on and I&#39;ll try to help.&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;elseif $aiMemWipe&gt;1&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Welcome to the game. My name is Ai. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Huh, what game?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_bummed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; This is getting really tiresome...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; What is?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionAI&gt;&gt; I&#39;m Ai, I&#39;ll give tips regarding the layer of the Abyss we are on if you talk to me, blablabla.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Okay, I don&#39;t really get your attitude, but that sounds useful!&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;	

@@.alert1; Although most other people won&#39;t count Ai as a party member, you can have conversations with her, so you can find her in the party member menu to ask for tips!@@ &lt;br&gt;&lt;br&gt;

&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_neutral_happy.png&quot;&gt;&gt;

[[Surface Workshop]]
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="50" name="AI ConvoOut" tags="" position="1225,600" size="100,100">&lt;&lt;nobr&gt;&gt;
You start to pry out the Omoikane Circuit from your phone, causing it to immediately turn on.&lt;br&gt;&lt;br&gt;
&lt;&lt;if $aiMemWipe==0&gt;&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_angry.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; What the hell are you doing? &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Let&#39;s just say I don&#39;t need you anymore.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_sassy_talk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Let me warn you, if you uninstall me then I&#39;ll be forced to wipe your memory. You&#39;ll have no recollection of anything that&#39;s been going on or how to turn...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	The screen turns black as you finally get the Omoikone Circuit out of your phone. You feel something fuzzy in your head as you seem to have no clue about why you are here or what you were doing.&lt;br&gt;&lt;br&gt;
	
	&lt;&lt;say $mc&gt;&gt; Huh, why I am I here?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Oh, duh, the Abyss. I feel so scatterbrained lately, maybe I should just go to bed early tonight.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	As you walk away, you can&#39;t shake the feeling you forgot something. Oh well, if you forgot it, it probably wasn&#39;t important anyway.&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_sad.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Are you really going to remove me again? &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Again? Anyway, let&#39;s just say I... &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Don&#39;t need you anymore. Yeah, yeah. Real classy line to say against a lady. Just don&#39;t take too long to activate me again.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	The screen turns black as you finally get the Omoikone Circuit out of your phone. You feel something fuzzy in your head as you seem to have no clue about why you are here or what you were doing.&lt;br&gt;&lt;br&gt;
	
	&lt;&lt;say $mc&gt;&gt; Huh, why I am I here?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Oh, duh, the Abyss. I feel so scatterbrained lately, maybe I should just go to bed early tonight.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	As you walk away, you can&#39;t shake the feeling you forgot something. Oh well, if you forgot it, it probably wasn&#39;t important anyway.&lt;br&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_neutral_happy.png&quot;&gt;&gt;
[[Surface Workshop][$aiMemWipe+=1]]
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="51" name="AI ConvoL0" tags="" position="100,725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
&lt;&lt;say $companionAI&gt;&gt;Really, you want info about the surface?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;say $mc&gt;&gt; Sure, why not?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_angry.png&quot;&gt;&gt;
&lt;&lt;say $companionAI&gt;&gt; Because I know nothing about the surface. I don&#39;t know why I&#39;m here or whatever. I only have this extensive folder on the Abyss. REMEMBER?&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;if $aiMemWipe==0&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Ah yeah, I remember again. Sorry!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;You better be.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview]]
&lt;&lt;else&gt;&gt;
	&lt;&lt;say $mc&gt;&gt;Uh, no, I don&#39;t actually. You very briefly explained you could help me in the Abyss, that&#39;s all.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_shocked.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;!!!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_bummed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;I can only blame myself for this. No, I don&#39;t know anything about the surface.&lt;&lt;/say&gt;&gt;&lt;br&gt;	
	
	&lt;&lt;say $mc&gt;&gt; Yeah, I got that by now. I really don&#39;t get you though. Jeez...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	[[End your conversation|Party overview]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_neutral_happy.png&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="52" name="AI ConvoL1" tags="" position="225,725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;say $companionAI&gt;&gt;How can I help you today?&lt;&lt;/say&gt;&gt;&lt;br&gt;

&lt;&lt;if $convoStart&gt;&gt;
[[Can you give me some more information on threats in this layer?|AI ConvoL1][$convoStart=0,$choice1=1]]&lt;br&gt;
[[Can you give me some more information on the relics in this layer?|AI ConvoL1][$convoStart=0,$choice1=2]]&lt;br&gt;
[[Can you give me some more information on the curses in this layer?|AI ConvoL1][$convoStart=0,$choice1=3]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $choice1==1&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Can you give me some more information on threats in this layer?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_smirk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Well, well, we have a bit of a scaredy cat on our hands. Already concerned about the threats on the first layer. &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_sassy_talk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Don&#39;t worry, there&#39;s not much to be scared of here. The only problem is that some bandits are said to ambush people coming back up from the second layer if you&#39;re carrying enough valuables.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_grin.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; But just like you, they&#39;re a bunch of scaredy cats. If you are in a big group you should be fine. Maybe if you become enormous they won&#39;t bother you, even in a small group. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionAI&gt;&gt; Be careful though, if you end up as some small pipsqueak you&#39;ll need more people to scare them off.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Pipsqueak? Like your size? Or would childlike sizes be enough as well?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_angry.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; I&#39;m no pipsqueak! The only reason I&#39;m height impaired is because you bought such a small phone and got me stuck here!! &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Sure, whatever you say. Thanks for the heads up though!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0]]

&lt;&lt;elseif $choice1==2&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Can you give me some more information on the Relics on this layer?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_clueless.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; To be honest the Relics in this layer seem kinda boring, I suppose the fun ones are already taken. I would honestly just sell most of these relics if you find them.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Okay, thanks for your enlightened opinion. Can you give me some information on them anyway? &lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; No need to get your panties in a twist, I actually was giving you advice. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_sassy_talk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Anyway, a few of the Relics that are still here might have some use, though. The Rømer Stones for example. They might seem useless by themselves, but their ability to absorb and release heat could be useful if you incorporate them into clothing.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionAI&gt;&gt; Or maybe you like to take the Chain of Lorelei to make it a little bit more believable you are the opposite sex by changing your voice.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_grin.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Although, if you want to achieve that effect you might as well just take a handful of Blisshrooms and see what happens.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Something tells me that that last piece of advice is more for your own entertainment. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_smirk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Maybe...&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_lecturing.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; The final relic I have info on is a bit of an odd one though, the Creepy Doll. It seems people have taken it before. There were groups that said it did absolutely nothing besides looking creepy, but also people who were traveling by themselves who said that the doll kept them safe, but there may have been side effects.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_plotting.png&quot;&gt;&gt;	
	&lt;&lt;say $companionAI&gt;&gt; If you ask me, I think those people might be delusional and reaching out to a doll to comfort them in the Abyss. I think it&#39;s probably useless, but you can check it out if you really want to.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; You know, once in a while you can be helpful!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_annoyed.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Hey! What&#39;s that supposed to mean? &lt;&lt;/say&gt;&gt;&lt;br&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0]]

&lt;&lt;elseif $choice1==3&gt;&gt;
	&lt;&lt;say $mc&gt;&gt; Can you give me some more information on the Curses in this layer?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_smirk.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; Hmm, they&#39;re pretty mild to be honest. Maybe you can try taking all of them for some easy corruption.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Can you be serious for a second, Ai?&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_plotting.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt; To be honest, I was only half joking when I said you could take all of them. You need to be careful though, because while they are mild, they will also not give much corruption.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionAI&gt;&gt;Pick up too much relics and you&#39;ll be forced to go down a layer, or wave goodbye to &lt;&lt;if $app.breastsCor &gt; 1 &gt;&gt;those nice huggable assets of yours&lt;&lt;elseif $app.penisCor&gt;1&gt;&gt;that fun tool between your legs&lt;&lt;/if&gt;&gt;, as Shrunken Assets is the only curse that give a lot of corruption on this layer.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	You gulp in apprehension.&lt;br&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Thanks for the heads up.&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $companionAI&gt;&gt;Oh, another intersting thing you might want to know is that you once you take a Dizzying Heights Curse, your fate is sealed.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; What does that mean?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionAI&gt;&gt;I mean that you can&#39;t cheat the Abyss. If you choose to shrink, and then get rid of the Curse at the Icon of Mercy that&#39;s somewhere on this layer, the Abyss will remember and you&#39;ll continue to shrink in the future.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_mortified.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;There&#39;re no second chances in the Abyss, so chose carefully!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;say $mc&gt;&gt; Okay, you&#39;re officially creeping me out, Ai&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_plotting2.png&quot;&gt;&gt;
	&lt;&lt;say $companionAI&gt;&gt;You&#39;re welcome!&lt;&lt;/say&gt;&gt;&lt;br&gt;

	&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_neutral_happy.png&quot;&gt;&gt;

	[[End your conversation|Party overview][$convoStart=1,$choice1=0]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;set $companionAI.imageIcon= &quot;Icons/Ai_neutral_happy.png&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="53" name="StoryMenu" tags="" position="350,725" size="100,100">[[Stats]]
[[Appearance]]
[[Inventory]]
&lt;br&gt;</tw-passagedata><tw-passagedata pid="54" name="Stats" tags="noreturn" position="475,725" size="100,100">You have $dubloons dubloons.
You have $corruption corruption points.
You have been exploring the Abyss for $time days.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $time &gt; 0&gt;&gt;
	[[View time spent in each layer|Time Stats]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $endSpectre &gt; 0&gt;&gt;
The Spectre of the End will come for you in &lt;&lt;print (900 - $time + $endSpectre)&gt;&gt; days.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;nobr&gt;&gt;&lt;&lt;if $debt &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have $debt dubloons of debt, which you must pay before voluntarily settling down for any habitation.&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.penalty &gt; 0&gt;&gt;
&lt;br&gt;You currently have a status condition that is slowing down your next $status.duration travel times by $status.penalty days each.&lt;br&gt;
&lt;&lt;if $hexflame &gt; 9&gt;&gt;
You currently have &lt;&lt;print ($hexflame - 9)&gt;&gt; jinxed flame counters,  increasing travel times by &lt;&lt;print Math.trunc($hexflame / 10)&gt;&gt; and increasing corruption gain by &lt;&lt;print (5 * Math.trunc($hexflame / 10))&gt;&gt; on every layer other than layer 6.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;/nobr&gt;&gt;
Your personal carrying capacity is &lt;&lt;print Math.round($carryWeight)&gt;&gt; kg.
Your team has a total carrying capacity of &lt;&lt;print Math.round($totalCarry)&gt;&gt; kg.
Your team is currently carrying &lt;&lt;print setup.calcCarriedWeight().toFixed(1)&gt;&gt; kg.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $swapComp &gt; -1&gt;&gt;
	&lt;&lt;print &quot;You are in the body originally belonging to $hiredCompanions[$swapComp].name and $hiredCompanions[$swapComp].name is in your old body.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

Your companions are:&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
		&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print &quot;[[$hiredCompanions[$i].name|Companion Info][$temp = $i]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Your curses are:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $playerCurses.length; $i++&gt;&gt;
		&lt;&lt;print $playerCurses[$i].name&gt;&gt;&lt;br&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;if $waterL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the first layer $waterL1 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the first layer $foodL1 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


&lt;&lt;back [[$menuReturn]]&gt;&gt;</tw-passagedata><tw-passagedata pid="55" name="Inventory" tags="noreturn" position="600,725" size="100,100">You have $items[0].count days of single-use water rations.
You have $items[1].count days of food.
You have $items[2].count unfilled flasks.
You have $items[3].count days of water in filled flasks.

Your inventory and the count (if applicable) of each item is as follows:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $items.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if $items[$i].count &gt; 1 || $items[$i].count &lt; 0&gt;&gt;
			&lt;&lt;print &quot;[[$items[$i].name|Item Info][$temp = $i]]&quot;&gt;&gt;		&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print $items[$i].count&gt;&gt;&lt;br&gt;
	&lt;&lt;elseif $items[$i].count == 1&gt;&gt;
		&lt;&lt;print &quot;[[$items[$i].name|Item Info][$temp = $i]] &quot;&gt;&gt;
		&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print &quot;[[$ownedRelics[$i].name|Relic Info][$temp = $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;set $total_value_relics=0&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
&lt;&lt;set $total_value_relics = $ownedRelics[$i].value + $total_value_relics&gt;&gt;
&lt;&lt;/for&gt;&gt;
The total value of all your relics is $total_value_relics dubloons.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $relicSwap.length &gt; 0&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $relicSwap.length; $i++&gt;&gt;
		&lt;&lt;capture $i&gt;&gt;
		You have swapped the abilities of the $relicSwap[$i][0].name and the $relicSwap[$i][1].name.&lt;br&gt;
		&lt;&lt;/capture&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;back [[$menuReturn]]&gt;&gt;</tw-passagedata><tw-passagedata pid="56" name="Habitation Ending" tags="ending" position="725,725" size="100,100">You&#39;ve reached the end of your journey due to a successful habitation ending. Was it worth it? Did you find what you were looking for?

You can find your collection of relics in your inventory, and your curses in the stats page.

Feel free to begin a new journey, by restarting and choosing the new game+ option. Also feel free to post your build on the thread for the game, the creator of this adaptation always loves to see how people&#39;s adventures went!</tw-passagedata><tw-passagedata pid="57" name="Adjustments" tags="noreturn" position="850,725" size="100,100">Use this page ONLY to adjust numbers due to interactions that save you money or resources that are not already accounted for in the game, or if there was a bug.

Do not cheat or fear the consequences of angering the things that lurk deep in the Abyss.


[[Adjust dubloons]]
[[Adjust corruption]]
[[Adjust time]]
[[Adjust water]]
[[Adjust food]]
[[Adjust bullets]]

Many options have their abilities as something like a light source or heat source automatically accounted for, but if you find a relic or combination that you think should give you an ability and it doesn&#39;t, use one of the following options to give that ability to yourself.

Click this if you have found something that can be used for cutting like a sword:
[[I have a Cutting Instrument|Adjustments][$cut = 1]]
[[No Cutting Instrument|Adjustments][$cut = 0]]

Click this if you have found something that can be used as a light source:
[[I have a Light|Adjustments][$light = 1]]
[[No Light|Adjustments][$light = 0]]

Click this if you have found something that can be used as a substantial heat source:
[[I have a source of Heat|Adjustments][$heat = 1]]
[[No Heat|Adjustments][$heat = 0]]

Click this if you have found something that can be used as a climbing rope:
[[I have something that can be a Rope|Adjustments][$rope = 1]]
[[No Rope|Adjustments][$rope = 0]]

Click this if you have found something that can be used for swimming underwater, similar to scuba gear:
[[I have something that can be used for Swimming|Adjustments][$scuba = 1]]
[[No Swimming|Adjustments][$scuba = 0]]

&lt;&lt;if $abyssKnow == 1&gt;&gt;Click this if you&#39;d like to disable the use of your abyssal knowledge from the encyclopedia or Saeko (This will result in more side effects from foraging):
	[[Turn off abyssal knowledge|Adjustments][$abyssKnow = 0]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $abyssKnow == 0 &amp;&amp; ($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) || $items[5].count &gt; 0)&gt;&gt;Click this if you&#39;d like to enable the use of your abyssal knowledge from the encyclopedia or Saeko (This will result in less side effects from foraging):
	[[Turn on abyssal knowledge|Adjustments][$abyssKnow = 1]]
&lt;&lt;/if&gt;&gt;

If you would like to use a Relic or combination of Relics to trade with the surface, similar to a commerce balloons function, then use the following:
[[Simulate the functionality of a commerce balloon|Commerce Balloon]]


[[Confirm Adjustments|$menuReturn]]</tw-passagedata><tw-passagedata pid="58" name="Time Stats" tags="noreturn" position="975,725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $timeL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL1 days on the first layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL2 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL2 days on the second layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL3 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL3 days on the third layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL4 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL4 days on the fourth layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL5 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL5 days on the fifth layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL6 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL6 days on the sixth layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL7 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL7 days on the seventh layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL8 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL8 days on the eighth layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $timeL9 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have spent $timeL9 days on the ninth layer of the Abyss.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;if $waterL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the first layer $waterL1 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the first layer $foodL1 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $waterL2 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the second layer $waterL2 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL2 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the second layer $foodL2 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $waterL3 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the third layer $waterL3 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL3 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the third layer $foodL3 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $waterL4 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the fourth layer $waterL4 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL4 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the fourth layer $foodL4 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $waterL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for water on the fifth layer $waterL5 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $foodL1 &gt; 0&gt;&gt;
	&lt;&lt;print &quot;You have foraged for food on the fifth layer $foodL5 times.&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="59" name="Version End" tags="" position="1100,725" size="100,100">That&#39;s all for this version!

Thank you for playing version 0.4 of the interactive adaptation of Abyss Diver by FloricSpacer.

I&#39;d like to hear any feedback about the current state of the game and any bugs or typos you&#39;ve found!

I&#39;m working on adding the remaining layers quickly, though it is pretty labor intensive, so that depends on my free time irl. I think a lot of the systems from the first few layers should carry over to later ones well, but there are also a lot of new mechanics that need to be implemented. Hopefully it doesn&#39;t take long and I can post the rest of the layers soon!

As I add more systems and the game gets more complicated under the hood, I expect many bugs that I didn&#39;t catch to manifest, so detailed bug reports for any errors you&#39;ve encountered are very valuable.

If you&#39;re interested in seeing the most recent changes to the code or contributing yourself, you should visit our public Github! 

https://github.com/FloricSpacer/AbyssDiver

You can also join the new Discord server, where we have regular discussion regarding the game and development.

https://discord.gg/gXnq5rmjxG

Thanks again for playing!</tw-passagedata><tw-passagedata pid="60" name="Appearance" tags="noreturn" position="1225,725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;HeightCorrected&gt;&gt;
&lt;&lt;appGender&gt;&gt;
&lt;&lt;LibidoCorrected&gt;&gt;
&lt;&lt;AppearanceCorrect&gt;&gt;
/*&lt;&lt;for $i = 0; $i &lt; $GenderLog.length; $i++&gt;&gt;
		&lt;&lt;print $GenderLog[$i].name&gt;&gt;
&lt;&lt;/for&gt;&gt;*/
&lt;&lt;/nobr&gt;&gt;Your name is $app.name and you are a $app.sex.

Your hair color is $app.hair, while your eyes are colored $app.eyeColor.
You have $app.skinColor colored $app.skinType skin.
You are &lt;&lt;print Math.round($app.heightCor)&gt;&gt; cm tall.
You have $app.ears ears.
You are $app.age years old&lt;&lt;if $app.age != $app.appAge&gt;&gt;, but you appear to be &lt;&lt;print Math.round($app.appAge)&gt;&gt; years old&lt;&lt;/if&gt;&gt;.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $dollevent2== true&gt;&gt;
	&lt;br&gt;&lt;br&gt;You seem to be stuck wearing a tattered pink dress that looks earily similar to the one your doll is wearing. Annoyingly, this prevents you from wearing other clothes, even in harsh environments.
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _hornyCount = setup.activeCurseCount(&quot;Horny&quot;)&gt;&gt;
&lt;&lt;if _hornyCount == 1&gt;&gt;
	&lt;br&gt;You have a noticeable demonic horn protruding from the center of your forehead.
&lt;&lt;elseif _hornyCount == 2&gt;&gt;
	&lt;br&gt;You have 2 noticeable demonic horns protruding from your head.
&lt;&lt;/if&gt;&gt;

&lt;br&gt;&lt;br&gt;$app.desc
&lt;&lt;for $i = 0; $i &lt; $playerCurses.length; $i++&gt;&gt;
	&lt;&lt;print $playerCurses[$i].appDesc&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) &amp;&amp; $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination B&quot;)&gt;&gt;
	&lt;&lt;print &quot;You are heavily lactating at all times, and need frequent milking breaks. Ignoring this causes your breasts to get sore and expand rather quickly. &quot;&gt;&gt;
&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination B&quot;)&gt;&gt;
	&lt;&lt;print &quot;You are lactating at all times, but thankfully it&#39;s just enough to be a bit annoying. &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _semenCount = setup.activeCurseCount(&quot;Semen Demon&quot;)&gt;&gt;
&lt;&lt;if _semenCount &gt; 0&gt;&gt;
	You must drink &lt;&lt;print (_semenCount * 10)&gt;&gt; ml of sexual fluids every day, or else you feel as though you were starving. This averages &lt;&lt;print (_semenCount * 2)&gt;&gt; loads per day.&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _quotaCount = setup.activeCurseCount(&quot;Quota&quot;)&gt;&gt;
&lt;&lt;if _quotaCount &gt; 0&gt;&gt;
	You need to directly bring other people to orgasm &lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sleep Tight&quot;)&gt;&gt;&lt;&lt;print (_quotaCount * 3)&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;print (_quotaCount * 2)&gt;&gt;&lt;&lt;/if&gt;&gt; times per day, or else you feel a huge wave of exhaustion and difficulty focusing, as if you hadn&#39;t slept for several days. &lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Blushing Virgin&quot;)&gt;&gt;And yet every time feels like your first time ever, making it a bit awkward to save time with group sessions!&lt;&lt;/if&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _limelightCount = setup.activeCurseCount(&quot;In the Limelight&quot;)&gt;&gt;
&lt;&lt;if _limelightCount &gt; 0&gt;&gt;
	You need to be the focus of &lt;&lt;print (_limelightCount * 50)&gt;&gt; orgasms per day, even if you are not causing them directly, or else you cease to feel joy entirely, falling into a deep depression. On top of that, your misadventures in the abyss are now streamed to quite a lot of people. This means &lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Semen Demon&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Quota&quot;)&gt;&gt;not only you have to have sex with so many people, but also &lt;&lt;/if&gt;&gt;you have to keep a steady supply of dirty photos and videos featuring you circling around for others to masturbate to. &lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Blushing Virgin&quot;)&gt;&gt;This line of work really does not go well with someone as shy as you! &lt;&lt;/if&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;if $bewitchBabies &gt; 0&gt;&gt;
	Due to your consumption of the contaminated rainwater of the second layer, your fertility has greatly increased. The average amount of  babies born from any pregnancy you&#39;re involved in is increased by &lt;&lt;print $bewitchBabies&gt;&gt;.&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $algalSize &gt; 0&gt;&gt;
	Your &lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;testicles are&lt;&lt;elseif $app.sex == &quot;female&quot;&gt;&gt;clitoris is&lt;&lt;else&gt;&gt;testicles and clitoris are&lt;&lt;/if&gt;&gt; approximately &lt;&lt;print (10 * $algalSize)&gt;&gt;% lager than usual due to drinking contaminated melted snow from the fourth layer.&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $crumbleFluid &gt; 0&gt;&gt;
	Due to the consumption of crumbleweed from the fifth layer, your production of sexual fluids has increased by &lt;&lt;print $crumbleFluid&gt;&gt;%. &lt;&lt;if $crumbleFluid &gt; 50&gt;&gt;Try not to get too dehydrated if you&#39;re especially sexually active.&lt;&lt;/if&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.gender &lt;= 1&gt;&gt;
You look like a typical man, with a masculine facial structure and a body profile that would obviously seem male from a distance.
&lt;&lt;elseif $app.gender == 2&gt;&gt;
You look like man, but your features are a bit softer than average. No one would mistake you for a woman, but maybe the label of &quot;twink&quot; could apply to you.
&lt;&lt;elseif $app.gender == 3&gt;&gt;
You look pretty androgynous. If someone were just looking at you with clothes on, most people would guess you look like a very effeminate man, but others might see you as a butch woman.
&lt;&lt;elseif $app.gender == 4&gt;&gt;
You look pretty androgynous. If someone were just looking at you with clothes on, most people would guess you look like a very butch woman, but others might see you as an effeminate man.
&lt;&lt;elseif $app.gender == 5&gt;&gt;
You look like a woman, but a bit on the masculine side. Many people would likely assume you&#39;re a tomboy based on your appearance.
&lt;&lt;elseif $app.gender &gt;= 6&gt;&gt;
You look like a typical woman, with a feminine face and a figure that looks clearly female from a distance.
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $app.fit&gt;8&gt;&gt;
Working out with the World Stone has given you a fit body with especially well-toned arm muscles.
&lt;&lt;elseif $app.fit&gt;6&gt;&gt;
You have a well-toned athletic body.
&lt;&lt;elseif $app.fit&gt;4&gt;&gt;
You have a unremarkable but healthy body.
&lt;&lt;else&gt;&gt;
Your body looks rather out of shape, you could definitely benefit from some exercise.
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;if $app.libido &lt;= 1&gt;&gt;
You have a very low libido, without much interest at all in sex.
&lt;&lt;elseif $app.libido == 2&gt;&gt;
You have your normal libido, being somewhat interested in sex, but you can certainly control yourself.
&lt;&lt;elseif $app.libido == 3&gt;&gt;
You have a slightly elevated libido. You will feel hot and bothered more reularly than you are accustomed to. Uncomfortable, but manageable.
&lt;&lt;elseif $app.libido == 4&gt;&gt;
You have an elevated libido. Your sexual urges are frequent and very difficult to resist. Can be only barely hidden; leading a normal lifestyle will be possible, but frequently frustrating.
&lt;&lt;elseif $app.libido == 5&gt;&gt;
Your libido would be considered a symptom of a mental disorder. You&#39;re hopelessly addicted to sex, and it is impossible to keep your desired hidden.
&lt;&lt;elseif $app.libido == 6&gt;&gt;
You desire sex about as much as basic necessities as food and water, perhaps slightly more. You go to great lengths for sex, and it dominates your life.
&lt;&lt;elseif $app.libido &gt;= 7&gt;&gt;
You need sex constantly - having sex will only sate your hunger for a matter of minutes, and you will find little meaning in things that don&#39;t lead to you having more sex.
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;if $app.penisCor&gt;=1&gt;&gt;
	&lt;&lt;if $app.penisCor == 1&gt;&gt;
	You have a tiny penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm, which is honestly barely larger than a clitoris.
	&lt;&lt;elseif $app.penisCor &lt;= 2.5&gt;&gt;
	You have a very small penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm. You need some very tight pants to show something that even remotely resembles a bulge in your crotch.
	&lt;&lt;elseif $app.penisCor &lt;= 3.5&gt;&gt;
	You have a small penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm. You are a bit self conscious about it, but it works perfectly well.
	&lt;&lt;elseif $app.penisCor &lt;= 4.5&gt;&gt;
	You have a below average penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm. Yeah, you know it&#39;s not that big, but you try not to get too hung up on it.
	&lt;&lt;elseif $app.penisCor &lt;= 5.5&gt;&gt;
	You have a pretty average penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm. Nothing to be ashamed of, but nothing to write home about either.
	&lt;&lt;elseif $app.penisCor &lt;= 6.5&gt;&gt;
	You have a totally average penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm, very typical for a man in your demographics.
	&lt;&lt;elseif $app.penisCor &lt;= 7.5&gt;&gt;
	You have a slightly above average penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm, not anything out of the ordinary, but some people may particularly enjoy it.
	&lt;&lt;elseif $app.penisCor &lt;= 8.5&gt;&gt;
	You have a large penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm, people who like larger sizes are likely to be impressed.
	&lt;&lt;elseif $app.penisCor &lt;= 9.5&gt;&gt;
	You have a very large penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm, size queens dream of meeting someone like you, but tighter orifices can be a bit of an issue occasionally.
	&lt;&lt;elseif $app.penisCor &gt; 9.5 &amp;&amp; $app.penisCor &lt; 100&gt;&gt;
	You have an enormous penis of &lt;&lt;print Math.round($app.penisCor)*2.5&gt;&gt; cm. Are you even going to able to have sex with this monster schlong?
	&lt;&lt;elseif $app.penisCor &gt;= 100&gt;&gt;
	You have a truly gargantuan penis that hangs at a size of &lt;&lt;print (Math.round($app.penisCor)*0.025).toFixed(1)&gt;&gt; meters long. Sex with normal sized people would need to be very different than it used to be.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;
&lt;&lt;if $app.vagina == 1&gt;&gt;
	&lt;&lt;if $playerCurses.some(e=&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt;
		You have a cavernous pussy sitting between your legs, most of your lovers would be able to fit their entire body inside you without even filling you up.
	&lt;&lt;elseif $playerCurses.some(e=&gt; e.name === &quot;Minish-ish&quot;)&gt;&gt;
		You have a miniscule pussy to match your size, making it very difficult to have sex with normal-sized people.
	&lt;&lt;else&gt;&gt;
		You have a nice pussy sitting between your legs, pretty typical for a woman in your demographics.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $app.womb &gt; 0&gt;&gt;
&lt;br&gt;You have an extra womb in your $app.womb1.
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $app.womb &gt; 1&gt;&gt;
&lt;br&gt;You have another extra womb in your $app.womb2.
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;

&lt;&lt;BreastCorrected&gt;&gt;
&lt;&lt;if $app.breastsCor &lt; 1&gt;&gt;
You have a flat, &lt;&lt;GenderPronoun&gt;&gt; chest.
&lt;&lt;elseif $app.breastsCor &lt; 2&gt;&gt;
You have AA cup mosquito bites, much smaller than most women.
&lt;&lt;elseif $app.breastsCor &lt; 3&gt;&gt;
You have cute A cup breasts, small but not out of the ordinary.
&lt;&lt;elseif $app.breastsCor &lt; 4&gt;&gt;
You have supple B cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 5&gt;&gt;
You have perfectly round C cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 6&gt;&gt;
You have nice handfuls of D cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 7&gt;&gt;
You have larger than most E cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 8&gt;&gt;
Your sizes are starting to get cumbersome with your F cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 9&gt;&gt;
You&#39;ve got to watch out for back pain with your G cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 10&gt;&gt;
You&#39;ve got to watch out for back pain with your H cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 11&gt;&gt;
You&#39;ve got to watch out for serious back pain with your I cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 12&gt;&gt;
You&#39;ve got to watch out for serious back pain with your J cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 13&gt;&gt;
You&#39;ve got to watch out for serious back pain with your K cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 14&gt;&gt;
You&#39;ve got to watch out for serious back pain with your L cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 15&gt;&gt;
You&#39;ve got to watch out for serious back pain with your M cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 16&gt;&gt;
You&#39;ve got to watch out for very serious back pain with your N cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 17&gt;&gt;
You&#39;ve got to watch out for very serious back pain with your O cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 18&gt;&gt;
You&#39;ve got to watch out for very serious back pain with your P cup breasts.
&lt;&lt;elseif $app.breastsCor &lt; 19&gt;&gt;
You&#39;ve got to watch out for very serious back pain with your Q cup breasts.
&lt;&lt;elseif $app.breastsCor &gt;= 19&gt;&gt;
You&#39;ve got to watch out for very serious back pain with your R cup breasts.
&lt;&lt;elseif $app.breastsCor &gt; 19&gt;&gt;
You&#39;ve got to watch out for extremely serious back pain with your S cup breasts.
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.tail.length &gt; 0&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $app.tail.length; $i++&gt;&gt;
		You have a $app.tail[$i] tail right above your butt.&lt;br&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
Overall the world would probably see you now as a &lt;&lt;PerceivedStature&gt;&gt; &lt;&lt;Inhuman&gt;&gt; &lt;&lt;PerceivedRace&gt;&gt; &lt;&lt;PerceivedGender&gt;&gt;.&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;back [[$menuReturn]]&gt;&gt;</tw-passagedata><tw-passagedata pid="61" name="Adjust dubloons" tags="noreturn" position="100,850" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many dubloons would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$dubloons += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="62" name="Adjust corruption" tags="noreturn" position="225,850" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many corruption points would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$corruption += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="63" name="Adjust time" tags="noreturn" position="350,850" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many days would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$time += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="64" name="Adjust water" tags="noreturn" position="475,850" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many water rations would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$items[0].count += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="65" name="Adjust food" tags="noreturn" position="600,850" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many food rations would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$items[1].count += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="66" name="Commerce Balloon" tags="balloon" position="725,850" size="100,100">Using your balloon, you&#39;re able to send up any relics you want to sell and get back any items you want to buy (or just dubloons if you&#39;d prefer).

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $tunnelUsed == 1&gt;&gt;
&lt;br&gt;[[Ask people on the surface to look for the items you sent to the surface from the One-sided Tunnel|Balloon Tunnel Retrieval]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
[[Send a request to the Outset Town Administration|Balloon Admin]]&lt;br&gt;
&lt;&lt;if $items[19].count &gt; 0&gt;&gt;
[[Send a request to the Relic Workshop|Balloon Workshop]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[18].count &gt; 0&gt;&gt;
[[Send a request to the inn on the surface|Balloon Inn]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;[[Sell relics|Balloon Sell1]]
[[Buy items|Balloon Store1]]


[[Finish using balloon to trade|$layerReturn]]</tw-passagedata><tw-passagedata pid="67" name="Balloon Sell1" tags="balloon" position="850,850" size="100,100">Here you can permanently sell any of your collected relics for a nice haul of dubloons. You can use this to fund further expeditions, pay off your debt, or just get a nice payday at the end of your expedition.

Choose the relic you would like to sell:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Creepy Doll&quot; &amp;&amp; $creepydoll.affec &gt; 5&gt;&gt;
			You can&#39;t seem to part ways with the Creepy Doll&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Chain of Lorelei&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$colwear=0,$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Heart-stealing Stole&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$hsswear=0,$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Sibyl Blend&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$SibylBuff=0,$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;World Stone&quot; &amp;&amp; $LilyPromise&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $companionLily.affec-=(5-$hsswear)]]&quot;&gt;&gt; &lt;br&gt;You promised Lily she could use the World Stone, selling it now will surely dissapoint her greatly. &lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Everheavea&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $items[2].count-=2]]&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Balloon Sell1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Continue using the commerce balloon|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="68" name="Balloon Store1" tags="balloon cards nobr" position="975,850" size="100,100">&lt;p&gt;&lt;&lt;CarryAdjust&gt;&gt;&lt;/p&gt;
&lt;p&gt;[[Continue using the commerce balloon|Commerce Balloon]]&lt;/p&gt;

&lt;&lt;include &quot;ShopInventory&quot;&gt;&gt;

&lt;p&gt;[[Continue using the commerce balloon|Commerce Balloon]]&lt;/p&gt;</tw-passagedata><tw-passagedata pid="69" name="Balloon Sell 2" tags="balloon" position="1100,850" size="100,100">&lt;&lt;set $dubloons += ($ownedRelics[$temp].value + $sellAdd)&gt;&gt;
The relic $ownedRelics[$temp].name has been successfully sold and you&#39;ve gotten your dubloon payment. You notice the person you sold it to quickly runs off, either to make use of it or sell it again in the everlasting chain of capitalism. Either way, you won&#39;t be getting that relic back easily.&lt;&lt;run $ownedRelics.deleteAt($temp)&gt;&gt;

[[Sell more relics|Balloon Sell1]]
[[Continue your balloon business|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="70" name="Item Info" tags="noreturn" position="1225,850" size="100,100">&lt;&lt;print $items[$temp].name&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[$temp].count &gt; 1&gt;&gt;
&lt;br&gt;Count: $items[$temp].count
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+$items[$temp].image]]

&lt;&lt;print $items[$temp].desc&gt;&gt;

Weight: $items[$temp].weight kg
Cost: $items[$temp].cost dubloons

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="71" name="Credits" tags="" position="100,975" size="100,100">Thank you so much to anyone who has helped me out with this project! I appreciate all the feedback and every suggestion I get, especially feature requests and bug reports! I try to respond promptly to these, so please let me know if you have an idea or find a bug!

Thanks to Ilse91 for helping with a huge variety of code and adding some new features regarding height, carry weight, companions, conversations, and endings. Additionally, she&#39;s been instrumental in helping update many systems to make them function better, such as Curses. She also helped in getting my motivation for working on the game back and her help is incredibly appreciated.

Thanks to Emmeken for helping with the move to Tweego and Github, numerous formatting fixes and improvements, transcribing the item descriptions for me, and huge amounts of help generally with code improvements.

Thanks to CaptainCaption for generously allowing the use of AI&#39;s images from his game re:Dreamer, you can try out and support his excellent transformation VN game at https://www.patreon.com/dreamteamstudio 

Thanks to Nerevar for writing drafts of the Curse descriptions that appear when transitioning layers or occasionally in a layer hub.
Thanks to dogflail for writing drafts for some of the Curse appearance screen decriptions.
Thanks to abiciendimittent for transcribing the relic and curse descriptions (will be added to the game when they are completed)
Thanks to Stadler for finding many bugs and reporting them to me.
Thanks to HiEv for having a great tutorial with sample code that I used in this project.
Thanks to laevus for bug reports.
Thanks to Kras for suggestions and bug reports.
And thanks to Lily for encouraging me when I got some negative feedback early in the initial draft form of this game.

I seriously appreciate all of your help and I&#39;m really happy that people were willing to help improve this project with me.</tw-passagedata><tw-passagedata pid="72" name="Surface Tunnel Retrieval" tags="surface" position="225,975" size="100,100">&lt;&lt;include &quot;Tunnel Retrieval&quot;&gt;&gt;\
You manage to find your items safely, retrieving all of them and putting them right back into your inventory where they belong. Luckily no one seems to have disturbed or taken anything in the time it took you to get back up here and find your items.

[[Continue your business in Outset Town|Surface Hub]]</tw-passagedata><tw-passagedata pid="73" name="Balloon Tunnel Retrieval" tags="balloon" position="350,975" size="100,100">&lt;&lt;include &quot;Tunnel Retrieval&quot;&gt;&gt;\
Helpful people on the surface managed to find your items safely, retrieving all of them and sending them back to you via the commerce balloon. Luckily nothing went missing.

[[Continue using the commerce balloon|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="74" name="Tunnel Retrieval" tags="nobr" position="475,975" size="100,100">&lt;&lt;for _i = 4; _i &lt; $items.length; _i++&gt;&gt;
	&lt;&lt;set $items[_i].count += $vaultItems[_i].count&gt;&gt;
	&lt;&lt;set $vaultItems[_i].count = 0&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $dubloons += $tunnelDubloons&gt;&gt;
&lt;&lt;set $tunnelUsed = 0&gt;&gt;</tw-passagedata><tw-passagedata pid="75" name="GameOver" tags="" position="600,975" size="100,100">@@.layerTitle;YOU ARE DEAD@@

&lt;&lt;if $items[1].count &lt; -5&gt;&gt;
Your food ration count has gone below -5, indicating that you have avoided eating for a few days, but eventually starved to death. If you didn&#39;t realize what had happened, you can avoid this fate by pressing the back arrow in the top left until you reach the main part of a layer. Once you are there, you can take the habitation option for your layer to avoid death.
&lt;&lt;else&gt;&gt;
Your days of water remaining count has gone below -2, indicating that you managed to survive without water for a few days, but eventually died of dehydration. If you didn&#39;t realize what had happened, you can avoid this fate by pressing the back arrow in the top left until you reach the main part of a layer. Once you are there, you can take the habitation option for your layer to avoid death.
&lt;&lt;/if&gt;&gt;&lt;&lt;if $corruption &lt; 0&gt;&gt;

Due to your negative corruption, you are unable to accept a habitation option at this time. However, you can go back to the main part of the layer, then take curses until you have reached a corruption above 0 to survive. This is highly reccomended if you wish to avoid death.
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="76" name="BrokerEnd" tags="" position="725,975" size="100,100">YOU MAY NOT ALLOW YOUR CORRUPTION TO GO BELOW 0 DUE TO YOUR BROKER&#39;S DEAL.

You have chosen to accept the deal of the Empty-handed Broker and attempted to take an action that would reduce your corruption points below 0. Because this is not possible, you must go back to avoid performing this action.

If you would still like to perform this action, you may go back to the main part of the layer you were on and accept curses to raise your corruption point total.

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="77" name="AgeLimit" tags="" position="850,975" size="100,100">YOU MUST BE AT LEAST 18 TO PLAY THIS GAME

If you are over 18, please go back and enter an age above 18 to continue.

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="78" name="Use Items and Relics" tags="" position="975,975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[7].count &gt; 0&gt;&gt;
	&lt;&lt;if $currentLayer==0&gt;&gt;
		There is no need to use a commerce balloon while you are on the surface.
	&lt;&lt;else&gt;&gt;
		[[Use a commerce balloon to trade with the surface|Commerce Balloon][$items[7].count -=1]]
	&lt;&lt;/if&gt;&gt;
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[8].count &gt; 0&gt;&gt;
	&lt;&lt;if $currentLayer==0&gt;&gt;
		There is no need to deploy your escape balloon while you are on the surface.
	&lt;&lt;elseif $currentLayer==1&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L1][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==2&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L2][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==3&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L3][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==4&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L4][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==5&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L5][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==6&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L6][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;elseif $currentLayer==7&gt;&gt;
		[[Use an escape balloon to escape towards the surface|Escape Balloon L7][$items[8].count -=1, $escBalDepl=1]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($items[4].count &gt; 0) &amp;&amp; ($status.penalty &gt; 0) &amp;&amp; $dragonBurn == 0&gt;&gt;
&lt;br&gt;You currently have a status condition that is slowing down your next $status.duration travel times by $status.penalty days each.&lt;br&gt;
[[Use a medkit to cure your status condition instantly|Use Items and Relics][$status.penalty = 0, $status.duration = 0, $items[4].count -=1]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($items[4].count &gt; 1) &amp;&amp; ($status.penalty &gt; 0) &amp;&amp; $dragonBurn == 1&gt;&gt;
&lt;br&gt;You currently have a severe dragon burn which is slowing you down permanently until you heal it, however it will take 2 medkits to heal it properly.&lt;br&gt;
[[Use a medkit to cure your status condition instantly|Use Items and Relics][$status.penalty = 0, $status.duration = 0, $items[4].count -= 2, $dragonBurn = 0]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;if $items[21].count &gt; 0&gt;&gt;
[[Discard all your used torches|Use Items and Relics][$items[21].count =0]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Heart-stealing Stole&quot;)&gt;&gt;
		&lt;&lt;if $hsswear&gt;&gt;
		&lt;br&gt;You can take off the stole you are using to improve relations with your companions. This will remove the benefit in affection events you are gaining from the Relic.&lt;br&gt;
		[[Take off the Heart-stealing Stole|Use Items and Relics][$hsswear=0]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
	&lt;br&gt;You can put on the majestic stole you have, it is sure to help sway the hearts of your companions to become more friendly and respect you as a leader. This increases the affection gain from any event that alters affection.&lt;br&gt;
			[[Wear the Heart-stealing Stole|Use Items and Relics][$hsswear=1]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;World Stone&quot;)&gt;&gt;
		&lt;&lt;if $app.fit&gt;=10&gt;&gt;
			&lt;br&gt;You don&#39;t think you would get anymore fit than you are from working out with the World Stone. Your fitness has reached near peak human levels, and while you might be able to improve a bit more with a dedicated workout period, it&#39;s not likely you&#39;ll be able to achieve that in the Abyss.&lt;br&gt;
		&lt;&lt;elseif $LastEx &lt; ($time-1)&gt;&gt;
			&lt;br&gt; You can make use of the World Stone to make use of a perfect fitness routine, tuned precisely to the needs of your body. If you want to get stronger and more fit, using this relic is the best way to do it.&lt;br&gt;
			[[Work out with the World Stone|Use Items and Relics][$app.fit+=1, $LastEx = $time]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
			&lt;br&gt;Your arms are still sore from your last workout with the World Stone, so even with the help of the Relic you won&#39;t get much benefit from working out more.&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Chain of Lorelei&quot;)&gt;&gt;
		&lt;&lt;if $colwear&gt;&gt;
			&lt;br&gt;Currently your voice is different than the one you were used to. Right now you have a feminine voice that sounds like its coming from someone with a natural talent for singing, as if you could be the central figure in an angelic chorus or make a career in music with only minimal training.&lt;br&gt;
			[[Take the Chain of Lorelei off|Use Items and Relics][$colwear=0]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
		    &lt;br&gt;You have a fairly normal &lt;&lt;GenderPronoun&gt;&gt; voice, but perhaps you sound different if you took advantage of one of your Relics?&lt;br&gt;
			[[Wear the Chain of Lorelei|Use Items and Relics][$colwear=1]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;From Seafoam&quot;)&gt;&gt;
		&lt;&lt;if !$scent&gt;&gt;
			&lt;br&gt;Currently you have a rather neutral scent&lt;br&gt;
			[[Scrub yourself with the sponge while imagining a sweet floral scent|Use Items and Relics][$scent=1]]&lt;br&gt;
			[[Scrub yourself with the sponge while imagining a spicy musky scent|Use Items and Relics][$scent=-1]]&lt;br&gt;
		&lt;&lt;elseif $scent==1 &gt;&gt;
			&lt;br&gt;Currently you have a sweet and floral scent lingering around you&lt;br&gt;
			[[Scrub yourself with the sponge while imagining a sweet floral scent|Use Items and Relics][$scent=0]]&lt;br&gt;
			[[Scrub yourself with the sponge while imagining a spicy musky scent|Use Items and Relics][$scent=-1]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
			&lt;br&gt;Currently you have a strong musky scent lingering around you&lt;br&gt;
			[[Scrub yourself with the sponge while imagining the sponge to be odourless|Use Items and Relics][$scent=0]]&lt;br&gt;
			[[Scrub yourself with the sponge while imagining a sweet floral scent|Use Items and Relics][$scent=1]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sibyl Blend&quot;)&gt;&gt;
		&lt;br&gt;You have posession of the Sibyl Blend, brewing it and looking in the leaves can point you in the direction of a Relic, saving you 1 day on your next Relic travel time.&lt;br&gt;
		&lt;&lt;if $SibylBuff == 0&gt;&gt;
			[[Use the Sibyl Blend to help find the next Relic more quickly|Use Items and Relics][$SibylBuff = 1]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
			&lt;br&gt;The Sibyl Blend tea leaves have pointed you in a clear direction for the next Relic. You are confident that finding it will take you 1 less day than it normally would.&lt;br&gt;
			[[Stop using the Sibyl Blend to help find future Relics|Use Items and Relics][$SibylBuff = 0]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Kin Shifter&quot;)&gt;&gt;
		&lt;br&gt;A glob of putty-like slime lays ready for you to copy other relics, if you desire to.&lt;br&gt;
			[[Use the Kin Shifter to copy relics|Kin Shifter Use][$tempValue = 0]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Forbidden Grimoire&quot;) &amp;&amp; $hiredCompanions.length &gt; 0&gt;&gt;
		&lt;br&gt;A ragged book written in a strange, ancient language sits in your bag. It holds forgotten knowledge that can improve anyone&#39;s skills, doubling any numeric benefit they provide.&lt;br&gt;
			[[Use the Forbidden Grimoire to improve someone&#39;s abilities|Forbidden Grimoire Select]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		You look at the glistening set of marbles known as the Managed Misfortune.
		&lt;&lt;if $StoredCurse != &quot;&quot; &amp;&amp; !$ManagedMisfortuneActive&gt;&gt;
		You have stored the curse named $StoredCurse.name in them. &lt;br&gt;
			&lt;&lt;if $StoredCurse.name==&quot;Perma-dye&quot; &amp;&amp; $curse7.variation==&quot;&quot;&gt;&gt;
				&lt;br&gt;As you look into the marbles you see your own reflection in the marble, as well as the miasma of the curse swirling within&lt;br&gt;
				The longer you look the more color if your hair seems to change in your reflection. After a while you can see that your hair seems as if it had always been its new color. Now, what color do you see?&lt;br&gt;
				Please enter your new hair color:&lt;br&gt;&lt;br&gt;
				
				&lt;&lt;textbox &quot;$curse7.variation&quot; &quot;turquoise&quot; &quot;Use Items and Relics&quot;&gt;&gt;
			&lt;&lt;elseif $StoredCurse.name== &quot;Fluffy Ears&quot; &amp;&amp; $curse17.variation==&quot;&quot;&gt;&gt;

				What type of ears would you like to gain?&lt;br&gt;&lt;br&gt;

				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry cat&quot; checked&gt;&gt; Cat&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;fluffy dog&quot; &gt;&gt; Dog&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;floppy cow&quot; &gt;&gt; Cow&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry monkey&quot; &gt;&gt; Monkey&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry rabbit&quot; &gt;&gt; Rabbit&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry fox&quot; &gt;&gt; Fox&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry mouse&quot; &gt;&gt; Mouse&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;pig&quot; &gt;&gt; Pig&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry horse&quot; &gt;&gt; Horse&lt;br&gt;
			&lt;&lt;elseif $StoredCurse.name== &quot;Fluffy Tail&quot; &amp;&amp; $curse18.variation==&quot;&quot;&gt;&gt;

				What type of tail would you like to gain?&lt;br&gt;&lt;br&gt;

				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;flowing cat&quot; checked&gt;&gt; Cat&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;wagging dog&quot; &gt;&gt; Dog&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;lazy cow&quot; &gt;&gt; Cow&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;prehensile monkey&quot; &gt;&gt; Monkey&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;fluffy rabbit&quot; &gt;&gt; Rabbit&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;bushy fox&quot; &gt;&gt; Fox&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;long mouse&quot; &gt;&gt; Mouse&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;twisted pig&quot; &gt;&gt; Pig&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;swaying horse&quot; &gt;&gt; Horse&lt;br&gt;
			&lt;&lt;elseif $StoredCurse.name== &quot;Maximum Fluff&quot; &amp;&amp; $curse19.variation==&quot;&quot;&gt;&gt;
				What type of fur would you like to gain?&lt;br&gt;&lt;br&gt;

				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cat-furred&quot; checked&gt;&gt; Cat&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;dog-furred&quot; &gt;&gt; Dog&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cow-furred&quot; &gt;&gt; Cow&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;monkey-furred&quot; &gt;&gt; Monkey&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;rabbit-furred&quot; &gt;&gt; Rabbit&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;fox-furred&quot; &gt;&gt; Fox&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;mouse-furred&quot; &gt;&gt; Mouse&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;pig-furred&quot; &gt;&gt; Pig&lt;br&gt;
				&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;horse-furred&quot; &gt;&gt; Horse&lt;br&gt;

			&lt;&lt;elseif ($StoredCurse.name== &quot;Wacky Wombs&quot; &amp;&amp; $curse19.variation1==&quot;&quot; ) || ($StoredCurse.name== &quot;Wacky Wombs&quot; &amp;&amp; $playerCurses.some(e=&gt; e.name === &quot;Wacky Wombs&quot; ) &amp;&amp; $curse19.variation2==&quot;&quot;) &gt;&gt;
				What is the location of the womb you would like to add?
				&lt;&lt;if $app.womb==0&gt;&gt; 
					&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;throat&quot; checked&gt;&gt; Throat
					&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;urethra&quot; &gt;&gt; Urethra
					&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;anus&quot; &gt;&gt; Anus
					&lt;&lt;if $vagina &gt; 0 &gt;&gt;
						&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;vagina&quot; &gt;&gt; Vagina
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;throat&quot; checked&gt;&gt; Throat
					&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;urethra&quot; &gt;&gt; Urethra
					&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;anus&quot; &gt;&gt; Anus
					&lt;&lt;if $vagina &gt; 0 &gt;&gt;
						&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;vagina&quot; &gt;&gt; Vagina
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			
			&lt;&lt;elseif $StoredCurse.name== &quot;Rainbow Swirl&quot; &amp;&amp; $curse39.variation==&quot;&quot;&gt;&gt;
				&lt;&lt;textbox &quot;$curse38.variation&quot; &quot;pink&quot; &quot;Use Items and Relics&quot;&gt;&gt;

			&lt;&lt;elseif $StoredCurse.name== &quot;Tipping the Scales&quot; &amp;&amp; $curse54.variation==&quot;&quot;&gt;&gt;
				&lt;&lt;textbox &quot;$curse54.variation&quot; &quot;green&quot; &quot;Use Items and Relics&quot;&gt;&gt;
			
			&lt;&lt;elseif $StoredCurse.name== &quot;Carapacian&quot;&gt;&gt;

				Please enter your new exoskeleton color:

				&lt;&lt;textbox &quot;$curse69.variation&quot; &quot;shiny black&quot; &quot;Use Items and Relics&quot;&gt;&gt;

			&lt;&lt;else&gt;&gt;
				&lt;&lt;if $StoredCurse.name==&quot;Dizzying Heights&quot; &amp;&amp; $HeightIncrease == 0&gt;&gt;
					&lt;br&gt;As you look into the marbles you see your own reflection in the marble, as well as the miasma of the curse swirling within&lt;br&gt;
					You see your own reflection alternating between growing and shrinking. After a while you see the curse has settle on a height... &lt;br&gt;&lt;br&gt;

					&lt;&lt;radiobutton &quot;$HeightIncrease &quot; -1 checked&gt;&gt; Decrease&lt;br&gt;
					&lt;&lt;radiobutton &quot;$HeightIncrease &quot; 1 &gt;&gt; Increase&lt;br&gt;

				&lt;&lt;/if&gt;&gt;

				&lt;&lt;if $StoredCurse.name== &quot;Hemospectrum&quot; &amp;&amp; $curse70.variation== &quot;&quot;&gt;&gt;

					What would you like your new blood (or maybe hemolymph, depending on how human you still are) color to be?

					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;blue&quot; checked&gt;&gt; Blue
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;purple&quot; &gt;&gt; Purple
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;green&quot; &gt;&gt; Green
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;yellow&quot; &gt;&gt; Yellow
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;orange&quot; &gt;&gt; Orange
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;pink&quot; &gt;&gt; Pink
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;black&quot; &gt;&gt; Black
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;brown&quot; &gt;&gt; Brown
					&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;white&quot; &gt;&gt; White
				
				&lt;&lt;/if&gt;&gt;

				&lt;&lt;link &quot;Activate the stored curse&quot; &quot;Use Items and Relics&quot;&gt;&gt;
					&lt;&lt;set $playerCurses.push($StoredCurse)&gt;&gt;
					&lt;&lt;if $StoredCurse.type == &quot;Height&quot;&gt;&gt;
						&lt;&lt;set $HeightLog.push($StoredCurse)&gt;&gt;
					&lt;&lt;elseif $StoredCurse.type == &quot;Gender&quot;&gt;&gt;
						&lt;&lt;set $GenderLog.push($StoredCurse)&gt;&gt;
					&lt;&lt;elseif $StoredCurse.type == &quot;Age&quot;&gt;&gt;
						&lt;&lt;set $AgeLog.push($StoredCurse)&gt;&gt;
					&lt;&lt;elseif $StoredCurse.type == &quot;Libido&quot;&gt;&gt;
						&lt;&lt;set $LibidoLog.push($StoredCurse)&gt;&gt;
					&lt;&lt;/if&gt;&gt;
					&lt;&lt;set $ManagedMisfortuneActive=true&gt;&gt;
				&lt;&lt;/link&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;elseif $ManagedMisfortuneActive &gt;&gt;
		You are affected by the Curse $StoredCurse.name stored in the marbles. &lt;br&gt;
		&lt;&lt;link &quot;Deactivate the stored curse&quot; &quot;Use Items and Relics&quot;&gt;&gt;
			&lt;&lt;set $targetCurse = $StoredCurse&gt;&gt;
			&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
			&lt;&lt;set $ManagedMisfortuneActive=false&gt;&gt;
		&lt;&lt;/link&gt;&gt;		
		&lt;&lt;else&gt;&gt;
		&lt;br&gt;You need to store a Curse in the Relic before you can use it&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Gleam Dazer&quot;)&gt;&gt;
	&lt;br&gt;You can use the Gleam Dazer one time to view a glimpse of the next layer and see what threats, relics, and curses await you further into the Abyss.&lt;br&gt;
		&lt;&lt;set $previewReturn = $layerReturn&gt;&gt;
		&lt;&lt;if $currentLayer == 0&gt;&gt;
			[[Peek at what is waiting for you on the first layer|Layer1 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 1&gt;&gt;
			[[Peek at what is waiting for you on the second layer|Layer2 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 2&gt;&gt;
			[[Peek at what is waiting for you on the third layer|Layer3 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 3&gt;&gt;
			[[Peek at what is waiting for you on the fourth layer|Layer4 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 4&gt;&gt;
			[[Peek at what is waiting for you on the fifth layer|Layer5 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 5&gt;&gt;
			[[Peek at what is waiting for you on the sixth layer|Layer6 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $currentLayer == 6&gt;&gt;
			[[Peek at what is waiting for you on the seventh layer|Layer7 Preview]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
[[Perform other stat adjustments to correct for errors|Adjustments]]


[[Return|$layerReturn]]</tw-passagedata><tw-passagedata pid="79" name="Adjust bullets" tags="noreturn" position="1100,975" size="100,100">&lt;&lt;set $temp = 0&gt;&gt;How many bullets would you like to add? (Use a negative number to subtract)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Adjustments][$items[20].count += (parseInt($temp))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="80" name="AgeEnd" tags="" position="1225,975" size="100,100">Your physical age has been reduced to a point where it is not physically possible for you to continue your journey. Perhaps your companions can carry you back to the surface or you can hope to grow up in the Abyss in the habitation option of this layer. But at this point your own choices don&#39;t play much role in your fate, so the game will end here.

You may undo your last choice which put you over this limit if you&#39;d like to try to continue your journey with a young (but not too young) body.

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="81" name="Relic Info" tags="noreturn" position="100,1100" size="100,100">@@.relicTitle;$ownedRelics[$temp].name@@

[img[setup.ImagePath+$ownedRelics[$temp].pic]]

&lt;&lt;print $ownedRelics[$temp].desc&gt;&gt;

Weight: $ownedRelics[$temp].weight kg
Value: $ownedRelics[$temp].value dubloons
Corruption cost: $ownedRelics[$temp].corr

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="82" name="Kin Shifter Use" tags="" position="225,1100" size="100,100">[img[setup.ImagePath+&quot;Relics/kinshifter.png&quot;]]

A glob of thick, putty-like slime. the face appears decorative. When touched to another relic that you own, a portion of the slime will break off and reshape itself into a perfect replica of that Relic, gaining all of its characteristics, abilities, value, and weight permanently. It cannot shift back to its original form. The amount that breaks off is dependent on the perceived value of the Relic, which can be measured with its dubloon value. The slime contains 70 dubloons worth of morphing power, and can be used on multiple Relics with that total value or less - however, the last Relic that is duplicated can put you over the 70 dubloon total, so long as that Relic is worth 70 dublooms or less. This Relic can also copy Relics woth over 70 dubloons, but in that case that Relic would have to be the sole Relic that you copy.

Some examples: A : (20)-&gt;(30)-&gt;(20) = total 70, done.

B: (20)-&gt;(30)-&gt;(40) = total 90, over 70, done.

C: (120) done, only possible configuration for duplicating a Relic worth this much.

&lt;&lt;nobr&gt;&gt;
The current total value of relics you have copied is $tempValue dubloons.&lt;br&gt;&lt;br&gt;

&lt;&lt;if $tempValue == 0&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Kin Shifter&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;&lt;set $soldRelics.push($ownedRelics[$temp])&gt;&gt;
	&lt;&lt;set $ownedRelics.deleteAt($temp)&gt;&gt;
&lt;&lt;/if&gt;&gt;

Please choose the relic you would like to copy:&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Copy|Kin Shifter Use][$ownedRelics.push($ownedRelics[$i]), $tempValue += $ownedRelics[$i].value]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;elseif $tempValue &lt;= 69&gt;&gt;
Please choose the relic you would like to copy:&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].value &lt; 70&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Copy|Kin Shifter Use][$ownedRelics.push($ownedRelics[$i]), $tempValue += $ownedRelics[$i].value]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;else&gt;&gt;
As you touched the final relic to the Kin Shifter, the last of the goo was used up and your relic was copied. The cute eyes faded as the slime transmuted into the new relic you chose. &lt;br&gt;&lt;br&gt;

Now that you have become better equipped, you can continue your journey.&lt;br&gt;&lt;br&gt;

[[Return to exploring|$layerReturn]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="83" name="Forbidden Grimoire Select" tags="" position="350,1100" size="100,100">[img[setup.ImagePath+&quot;Relics/forbiddengrimoire.png&quot;]]
A grisly-looking ragged book written in an indecipherable language. Words can only be seen on the page when a person reads it alone, and they vanish as that one person reads them. This will take whatever skills the reader possesses and improve them greatly, leaving a blank, non-useful book behind. Mechanically speaking, if you let a companion use it, it would double the specific numeric benefit of their special ability - Khemia would reduce travel costs by 4 days, Cloud would redduce bullet costs by 4 (minimum 1), Cherry would reduce status effect lengths by2, and so on. (It doesn&#39;t really affect, say, Khemia&#39;s ability to slay monsters so much - he&#39;s already trained to nearly the maximum human limits, and if there&#39;s a monster he can&#39;t defeat, it&#39;s more about the monster simply being durable beyond the human body&#39;s limits than it is about any imperfections in his fighting sills.) Using it on yourself could help you in your normal life, but probably not very much on your journey - the benefit would be substantially less than that from using it on a companion, anyways. If one person were to read it twice (such as through Kin Shifter), the second use would have no benefit - best to spread it out among multiple companions.

It&#39;s useless once it&#39;s been used once of course, so choose wisely who will get the benefit.

Who do you want to give the grimoire to improve their skills?

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
		&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print &quot;[[$hiredCompanions[$i].name|Forbidden Grimoire Outcome][$name = $hiredCompanions[$i].name]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Put away the grimoire without using it|$layerReturn]]</tw-passagedata><tw-passagedata pid="84" name="Forbidden Grimoire Outcome" tags="" position="475,1100" size="100,100">You have given the eldritch knowledge contained in the book to $name.

&lt;&lt;include `&quot;Forbidden Grimoire &quot; + $name`&gt;&gt;

After $name finishes reading, all words fade from the grimoire&#39;s pages, leaving it completely blank.
&lt;i&gt;Note: This limitation is not implemented yet.&lt;/i&gt;

[[Return to exploring|$layerReturn]]</tw-passagedata><tw-passagedata pid="85" name="Forbidden Grimoire Maru" tags="" position="600,1100" size="100,100">While Maru great appreciates your gift and improves the taste of his cooking, you don&#39;t gain any material benefit on your journey from giving it to him.</tw-passagedata><tw-passagedata pid="86" name="Forbidden Grimoire Lily" tags="" position="725,1100" size="100,100">After reading from the book, Lily&#39;s tongue seems just the slightest bit quicker and she sounds more convincing than ever. You now gain 20 extra dubloons when selling Relics with her on the surface.&lt;&lt;set $sellAdd += 10&gt;&gt;</tw-passagedata><tw-passagedata pid="87" name="Forbidden Grimoire Khemia" tags="" position="850,1100" size="100,100">After reading from the book, Khemia&#39;s seems to always spot even more efficient routes than before, as if he were intuitively able to tell the best paths through the Abyss. Travel times in the Abyss are now reduced by 4 days instead of 2 while he is with you.&lt;&lt;set $timeRed += 2&gt;&gt;</tw-passagedata><tw-passagedata pid="88" name="Forbidden Grimoire Cherry" tags="" position="975,1100" size="100,100">After reading from the book, Cherry seems to somberly ponder what she read for a few minutes, occasionally looking at her own body as if she were truly seeing it for the first time. The duration of status effects with a predetermined length is now reduced by 2 days instead of 1.&lt;&lt;set $statRed += 1&gt;&gt;</tw-passagedata><tw-passagedata pid="89" name="Forbidden Grimoire Cloud" tags="" position="1100,1100" size="100,100">After reading from the book, Cloud lines up his finger with a rock in the distance, mime&#39;s a gunshot, then turns to you and smiles. &lt;q&gt;I&#39;ve got to test out some of the stuff I saw in there, it&#39;s crazy stuff.&lt;/q&gt; You now have to spend 4 less bullets for any task instead of 2 less.&lt;&lt;set $bullRed += 10&gt;&gt;</tw-passagedata><tw-passagedata pid="90" name="Forbidden Grimoire Saeko" tags="" position="1225,1100" size="100,100">After reading from the book, Saeko&#39;s looks a bit sad as she turns the last page, as if hoping there was more to learn. After that, she is able to use innovative techniques you&#39;ve never seen before to minimzie your exposure to the miasma whenever possible. You now subtract 10 from all corruption costs in the Abyss, rather than 5.&lt;&lt;set $corrRed += 5&gt;&gt;</tw-passagedata><tw-passagedata pid="91" name="Balloon Inn" tags="balloon nobr" position="100,1225" size="100,100">[img[setup.ImagePath+&#39;Surface/Inn Room.png&#39;]]
&lt;br&gt;&lt;br&gt;

&lt;&lt;include &quot;Inn Storage&quot;&gt;&gt;

[[Continue using the commerce balloon|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="92" name="Balloon Workshop" tags="balloon" position="225,1225" size="100,100">[img[setup.ImagePath+$items[19].image]]

You can use the balloon to send requests and relics back to Outset Town. You can send up any Relics you have along with what you want done to them and the people at the workshop can reply and send back any modified Relics you want.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Purity Tree Plank&quot;&gt;&gt;

		&lt;br&gt;Would you like to fashion your Purity Wood Planks into protective gear for a value of +25 corruption each?&lt;br&gt;

		[[Use Purity Wood Plank|Balloon Workshop][$ownedRelics.deleteAt($i), $corruption += 25]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics[$i].name == &quot;Rømer Stones&quot; &amp;&amp; $warmCloth == 0 &amp;&amp; $coolCloth == 0&gt;&gt;
	&lt;br&gt;You muse over what you can do with the Rømer Stones, taking advantage over their ability for limitless small-scale heating or cooling.&lt;br&gt;&lt;br&gt;
	You can either buy some winter clothers for 30 dubloons to craft self-warming winter gear, or you could buy some light summer clothing for 25 dubloons to craft some cooling summer clothes.&lt;br&gt;
		[[Use the Rømer Stones for self-warming winter gear|Balloon Workshop][$ownedRelics.deleteAt($i), $items[22].count = 1, $dubloons -=30,$warmCloth=1]]&lt;br&gt;
		[[Use the Rømer Stones for self-cooling summer gear|Balloon Workshop][$ownedRelics.deleteAt($i), $items[23].count = 1, $dubloons -=25, $coolCloth=1]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Brave Vector&quot; &amp;&amp; $slingshot == 0&gt;&gt;
		&lt;br&gt;The Brave Vector seems like it should have some application as a weapon, but it turns out that it is exceedingly difficult to use a bent pipe like that as a gun substitute. Luckily, with the help of the resident Relic experts, you can change the form of the Brave Vector to a much more useful one. They seem to reccomend a sort of metal slingshot design, which should be able to function like a gun, but will be able to use anything of approximately the correct size as ammo. &lt;br&gt;
		&lt;br&gt;The raw materials for this are relatively cheap, letting you reshape the Brave Vector for only 10 dubloons.&lt;br&gt;
		[[Reshape the Brave Vector into a powerful slingshot|Balloon Workshop][$slingshot = 1, $dubloon -= 10]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Joyous Sunder&quot; &amp;&amp; $joyousSword == 0&gt;&gt;
		&lt;br&gt;The Joyous Sunder is an incredibly powerful offensive tool, but it is limited by its form as a small knife. Luckily, with the help of the local Relic Engineers, you can reshape this Relic into a true sword that an expert swordsman would feel comfortable using. A weapon like that would be literally unstoppable by any enemy that can be defeated by physical attacks and does not disable the user before they can get close enough to use it. This would be most useful in the hands of someone like Khemia, letting him defeat powerful beasts from the depths of the Abyss without fear of injury himself. The materials to forge a sword from the Joyous Sunder would cost you 20 dubloons.&lt;br&gt;
		[[Reshape the Joyous Sunder into a true sword|Balloon Workshop][$joyousSword = 1, $dubloon -= 20]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Continue using the commerce balloon|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="93" name="Balloon Admin" tags="balloon" position="350,1225" size="100,100">You can send a request to the Outset Town Administration. There seem to be a number of services that are provided here for people who need them, including managing debts and changing your legal name.

For a small fee of 10 dubloons, you can change your legal name from $app.name to whatever you wish.
[[Change your name|Balloon Name]]

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;)&gt;&gt;
You can use your companion Cloud&#39;s connections to borrow some money, but you will need to pay back an extra 20% as interest before you settle down for any voluntary habitation option.
[[Borrow more money|Balloon debt1]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $debt &gt; 0&gt;&gt;
You currently have $debt dubloons of debt, which you can pay off now to allow yourself to settle down at a habitation option.
[[Pay off your debt|Balloon debt2]]
&lt;&lt;/if&gt;&gt;

[[Continue using the commerce balloon|Commerce Balloon]]</tw-passagedata><tw-passagedata pid="94" name="Balloon Name" tags="balloon" position="475,1225" size="100,100">&lt;&lt;set $dubloons -= 10&gt;&gt;

The balloon sends down some surprisingly concise forms where you can fill out your new name, changing it for all official purposes.

What is your new name?
&lt;&lt;textbox &quot;$app.name&quot; &quot;Nana&quot; &quot;Commerce Balloon&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="95" name="Balloon debt1" tags="balloon" position="600,1225" size="100,100">Cloud is willing to allow you to use his connections to fund your expedition, as long as you can pay back the loan after you&#39;re done, with interest of course.

How many dubloons would you like to borrow?
&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Commerce Balloon][$dubloons += parseInt($temp), $debt += parseInt(Math.round($temp * 1.2))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="96" name="Balloon debt2" tags="balloon" position="725,1225" size="100,100">In order to finally settle down at an ending, you must pay off your debt to Cloud&#39;s mysterious connections. You currently owe $debt dubloons of debt to them.

How many dubloons would you like to pay back?
&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Commerce Balloon][$dubloons -= parseInt($temp), $debt -= parseInt($temp)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="97" name="CurseRemoval" tags="" position="850,1225" size="100,100">&lt;&lt;set _curseDeleted=false&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; $playerCurses.length; _i++&gt;&gt;
	&lt;&lt;if  !_curseDeleted &amp;&amp; $playerCurses[_i].name == $targetCurse.name&gt;&gt;
		&lt;&lt;if $targetCurse.type == &quot;Height&quot;&gt;&gt;
			&lt;&lt;set _j=$HeightLog.lastIndexOf(e =&gt; e.name === $targetCurse.name)&gt;&gt;
			&lt;&lt;set $HeightLog.deleteAt(_j)&gt;&gt;
		&lt;&lt;elseif $targetCurse.type == &quot;Gender&quot;&gt;&gt;
			&lt;&lt;set _j=$GenderLog.lastIndexOf(e =&gt; e.name === $targetCurse.name)&gt;&gt;
			&lt;&lt;set $GenderLog.deleteAt(_j)&gt;&gt;
		&lt;&lt;elseif $targetCurse.type == &quot;Age&quot;&gt;&gt;
			&lt;&lt;set _j=$AgeLog.lastIndexOf(e =&gt; e.name === $targetCurse.name)&gt;&gt;
			&lt;&lt;set $AgeLog.deleteAt(_j)&gt;&gt;
		&lt;&lt;elseif $targetCurse.type == &quot;Libido&quot;&gt;&gt;
			&lt;&lt;set _j=$LibidoLog.lastIndexOf(e =&gt; e.name === $targetCurse.name)&gt;&gt;
			&lt;&lt;set $LibidoLog.deleteAt(_j)&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $playerCurses.deleteAt(_i)&gt;&gt;
		&lt;&lt;set _curseDeleted=true&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;</tw-passagedata><tw-passagedata pid="98" name="GeneralTimeSetup" tags="" position="975,1225" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $currentLayer==1&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty)&gt;&gt;
&lt;&lt;elseif $currentLayer==2&gt;&gt;
	&lt;&lt;set _cutRed = setup.haveCuttingTool() ? 1 : 0&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty - _cutRed)&gt;&gt;
&lt;&lt;elseif $currentLayer==3&gt;&gt;
	&lt;&lt;set _lightRed = setup.haveTravelLightSource() ? 1 : 0&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty - _lightRed)&gt;&gt;
&lt;&lt;elseif $currentLayer==4&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty)&gt;&gt;
	&lt;&lt;if $torchUse == 1 &amp;&amp; $heat == 1&gt;&gt;
		&lt;&lt;set $tempTime -= 2&gt;&gt;
	&lt;&lt;elseif $items[9].count &gt; 0 &amp;&amp; $torchUse == 1&gt;&gt;
		&lt;&lt;set $tempTime -= 2&gt;&gt;
		&lt;&lt;set $items[9].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $tempTime += $playerCurses.filter(e =&gt; e.name === &quot;Cold Blooded&quot;).length&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $currentLayer==5&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)) - $cool)&gt;&gt;
&lt;&lt;elseif $currentLayer==6&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime  - $timeRed + $status.penalty -$cool)&gt;&gt;
&lt;&lt;elseif $currentLayer==7&gt;&gt;
	&lt;&lt;set $tempTime = (1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $tempTime = Math.max(0, $tempTime)&gt;&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="99" name="GeneralTimeStats" tags="" position="1100,1225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $currentLayer==1&gt;&gt;

	&lt;&lt;set $timeL1 += $tempTime&gt;&gt;

&lt;&lt;elseif $currentLayer==2&gt;&gt;

	&lt;&lt;set $timeL2 += $tempTime&gt;&gt;
	&lt;&lt;if $items[1].count &gt; 9&gt;&gt;
		&lt;&lt;set $timeL2T1 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $currentLayer==3&gt;&gt;

	&lt;&lt;set $timeL3 += $tempTime&gt;&gt;
	&lt;&lt;if $items[9].count &gt; 0 &amp;&amp; $torchUse == 1&gt;&gt;
		&lt;&lt;set $items[9].count -= 1&gt;&gt;
	&lt;&lt;elseif $items[9].count == 0 &amp;&amp; $torchUse == 1&gt;&gt;
		&lt;&lt;set $torchUse = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $timeL3T1 += 1&gt;&gt;
	&lt;&lt;if !setup.haveTravelLightSource()&gt;&gt;
		&lt;&lt;set $timeL3T2 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;elseif $currentLayer==4&gt;&gt;

	&lt;&lt;set $timeL4 += $tempTime&gt;&gt;
	&lt;&lt;set $timeL4T1 += $tempTime&gt;&gt;

&lt;&lt;elseif $currentLayer==5&gt;&gt;

	&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
	&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
		&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $timeL5T1 += $tempTime&gt;&gt;

&lt;&lt;elseif $currentLayer==6&gt;&gt;

	&lt;&lt;set $timeL6 += $tempTime&gt;&gt;
	&lt;&lt;if $dubloons &gt; 199&gt;&gt;
		&lt;&lt;set $timeL6T2 += $tempTime&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $timeL6T1 += $tempTime&gt;&gt;
	&lt;&lt;set $hexflame += $tempTime&gt;&gt;

&lt;&lt;elseif $currentLayer==7&gt;&gt;

	&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
	&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
	&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
		&lt;&lt;set $dubloons -= 1&gt;&gt;
		&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
		&lt;&lt;set $dubloons -= 2&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $dubloons -= 3&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
			&lt;&lt;if $currentLayer==1&gt;&gt;
				&lt;&lt;set $foodL1 += 1&gt;&gt;
				&lt;&lt;set $GenderLog.push($ForageFoodMajor)&gt;&gt;/* layer specific */
			&lt;&lt;elseif $currentLayer==2&gt;&gt;
				&lt;&lt;set $foodL2 += 1&gt;&gt;
				&lt;&lt;if $mudHunt == 1&gt;&gt;
					&lt;&lt;if $slingshot == 1&gt;&gt;
					&lt;&lt;elseif ($items[13].count &gt; 0 &amp;&amp; $items[20].count) &gt; 0&gt;&gt;
						&lt;&lt;set $items[20].count -= 1&gt;&gt;
					&lt;&lt;else&gt;&gt;
						&lt;&lt;set $LibidoLog.push($ForageFoodMajor)&gt;&gt;
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $LibidoLog.push($ForageFoodMajor)&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $currentLayer==3&gt;&gt;
				&lt;&lt;set $foodL3 += 1&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMajor)&gt;&gt;
			&lt;&lt;elseif $currentLayer==4&gt;&gt;
				&lt;&lt;if $slingshot == 1&gt;&gt;
					&lt;&lt;set $foodL4 += 1&gt;&gt;
					&lt;&lt;set $HeightLog.push($ForageFoodMajor)&gt;&gt;
				&lt;&lt;elseif $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 0&gt;&gt;
					&lt;&lt;set $foodL4 += 1&gt;&gt;
					&lt;&lt;set $items[20].count -= Math.max(2 - $bullRed, 1)&gt;&gt;
					&lt;&lt;set $HeightLog.push($ForageFoodMajor)&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $items[1].count -= 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $currentLayer==5&gt;&gt;
				&lt;&lt;set $foodL5 += 1&gt;&gt;
				&lt;&lt;set $crumbleFluid += 5&gt;&gt;
			&lt;&lt;elseif $currentLayer==6&gt;&gt;
				&lt;&lt;set $foodL6 += 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
			&lt;&lt;if $currentLayer==2&gt;&gt;
				&lt;&lt;set $foodL2 += 1&gt;&gt;
				&lt;&lt;if $mudHunt == 1&gt;&gt;
					&lt;&lt;if $slingshot == 1&gt;&gt;
					&lt;&lt;elseif ($items[13].count &gt; 0 &amp;&amp; $items[20].count) &gt; 0&gt;&gt;
						&lt;&lt;set $items[20].count -= 1&gt;&gt;
					&lt;&lt;else&gt;&gt;
						&lt;&lt;set $lastFlan=$time+1&gt;&gt;
					&lt;&lt;/if&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $lastFlan=$time+1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $currentLayer==3&gt;&gt;
				&lt;&lt;set $foodL3 += 1&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMinor)&gt;&gt;
			&lt;&lt;elseif $currentLayer==4&gt;&gt;
				&lt;&lt;if $slingshot == 1&gt;&gt;
					&lt;&lt;set $foodL4 += 1&gt;&gt;
					&lt;&lt;set $HeightLog.push($ForageFoodMinor)&gt;&gt;
				&lt;&lt;elseif $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 0&gt;&gt;
					&lt;&lt;set $foodL4 += 1&gt;&gt;
					&lt;&lt;set $items[20].count -= Math.max(2 - $bullRed, 1)&gt;&gt;
					&lt;&lt;set $HeightLog.push($ForageFoodMinor)&gt;&gt;
				&lt;&lt;else&gt;&gt;
					&lt;&lt;set $items[1].count -= 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $currentLayer==5&gt;&gt;
				&lt;&lt;set $foodL5 += 1&gt;&gt;
				&lt;&lt;set $crumbleFluid += 1&gt;&gt;
			&lt;&lt;elseif $currentLayer==6&gt;&gt;
				&lt;&lt;set $foodL6 += 1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;	
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;if $currentLayer==1&gt;&gt;
				&lt;&lt;set $waterL1 += 1&gt;&gt;
				&lt;&lt;set $GenderLog.push($ForageWaterMajor)&gt;&gt;/* layer specific */
			&lt;&lt;elseif $currentLayer==2&gt;&gt;
				&lt;&lt;set $waterL2 += 1&gt;&gt;
				&lt;&lt;set $bewitchBabies += 1&gt;&gt;
			&lt;&lt;elseif $currentLayer==3&gt;&gt;
				&lt;&lt;set $waterL3 += 1&gt;&gt;
			&lt;&lt;elseif $currentLayer==4&gt;&gt;
				&lt;&lt;set $waterL4 += 1&gt;&gt;
				&lt;&lt;if $abyssKnow == 0&gt;&gt;
					&lt;&lt;set $algalSize += 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $currentLayer==5&gt;&gt;	
				&lt;&lt;set $waterL5 += 1&gt;&gt;
			&lt;&lt;elseif $currentLayer==6&gt;&gt;
				&lt;&lt;set $waterL6 += 1&gt;&gt;
				&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
					&lt;&lt;set $hexflame += 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;if $layer==3&gt;&gt;
				&lt;&lt;set $waterL3 += 1&gt;&gt;
			&lt;&lt;elseif $layer==4&gt;&gt;
				&lt;&lt;set $waterL4 += 1&gt;&gt;
				&lt;&lt;if $abyssKnow == 0&gt;&gt;
					&lt;&lt;set $algalSize += 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;elseif $layer==5&gt;&gt;
				&lt;&lt;set $waterL5 += 1&gt;&gt;
			&lt;&lt;elseif $layer==6&gt;&gt;
				&lt;&lt;set $waterL6 += 1&gt;&gt;
				&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
					&lt;&lt;set $hexflame += 1&gt;&gt;
				&lt;&lt;/if&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $tempTimeFixed=0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="100" name="Curse Descriptions" tags="" position="1225,1225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $playerCurses.length&gt;0&gt;&gt;
	&lt;&lt;set $temp = random(0,$playerCurses.length - 1)&gt;&gt;
	&lt;&lt;set $tempCurse = $playerCurses[$temp]&gt;&gt;
	&lt;&lt;LibidoCorrected&gt;&gt;
	&lt;&lt;appGender&gt;&gt;
	&lt;&lt;AppearanceCorrect&gt;&gt;
	&lt;&lt;BreastCorrected&gt;&gt;

&lt;&lt;if $tempCurse.name == &quot;Libido Reinforcement A&quot; || $tempCurse.name == &quot;Libido Reinforcement B&quot; || $tempCurse.name == &quot;Libido Reinforcement C&quot; || $tempCurse.name == &quot;Libido Reinforcement D&quot; || $tempCurse.name == &quot;Libido Reinforcement E&quot;&gt;&gt;
	&lt;&lt;if $app.libido == 3&gt;&gt;
		Sex. It&#39;s not quite a constant obsession for you, not yet, but you&#39;d certainly like some right now... and a few more times a day. It just feels so good. This might be the Libido Reinforcement curse that you took on talking, but seriously, orgasms add so much joy to life, and you&#39;d just like to have more. It can change the way you look at others and yourself. Do others feel this need as much as you do? Probably not, since you remember not thinking about sex this much before you came to this Abyss. &lt;br&gt;&lt;br&gt;Relax, now isn&#39;t the time for sex... even though you wish it were. &lt;br&gt;&lt;br&gt;Surely there will be an opportunity soon? You hope so.
	&lt;&lt;elseif $app.libido == 4&gt;&gt;
		You masturbated forty minutes ago, why are you thinking about sex again? Now that your libido has been greatly elevated, your desires are getting harder to control. You used to be intimidated by the idea of propositioning people for sex, but your need has suppressed that instinct as a simple matter of practicality. You realize you&#39;re becoming a bit of a slut, but what can you do? These curses are just driving you into it. Despite how much of an issue it may be, you can&#39;t deny that a part of you is enjoying it.
	&lt;&lt;elseif $app.libido == 5&gt;&gt;
		How many orgasms have you had in the past day? &lt;br&gt;&lt;br&gt;You&#39;ve lost count. It&#39;s all becoming a blur. Everything you see reminds you of sex. &lt;br&gt;&lt;br&gt;Every person you see, no matter how unattractive they are, causes you to think about sexual interaction with them. When you look at animals, you&#39;re noticing their genitals, and wondering about them. Heck, you almost got off by grinding yourself into the dirt as you were &quot;trying to go to sleep&quot; last night. You might just have a problem. &lt;br&gt;&lt;br&gt;No, it&#39;s not your fault, it&#39;s all these Libido Reinforcement Curses you&#39;ve got! You try to calm down and take deep breaths, but then your arousal takes back control.
	&lt;&lt;elseif $app.libido == 6&gt;&gt;
		You&#39;ve accepted it at this point. You&#39;re the sluttiest slut you&#39;ve ever heard of. You just can&#39;t stop yourself anymore. &lt;br&gt;&lt;br&gt;Any sexual standards you once had have faded into mild preferences, but nothing can truly sate the need you feel. Whether you get back to the surface or stay down here, you&#39;re not going to be able to hold down any job except being a whore. But wow, you&#39;d make a fantastic whore. &lt;br&gt;&lt;br&gt;Every one of your orifices longs to be filled and each of your protrusions crave stimulation. If you can&#39;t find somebody else to help you, you&#39;ll do it to yourself, but you really want the company. You&#39;d be happy having sex all day long, with only a few breaks. &lt;br&gt;&lt;br&gt;Sometimes you worry that you&#39;re starting to lose track of your mission down here. Did you come down here into the Abyss just to fuck everyone and everything around you? No, but your original goals seem less important than they once did to you. Perhaps you can multitask and have sex while you&#39;re exploring? That sounds kind of awkward, but like it could be worth trying.
	&lt;&lt;elseif $app.libido &gt;= 7&gt;&gt;
		You&#39;re feeling less like a person and more like a set of warm body parts that crave sex. It&#39;s your true purpose, to fuck and get fucked as much as possible. &lt;br&gt;&lt;br&gt;&quot;No&quot; screams a tiny voice in the back of your mind. &quot;You&#39;re a person, you have dreams, you&#39;re more than just an animated sex doll.&quot; However, the need roars back even louder. Your rational mind tries to be optimistic. &quot;Look,&quot; it says &quot;this is manageable. When you get back to the surface, you can build a sex machine on wheels, and ride it around naked, and people who you pass can fuck you while you&#39;re going about our daily business. As long as you can keep your urges satisfied, you can live your life, and pursue your dreams.&quot; &lt;br&gt;&lt;br&gt;Your dominant libido considers that and seems to assent, but that tiny bit of you that&#39;s still connected to non-sexual desires can&#39;t quite reconcile how that plan is going to work. Is there really any way you can possibly have enough sex to satisfy you without being detained as a public menace? Your primary fear is no longer dying down here, or being unable to get back, but just the fear of being deprived of erotic stimulation. &lt;br&gt;&lt;br&gt;You don&#39;t just belong in a brothel, you belong in an unending orgy.
	&lt;&lt;/if&gt;&gt;	
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $tempCurse.name == &quot;Gender Reversal A&quot; || $tempCurse.name == &quot;Gender Reversal B&quot; || $tempCurse.name == &quot;Gender Reversal C&quot; || $tempCurse.name == &quot;Gender Reversal D&quot; || $tempCurse.name == &quot;Gender Reversal E&quot;&gt;&gt;
	&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
	&lt;&lt;if $app.gender == 2&gt;&gt;
			Ever since you obtained the Gender Reversal Curse, you&#39;ve started looking, and feeling, a bit more feminine. It&#39;s mostly subtle things, so you can mostly hide the changes if you want to. &lt;br&gt;&lt;br&gt;Your body hair is a little less thick. Your facial hair isn&#39;t growing very much. Your voice is a little smoother and slightly higher. You&#39;re still a man, but your muscles are slightly less pronounced and you&#39;re giving off an aura that your masculinity is not something you&#39;ve really cultivated. Overall though, it&#39;s still pretty easy to identify you as a man at a glance, albeit a feminine one.
	&lt;&lt;elseif $app.gender == 3&gt;&gt;
			Your facial hair has stopped growing entirely. The hair on your chest doesn&#39;t seem to be growing either. Your shoulders have slimmed down and you&#39;ve lost noticeable muscle mass. Another level of gender reversal has left you barely masculine at all. &lt;br&gt;&lt;br&gt;Over the last week your adam&#39;s apple has shriveled away. Sometimes you go to say something and find your voice cracking, like when you were going through puberty, only you know it&#39;s not getting lower pitched, it&#39;s getting higher. In some environments you&#39;re certain that some guys with high masculinity and an ill temperament would pick on you. Even your hands have slimmed down and shrunk a little. &lt;br&gt;&lt;br&gt;You&#39;re worried that at this point you&#39;re neither feminine nor masculine enough to be regarded as &quot;sexy&quot; by most people. Are you okay with that? If not, it might be easier to go forward with more Curses than trying to go backwards, since you can&#39;t override the Curse and ever be more masculine again anyway. Maybe you&#39;re thinking too much. When the choices are presented to you, you&#39;ll make them.
	&lt;&lt;elseif $app.gender == 4&gt;&gt;
			Is anyone sure what your gender is? The other explorers who give you long glances trying to figure it out don&#39;t seem to have a clue. Do you even know? You&#39;re nearly perfectly androgynous, just slightly more feminine. Every bit of you from the top of your head to the tips of your toes could be either gender (excluding a few bits that you keep covered up). &lt;br&gt;&lt;br&gt;Really though, you&#39;re not a man, and you&#39;re not a woman. You are neither and both. There&#39;s power in that. To walk the path between marks you apart. There are words for this in many languages, but is this what you want? In a way, you&#39;re beautiful, just not really in a way that would normally be thought of sexually. Do you see the rewards in this experience as being worth the burden, or will you continue the process of letting the Abyss change you?
	&lt;&lt;elseif $app.gender == 5&gt;&gt;
			You&#39;ve crossed the threshold. People see you as female now. You think that when your hips widened and the way you walk changed it might have been the dividing line, but there are so many subtle changes that have happened to your body that you&#39;re really not sure. You&#39;re not sure how good you are at being female though. The Curse is giving you physical features, but it&#39;s not teaching you the secrets of womanhood in any way beyond your appearance. If you don&#39;t want to stand out as clueless and badly mannered, you&#39;re going to have to learn.
	&lt;&lt;elseif $app.gender &gt;= 6&gt;&gt;
			Your body has been completed changed by the continued erosion of your original masculinity. No one who casually looked at you would guess that you weren&#39;t born a woman, but sometimes it still feels strange. You&#39;re not as strong as you used to be and you flaired hips and thighs certainly show off some of your new assets below the waist. Sometimes when you rub your face you still get the strange sensation that things aren&#39;t quite in the same place, but over time you&#39;re getting more and more used to your new reality with your distinctly feminine body.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;if $app.gender == 5&gt;&gt;
			Ever since you obtained the Gender Reversal Curse, you&#39;ve lost a bit of &quot;femininity&quot; as some would describe it. You don&#39;t think you&#39;ll be wearing as many dresses or skirts from here on out, since it would just feel a bit awkward given your more aggressively hairy legs and changing figure. But you&#39;re taking a bit more joy in exploring the Abyss and you&#39;ve gained a bit of muscle. Your voice is a tinge deeper, but more like a deep woman&#39;s voice, not a man&#39;s. 
	&lt;&lt;elseif $app.gender == 4&gt;&gt;
			The hair on your arms and legs has started growing thicker, and you can&#39;t shave it off all the time or it grows back too quickly. You used to have noticeable hips, but they&#39;ve started narrowing. It&#39;s definitely changed the way you walk, which was something you didn&#39;t expect, and now your gait is more masculine. Another level of gender reversal has made you downright mannish, for a woman at least. There&#39;s are faint wisps of hair that are appearing on other parts of your body that didn&#39;t have them before. &lt;br&gt;&lt;br&gt;You&#39;re worried that at this point you&#39;re neither feminine nor masculine enough to be regarded as &quot;sexy&quot; by most people. Are you okay with that? If not, it might be easier to go forward with more Curses than trying to go backwards, since you can&#39;t override the Curse and ever be more feminine again anyway. Maybe you&#39;re thinking too much. When the choices are presented to you, you&#39;ll make them.
	&lt;&lt;elseif $app.gender == 3&gt;&gt;
			Is anyone sure what your gender is? The other explorers who give you long glances trying to figure it out don&#39;t seem to have a clue. Do you even know? You&#39;re nearly perfectly androgynous, just slightly more masculine. Every bit of you from the top of your head to the tips of your toes could be either gender (excluding a few bits that you keep covered up). &lt;br&gt;&lt;br&gt;Really though, you&#39;re not a man, and you&#39;re not a woman. You are neither and both. There&#39;s power in that. To walk the path between marks you apart. There are words for this in many languages, but is this what you want? In a way, you&#39;re beautiful, just not really in a way that would normally be thought of sexually. Do you see the rewards in this experience as being worth the burden, or will you continue the process of letting the Abyss change you?
	&lt;&lt;elseif $app.gender == 2&gt;&gt;
			You&#39;ve crossed the threshold. People see you as male now. You think that when your beard started growing it cemented that impression, but there are so many subtle changes that have happened to your body and mannerisms that you&#39;re really not sure. Your muscles aren&#39;t that pronounced for a man, but the layer of subdermal fat that women have is gone from your arms, so your muscles stand out more. You suppose the Curse must be messing with your hormone levels, but it&#39;s doing other things too. Still, it&#39;s given you the body of a man (even if not a very masculine one), but it hasn&#39;t taught you how to be a man. What does that even mean though? You feel some aggressive impulses that are more intense than what you are used to dealing with, but they aren&#39;t overpowering or anything like that. You&#39;re going to have to find a way to control those.
	&lt;&lt;elseif $app.gender &lt;= 1&gt;&gt;
			Your body has been completed changed by the continued erosion of your original femininity. No one who casually looked at you would guess that you weren&#39;t born a man, but sometimes it still feels strange. You&#39;re much stronger than you used to be and your solid musculature shows off your new assets in your arms. Sometimes when you rub your face you still get the strange sensation that things aren&#39;t quite in the same place, and occassionally scratching yourself on your stiff facial hair is something you&#39;ll need to get used to, but over time you&#39;re getting more and more used to your new reality with your distinctly masculine body.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;	
&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Clothing Restriction A&quot;&gt;&gt;
		No accessories for you. That&#39;s your reality after taking that Clothing Restriction curse. &lt;br&gt;&lt;br&gt;Your fashion options are a bit more limited now, but not being able to use any hats or scarves is legitimately inconvenient in some weather! Luckily, ou&#39;ve found that you&#39;re able to wear clothing with hoods attached, but as minor as this curse is, you&#39;re going to notice it as an annoyance in your daily life.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Hair Removal&quot;&gt;&gt;
		You didn&#39;t think losing your body hair would have been such a big deal, but now every time you brush against something the sensation is more intense. Even in places you shaved, it feels different than before. Somehow, missing those little hairs that would grow in between shaving sessions gives your skin a significantly different feeling a lot of the time, more than you would have expected before. It almost feels as if you&#39;ve lost a layer of protection from the world. Somehow, it seems like your interaction with the world and people around you has become more... intimate. 
	&lt;&lt;/if&gt;&gt;	
	&lt;&lt;if $tempCurse.name == &quot;Perma-dye&quot;&gt;&gt;
		Ha, you thought having $app.hair hair wouldn&#39;t be such a big deal. But now you&#39;re beginning to realize it&#39;s affecting the way others see you, and the way you see yourself. When you see your reflection it makes it just a little bit harder to recognize yourself, it takes just a moment longer before you can tell that the person in the mirror is you. Despite being such a minor change, it still feels strange.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Freckle Speckle&quot;&gt;&gt;
		With your skin now speckled with freckles, your appearance is much more unique. You chose where each freckle would appear, but you didn&#39;t exactly have a lot of time to really think about it or even a mirror to see what you&#39;d look like! You hope that the next time you really get a good look at yourself you&#39;re happy with the choices you made. The Abyss is a strange place, but you&#39;re trying to make good choices while you&#39;re down here. That might get harder to do as the potential outcomes become harsher and harsher.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Knife-ear&quot;&gt;&gt;
		When you were cursed with knife-ears, you knew it would alter your appearance and the way other perceived you. But what you hadn&#39;t realized is just how sensitive the tips of your ears would become! Sometimes when you lay down your head on your pillow at night, if the angle is right, it feels almost sensual and you feel an urge to rub up against the pillow more. While it isn&#39;t too hard to control yourself, these new, pleasurable sensations are strange to deal with.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Dizzying Heights&quot;&gt;&gt;
		You wince as you stub your toe, yet again. You&#39;re not quite used to your legs being this length, or really the new size of your whole body. With the Dizzying Heights curse and what scavenging you&#39;ve done, you&#39;re now &lt;&lt;print Math.round($app.heightCor)&gt;&gt; cm tall. You didn&#39;t think that would be such a big deal, but you&#39;d gotten used to your body being a certain size, and a lot of the motions that you practiced many times before are just producing awkward results now! The whole world feels like it has changed in size, even though you know it&#39;s the same, it&#39;s only you that&#39;s changed.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Increased Sensitivity&quot;&gt;&gt;
		A part of you knew that being cursed with Increased Sensitivity would be a major change in erotic situations and it might not be the most convenient thing in everyday life. However, the tantalizing excitement drew you in, and now you&#39;re living with the consequences. You hadn&#39;t fully understood how the brush of cloth against your nipples and between your legs would draw shivers of desire out of you. You hadn&#39;t expected that you&#39;d be splattering your juices simply by brushing against something at the right angle and position, but here you are, hot and panting simply because you brushed against a boulder the wrong way as you were moving past it.
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Refractory Refactorization&quot;&gt;&gt;
		Getting rid of your refractory period? That&#39;s not so bad for a Curse, or so you&#39;d thought. Then you found yourself in an erotic situation, and ended up cumming for seven minutes straight, not a moment&#39;s break in between. Your body was locked in spasms, and the experience was just so hot that you just kept on riding orgasm after orgasm in a continuous wave. Now however, you feel used up, worn out, desperately thirsty, and like your body pumped out something vital. Yet, your mind is abuzz with one of the most intense experiences of your life and you feel like you could go again at any moment.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Heat/Rut&quot;&gt;&gt;
		You frantically scan the abyss around you. There must be someone or something else here that you can fuck. You let out a bestial growl that gradually becomes a simple whine of need. You used to think it was a little bit funny when animals went into heat or rut, but now that the Abyss has cursed you with the same condition, you realize just how much being helplessly horny for long periods of time can warp your perspective. You&#39;ve orgasmed multiple times in the past few hours, but the relief only lasts a few minutes before the need once again becomes all-consuming. It&#39;s a horniness that&#39;s relentless and unending, never giving you even a moment of respite. You&#39;ve tried masturbating, but it&#39;s just not doing it for you. Not that fucking is giving you much relief either. &lt;br&gt;&lt;br&gt;You want to scream. &lt;br&gt;&lt;br&gt;Then you see somebody nearby. &lt;br&gt;&lt;br&gt;Yes! You don&#39;t know who or what they are, but it doesn&#39;t even matter. You dash off towards them in complete desperation, so keyed up with arousal that you can&#39;t even think. Maybe tomorrow you&#39;ll remember this, with the haze of the Curse cleared.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Sex Switcheroo&quot;&gt;&gt;
		&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
			When you were cursed to replace you cock with a cunt, did you realize just how distracting it would be? Perhaps, but now you can&#39;t stop thinking about your new equipment. &lt;br&gt;&lt;br&gt;Yet, it&#39;s more than equipment, isn&#39;t it? It&#39;s part of who you are now. How is this going to affect the rest of your life? &lt;br&gt;&lt;br&gt;Sure, the enlightened say that it doesn&#39;t really matter, and to some random surface dweller that you past on the street, it probably shouldn&#39;t matter unless you plan to sleep with them. For you though, this is your body, and it matters quite a lot.
		&lt;&lt;else&gt;&gt;
			When you were cursed to replace you cunt with a cock, did you realize just how distracting it would be? Perhaps, but now you can&#39;t stop thinking about your new equipment. &lt;br&gt;&lt;br&gt;Yet, it&#39;s more than equipment, isn&#39;t it? It&#39;s part of who you are now. How is this going to affect the rest of your life? &lt;br&gt;&lt;br&gt;Sure, the enlightened say that it doesn&#39;t really matter, and to some random surface dweller that you past on the street, it probably shouldn&#39;t matter unless you plan to sleep with them. For you though, this is your body, and it matters quite a lot.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Futa Fun&quot;&gt;&gt;
		Having both a penis and breasts comes with a different perspective. There are pleasures that are open to you that are closed to many others. However, as you encounter more of the Abyss, there&#39;s also a little trepidation that enters your mind of what else may change in the future. This place has a way of changing things, and you might have just opened a door for even more ways that it can change you. This Curse alone is a significant change, but are you prepared for what may follow if your body becomes even more corrupted?
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Blushing Virgin&quot;&gt;&gt;
		Your face burns a brilliant red. They&#39;re looking at you. They see you! This is so embarrassing! &lt;br&gt;&lt;br&gt;&quot;But it&#39;s also exciting&quot; murmurs a different part of your mind. You find yourself agreeing, but that only makes you more embarrassed. Part of you knows that this is a result of the Blushing Virgin curse, but you can&#39;t help the way you feel, or how your burning cheeks are only making you more aroused. You&#39;re so awkward, but that only adds a a novelty and vitality to the lewdness you engage in on a day to day basis.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Submissiveness Rectification A&quot; || $tempCurse.name == &quot;Submissiveness Rectification B&quot; &gt;&gt;
		&lt;&lt;if $playerCurses.filter(e =&gt; e.name === &quot;Submissiveness Rectification A&quot;).length + $playerCurses.filter(e =&gt; e.name === &quot;Submissiveness Rectification B&quot;).length == 1&gt;&gt;
			You&#39;re a nice person. You want to help people. Sometimes you&#39;re not sure what&#39;s best, even for yourself, so letting others take the lead makes total sense. &lt;br&gt;&lt;br&gt;You want to be open to trying new things, and generally be a fun person to be around. However, there&#39;s little doubt in your mind that the Submissiveness Rectification curse is amplifying this aspect of your personality somewhat, though you aren&#39;t quite sure how much. &lt;br&gt;&lt;br&gt;Lately your dreams have been about getting tied up and letting strong dominant people do naughty things to you. Is this some idle fantasy, or a prediction for your future? The curses in the Abyss can warp things in such strange ways that you&#39;re not sure.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;Clothing Restriction B&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;)&gt;&gt;
			Oh gosh, you&#39;re perpetually naked now. No underwear, no clothes, no armor, just flashing everyone and everything all day long. If you&#39;re going to do anything but draw open-mouthed stares, you&#39;re going to have to get really good at using convincing body-paint, but even that won&#39;t work if anyone looks at you especially hard. Wherever you end up, this is going to have a big impact on your life. And there&#39;s no way to even unintentionally wear clothes, since the Curse makes them degrade immediately if you even attempt to get around it. &lt;br&gt;&lt;br&gt;Maybe being naked isn&#39;t so bad, humans are the only creatures on the surface that wear clothes anyway. But when you think about everyone staring at your naked body, always, it conjures up a wild mix of emotions: embarrassment, fear, lust. If you live anywhere but a nudist colony, you&#39;re going to run afoul of a bunch of prudish people, or end up being followed by a bunch of horny people, let alone any laws you might be breaking!
		&lt;&lt;else&gt;&gt;
			Underwear is overrated, or at least that&#39;s what you&#39;d been thinking when the Abyss bestowed this Clothing Restriction curse on you. Your experience since then has slightly contradicted that. Your clothing really used to fit a lot better and stayed on more easily when the cloth of your undergarments was helping to hold it there. &lt;br&gt;&lt;br&gt;Now you&#39;re worried that when you stretch awkwardly some of your clothes are just going to fall right off. Anyone looking on wouldn&#39;t just get a glimpse of your underwear, which before you&#39;d have thought was embarrassing, they&#39;d see your naked body. Going commando is generally thought of as pretty promiscuous behavior. Back on the surface, people are bound to notice that you&#39;re doing so eventually. If not from seeing a glimpse beneath your clothes, then surely someone will notice from the outline of your more sensitive parts if you happen to wear anything light during a hot summer day.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Power Dom&quot;&gt;&gt;
		You just can&#39;t help yourself, you feel the need to try to dominate everything. You&#39;re not sure how the Power Dom curse was able to warp your personality, how it embedded this irresistible compulsion into you, but it sure feels good when it works out. Dominating battles, dominating conversations, dominating someone sexually... you just can&#39;t help but try to do it whenever you get a chance. The problem comes when you aren&#39;t actually able to succeed in the attempt. Sometimes the dissatisfaction you feel makes you wonder if this curse is turning you into a bad person. You don&#39;t want to be cruel or overbearing, you want to help, but you&#39;re having a much harder time dealing with any interaction where you&#39;re not on top. It just makes sense for you to be the one in charge! &lt;br&gt;&lt;br&gt;You&#39;re worried about how many people are going to think you&#39;re a jerk, but if you&#39;re good enough, at leading, at giving pleasure, at talking, at fighting, at everything, then maybe a lot of people will really like who you&#39;ve become. The prospect is daunting, but if you&#39;re going to insist on being in charge, don&#39;t you have the responsibility to make sure you at least do it well? The best way to get better is to practice. When you&#39;re the best no one can deny you your rightful place above them.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;20/20000000&quot;&gt;&gt;
		Who needs vision? Or that must have been what you were foolishly thinking when you were cursed to see either a big dark blur or a big light blur when you don&#39;t have your glasses on. Sure, most of the time you have them on, but when they fall off, or you take them off to sleep, you can&#39;t help but realize just how vulnerable you are. All that someone with hostile intent would need to do is knock off your glasses, then you&#39;d be totally unable to defend yourself without help. You&#39;re not sure whether you think wearing glasses improves your style, or whether your new vulnerability is just a little bit exciting, but your brain is telling you very sternly that trading your vision for a mere 20 corruption points was a not a very good trade after all.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Comic Relief&quot;&gt;&gt;
		AAAGGGHHHH! the Comic Relief curse is driving you crazy. It interferes in your life constantly in subtle ways. When you&#39;re trying to say something you can feel it slightly changing the words that come out of your mouth to make everything sound like a sexual innuendo, leaving you to embarrassingly try to backpedal and only make it worse. People just happen to walk in on you at the most embarrassing moments. You sometimes trip and fall in the most embarrassing ways. Every time it happens, at the edge of your consciousness, you can feel the curse just nudging the universe to make you the butt of a grand cosmic joke. &lt;br&gt;&lt;br&gt;You&#39;d try to explain it to other people, but you&#39;re sure that even if you made the attempt, the curse would just make you sound ridiculous. Well, even if people are laughing at you and blushing about you, at least you bring a bit of entertainment to their lives. You could try to pursue a career as an off-the-wall comedian once you&#39;re done with this, everything you do is hilarious whether you want it to be or not, so maybe you could at least take advantage of the situation!
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Equal Opportunity&quot;&gt;&gt;
		Sexuality is complicated for many people, but less so for you now. The Equal Opportunity curse has opened your eyes to just how sexy everyone can be, just how much pleasure you could get from every kind of person, even people you didn&#39;t find the least bit sexual before. Not everyone is going to be interested in that kind of interaction with you, but that&#39;s okay. There are plenty of fish in the sea. Whether you&#39;re getting pounded by a massive cock or fisting a vagina, your newfound liberation from previous narrow-minded ideas about sexuality has really opened the door to new varieties of pleasure and new people to connect with in that intimate way.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Absolute Pregnancy&quot;&gt;&gt;
		They say that our biology calls on us to reproduce. You&#39;re not so sure about that, but there is something entrancingly intimate about having a living thing growing inside you. During the act of sex, it&#39;s possible to experience that intimacy briefly, but in pregnancy, the intimacy stretches out, grows, and brings a new life into the world. Now that you&#39;ve been cursed with Absolute Pregnancy, you&#39;re going to be experiencing that deep sort of intimacy a lot more. You could try to be celibate, but you know that may not work out no mater how hard you try. &lt;br&gt;&lt;br&gt;The certainty of getting pregnant from any sex means that you&#39;ll always live with pregnancy only a brief moment away. In a sense, it makes your sex feel much more intimate and the consequences much more real. Hopefully they&#39;re consequences that you&#39;ll be happy to live with.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Absolute Birth Control&quot;&gt;&gt;
		The thought of having children always frightened you. Whether it was the responsibility, the agonies, the commitment, or just losing your freedom, it just never appealed to you. It added a layer of hesitancy to your romantic life, it was a risk that could come up at any moment. &lt;br&gt;&lt;br&gt;Now, because of the Absolute Birth Control curse that is bound to you, you never have to worry about that again. You don&#39;t have to let that fear hold back your intimacy any longer. Maybe it&#39;s time to live a little, free of the worry of being tied down to a child. &lt;br&gt;&lt;br&gt;A part of you is sad about never getting a chance to continue your family line personally, but if you really want children then adoption is always available!
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Wacky Wombs&quot;&gt;&gt;
		&lt;&lt;if $app.womb == 1&gt;&gt;
			You feel a twinge of sensation from the area of your $app.womb1 and wonder if you&#39;re pregnant. Could any sperm have found their way into it? You picture yourself with that region of your body swelling with new life, your organs rearranging to make room for it, your balance shifting, and culminating in a messy and painful birth many months from now. Was adding a womb to your $app.womb1 really a smart idea? Smart or not, you&#39;re stuck with it now. Even if you&#39;re not pregnant yet, and that twinge is just a result of the shifting internal folds of your new organs, the Abyss is a strange, perverse, and risky place. How long until someone or something compatible gets the better of you and you end up pregnant? Things are harder to predict down here, and sperm can get into the strangest places... and then start swimming.
		&lt;&lt;elseif $app.womb == 2&gt;&gt;
			You feel a twinge of sensation from two different spots near simultaneously. Your $app.womb1 and $app.womb2 both seem to clench in irritation and then relax. That&#39;s unnerving. You wonder, could you be pregnant in both of your added wombs? Could any sperm have found their way into those spots? You picture yourself with those regions of your body swelling with new life, your organs rearranging to make room for the pregnancies, your balance shifting, with it all culminating in messy and painful births many months from now. &lt;br&gt;&lt;br&gt;Was adding two wombs to your $app.womb1 and $app.womb2 really a smart idea? Smart or not, you&#39;re stuck with it now. Even if you&#39;re not pregnant yet, and those twinges were just a result of the shifting internal folds of your new organs, the Abyss is a strange, perverse and risky place. How long until someone or something compatible gets the better of you and you end up pregnant? Things are harder to predict down here, and sperm can get into the strangest places... and then start swimming.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Omnitool&quot;&gt;&gt;
		Down here, in the Abyss, you&#39;ve been exposed to many things that would be considered very strange back on the surface. Due to the Omnitool curse, you can now even reproduce with other species. Do you want to? Will you have a choice? What lives will your offspring live? Will you end up staying down here with them, trying to bring them back to the surface? The social implications seem like they may outweigh the biological ones. Yet... you&#39;ve heard about dragons that live down here...&lt;br&gt;&lt;br&gt;You mind wanders and wanders, bouncing between the consequences of this curse you&#39;ve found yourself with. There don&#39;t seem to be any answers to many of these questions, and yet you can&#39;t keep yourself from asking them regardless. This curse will certainly keep you awake late on many nights as you consider what the rest of your life may look like.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Gooey&quot;&gt;&gt;
		Gloop, gloop, squelch. &lt;br&gt;&lt;br&gt;These are now the sounds you make while moving around. Taking the Gooey curse has turned you into a creature much like the slimes you&#39;ve heard about in stories and video games from the surface. It&#39;s a truly strange experience being so sticky and malleable, you have a hard time descriving the sensations to anyone who can&#39;t experience it for themselves. &lt;br&gt;&lt;br&gt;Dirt and rocks stick to your feet as you walk, and even slip a tiny bit inside you before the goo that makes up your body instinctively spits them out. Sometimes air gets caught up in your goo and makes funny bubbling noises at it pops back out. You&#39;re a bit more transparent than you used to be, and you have no idea how your organs work now, or if you even have proper organs at all. You can feel that everything inside of you is goo. And while you still have orifices, strangely, you no longer produce excrement. Everything you eat just turns into more goo, but you also shed little bits of goo as you brush against things occasionally. Sometimes when you touch things and your goo spreads out on the surface, you just kind of shlorp it all back up while you slowly pull away. Sometimes little bits of it remain behind, clinging to the surface with their stickiness. That&#39;s not gross, right? Maybe it would seem gross if it weren&#39;t your own body doing it. Perhaps you should ask for a secon opinion? &lt;br&gt;&lt;br&gt;Regardless, that is a distant thought for you because you figured out you can do something really really cool. Even if you stand still, you can manipulate your goo to slowly move you along a surface. You can do it standing up, just slowly gliding over the ground, you can do it lying down, you can do it while adopting all kinds of interesting postures. It&#39;s surprisingly fun! However, you can&#39;t use it to climb vertical surfaces or go upside-down. If you have hand-holds and foot-holds, you can climb just fine, but if you press yourself against a surface and try to move yourself up by your own stickiness, you start to go up, but then kind of just fold down in on yourself from gravity and flop into a deformed version of yourself on the ground and quickly squelch back into your proper shape. &lt;br&gt;&lt;br&gt;You might be all goo, but the goo inside you is more sensitive than the goo outside of you, a lot more sensitive, as you&#39;ve found from some cursory explorations of your body. This curse has certainly radically changed the way you live your everyday life.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Rainbow Swirl&quot;&gt;&gt;
		Ah, colors. Your body is now a work of art. The Rainbow Swirl curse allowed you to choose how to colorize yourself, sort of. It let you turn your skin and eyes into incredibly striking and intriguing colors and patterns, but it absolutely would not let you make yourself look like other humans. In some ways, this change is entirely superficial, but it&#39;s also an expression of who you are, or at least who you&#39;re becoming. From now on, you&#39;ll stand out, especially if you&#39;re showing much skin., and you won&#39;t be able to hide the fact you&#39;ve been touched by the Abyss.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Double Pepperoni&quot;&gt;&gt;
		How much did you think about your nipples before you took the Double Pepperoni curse? You&#39;re not entirely sure, but they&#39;re certainly a very notable part of your life now. They&#39;re just so big, and with so many nerves. When you get back to the surface, are you going to invest in a special bra to try to minimize the sensation, or maybe something to take advantage of it? You feel yourself growing aroused at the idea of somebody taking one of your engorged nipples into their mouth and starting to suck, maybe to gently nibble on it. No, no, no, you try to snap out of the distracting fantasy. You need to focus on surviving, not all the erotic things you want to do with very prominet and very sensitive nipples you&#39;ve found yourself with.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Literal Blushing Virgin&quot;&gt;&gt;
		You&#39;re so nervous, but also really excited to finally lose your virginity. This is all new to you! To be this naked and vulnerable, moving against another person, your body being filled with strange sensations that are a little scary and wonderful at the same time. You don&#39;t really understand, but you&#39;re also feeling a strange sense of deja vu, like possibly you&#39;ve done this before, except you haven&#39;t. You don&#39;t know what comes next. The confusion only heightens the intimacy, the sensations of skin on skin, sweat mingling in this kinetic experience, your body starts to tense up, and then a wave of sensation washes through your loins, flattening your thoughts, driving out everything else. As the moment ends, you shake your head to clear it. &lt;br&gt;&lt;br&gt;Wait, you&#39;ve done this before! Here you were being so passionate about losing your virginity, and it turns out that you&#39;re not even really a virgin? Oh dear. Then you remember the Literal Blushing Virgin curse and sigh. Yeah, the Abyss did this to you. Now that all your experiences have come rushing back to you, you think about all the ways that you could have prolonged the contact, brought out even more ecstasy from the experience, except you couldn&#39;t have, because you couldn&#39;t remember. It seems you&#39;ll never learn to be any better of a lover than you are now. Still, the feeling of something new lingers. You might have had many first times, but you can never forget any of them. It&#39;s impossible to get jaded about something that&#39;s always new!
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Lactation Rejuvination A&quot; || $tempCurse.name == &quot;Lactation Rejuvination B&quot;&gt;&gt;
		Milk. You took on a Curse that made you produce milk from your chest. It&#39;s not that big of a deal, right? &lt;br&gt;&lt;br&gt;Sure, your breasts will gradually swell up, getting more sensitive as your milk ducts inflate, and to take care of yourself every several hours you need to stimulate your nipples sufficiently to initiate let down. It feels rather strange, slightly empowering, slightly erotic, but very wet and a bit sticky. &lt;br&gt;&lt;br&gt;Maybe it is kind of a big deal after all. The biggest question is: what to do with all the milk? It&#39;s not that much, but it feels so wasteful to just let it fall on the ground. Should you maybe... share it with somebody? You&#39;re attempting to survive, and every drop of wasted milk is a drop of fluid and nutrients that you&#39;ll have to try to recover some other way. As you run your fingers over your nipples, preparing to milk yourself again, you lick your lips and think about how responsible it would be not to let it go to waste.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Sleep Tight&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sweet Dreams&quot;)&gt;&gt;
			Sleep calls to you once again. Soon you&#39;ll enter your dreams, where you&#39;ll be in the hands of those odd things the Abyss has conjured up. They&#39;ll do things to you. They&#39;ll warp and change your body to their desires. You&#39;ll be helpless before them, but they will satisfy both themselves and you. Their teeth, their claws, their tentacles and slime, their enormous barbed penises that spear into you again and again, their vaginas that suck you in and hold you there while they vibrate around you with malicious mirth... &lt;br&gt;&lt;br&gt;You are their plaything, but even if they sometimes hurt you, it always feels sublime, and it&#39;s only a dream. The only real thing about them is the orgasms they&#39;ll rip from your body as you cry out during your slumber... or perhaps they&#39;re not as imaginary as you think. The Abyss can perform apparent miracles after all. Are these creatures just in your imagination, or is it an intrusion into your mind by creatures of the Abyss? You&#39;re not sure. &lt;br&gt;&lt;br&gt;Somehow though, no matter how wicked and perverse the things they do to you, you always end up longing for more. You lick your lips and shiver in a mix of anticipation and fear as you close your eyes, and let a new journey begin tonight.
		&lt;&lt;else&gt;&gt;
			Warmth, softness, comfort, letting your mind lazily drift through thoughts and dreams. That&#39;s what half of every day is like for you now. You don&#39;t remember it clearly most of the time, but it&#39;s so nice, and preferable to being awake most of the time. However, you are still getting a lot done in your waking hours. Razor focus often comes upon you, and you feel that your getting close to your purpose for coming down here. Then sleep begins to call you again. You understand why cats sleep so much now; it is glorious to those who can appreciate the peace it offers.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Sweet Dreams&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sleep Tight&quot;)&gt;&gt;
			Sleep calls to you once again. Soon you&#39;ll enter your dreams, where you&#39;ll be in the hands of those odd things the Abyss has conjured up. They&#39;ll do things to you. They&#39;ll warp and change your body to their desires. You&#39;ll be helpless before them, but they will satisfy both themselves and you. Their teeth, their claws, their tentacles and slime, their enormous barbed penises that spear into you again and again, their vaginas that suck you in and hold you there while they vibrate around you with malicious mirth... &lt;br&gt;&lt;br&gt;You are their plaything, but even if they sometimes hurt you, it always feels sublime, and it&#39;s only a dream. The only real thing about them is the orgasms they&#39;ll rip from your body as you cry out during your slumber... or perhaps they&#39;re not as imaginary as you think. The Abyss can perform apparent miracles after all. Are these creatures just in your imagination, or is it an intrusion into your mind by creatures of the Abyss? You&#39;re not sure. &lt;br&gt;&lt;br&gt;Somehow though, no matter how wicked and perverse the things they do to you, you always end up longing for more. You lick your lips and shiver in a mix of anticipation and fear as you close your eyes, and let a new journey begin tonight.
		&lt;&lt;else&gt;&gt;
			You try to keep going, you don&#39;t want those things to get you again. They lurk in your thoughts as sinister laughs and prideful snarls. The things they do to you when you fall asleep... Sleep.... You need to sleep. The last two days you&#39;ve only gotten 4 hours a night, both nights you woke up screaming while also cumming all over yourself. The mix of terror and ecstasy left you confused and exhausted. &lt;br&gt;&lt;br&gt;You don&#39;t want to be at the mercy of those things again, and yet... part of you is loving the things they do to you. You were cursed with Sweet Dreams, that has to be what&#39;s causing your strange nightmares, but... you&#39;re too tired. They&#39;re just dreams. You&#39;re a person. People can adapt. Part of you expects that you&#39;ll find a way to deal with this new reality the Curse has bestowed on you. &lt;br&gt;&lt;br&gt;In truth, more than half your fear is of your own adaptation. What kind of person will you have to become to sleep peacefully through the night? Probably one who enjoys and accepts all the strange and bizarre ways that the creatures in your nightmares milk orgasms from you. You can&#39;t keep your eyes open any longer, you&#39;re just too tired. Maybe this time won&#39;t be so bad.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Crossdress Your Heart&quot;&gt;&gt;
		&lt;&lt;if $app.sex==&quot;male&quot;&gt;&gt;
			Skirts, dresses, and billowy blouses with ruffles and lace. Panties, bras, and not a single pair of pants in sight. That&#39;s what you feel most comfortable in right now, as embarrassing as it may be to be seen like that, in very feminine attire, that&#39;s what feels right. You can deviate from it a little bit, but deviate too much and before long the Crossdress Your Heart Curse starts taking a hold of you and pushing you in the right direction once again. Your penis feels quite strange wrapped in a lace thong as you move around in your light pink sundress. &lt;br&gt;&lt;br&gt;You feel constricted, knowing that you&#39;re going to have to dress like this or similarly for the rest of your life, but somehow, you also feel free, beautiful; like you&#39;re trapped, but that it&#39;s wonderful at the same time. So much artistry and care went into these clothes, and at the center of them is you. It makes a warm little special feeling light up in your chest. Is it the Curse making you feel this way, or is this what you always wanted to be forced into?
		&lt;&lt;else&gt;&gt;
			Recently you&#39;ve been completely unable to wear bras, and your chest hangs free, unsupported and sometimes leaving a nipple poking through your shirt. Power suits, muscle shirts, loose fitting pants and boxers are what you feel most comfortable in now that the Crossdress Your Heart Curse has taken a hold of you. If you go swimming, you know that you&#39;ll only be able to wear a pair of swim trunks, nothing covering your upper body. If you try to veer towards clothes that are gender-neutral, the Curse takes hold and picks the most masculine thing you can think of. &lt;br&gt;&lt;br&gt;You can&#39;t even wear pants tailored for women! Wear a belt. In one sense, many women have been cross-dressing semi-frequently for a very long time. In another sense though, you&#39;re taking that practice far further than most would dare. You&#39;re worried that if you actually tried to wear something feminine that the Curse would somehow leave you topless, wearing only a loincloth, and dripping in sweat. You only feel comfortable when you&#39;re wearing dark colors in masculine styles. You&#39;ll need to be mindful of the other Curses you have. The larger your breasts are, the more you&#39;re going to stand out, as none of these clothes are tailored to accommodate them very well.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Lie Detector&quot;&gt;&gt;
		The Lie Detector Curse has really messed with your ability to communicate. You used to be able to be polite and say things that were nice, even if they weren&#39;t entirely true. Now your true thoughts always shine through your words. Other people don&#39;t seem to consciously understand that the Abyss has helped them see through you, they just have keen instinct into what you mean. There are times though that before you would have told a lie to people who had no business asking you something. You used to tell half-truths, carefully phrased so that deception may have been involved, but you weren&#39;t really lying. Doing that now just results badly. &quot;What aren&#39;t you telling me?&quot; is the most common response when you say a half-truth. For some things it might not matter, but for others it does. You&#39;re going to have to get better at saying nothing. The silver lining to all this is that trust is deeper. People might not understand why they trust you when you&#39;re honest, why they feel like they understand you better, but they do. You&#39;re wearing your heart on your sleeve, but you think your heart isn&#39;t so bad, and at least some people will have an easier time appreciating you for who you really are.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Megadontia&quot;&gt;&gt;
		Your teeth are so much more imposing with the Megadontia Curse&#39;s influence on you. They&#39;re fantastic for ripping into meat, for grabbing things, and for intimidation, but they&#39;re really not suited to chewing vegetables or even talking without a slightly strange new accent. You&#39;ve had to adjust the way you move your tongue in your mouth to avoid getting it caught on all these sharp teeth, and while you can definitely talk, but your voice just sounds... different. The way you pronounce things has changed, and your smiles are positively crocodilian. Almost all animals react to the sight of your many teeth that are so large and so sharp. Did you realize you would look like a natural carnivore when you took this Curse?
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Lingual Leviathan&quot;&gt;&gt;
		Tongues are absolutely amazing. They&#39;re incredibly strong, ridiculously flexible, they heal quickly, and they&#39;re covered in sensitive taste buds. But your tongue though goes a bit overboard. When you extend it, it has 30 cm of controllable, prehensile reach. Because you&#39;re creative, you understand just how awesome this can be, however, the downsides are pretty obvious too. Talking normally has gotten a little trickier, since you just have so much tongue in your mouth! &lt;br&gt;&lt;br&gt;You are also struck with an observation you&#39;d never realized before: many of the animals with truly glorious tongues, like frogs, have lost their teeth. If your tongue is good enough, teeth sort of only become a hindrance and liability. Maybe the Abyss will offer you some way to replace yours with smooth ridges of bone... which would be very weird, but perhaps more practical. This much tongue though, it wants to be doing something. Just having it cramped up in your mouth all the time makes you restless. Perhaps you can put it to use on yourself or someone else who may want some oral attention.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Tipping the Scales&quot;&gt;&gt;
		You stretch out on a rock, and see the faint iridescence of your $curse54.variation scales. It&#39;s a big change from what your skin used to be like, and is a mark that some parts of your physical humanity have been consumed by the Abyss. There&#39;s no point mourning what is gone though, and your scales are magnificent. They make you feel tough and confident, plus they look quite attractive to anyone who is inclined towards them. They&#39;re only on the outside though, and the skin inside you is not armored like your exterior. The contrast draws even more of your focus onto anything that manages to get past your scaly armor.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Reptail&quot;&gt;&gt;
		Your large, scaly tail drags on the ground behind you. You could hold it upright, but at the moment you&#39;re trying to look around, and it&#39;s much easier this way rather than needing to put the effort into holding it up. If you want to keep it above the ground, it&#39;s almost like standing on your tiptoes for long periods of time. &lt;br&gt;&lt;br&gt;You also hadn&#39;t anticipated just how much the Reptail Curse would alter your center of balance! Your tail is marvelous, powerful, strong, delightfully armored in elegant scales, but it actually is pretty heavy with its thick and muscular shape. When the Abyss bestowed the Curse on you, there were some other subtle things that you felt changing in your backbone and pelvis. Your body rearranged itself to be able to cope with such a large addition, but when walking on two legs it means you need to lean forward much more to maintain your balance, but less so when you let your tail drag. This tail is going to come in handy for self-defense, and it&#39;s going to be amazing for swimming, but sometimes it can also be cumbersome and get in the way. Part of you thinks about how far forward you&#39;re frequently leaning, and how close your arms are to the ground, and wonders if it wouldn&#39;t be more practical to start using your hands to help you move forward, scurrying around like a lizard.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Cold Blooded&quot;&gt;&gt;
		Cold isn&#39;t painful, it isn&#39;t stressful, but a little bit makes you feel very lethargic, and a lot makes you fall into a peaceful, sleep-like state. Even your thoughts slow down in the cold. Ever since you obtained the Cold Blooded Curse your metabolism has been wildly different. Now that your body isn&#39;t wasting so much of the energy you get from food on making heat, you&#39;ve theoretically got a lot more energy for other stuff and when you&#39;re warm you feel so powerful! You can run around, lunge with enormous force, and you feel like as long as you can get enough oxygen to your muscles you can just keep going. &lt;br&gt;&lt;br&gt;In the cold though... well, sometimes it&#39;s nice and relaxing to be slow, sometimes it can help you rest, but if you even want to think clearly you have to drag yourself somewhere warmer. If you end up staying down here in the Abyss, you&#39;re going to want to take this into account. Some layers are going to be much more hospitable to you, while others are just going to be miserable.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Pleasure Respecification A&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification B&quot;)&gt;&gt;
			Your ragged breathing is a sign of what the Abyss has done to you. You&#39;re so horny right now that you can&#39;t think. Every time you try to get yourself off, you get so close, so tanatlizingly close, but you&#39;re never quite able to achieve orgasm. Every time you&#39;re fucking somebody else, the same thing happens. The feeling of need just keeps building, but there&#39;s never any relief. You calm down a little, but has anyone ever been this sexually frustrated? &lt;br&gt;&lt;br&gt;The terrible truth is dawning on you. Only the Abyss can give you what you need. There are Curses that force you to have an orgasm, that circumvent all other rules and logic. Curses that will give you what you need. That&#39;s your only salvation now. Seek out those Curses and achieve release through the twisted and perverse whims of the Abyss. It&#39;s either that or stay this desperately horny and frustrated for the rest of your life.
		&lt;&lt;else&gt;&gt;
			Touching yourself feels amazing, but the pleasurable haze that clouds your mind only culminates in release when you&#39;re being touched by someone else... or fucking them. It&#39;s incredibly frustrating. The Abyss has done so many things to tempt you down the path of sex addiction, but with all of that, now you can&#39;t even obtain temporary relief on your own. You &quot;need&quot; to be with somebody else, or tat least hat&#39;s how you feel right now. The intensity of carnal relations with another person has only grown now that it&#39;s your only source of release. You need to be pressed against them, cumming your brains out. Nothing else will satisfy you, and you&#39;re just so horny!
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Clothing Restriction C&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;)&gt;&gt;
			Oh gosh, you&#39;re perpetually naked now. No underwear, no clothes, no armor, just flashing everyone and everything all day long. If you&#39;re going to do anything but draw open-mouthed stares, you&#39;re going to have to get really good at using convincing body-paint, but even that won&#39;t work if anyone looks at you especially hard. Wherever you end up, this is going to have a big impact on your life. And there&#39;s no way to even unintentionally wear clothes, since the Curse makes them degrade immediately if you even attempt to get around it. &lt;br&gt;&lt;br&gt;Maybe being naked isn&#39;t so bad, humans are the only creatures on the surface that wear clothes anyway. But when you think about everyone staring at your naked body, always, it conjures up a wild mix of emotions: embarrassment, fear, lust. If you live anywhere but a nudist colony, you&#39;re going to run afoul of a bunch of prudish people, or end up being followed by a bunch of horny people, let alone any laws you might be breaking!
		&lt;&lt;else&gt;&gt;
			Underwear is as much as you can ever wear now. You have a deep feeling in your gut that if you even tried to put on a swimsuit, the Curse you took would prevent it. No, your underwear needs to really be underwear, and everyone is able to see it all the time. How many situations is that going to be appropriate in? You can think of very few that aren&#39;t supposed to be intimate or private. &lt;br&gt;&lt;br&gt;As you explore another layer of the Abyss, you look down at your underwear and feel very vulnerable. In this context, you look like you&#39;re either soliciting sexual interactions, or like you lost your clothes and are in a desperate situation. You&#39;re not sure which one is worse.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Massacre Manicure&quot;&gt;&gt;
		Your claws are magnificent, but aside from dishing out painful slashes and catching things, they&#39;re not especially practical. In some situations they can help with climbing, but only if they can dig into the surface and find a hold. There are many tasks that have become more difficult, including social interactions. Unsurprisngly, many react with a bit more trepidation to a hand covered in claws. &lt;br&gt;&lt;br&gt;There are things you could do to hide them, but some of them make you instinctively fearful of the possibility of one of your claws getting stuck. You&#39;ve already experienced that once and it was agonizing as you dug your claw out. And regardless, it&#39;s not like the Abyss lets you hide the effects of a Curse for long. &lt;br&gt;&lt;br&gt;There are a number of small ways that these are going to change your habits, but when you were Cursed with these calws you knew there would be consequences. All things considered, you can deal with this, but it&#39;s one more way the Abyss has changed you. You sure hope the Relics are worth it.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;S&quot;&gt;&gt;
		Sadism. &lt;br&gt;&lt;br&gt;One of the cardinal vices. An attribute that has driven countless individuals into unspeakably evil acts. Yet, you are now one of the most adamant followers of sadistic pleasure. What does that say about you? &lt;br&gt;&lt;br&gt;Yesterday you nearly had an orgasm from violently squashing a bug. Sex is just going to be boring if you&#39;re not making someone else feel pain. True masochists might enjoy the experience with you, but you&#39;re now too extreme for nearly anyone else to have a good time succumbing to your cruelty. Hunting has become an erotic sport for you, but any decent hunter would be appalled when you fail to stop yourself once you get your hands on the prey. The pleasure that suffuses your mind and body just feels so good. Are you turning into some kind of monster?
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $tempCurse.name == &quot;M&quot;&gt;&gt;
		Masochism. &lt;br&gt;&lt;br&gt;Oh, why do you feel this way? The Curse, you suppose. It&#39;s so wrong, but you struggle to stop yourself now. &lt;br&gt;&lt;br&gt;You&#39;re poking yourself just to feel better. When you get back to the surface, you&#39;re dreaming of covering your body in tattoos and piercing absolutely everywhere. Not so much because you want that appearance, but when you imagine the pain of a needle piercing your skin, you can hardly stop yourself from getting excited. When you think erotic thoughts, you think of being whipped, of hot wax dripping onto your skin, of being fucked so hard that you scream out from it. &lt;br&gt;&lt;br&gt;This isn&#39;t healthy, but as you withdraw a fingernail from an indentation it was making on your arm you still find yourself wanting more. You restrain yourself for now. Wait, is the absence of pleasure sufficient pain that it will cause some kind of pleasure of its own? That paradox scrambles your brain for a bit. Are nuns and monks secretly masochistic perverts who get off on their own self-denial? That thought seems rather taboo and a little unlikely, but it also opens up a little window for another path you could walk to extract some positive feelings from what this Curse has done to you.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Hijinks Ensue&quot; &amp;&amp; $currentLayer &lt;= 5&gt;&gt;
		You&#39;re not sure if the Abyss hates you, or if it&#39;s just trying to turn you into a naughty slut, but the Hijinks Ensue Curse has certainly gotten you into quite a few embarrassing situations. There was that guy you were walking past on the trail, when you tripped on a rock that hadn&#39;t been there a second before, and you flung out your arms for support, but the only thing they encountered were his pants! Somehow, his pants came unbuckled as if his belt wasn&#39;t even there, his pants and underwear slid down as you crashed into him, and you face-planted into his crotch with his improbably erect penis in your MOUTH! &lt;br&gt;&lt;br&gt;You must have looked like some super-slutty ninja pulling that off, except you were just trying to walk down the trail! Then there was the tree-branch incident... actually, you don&#39;t want to think about that, it was just too embarrassing. Somehow, you think the Curse is helping you get out of some of the consequences, nudging things into not being dangerous or detrimental in the long term, except for the embarrassment, and the damage to your reputation.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Flower Power&quot;&gt;&gt;
		Having leaves and flowers for hair is actually pretty nice, except for the occasional bugs it attracts. You used to feel when something brushed against your hair by the nerves in your scalp, but hair is mostly dead cells, and your new floral coating is very much alive. Now, you can notice any time something brushes against your much more sensitive hair, and haircuts may not be the most pleasant experience, as you feel a pinch any time you break off one of your hairs. &lt;br&gt;&lt;br&gt;The flowers might have been a bad idea. You always thought of them as pleasant, but you hadn&#39;t thought about how they&#39;re essentially plant sex organs waving around inviting every pollinator in the world to interact with them. You suspect that plants experience the process a bit differently from you, but when a bee is rustling against your stamens and drinking your nectar, it feels like a toned down version of sexual activity, only it&#39;s on your head. You also caught a caterpillar munching on the leaves on the back of your head. It was only briefly, and you experienced it more as discomfort than pain, but the indignity of it all. How dare that caterpillar presume so much as to munch on you! &lt;br&gt;&lt;br&gt;Still, the gentle breeze beneath your leaves and flowers makes everything more relaxing. It&#39;s going to be a lot harder to live normally back on the surface like this, but overall you are enjoying the Flower Power Curse.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Cellulose&quot;&gt;&gt;
		If only the Cellulose Curse had included a bit more lignin, the compound that makes plants more stiff and strong, and a little less cellulose. If your skin was made of lignin you&#39;d be more like a dryad, and dryads are awesome. They&#39;re so tough and hardly anyone would be stupid enough to try to fight a lignin-hardened dryad. &lt;br&gt;&lt;br&gt;You though, your skin is made of cellulose, it&#39;s more supple, a bit more delicate, and while it&#39;s kind of nifty, you&#39;re pretty terrified of how flammable you are now. Still, your new skin isn&#39;t all bad. If you had to blend in with a bunch of foliage, you&#39;d have much more success, without even needing to paint yourself in camo. &lt;br&gt;&lt;br&gt;However, going back to the surface is going to be much more socially difficult now. The change might be superficial, but people are often focused on the superficial and other creatures are even starting to treat you more like you were a plant. You think that carnivores might ignore you, but you&#39;ve suddenly realized that things like termites, giraffes, and even cows, are going to look at you like a buffet. You never thought you&#39;d be afraid of a cow.... but some instinct of self-preservation is warning you that you shouldn&#39;t get too close to them.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Chlorophyll&quot;&gt;&gt;
	As the miasmic light shines against your skin, you feel rejuvenated. The Chlorophyll Curse changed you in some pretty fundamental ways. You now have chloroplasts within your cells, like a plant. Some biologist would surely love to examine what happened more closely, but this is just who you are now. &lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;Perhaps Saeko may want to examine you? She doesn&#39;t have her equipment, but you&#39;ve noticed she has been looking at your more closely since your change. &lt;&lt;/if&gt;&gt;Your skin has taken on a greenish hue. Even your dreams are filled with visions of standing naked in sunny fields as a gentle wind rustles the grasses at your feet. &lt;br&gt;&lt;br&gt;As long as you have light, water, and air, you feel profound peace suffusing you. The people and animals you once found so normal now seem just a bit strange to you. They just seem so agitated as they buzz about. You can still act like them, but there&#39;s now a part of you that asks if it wouldn&#39;t be nicer to slow down and bask in the light.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Pheromones&quot;&gt;&gt;
		Is that love in the air? Perhaps, or maybe it&#39;s just the aromatic cloud of pheromones that you have streaming out of you thanks to the Curse the Abyss bestowed on you. It&#39;s a very subtle change, except when it&#39;s not so subtle. You definitely could use this to your advantage if you wanted to, but your inability to turn it off also makes it a pretty clumsy tool for manipulation. &lt;br&gt;&lt;br&gt;It&#39;s great if what you want is to have better sex, or take advantage of people, or be in the middle of a giant orgy. But if you want to be part of a group working on some task, you&#39;re going to need to stand downwind of everyone else, lest their bodies start distracting them from the task at hand. You&#39;ll have to test that, blowing your pheromones around. Are they magical in themselves, or has the Curse just made you produce more of something you were already producing?
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Carapacian&quot;&gt;&gt;
		Your exoskeleton is just so cool. It&#39;s like being encased in shiny hardened latex in some ways. It protects you, but it doesn&#39;t really dull the sensations you experience. You feel... snug inside your new chitinous armor. You can still feel everything you brush against, indeed, it&#39;s almost like your nerves have compensated, and the sensations are even more acute. They just don&#39;t hurt unless something could pierce your outer layers. And there are other sensations, more internal. You feel... a bit squishier inside. You don&#39;t know what that means, but it feels fine, so you&#39;re going to just roll with it.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Hemospectrum&quot;&gt;&gt;
		Changing the color of your blood for 35 free corruption points? What an easy decisions. Now though, as you look at that small scrape you got earlier, and see the $curse70.variation blood that has dried into a scab, you can&#39;t help but think about how this marks you as very different to any other human who sees you bleed. &lt;br&gt;&lt;br&gt;It&#39;s subtly changed the coloring in your eyes, of the veins beneath your skin, you feel... less human. If they see you bleed, won&#39;t other humans see you as less human too? They might be afraid of you. Frequently people fear what they don&#39;t understand, right? When you set off into the Abyss, you knew you&#39;d be changed, but these subtle reminders about how you keep changing are warping your identity. What are you now?
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Wriggly Antennae&quot;&gt;&gt;
		Your antennae might shock and initially creep out many people, but they also definitely boost your senses. Subtle changes in the air stand out to you in ways you never noticed before. They respond to your thoughts, but you&#39;re not very good at controlling them yet. Their sensitivity affects you in one way you hadn&#39;t expected though. Gently rubbing them arouses you, awakening a deep warmth within you and a desire for someone else to touch them. You don&#39;t know what&#39;s going on in your brain, or why your body is responding this way, but you get the feeling that sufficient stimulation of your antennae might just send you over the edge. It&#39;s a bit of an awkward realization.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Eggxellent&quot;&gt;&gt;
		Your eggs. &lt;br&gt;&lt;br&gt;You hadn&#39;t really understood what laying eggs would be like before you obtained the Eggxellent Curse, but now... well, it&#39;s an intense experience. Not quite painful, but they are large enough where the sensation borders on pain. As you look down at the small pile of eggs that just came out of you, you realize this is a bigger change to your life than you&#39;d anticipated. As you recover, the memory of how those large, smooth, slippery eggs felt as they came out of you clings in your mind. &lt;br&gt;&lt;br&gt;Not just any eggs though, your eggs.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Pleasure Respecification B&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification A&quot;)&gt;&gt;
			Your ragged breathing is a sign of what the Abyss has done to you. You&#39;re so horny right now that you can&#39;t think. Every time you try to get yourself off, you get so close, so tanatlizingly close, but you&#39;re never quite able to achieve orgasm. Every time you&#39;re fucking somebody else, the same thing happens. The feeling of need just keeps building, but there&#39;s never any relief. You calm down a little, but has anyone ever been this sexually frustrated? &lt;br&gt;&lt;br&gt;The terrible truth is dawning on you. Only the Abyss can give you what you need. There are Curses that force you to have an orgasm, that circumvent all other rules and logic. Curses that will give you what you need. That&#39;s your only salvation now. Seek out those Curses and achieve release through the twisted and perverse whims of the Abyss. It&#39;s either that or stay this desperately horny and frustrated for the rest of your life.
		&lt;&lt;else&gt;&gt;
			Getting fucked feels amazing, but the pleasurable haze that clouds your mind only culminates in release when you&#39;re the one touching yourself. It&#39;s frustrating and a bit embarrassing when you can&#39;t finish with another person. In so many cultures masturbation is taboo, and while you&#39;re not ashamed of doing it, the fact that it&#39;s the only way you can get off now makes your cheeks burn hot. The Abyss has done so many things to tempt you down the path of sex addiction, but with all of that, now you can&#39;t even properly enjoy sex! When you took the Pleasure Respecification B Curse, you now realize that the Abyss was asking you &quot;Hey, do you want to go fuck yourself?&quot; and you responded with &quot;oh yes, I want to be fucking myself all the time&quot;. Somehow, that thought has become more erotic than it once would have been. Tonight you&#39;ll slink off and masturbate alone, and it will feel so, so good.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Horny&quot;&gt;&gt;
		You always wondered why all the depictions of incubi and succubi that you&#39;d seen just has them standing around looking pretty or using magic, or fighting like humans with extra agility. They always have those horns on their heads, but they never seem to use them like horns are supposed to be used, for goring or ramming. Well, now that you have your own thanks to the Horny Curse, you understand. They&#39;re not meant for fighting. They&#39;re essentially extra sexual organs that are sprouting out of your head. &lt;br&gt;&lt;br&gt;You&#39;re pretty happy with how yours look, but you have to admit that aside from being a bold fashion choice, these horns are simply a liability. Maybe true incubi or succubi could draw sexual energy through them or something similar, but for you, twirling your fingers around the tips of them is enough to bring you to orgasm, and the same is true if you rub the shafts enough. The thought of ramming them into anything though... well that&#39;s too painful to consider. When you smacked them into a low hanging branch it briefly left you curled into a ball from the pain. Your new distinctive appearance is almost secondary to the sensitivity of your new appendages. It&#39;s a lot to take in, but maybe you&#39;ll get more used to it over time.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Drawing Spades&quot;&gt;&gt;
		Your spade-tipped demon tail is just so naughty. You can feel the sensations from it, but it really has a mind of its own. You once came across a rabbit that had just reached sexual maturity, and it tried to have sex with absolutely everything around it. You&#39;re wondering if your tail has a similar spirit. It wraps around other people, especially any you find attractive, and it finds its way into their clothing if you don&#39;t pay attention and consciously hold it back. When you&#39;re alone, it tries to do the same to you. &lt;br&gt;&lt;br&gt;If you really focus, you can control it, but it&#39;s easy to get distracted and then it once again tries to stimulate you. It seems to cooperate when you&#39;re in need of navigating obstacles or dealing with danger, but the rest of the time it seems focused on how it can make the most mischief, generally of the sexual variety. It&#39;s really annoying! But some part of you wonders whether it&#39;s only responding to what you subconsciously desire.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Tattoo Tally&quot;&gt;&gt;
		You feel a mix of embarrassment, shame, and pride as you look at the ornate Tattoo Tally that&#39;s permanently inked into your abdomen. It&#39;s not the only tattoo left by the Curse, and it&#39;s the one that&#39;s easiest for you to cover up, but when you look at it, the details of every lewd thing you&#39;ve ever done or experienced jump into your mind. The people and beings that glimpse your tattoos stare at you. Their expressions take on various shades of hunger, wide-eyed lust, disgust, and envy. When you&#39;re not trying to inspire any of these emotions, it&#39;s very inconvenient, but... part of you wonders what you really do want going forward. Perhaps those aren&#39;t necessarily bad emotions to inspire. When you look at the tattoos yourself, they bring many thoughts and memories to your mind, but arousal always comes with them.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Leaky&quot;&gt;&gt;
		You might need to consider getting some super absorbent sanitary pads, ones that you can change out every few hours. The Leaky Curse isn&#39;t just keeping your crotch moist, it&#39;s dripping your juices down your legs. It&#39;s not entirely unpleasant, a gentle euphoric feeling accompanies your condition, and offsets the irritation the stickiness causes. &lt;br&gt;&lt;br&gt;However, the way the few other explorers you have encountered since you took on this Curse have looked at you has been awkward at best. One seemed to think you were wetting yourself, another caught on to what was happening and started giving you very lurid looks. The worst part is, this constant leakiness is not relieving arousal, it just makes you constantly ready. Maybe the lurid looks you got were in equal part due to your own appareny desperation.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Wandering Hands&quot;&gt;&gt;
		Your naughty, naughty fingers seem to be on auto-pilot whenever you&#39;re not forcing them to do something else, and autopilot is apparently fondling you and touching yourself in lewd ways. How many times a day do you find your hands doing something naughty? The answer is: constantly. The Wandering Hands Curse is unrelenting, always trying to edge you into sex addiction. It doesn&#39;t matter what you&#39;re trying to do, start a fire, draw a map, discuss a plan with others, before you know if you&#39;ve got at least one hand rubbing between your legs.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Urine Reamplification A&quot;&gt;&gt;
		Pee... why did you take a Curse that makes you have to pee all the time? You&#39;re still continent, you can control it, you can hold it, or that&#39;s what you tell yourself. In truth, having to find a place to pee every fifteen to thirty minutes is quite a nuisance, and you&#39;ve had multiple accidents while sleeping. Down here, it&#39;s a nuisance, but there are plenty of trees and rocks. What about back on the surface though? You&#39;re afraid of the social ramifications to this Curse. You might even have to start wearing diapers.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Barter System&quot;&gt;&gt;
		These reality warping Curses always seem to surprise you. When you accepted the Barter System Curse you didn&#39;t quite see yourself giving three guys blowjobs so you could replace the pair of shoes that you brought with you that have finally worn out. Once upon a time, when you didn&#39;t have money, those with goods to sell would fold their arms and expect you to leave. Now, the Curse seems to make them go far out of their way to find some way that you can get what you want by doing enough sexual favors for them, their friends, their clients, their workers, and on and on. &lt;br&gt;&lt;br&gt;You&#39;re pretty sure that before you obtained this Curse, none of those people would have been interested, and none would have been shameless enough to actually work through an elaborate exchange of goods, favors, and funds on your behalf just so that you could purchase what you wanted by being a massive whore. When you get back to the surface (if you get back) you&#39;re half-inclined to try to use this Curse to buy a house, or a mansion, or a country. You&#39;re just curious what would happen, but also afraid that it might work, but that when you involve that many people in a proposal, you can&#39;t just say &quot;no&quot; after everything is worked out. Would you be forced to be a sex slave for life in return for buying an estate?
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Shared Space&quot;&gt;&gt;
		One of the reasons so many people love pets is that they feel like they have permission to pet them, to hold them, to snuggle with them whenever they feel like it. And ever since you obtaiined the Shared Space Curse, people treat you like that, with one crucial difference. People generally don&#39;t have any sexual interest in pets, but they definitely have sexual interest in you. &lt;br&gt;&lt;br&gt;Somehow, the Curse makes it so that even as people put their hands all over you in very inappropriate ways, everyone watching treats it as normally as a person petting a cat. The people groping you don&#39;t even realize they&#39;re doing anything too forward. All their perceptions around you are altered. You struggle with the change, and how you feel about it. Is it really the fault of others that they&#39;re treating you in accordance with the Curse? Is this how you want to be treated? You&#39;re still not sure. However, as abrupt as the touches of others can be, they&#39;re normally kind enough, and sometimes quite pleasant.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Weakling&quot;&gt;&gt;
		Taking the Weakling Curse has made you keenly aware that you&#39;re absolutely unable to defend yourself. The only thing you could wrestle is an empty cardboard box, and even then probably only if it&#39;s wet. Anyone else you encounter, everything else you encounter, they aren&#39;t just stronger than you, they&#39;re comically stronger than you. More than that though, just moving all your stuff around has become far more difficult. &lt;br&gt;&lt;br&gt;That carry weight limit that they kept talking about on the surface is very real, and yours is now very low. Even that is a struggle for you though. It&#39;s a weird feeling. You can move about just fine with your body, but every bit of weight added to your body feels like its weight has been magically augmented on an incredible scale. You&#39;d have as much luck lifting a mountain as lifting another person. But you can climb things as easily as ever as long as you&#39;re not carrying too much extra stuff. You swear, you can almost hear the Abyss snicker when you forget about your own weakness and fail to pick up something that should be relatively trivial and struggle.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Random Orgasms&quot;&gt;&gt;
		When you took the Random Orgasms Curse, you hadn&#39;t expected just how disruptive it would be to your everyday life. The other day you were trying to scale a small cliff when a random orgasm racked your body and very nearly made you fall off the cliff face. Death by orgasm, that would have been pretty embarrassing. &lt;br&gt;&lt;br&gt;You&#39;re certain that the social ramifications are going to be very awkward, but now, after the cliff incident, you find yourself approaching every task by first asking &quot;What happens if I randomly orgasm while doing this?&quot;. As humiliating as your condition is, as scary as it makes some things, the euphoria you feel during these intense events is undeniable. Even as part of you fears the next toe curling orgasm that will hit you, another part craves it, and that part seems to be growing.
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Creature of the Night&quot;&gt;&gt;
		&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction A&quot;) &amp;&amp; $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;)&gt;&gt;
			You truly are a creature of the night now, not so much because vampires can&#39;t shelter from the sun while still being out in the day, but because you took this Curse in conjunction with multiple clothing restriction Curses. Some people say that vampires can turn into bats, that&#39;s not true, or at least you can&#39;t (you tried) but then you realized it hardly matters because you were already total dingbat to pick this combination of Curses. You&#39;re not just a vampire, you&#39;re &quot;the&quot; naked vampire. Going out exclusively in the dark is going to be very inconvenient, especially given your new thirst for blood and the fact that you can&#39;t enter anyone&#39;s home unless they give you permission. You absolutely have to drink blood now, but wherever you end up living you&#39;re probably going to have to reach some consensual arrangements to satisfy your thirst. You shiver at the prospect of what others might demand from you in exchange for both their blood and keeping your secret. Unless you&#39;re lucky enough to get some incredible combination of relics that can turn you into a super-fast super-strong predator, consensual feeding is probably your only option to keep your thirst fulfilled.
		&lt;&lt;else&gt;&gt;
			When the Abyss gave you a Curse as straightforward as Creature of the Night, you were sure there had to be a catch. Become a vampire? That&#39;s rather straight forward, isn&#39;t it? Well, there sort of wasn&#39;t a catch, except that drinking blood feel amazing, and being without it for a long time is an agony that would drive you mad. Also you need to be very careful around the sun to make sure whatever clothing and accessories you have are adequately protecting you. Going forward, you think you have 2 options. You can either find some willing blood donors for you, which would put you in their debt and might put you in an awkward position, or you could become a transient, finding victims through surprise or guile getting a meal, and then moving on. Technically, you&#39;re not alive anymore, but semantics aside, it&#39;s up to you what kind of life you want to try to live.
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Minish-ish&quot;&gt;&gt;
		&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
			Thank goodness you didn&#39;t come down here alone. Now that the Minish-ish Curse has reduced you to mouse-like size, you&#39;re relying on a companion to carry basically everything for you. There are advantages to being this small. You can squeeze into tiny little places... don&#39;t think about that too much. Your ability to move and jump might be lower than it once was in objective terms, but for your size, you can do some amazing stuff. You can jump more than your entire body height, since being light has its advantages. Still, yesterday you were tired of running and asked $hiredCompanions[0].name to carry you. Their hands felt so huge around you, but in an odd way, it was wonderfully comforting and exciting.
		&lt;&lt;else&gt;&gt;
			Oh no, this is a disaster. The Minish-ish Curse has left you so tiny and you came down here alone. You&#39;re going to have to act like a squirrel and run back and forth with individual food parcels and individual bottles of water, moving them from 1 pile to another, if you want to get anywhere while still keeping even your food with you. Some relics are now impossible for you to move! What are you going to do? More than that, you&#39;re afraid of just leaving your stuff in a pile. What if some one or something sees it and just helps itself? Burying your supplies really is starting to make a lot of sense in this context. If only you had somebody big to help you on this giant journey, but you don&#39;t. This is going to be very tough.&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $tempCurse.name == &quot;Colossal-able&quot;&gt;&gt;
		It&#39;s not fair. You&#39;re huge. You should be able to move quickly, and you can, except the Abyss is so treacherous that everything is cramped. Cliff side paths you could once have walked along now are merely a crevice to put the first joint of your fingers in. Your body is tough enough to endure some of your new tribulations, but walking through a forest now means snapping dozens of tree branches with every step, or carefully lifting up your legs over the treetops and setting them down ahead of you (a process that still is not gentle for either you or the trees). Small trees are like prickly ground-cover to you, but large ones are like brambles that you have to wade through. Then there are cavern ceilings, which sometimes are low enough to force you to crawl or stop you altogether. &lt;br&gt;&lt;br&gt;You could carry a small house in your hand, but ugh, everything is just so awkward now. There are some layers of the Abyss where you might feel comfortable taking up residence, and on the surface you&#39;d be... very notable, but certainly able to stretch out. You&#39;re going to have to change the way you live life though. Your new size just doesn&#39;t match many of the skills you previously practiced.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="101" name="StoryInit" tags="" position="100,1350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ocarryWeight = 0&gt;&gt;
&lt;&lt;set $carryWeight = 0&gt;&gt;
&lt;&lt;set $totalCarry = 0&gt;&gt;
&lt;&lt;set $dubloons = 0&gt;&gt;
&lt;&lt;set $firstDescent = 0&gt;&gt;
&lt;&lt;set $debt = 0&gt;&gt;
&lt;&lt;set $corruption = 0&gt;&gt;
&lt;&lt;set $time = 0&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;set $forageFood = 0&gt;&gt;
&lt;&lt;set $corRed = 0&gt;&gt;
&lt;&lt;set $timeRed = 0&gt;&gt;
&lt;&lt;set $statRed = 0&gt;&gt;
&lt;&lt;set $bullRed = 0&gt;&gt;
&lt;&lt;set $sellAdd = 0&gt;&gt;
&lt;&lt;set $abyssKnow = 0&gt;&gt;
&lt;&lt;set $timeL1 = 0&gt;&gt;
&lt;&lt;set $timeL2 = 0&gt;&gt;
&lt;&lt;set $timeL2T1 = 0&gt;&gt;
&lt;&lt;set $timeL3 = 0&gt;&gt;
&lt;&lt;set $timeL3T1 = 0&gt;&gt;
&lt;&lt;set $timeL3T2 = 0&gt;&gt;
&lt;&lt;set $timeL4 = 0&gt;&gt;
&lt;&lt;set $timeL4T1 = 0&gt;&gt;
&lt;&lt;set $timeL5 = 0&gt;&gt;
&lt;&lt;set $timeL5T1 = 0&gt;&gt;
&lt;&lt;set $timeL5T2 = 0&gt;&gt;
&lt;&lt;set $timeL6 = 0&gt;&gt;
&lt;&lt;set $timeL6T1 = 0&gt;&gt;
&lt;&lt;set $timeL6T2 = 0&gt;&gt;
&lt;&lt;set $timeL7 = 0&gt;&gt;
&lt;&lt;set $timeL7T2 = 0&gt;&gt;
&lt;&lt;set $timeL8 = 0&gt;&gt;
&lt;&lt;set $timeL9 = 0&gt;&gt;
&lt;&lt;set $currentLayer = 0&gt;&gt;
&lt;&lt;set $visitL1 = 0&gt;&gt;
&lt;&lt;set $visitL2 = 0&gt;&gt;
&lt;&lt;set $visitL3 = 0&gt;&gt;
&lt;&lt;set $visitL4 = 0&gt;&gt;
&lt;&lt;set $visitL5 = 0&gt;&gt;
&lt;&lt;set $visitL6 = 0&gt;&gt;
&lt;&lt;set $visitL7 = 0&gt;&gt;
&lt;&lt;set $visitL8 = 0&gt;&gt;
&lt;&lt;set $visitL9 = 0&gt;&gt;
&lt;&lt;set $innUsed = -1&gt;&gt;
&lt;&lt;set $innDubloons = 0&gt;&gt;
&lt;&lt;set $foodL1 = 0&gt;&gt;
&lt;&lt;set $iconUsed = 0&gt;&gt;
&lt;&lt;set $brokerUsed = 0&gt;&gt;
&lt;&lt;set $starUsed = 0&gt;&gt;
&lt;&lt;set $swapComp = -1&gt;&gt;
&lt;&lt;set $mudHunt = 0&gt;&gt;
&lt;&lt;set $bewitchBabies = 0&gt;&gt;
&lt;&lt;set $dizzyCount = 0&gt;&gt;
&lt;&lt;set $scalesUsed = 0&gt;&gt;
&lt;&lt;set $skewedUsed = 0&gt;&gt;
&lt;&lt;set $skewedForced = 0&gt;&gt;
&lt;&lt;set $steadyForced = 0&gt;&gt;
&lt;&lt;set $layerExit = 0&gt;&gt;
&lt;&lt;set $layerExitTime = 0&gt;&gt;
&lt;&lt;set $riverVisit = 0&gt;&gt;
&lt;&lt;set $cut = 0&gt;&gt;
&lt;&lt;set $light = 0&gt;&gt;
&lt;&lt;set $heat = 0&gt;&gt;
&lt;&lt;set $cool = 0&gt;&gt;
&lt;&lt;set $rope = 0&gt;&gt;
&lt;&lt;set $scuba = 0&gt;&gt;
&lt;&lt;set $height = &quot;0&quot;&gt;&gt;
&lt;&lt;set $torchUse = 0&gt;&gt;
&lt;&lt;set $purityUsed = 0&gt;&gt;
&lt;&lt;set $algalSize = 0&gt;&gt;
&lt;&lt;set $oasisVisit = 0&gt;&gt;
&lt;&lt;set $hexflame = 9&gt;&gt;
&lt;&lt;set $endSpectre = 0&gt;&gt;
&lt;&lt;set $crumbleFluid = 0&gt;&gt;
&lt;&lt;set $booby = 0&gt;&gt;
&lt;&lt;set $booby1 = 0&gt;&gt;
&lt;&lt;set $booby2 = 0&gt;&gt;
&lt;&lt;set $booby3 = 0&gt;&gt;
&lt;&lt;set $vaultWait = 0&gt;&gt;
&lt;&lt;set $vaultTimer = 0&gt;&gt;
&lt;&lt;set $vaultFound = 0&gt;&gt;
&lt;&lt;set $vaultMedkits = 0&gt;&gt;
&lt;&lt;set $tunnelUsed = 0&gt;&gt;
&lt;&lt;set $tunnelDubloons = 0&gt;&gt;
&lt;&lt;set $tunnelSkewer = 0&gt;&gt;
&lt;&lt;set $layerTemp = 0&gt;&gt;
&lt;&lt;set $tentacleFucked = 0&gt;&gt;
&lt;&lt;set $khemiaFucked = 0&gt;&gt;
&lt;&lt;set $khemiaDragon = 0&gt;&gt;
&lt;&lt;set $electricDragon = 0&gt;&gt;
&lt;&lt;set $dragonKill = 0&gt;&gt;
&lt;&lt;set $dragonBurn = 0&gt;&gt;
&lt;&lt;set $layer7Hypno = 0&gt;&gt;
&lt;&lt;set $randomOrgasms = 0&gt;&gt;
&lt;&lt;set $heavyLiftDubloons = 0&gt;&gt;
&lt;&lt;set $landExcavDubloons = 0&gt;&gt;
&lt;&lt;set $cityPaintDubloons = 0&gt;&gt;
&lt;&lt;set $energyGenDubloons = 0&gt;&gt;
&lt;&lt;set $roboProstituteDubloons = 0&gt;&gt;

&lt;&lt;set $escBalDepl = 0&gt;&gt;
&lt;&lt;set $convoStart = 1&gt;&gt;
&lt;&lt;set $endloop = false&gt;&gt;
&lt;&lt;set $subdom = 0&gt;&gt;
&lt;&lt;set $warmCloth =0&gt;&gt;
&lt;&lt;set $coolCloth =0&gt;&gt;
&lt;&lt;set $colwear=0&gt;&gt;
&lt;&lt;set $hsswear =0&gt;&gt;
&lt;&lt;set $LastEx =0&gt;&gt;
&lt;&lt;set $SizeHandicap=0&gt;&gt;
&lt;&lt;set $SibylBuff = 0 &gt;&gt;
&lt;&lt;set $slingshot = 0&gt;&gt;
&lt;&lt;set $joyousSword = 0&gt;&gt;
&lt;&lt;set $scent = 0 &gt;&gt;
&lt;&lt;set $HeightIncrease = 0&gt;&gt;
&lt;&lt;set $ManagedMisfortuneActive=false&gt;&gt;

&lt;&lt;set $dollevent = false&gt;&gt;
&lt;&lt;set $dollevent2= false&gt;&gt;

&lt;&lt;set $choice1 = 0&gt;&gt;
&lt;&lt;set $choice2 = 0&gt;&gt;
&lt;&lt;set $choice3 = 0&gt;&gt;


&lt;&lt;set $app = {
name: &quot;Nana&quot;,
sex: &quot;male&quot;,
osex: &quot;male&quot;,
ohair: &quot;black&quot;,
hair: &quot;black&quot;,
penis: 6,
openis: 6,
modpenis: 0,
vagina: 0,
gender: 1,
ogender: 1,
modgender:0,
switch: false,
breasts: 0,
obreasts: 0,
modbreasts: 0,
breastsCor: 0,
ears: &quot;normal human&quot;,
height: 170,
oheight: 170,
fit: 0,
modheight: 0,
bodyHair: 1,
skinType: &quot;&quot;,
oskinColor: &quot;pale&quot;,
skinColor: &quot;pale&quot;,
oeyeColor: &quot;blue&quot;,
eyeColor: &quot;blue&quot;,
tail: [],
womb: 0,
womb1: &quot;&quot;,
womb2: &quot;&quot;,
desc: &quot;&quot;,
blood: &quot;red&quot;,
age: 25,
appAge: 25,
libido: 2
}&gt;&gt;

&lt;&lt;set $status = {
penalty: 0,
duration: 0
}&gt;&gt;

&lt;&lt;set _page1 = setup.SoundPath + &quot;1 Above the Treetops.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;surface&quot; _page1&gt;&gt;

&lt;&lt;set _page2 = setup.SoundPath + &quot;2 Tropos by Day.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer1&quot; _page2&gt;&gt;

&lt;&lt;set _page3 = setup.SoundPath + &quot;3 City of Tears.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer2&quot; _page3&gt;&gt;

&lt;&lt;set _page4 = setup.SoundPath + &quot;4 Ancient Barrow.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer3&quot; _page4&gt;&gt;

&lt;&lt;set _page5 = setup.SoundPath + &quot;5 Ice Ruins.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer4&quot; _page5&gt;&gt;

&lt;&lt;set _page6 = setup.SoundPath + &quot;6 Casiopeia.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer5&quot; _page6&gt;&gt;

&lt;&lt;set _page7 = setup.SoundPath + &quot;7 Ginnungagap.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer6&quot; _page7&gt;&gt;

&lt;&lt;set _page8 = setup.SoundPath + &quot;8 You&#39;ve Got Me.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer7&quot; _page8&gt;&gt;

&lt;&lt;set _page9 = setup.SoundPath + &quot;9 Sunken Ruin.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer8&quot; _page9&gt;&gt;

&lt;&lt;set _page10 = setup.SoundPath + &quot;10 Quiet and Falling.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer9&quot; _page10&gt;&gt;

&lt;&lt;set _page11 = setup.SoundPath + &quot;11 Swings and Roundabouts.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer10&quot; _page11&gt;&gt;

&lt;&lt;set _page12 = setup.SoundPath + &quot;12 Come With Me.mp3&quot;&gt;&gt;
&lt;&lt;cacheaudio &quot;layer11&quot; _page12&gt;&gt;

&lt;&lt;include &quot;Init Companions&quot;&gt;&gt;

&lt;&lt;set $creepydoll = {
name: &quot;???&quot;,
affec: 0,
imageIcon: &quot;Icons/CreepyDoll.png&quot;,
osex: &quot;female&quot;,
genderVoice: 98,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(225, 0, 0,1);background-color: red;&quot;
}&gt;&gt;

&lt;&lt;set $Banditleader = {
name: &quot;Bandit Leader&quot;,
imageIcon: &quot;Icons/Banditleader.png&quot;,
osex: &quot;female&quot;,
genderVoice: 5,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(0, 0, 0,1);background-color: red;&quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $rndM = {
name: &quot;Male diver&quot;,
imageIcon: &quot;Icons/npcM.png&quot;,
osex: &quot;male&quot;,
genderVoice: 1,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(0, 0, 0,1);background-color: red;&quot;,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $rndF = {
name: &quot;Female diver&quot;,
imageIcon: &quot;Icons/npcF.png&quot;,
osex: &quot;female&quot;,
genderVoice: 6,
style: &quot;border: 2px solid rgb(1,0,0);&quot;,
style1: &quot;box-shadow: 0px 0px 10px 2px rgba(255, 225, 225,1);background-color: black;&quot;
}&gt;&gt;

&lt;&lt;set $purityPlank = {
name: &quot;Purity Tree Plank&quot;,
value: 35,
weight: 1.5,
corr: 0,
time: 0,
desc: &quot;A plank of wood taken from a rare breed of tree that somehow developed a way to absorb the natural miasma of the Abyss.&quot;,
pic: &quot;Wonders/puritytree.png&quot;
}&gt;&gt;

&lt;&lt;include &quot;Init Items&quot;&gt;&gt;
&lt;&lt;include &quot;Init Relics&quot;&gt;&gt;

&lt;&lt;set $curse1 = {
name: &quot;Libido Reinforcement A&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/libidoreinforcementA.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Libido&quot;
}&gt;&gt;
 
&lt;&lt;set $curse2 = {
name: &quot;Gender Reversal A&quot;,
corr: 15,
desc: &quot;x&quot;,
pic: &quot;Curses/genderreversalA.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse3 = {
name: &quot;Asset Robustness A&quot;,
corr: 10,
desc: &quot;x&quot;,
pic: &quot;Curses/assetrobustnessA.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse4 = {
name: &quot;Clothing Restriction A&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/clothingrestrictionA.png&quot;,
appDesc: &quot;You cannot bring yourself to wear any accessories anywhere on your body. &quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse5 = {
name: &quot;Shrunken Assets&quot;,
corr: 75,
desc: &quot;x&quot;,
pic: &quot;Curses/shrunkenassets.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse6 = {
name: &quot;Hair Removal&quot;,
corr: 5,
desc: &quot;x&quot;,
pic: &quot;Curses/hairremoval.png&quot;,
appDesc: &quot;&lt;&lt;if !$playerCurses.some(e =&gt; e.name === \&quot;Maximum Fluff\&quot;)&gt;&gt;Your entire body below your nose is completely hairless and smooth. Your eyebrows also look like they have been carefully trimmed. &lt;&lt;/if&gt;&gt;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse7 = {
name: &quot;Perma-dye&quot;,
corr: 5,
desc: &quot;x&quot;,
pic: &quot;Curses/perma-dye.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse8 = {
name: &quot;Freckle Speckle&quot;,
corr: 10,
desc: &quot;x&quot;,
pic: &quot;Curses/frecklespeckle.png&quot;,
appDesc: &quot;An assortment of freckles are spread over your body. &quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse9 = {
name: &quot;Knife-ear&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/knifeear.png&quot;,
appDesc: &quot;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse10 = {
name: &quot;Dizzying Heights&quot;,
corr: 5,
desc: &quot;x&quot;,
pic: &quot;Curses/dizzyingheights.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Height&quot;
}&gt;&gt;

&lt;&lt;set $curse11 = {
name: &quot;Increased Sensitivity&quot;,
corr: 10,
desc: &quot;x&quot;,
pic: &quot;Curses/increasedsensitivity.png&quot;,
appDesc: &quot;Your erogenous zones are extremely sensitive, and just a bit of stimulation is enough to bring you to the edge of orgasm. &quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse12 = {
name: &quot;Refractory Refactorization&quot;,
corr: 10,
desc: &quot;x&quot;,
pic: &quot;Curses/refractoryrefactorization.png&quot;,
appDesc: &quot;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse13 = {
name: &quot;Libido Reinforcement B&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/libidoreinforcementB.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse14 = {
name: &quot;Gender Reversal B&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/genderreversalB.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse15 = {
name: &quot;Asset Robustness B&quot;,
corr: 15,
desc: &quot;x&quot;,
pic: &quot;Curses/assetrobustnessB.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse16 = {
name: &quot;Age Reduction A&quot;,
corr: 15,
desc: &quot;x&quot;,
pic: &quot;Curses/agereductionA.png&quot;,
appDesc: &quot;&quot;,
type:&quot;Age&quot;
}&gt;&gt;

&lt;&lt;set $curse17 = {
name: &quot;Fluffy Ears&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/fluffyears.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse18 = {
name: &quot;Fluffy Tail&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/fluffytail.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type:&quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse19 = {
name: &quot;Maximum Fluff&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/maximumfluff.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse20 = {
name: &quot;Heat/Rut&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/heat.png&quot;,
appDesc: &quot;For the entirety of one day each month, you feel insatiably horny. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse21 = {
name: &quot;Lightweight&quot;,
corr: 15,
desc: &quot;x&quot;,
pic: &quot;Curses/lightweight.png&quot;,
appDesc: &quot;Just a little bit of alcohol turns you into a drunk mess. You&#39;d better not go out partying without trusted friends nearby. Behavior altering substances in general also have a much stronger effect on you. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse22 = {
name: &quot;Sex Switcheroo&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/sexswitcheroo.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse23 = {
name: &quot;Futa Fun&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/futafun.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse24 = {
name: &quot;Blushing Virgin&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/blushingvirgin.png&quot;,
appDesc: &quot;You are very shy about nudity, and even getting undressed while no one is looking already feels a bit embarrassing to you. Sex also feels very embarrassing, no matter how many times you might have done it. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse25 = {
name: &quot;Submissiveness Rectification A&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/submissivenessrectificationA.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse26 = {
name: &quot;Gender Reversal C&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/genderreversalC.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse27 = {
name: &quot;Asset Robustness C&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/assetrobustnessC.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse28 = {
name: &quot;Clothing Restriction B&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/clothingrestrictionB.png&quot;,
appDesc: &quot;You cannot bring yourself to wear any underwear whatsoever. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse29 = {
name: &quot;Power Dom&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/powerdom.png&quot;,
appDesc: &quot;You are never able to sit back and let someone else take charge, neither in life nor in sex. &quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse30 = {
name: &quot;20/20000000&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/20-20.png&quot;,
appDesc: &quot;Your sight is pretty terrible, and you are pretty much blind without glasses. Contacts also feel extremely uncomfortable. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse31 = {
name: &quot;Comic Relief&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/comicrelief.png&quot;,
appDesc: &quot;No one ever seems to take you seriously. You get patronized and talked down to pretty often. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse32 = {
name: &quot;Equal Opportunity&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/equalopportunity.png&quot;,
appDesc: &quot;Gender is really not an issue for you when selecting sexual partners. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse33 = {
name: &quot;Absolute Pregnancy&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/absolutepregnancy.png&quot;,
appDesc: &quot;Any and all sex you engage in results in pregnancy. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse34 = {
name: &quot;Absolute Birth Control&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/absolutebirthcontrol.png&quot;,
appDesc: &quot;You are completely sterile and cannot have children. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse35 = {
name: &quot;Wacky Wombs&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/wackywombs.png&quot;,
appDesc: &quot;&quot;,
variation1: &quot;&quot;,
variation2: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse36 = {
name: &quot;Omnitool&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/omnitool.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse37 = {
name: &quot;Gooey&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/gooey.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse38 = {
name: &quot;Rainbow Swirl&quot;,
corr: 25,
desc: &quot;x&quot;,
pic: &quot;Curses/rainbowswirl.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse39 = {
name: &quot;Double Pepperoni&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/doublepepperoni.png&quot;,
appDesc: &quot;Your nipples and areola are rather large and puffy. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse40 = {
name: &quot;Literal Blushing Virgin&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/literalblushingvirgin.png&quot;,
appDesc: &quot;No matter how many times you have sex, the moment it starts, you always forget your previous experiences, and genuinely believe it is your first time. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse41 = {
name: &quot;Libido Reinforcement C&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/libidoreinforcementC.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse42 = {
name: &quot;Lactation Rejuvination A&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/lactationrejuvinationA.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse43 = {
name: &quot;Asset Robustness D&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/assetrobustnessD.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse44 = {
name: &quot;Age Reduction B&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/agereductionB.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Age&quot;
}&gt;&gt;

&lt;&lt;set $curse45 = {
name: &quot;Sleep Tight&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/sleeptight.png&quot;,
appDesc: &quot;You need 12 hours of sleep each night, but at least sleeping is very comforting and pleasurable. you also feel a bit more energized during your waking hours. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse46 = {
name: &quot;Sweet Dreams&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;sweetdreams&quot;,
appDesc: &quot;Every night you have horrifyingly sexy and sexily horrifying wet nightmares, and wake up shaking in fear in a puddle of your own juices. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse47 = {
name: &quot;Hypno Happytime&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/hypnohappytime.png&quot;,
appDesc: &quot;yOu are very susceptiBlE to hYpnosis, and it is not hard to implant suggestions into your MalleablE mind. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse48 = {
name: &quot;Crossdress Your Heart&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/crossdressyourheart.png&quot;,
appDesc: &quot;You can only bring yourself to wear clothing associated with the opposite sex. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse49 = {
name: &quot;Lie Detector&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/liedetector.png&quot;,
appDesc: &quot;No matter how convincing a lie you craft, everyone can tell when you are not being truthful. Others are aware even when you are just omitting information. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse50 = {
name: &quot;Megadontia&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/megadontia.png&quot;,
appDesc: &quot;Your teeth are very sharp, and you have a couple of fangs poking out even when your mouth is closed. Some would call it cute, but be careful when making out. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse51 = {
name: &quot;Softie&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/softie.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse52 = {
name: &quot;Hard Mode&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/hardmode.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse53 = {
name: &quot;Lingual Leviathan&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/lingualleviathan.png&quot;,
appDesc: &quot;You have an extremely long, prehensile tongue, making you especially great at oral. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse54 = {
name: &quot;Tipping the Scales&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/tippingthescales.png&quot;,
appDesc: &quot;&quot;,
variation:&quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse55 = {
name: &quot;Reptail&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/reptails.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse56 = {
name: &quot;Cold Blooded&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/coldblooded.png&quot;,
appDesc: &quot;You no longer produce heat on your own, and need external heat sources. Your nights lately involve a lot of cuddling. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse57 = {
name: &quot;Libido Reinforcement D&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/Curses/libidoreinforcementD.png.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse58 = {
name: &quot;Gender Reversal D&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/genderreversalD.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse59 = {
name: &quot;Pleasure Respecification A&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/pleasurerespecificationA.png&quot;,
appDesc: &quot;You can no longer orgasm from masturbation. you can still feel pleasure and work your way towards the edge, but you will always need someone else&#39;s help to climax. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse60 = {
name: &quot;Clothing Restriction C&quot;,
corr: 60,
desc: &quot;x&quot;,
pic: &quot;Curses/clothingrestrictionC.png&quot;,
appDesc: &quot;You can no longer wear any clothing besides underwear, or clothes skimpy enough that others would consider them underwear. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse61 = {
name: &quot;Massacre Manicure&quot;,
corr: 30,
desc: &quot;x&quot;,
pic: &quot;Curses/massacremanicure.png&quot;,
appDesc: &quot;You have sharp claws instead of fingernails. they are retractable to an extent, but remain a permanent fixture of your hands. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse62 = {
name: &quot;DoS&quot;,
corr: 50,
desc: &quot;x&quot;,
pic: &quot;Curses/dos.png&quot;,
appDesc: &quot;You feel pleasure when inflicting pain on others, though other sources of pleasure are somewhat dulled. &quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse63 = {
name: &quot;DoM&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/dom.png&quot;,
appDesc: &quot;All pain you feel is converted into pleasure, though other sources of pleasure are somewhat dulled. &quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse64 = {
name: &quot;Hijinks Ensue&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/hijinksensue.png&quot;,
appDesc: &quot;You get involved in embarrassing sexual situations more often than it is reasonable. You are constantly getting caught in compromising positions, stumbling into other people having sex, suffering wardrobe malfunctions... &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse65 = {
name: &quot;Flower Power&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/flowerpower.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse66 = {
name: &quot;Cellulose&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/cellulose.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse67 = {
name: &quot;Chlorophyll&quot;,
corr: 50,
desc: &quot;x&quot;,
pic: &quot;Curses/chlorophyll.png&quot;,
appDesc: &quot;You need sunlight every day in order to feel energized; two hours when clothed, or 20 minutes nude. Thankfully, miasma takes care of most of your needs in the abyss. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse68 = {
name: &quot;Pheromones&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/pheromones.png&quot;,
appDesc: &quot;You are constantly emitting pheromones that make other people more aroused, especially towards you. Thankfully, it does not cloud their judgment any more than natural arousal. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse69 = {
name: &quot;Carapacian&quot;,
corr: 50,
desc: &quot;x&quot;,
pic: &quot;Curses/carapacian.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse70 = {
name: &quot;Hemospectrum&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/hemospectrum.png&quot;,
appDesc: &quot;&quot;,
variation: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse71 = {
name: &quot;Wriggly Antennae&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/wrigglyantennae.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse72 = {
name: &quot;Eggxellent&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/eggxellent.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse73 = {
name: &quot;Submissiveness Rectification B&quot;,
corr: 35,
desc: &quot;x&quot;,
pic: &quot;Curses/submissivenessrectificationB.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse74 = {
name: &quot;Lactation Rejuvination B&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/lactationrejuvinationB.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse75 = {
name: &quot;Pleasure Respecification B&quot;,
corr: 55,
desc: &quot;x&quot;,
pic: &quot;Curses/pleasurerespecificationB.png&quot;,
appDesc: &quot;You can no longer orgasm from sex with another person, and need to spend some time masturbating after the act to reach climax. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse76 = {
name: &quot;Age Reduction C&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/agereductionC.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Age&quot;
}&gt;&gt;

&lt;&lt;set $curse77 = {
name: &quot;Horny&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/horny.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse78 = {
name: &quot;Drawing Spades&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/drawingspades.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse79 = {
name: &quot;Tattoo Tally&quot;,
corr: 55,
desc: &quot;x&quot;,
pic: &quot;Curses/tattootally.png&quot;,
appDesc: &quot;You have several small runic tattoos throughout your body, and a larger heart shaped one above your crotch. Everyone who looks at them instinctively knows the full extent of your sexual history. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse80 = {
name: &quot;Leaky&quot;,
corr: 55,
desc: &quot;x&quot;,
pic: &quot;Curses/leaky.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse81 = {
name: &quot;Wandering Hands&quot;,
corr: 55,
desc: &quot;x&quot;,
pic: &quot;Curses/wanderinghands.png&quot;,
appDesc: &quot;Whenever you aren&#39;t paying attention, your hands start rubbing your crotch. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse82 = {
name: &quot;Semen Demon&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/semendemon.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse83 = {
name: &quot;Quota&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/quota.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse84 = {
name: &quot;In the Limelight&quot;,
corr: 20,
desc: &quot;x&quot;,
pic: &quot;Curses/inthelimelight.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse85 = {
name: &quot;Libido Reinforcement E&quot;,
corr: 50,
desc: &quot;x&quot;,
pic: &quot;Curses/libidoreinforcementE.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Libido&quot;
}&gt;&gt;

&lt;&lt;set $curse86 = {
name: &quot;Gender Reversal E&quot;,
corr: 45,
desc: &quot;x&quot;,
pic: &quot;Curses/genderreversalE.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse87 = {
name: &quot;Asset Robustness E&quot;,
corr: 50,
desc: &quot;x&quot;,
pic: &quot;Curses/assetrobustnessE.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Gender&quot;
}&gt;&gt;

&lt;&lt;set $curse88 = {
name: &quot;Urine Reamplification A&quot;,
corr: 55,
desc: &quot;x&quot;,
pic: &quot;Curses/urinereamplificationA.png&quot;,
appDesc: &quot;Your bladder capacity has been significantly reduced, you need to be careful to make sure you don&#39;t have any accidents. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse89 = {
name: &quot;Barter System&quot;,
corr: 65,
desc: &quot;x&quot;,
pic: &quot;Curses/bartersystem.png&quot;,
appDesc: &quot;You are unable to process currency, so one of your companions or friends will need to perform any transactions on your behalf, except for when a merchant is willing to trade you an item in exchange for a sexual favor. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse90 = {
name: &quot;Shared Space&quot;,
corr: 60,
desc: &quot;x&quot;,
pic: &quot;Curses/sharedspace.png&quot;,
appDesc: &quot;People around you are always happy to grope you, having little regard to giving you any space to yourself. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse91 = {
name: &quot;Weakling&quot;,
corr: 65,
desc: &quot;x&quot;,
pic: &quot;Curses/weakling.png&quot;,
appDesc: &quot;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse92 = {
name: &quot;Random Orgasms&quot;,
corr: 65,
desc: &quot;x&quot;,
pic: &quot;Curses/randomorgasms.png&quot;,
appDesc: &quot;&lt;&lt;set $randomOrgasms = $playerCurses.filter(e =&gt; e.name === \&quot;Random Orgasms\&quot;).length&gt;&gt;&lt;&lt;if $randomOrgasms == 1&gt;&gt;Once each day, randomly, you spontaneously orgasm, sometimes in public. &lt;&lt;else&gt;&gt;$randomOrgasms times each day you spontaneously orgasm without any stimulation, someimes in public. &lt;&lt;/if&gt;&gt;&quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse93 = {
name: &quot;Beastly&quot;,
corr: 80,
desc: &quot;x&quot;,
pic: &quot;Curses/beastly.png&quot;,
appDesc: &quot;You tend to behave in a very animalistic way instinctually. People around you tend to assume you&#39;re more of an animal or a pet than a person to be respected properly. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse94 = {
name: &quot;Creature of the Night&quot;,
corr: 40,
desc: &quot;x&quot;,
pic: &quot;Curses/creatureofthenight.png&quot;,
appDesc: &quot;You no longer have a pulse and sunlight causes you discomfort, similar to mythological vampires. You also need to drink a small amount of blood to survive, in addition to normal food. &quot;,
type: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $curse95 = {
name: &quot;Minish-ish&quot;,
corr: 75,
desc: &quot;x&quot;,
pic: &quot;Curses/minish-ish.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Height&quot;
}&gt;&gt;

&lt;&lt;set $curse96 = {
name: &quot;Colossal-able&quot;,
corr: 75,
desc: &quot;x&quot;,
pic: &quot;Curses/colossal-able.png&quot;,
appDesc: &quot;&quot;,
type: &quot;Height&quot;
}&gt;&gt;

&lt;&lt;set $curses = [$curse1, $curse2, $curse3, $curse4, $curse5, $curse6, $curse7, $curse8, $curse9, $curse10, $curse11, $curse12, $curse13, $curse14, $curse15, $curse16, $curse17, $curse18, $curse19, $curse20, $curse21, $curse22, $curse23, $curse24, $curse25, $curse26, $curse27, $curse28, $curse29, $curse30, $curse31, $curse32, $curse33, $curse34, $curse35, $curse36, $curse37, $curse38, $curse39, $curse40, $curse41, $curse42, $curse43, $curse44, $curse45, $curse46, $curse47, $curse48, $curse49, $curse50, $curse51, $curse52, $curse53, $curse54, $curse55, $curse56, $curse57, $curse58, $curse59, $curse60, $curse61, $curse62, $curse63, $curse64, $curse65, $curse66, $curse67, $curse68, $curse69, $curse70, $curse71, $curse72, $curse73, $curse74, $curse75, $curse76, $curse77, $curse78, $curse79, $curse80, $curse81, $curse82, $curse83, $curse84, $curse85, $curse86, $curse87, $curse88, $curse89, $curse90, $curse91, $curse92, $curse93, $curse94, $curse95, $curse96]&gt;&gt;
&lt;&lt;set $playerCurses = []&gt;&gt;
&lt;&lt;set $StoredCurse = &quot;&quot;&gt;&gt;

&lt;&lt;set $ForageFoodMajor = {name: &quot;1 Day Food Forage Major Impact&quot;}&gt;&gt;
&lt;&lt;set $ForageFoodMinor = {name: &quot;1 Day Food Forage Minor Impact&quot;}&gt;&gt;
&lt;&lt;set $ForageWaterMajor = {name: &quot;1 Day Water Forage Major Impact&quot;}&gt;&gt;
&lt;&lt;set $ForageWaterMinor = {name: &quot;1 Day Water Forage Minor Impact&quot;}&gt;&gt;
&lt;&lt;set $DollTF = {name: &quot;Doll Transformation&quot;}&gt;&gt;
&lt;&lt;set $AgeLog = []&gt;&gt;
&lt;&lt;set $GenderLog = []&gt;&gt;
&lt;&lt;set $HeightLog = []&gt;&gt;
&lt;&lt;set $LibidoLog = []&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="102" name="Init Items" tags="" position="225,1350" size="100,100">&lt;&lt;set $item2 = {
name: &quot;Food Rations&quot;,
weight: 0.4,
cost: 2,
count: 0,
desc: &quot;If you&#39;re going to be on a long expedition the first thing you need to think about is what you&#39;re going to be eating and drinking. &lt;q&gt;3 days without water, 3 weeks without food&lt;/q&gt; is a common estimate for human limits, but those are in optimum conditions, not for long treks through a mysterious magical cave with the occasional tentacle beast buttfucking! I&#39;d give you &lt;i&gt;roughly&lt;/i&gt; 8 days without food and 2 days without water before death... though you&#39;ll probably reach a point where &lt;i&gt;starvation or dehydration heavily disables you and hinders your ability to move and obtain resources&lt;/i&gt; in about half that time.&lt;br&gt;&lt;br&gt;Of course, eating as little as possible within those limits would be dangerous, too. You should really try to do both daily.&quot;,
image: &quot;Surface/foodrations.png&quot;
}&gt;&gt;

&lt;&lt;set $item1 = {
name: &quot;Water&quot;,
weight: 0.8,
cost: 1,
count: 0,
desc: &quot;Each purchase gets you a day&#39;s worth of water, packaged in post-usage-hyperultrabiodegradeable, single-use containers. How much food and water do you need? Good question! Some divers have surfaced after a few days of exploring the upper layers, others have spent weeks down there, still not sure if they were even close to the bottom. Some spend months, but carrying that many supplies with you can be difficult for very long expeditions like that, you may need to rely on potentially-dangerous food foraged from the Abyss.&quot;,
image: &quot;Surface/water.png&quot;
}&gt;&gt;

&lt;&lt;set $item3 = {
name: &quot;Empty Flask&quot;,
weight: 0.2,
cost: 4,
count: 0,
desc: &quot;A durable, well-made flask that can hold one entire day&#39;s worth of water. Useful if you want to gather water in the Abyss &amp;mdash; the Miasma keeps out conventional gross tapeworms and stuff, but can add other...unique or corruptive properties to water. You can fill it for free whenever you&#39;re here in town.&lt;br&gt;&lt;br&gt; If you&#39;re planning to rely extensively on foraged water, you&#39;ll probably want to stock up on several of these so you can have plenty of water stored for emergencies, and buying some cheaper water bottles too might be a good idea, just in case. Water isn&#39;t always readily available in the Abyss, and in some cases it can take many days to find viable water sources.&quot;,
image: &quot;Surface/flask.png&quot;
}&gt;&gt;

&lt;&lt;set $item4 = {
name: &quot;Filled Flask&quot;,
weight: 1,
cost: 4,
count: 0,
desc: &quot;A durable, well-made flask that can hold one entire day&#39;s worth of water. Useful if you want to gather water in the Abyss &amp;mdash; the Miasma keeps out conventional gross tapeworms and stuff, but can add other...unique or corruptive properties to water. You can fill it for free whenever you&#39;re here in town.&lt;br&gt;&lt;br&gt; If you&#39;re planning to rely extensively on foraged water, you&#39;ll probably want to stock up on several of these so you can have plenty of water stored for emergencies, and buying some cheaper water bottles too might be a good idea, just in case. Water isn&#39;t always readily available in the Abyss, and in some cases it can take many days to find viable water sources.&quot;,
image: &quot;Surface/flask.png&quot;
}&gt;&gt;

&lt;&lt;set $item5 = {
name: &quot;Medkit&quot;,
weight: 1,
cost: 11,
count: 0,
desc: &quot;A kit packed full of anything you could need to treat injuries sustained in the Abyss, be they from beasts or the treacherous terrain of the Abyss itself. Run-ins with some dangers of the Abyss can leave you with &lt;b&gt;status conditions&lt;/b&gt;, which can hinder you on your journey. The kit packed very austerely for portability and ease of use under pressure, and each kit has enough supplies to treat one &lt;i&gt;status condition&lt;/i&gt;.&quot;,
image: &quot;Surface/firstaidkit.png&quot;
}&gt;&gt;

&lt;&lt;set $item6 = {
name: &quot;Encyclopedia Abyssia&quot;,
weight: 3.5,
cost: 70,
count: 0,
maxCount: 1,
desc: &quot;A compilation of all known information about the Abyss a diver could ever need, largely related to what kinds of flora and fauna are safe to eat (and which ones at least have minimal...side effects.) The most useful information in it is about the upper layers, and our available information about layers beyond those is still very limited. Mysteriously, all human-edible species in the Abyss contain hyper-adapted bodies, causing them to perish and rot near-instantly after being taken outside of their native layer. (In other words, you cannot extensively &lt;q&gt;farm&lt;/q&gt; food in one layer and save it for future layers.)&lt;br&gt;&lt;br&gt;&lt;i&gt;Taking this with you is strongly recommended if you intend to rely extensively on foraging!&lt;/i&gt;&quot;,
image: &quot;Surface/encyclopediabyssia.png&quot;
}&gt;&gt;

&lt;&lt;set $item7 = {
name: &quot;Messenger Balloon&quot;,
weight: 0.1,
cost: 1,
count: 0,
desc: &quot;A small, durable, Miasma-propelled balloon designed to carry messages from divers deep in the Abyss to the surface. This, like all of the other available balloons, takes about 2 hours or so to reach the surface for every level you travel down into the abyss. Has a very low capacity, and can&#39;t realistically carry anything heavier than a paper message. Nobody will venture down into the Abyss to save you, but maybe you&#39;d like to keep the surface updated, or just let people know that you&#39;re alive? Comes with free pen and paper. Single-use.&quot;,
image: &quot;Surface/messageballoon.png&quot;
}&gt;&gt;

&lt;&lt;set $item8 = {
name: &quot;Commerce Balloon&quot;,
weight: 5,
cost: 60,
count: 0,
desc: &quot;Using a very sophisticated pulley-based delivery system, this balloon allows you &lt;i&gt;one chance&lt;/i&gt; to purchase items and sell Relics with this shop (this page) while you re down in the Abyss, at any time you like. After it reaches the surface, a scout from here will find your balloon with your attached order form, dubloons, and any Relics you wish to sell, and will use a pulley to quickly send any items you wish to purchase down to you. The balloon degrades and quickly fails after less than a day, so you should keep it all in a single transaction. Single-use. Should be durable enough to safely transport any Relic you could find in the Abyss. Cannot be used to hire companions.&quot;,
image: &quot;Surface/commerceballoon.png&quot;
}&gt;&gt;

&lt;&lt;set $item9 = {
name: &quot;Escape Balloon&quot;,
weight: 5.5,
cost: 130,
count: 0,
desc: &quot;A mini passenger-sized Miasma balloon. The return trip from the Abyss is always longer and harder than the trip down, and hitching a ride on a balloon is much faster, taking hours rather than weeks or days. However, if you want to stop to pick up any kinds of Relics, you would need to cut your balloon flight short, and it&#39;s single-use. Pretty much the only thing you&#39;re able to do while ascending with your Escape Balloon is accepting Curses and gaining corruption from them. The Escape Balloon has no protection against the Miasma, so while you don&#39;t need to spend significant time during your ascent, you &lt;i&gt;do&lt;/i&gt; still need to pay the full corruption price for every layer you ascend through.&quot;,
image: &quot;Surface/escapeballoon.png&quot;
}&gt;&gt;

&lt;&lt;set $item10 = {
name: &quot;Torch&quot;,
weight: 0.4,
cost: 4,
count: 0,
desc: &quot;A simple wooden torch, lit by striking against a hard surface. Provides light and a source of flame. Much of the Abyss naturally lit up through complex reactions in the Miasma, but not all of it. Single-use, meaning that after it&#39;s lit up, it will serve you for one choice you make, whether it speeds up travel or is required to overcome an obstacle. This does mean that its actual usable time in days can vary a bit, but that&#39;s just one of the wonders of stick-based technology.&quot;,
image: &quot;Surface/torch.png&quot;
}&gt;&gt;

&lt;&lt;set $item11 = {
name: &quot;Flashlight&quot;,
weight: 1,
cost: 45,
count: 0,
maxCount: 1,
desc: &quot;A modern alternative to the torch, this revolutionary flashlight has a Miasma-powered cell that should be more than enough to sustain you through your whole adventure. Unlike torches, it doesn&#39;t provide heat, though.&quot;,
image: &quot;Surface/flashlight.png&quot;
}&gt;&gt;

&lt;&lt;set $item12 = {
name: &quot;Rope&quot;,
weight: 3,
cost: 50,
count: 0,
maxCount: 1,
desc: &quot;Strong, sturdy rope. Could serve many possible purposes down there, notably climbing. You get a lot of rope with this; don’t worry about purchasing it more than once.&quot;,
image: &quot;Surface/rope.png&quot;
}&gt;&gt;

&lt;&lt;set $item13 = {
name: &quot;Compass&quot;,
weight: 0.2,
cost: 25,
count: 0,
maxCount: 1,
desc: &quot;Attempts at mapping the Abyss always seem to mysteriously fail, so this would probably be of limited use. Might help you keep your bearing in some spots.&quot;,
image: &quot;Surface/compass.png&quot;
}&gt;&gt;

&lt;&lt;set $item14 = {
name: &quot;Pistol&quot;,
weight: 2,
cost: 40,
count: 0,
maxCount: 1,
desc: &quot;A simple weapon, which you might be able to use for hunting or self-defense. Comes with six single-use bullets. You can buy additional cartridges of six bullets at 4 dubloons apiece. (0.2kg each) Taking one of these with plenty of ammunition is recommended if you intend on surviving on food from the Abyss &amp;mdash; in some cases, difficult-to-catch fauna may be the only available food source.&quot;,
image: &quot;Surface/pistol.png&quot;
}&gt;&gt;

&lt;&lt;set $item15 = {
name: &quot;Sword&quot;,
weight: 2.5,
cost: 45,
count: 0,
maxCount: 1,
desc: &quot;A versatile, sharp cutting weapon. Can be used both for protecting yourself and as a cutting tool. Generally a riskier weapon than a pistol, but doesn&#39;t consume ammo.&quot;,
image: &quot;Surface/sword.png&quot;
}&gt;&gt;

&lt;&lt;set $item16 = {
name: &quot;Scuba Gear&quot;,
weight: 3,
cost: 50,
count: 0,
maxCount: 1,
desc: &quot;Contains goggles and built in mechanical &lt;q&gt;gills&lt;/q&gt; able to extract breathable oxygen from water. Might be useful if you spot any artifacts trapped under a lake?&quot;,
image: &quot;Surface/scubagear.png&quot;
}&gt;&gt;

&lt;&lt;set $item17 = {
name: &quot;Warding Brace&quot;,
weight: 1,
cost: 60,
count: 0,
maxCount: 2,
desc: &quot;An arm brace made from the wood of the extremely rare Purity Tree, only rarely sighted in and around the Abyss. Can absorb a limited amount of Miasma, shielding the wearer from it and effectively giving them +20 corruption points (a good thing!) Purity Tree products are very rare, they only have two of these in stock. Buying the pair will effectively give you +40 corruption points.&quot;,
image: &quot;Surface/armbrace.png&quot;
}&gt;&gt;

&lt;&lt;set $item18 = {
name: &quot;Smartphone&quot;,
weight: 0.2,
cost: 150,
count: 0,
maxCount: 1,
desc: &quot;The newest model of the RingoDroid Phone, or whatever kind of phone is popular in the outside world these days? We can get the exact same model you have right now if you&#39;d prefer. Can be used as a &lt;i&gt;flashlight&lt;/i&gt;, a &lt;i&gt;compass&lt;/i&gt;, to send messages to the surface (and even receive them!), and comes with a digital version of the &lt;i&gt;Encyclopedia Abyssia&lt;/i&gt; loaded onto it. Just keep it on ultra battery-saving mode and you should be fine for a few months. I don&#39;t think there&#39;s any outlets down there.&quot;,
image: &quot;Surface/smartphone.png&quot;
}&gt;&gt;

&lt;&lt;set $item19 = {
name: &quot;Inn Room Pass&quot;,
weight: 0,
cost: 15,
count: 0,
maxCount: 1,
desc: &quot;This shop also contains a very nice inn on the side for travelers passing through! They have a special deal where 15 dubloons covers the price of your room for your entire adventure, so you can have a nice place to stop and rest during the 2-day interval you have when returning to the surface, before you have to decide whether to return to the Abyss or call it quits. Otherwise, you&#39;ll be sleeping on the ground up here, which isn&#39;t fun. Also covers warm meals whenever you&#39;re up here, which can be &lt;i&gt;really nice&lt;/i&gt; after living off food rations for a long time. Pretty much your only other option for meals while you&#39;re up here would be buying food rations (Note: complimentary warm meals would be terribly ineffective food rations in the Abyss, and you&#39;re not permitted to take them outside of town anyways.)&lt;br&gt;&lt;br&gt;A securely-locked room at the inn would also be helpful as a place to drop off Relics that you don&#39;t want to sell, but also don&#39;t want to carry around with you in the Abyss. You weren&#39;t planning on simply leaving Relics lying in the street, were you?&quot;,
image: &quot;Surface/Inn Room.png&quot;
}&gt;&gt;

&lt;&lt;set $item20 = {
name: &quot;Relic Workshop Pass&quot;,
weight: 0,
cost: 30,
count: 0,
maxCount: 1,
desc: &quot;The Relics you can find in the Abyss tend to have recognizable shapes, often similar to weapons, tools, or clothing, but the shapes they hold are not terribly strict. So long as a Relic you find remains as the same basic kind of object, it will still function as usual &amp;mdash; so you could, for example, modify a pair of magic slippers into sneakers, or alter their size within normal footwear ranges, or dye them a new color, and they would still retain their magical effects. We have a workshop lined up with an expert team of painters, woodworkers, blacksmiths, welders, tailors, and many others, all well-trained in quickly modifying Relics and ready to shape them to your heart&#39;s content. One purchase gets you unlimited assistance from them for your whole journey.&lt;br&gt;&lt;br&gt; Aside from the aesthetic benefits, it&#39;s worth noting that &lt;i&gt;many&lt;/i&gt; Relics of the Abyss have relatively simple and focused effects, which only truly shine when combined with other Relics in interesting ways. You could try to MacGyver your own weapons and Relic-based devices with whatever you find down there, but if you want real, proper workmanship on your inventions, you should take them here. You can send requests up via a commerce balloon, too.&quot;,
image: &quot;Surface/Relic Workshop.png&quot;
}&gt;&gt;

&lt;&lt;set $item21 = {
name: &quot;Pistol Bullets&quot;,
weight: 0.03,
cost: 4,
count: 0,
desc: &quot;These are the bullets you load into your pistol to shoot. Very useful, even in the Abyss, for dealing with threats. Single use only.&quot;,
image: &quot;Surface/pistol.png&quot;
}&gt;&gt;

&lt;&lt;set $item22 = {
name: &quot;Omoikone Smartphone&quot;,
weight: 0.3,
cost: 0,
count: 0,
desc: &quot;This is a phone with infinite battery life, an OS specifically attuned to your thought patterns for productivity and ease of use, free infinite data a bit faster than any plan on the market. Its specs are about 120% as good as the best commercially available consumer electronic. Also comes with a cute and helpful AI assisstant. Although that last part might be debatable now that you met her.&quot;,
image: &quot;Surface/smartphone2.png&quot;
}&gt;&gt;

&lt;&lt;set $item23 = {
name: &quot;Self warming clothes&quot;,
weight: 2,
cost: 0,
count: 0,
desc: &quot;This set of winter clothes has the Rømer Stones integrated into their lining, radiating a constant ambient heat. Together with the insulating properties of the winter clothing itself, these clothes can keep you feeling warm and toasty even in the harshest of icey conditions.&quot;,
image: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $item24 = {
name: &quot;Self cooling clothes&quot;,
weight: 1.4,
cost: 0,
count: 0,
desc: &quot;This set of summer clothes has the Rømer Stones integrated into them, which act as a continual heat sink. Together with the light and airy cloth of the summer garb itself, these clothes will keep you cool for some time in even the hottest of summer conditions&quot;,
image: &quot;&quot;
}&gt;&gt;

&lt;&lt;set $item25 = {
name: &quot;Energy Rations&quot;,
weight: 0.5,
cost: 11,
count: 0,
desc: &quot;Special rations produced through advanced futuristic methods. In addition to providing a day&#39;s worth of food, eating one will temporarily fill your body up with incredible energy and make it move faster than it normally can, allowing you to cover up to 2 days&#39; worth of distance in just 1 day. The effect magically transfers to anyone around you that has the &lt;q&gt;purity gene.&lt;/q&gt; Kinda has a lemon ginger flavor, but with a slightly bitter, almost coffee-like undertone? It&#39;s a bit of an acquired taste, to be honest.&quot;,
image: &quot;Wonders/energyrations.png&quot;
}&gt;&gt;

&lt;&lt;set $item26 = {
name: &quot;Ward Water&quot;,
weight: 0.9,
cost: 4,
count: 0,
desc: &quot;Specially-developed water, presumably designed to assist divers who lived in this city long ago. In addition to providing a day&#39;s worth of water, it also helps counteract the jinxed flame status from layer 6. Drinking 1 can will remove 1 counter from the status, in addition to the normal daily loss. You could also drink it while in layer 6 to gain a net 0 counters each day you explore there. The effect transfers to those nearby with he &lt;q&gt;purity gene.&lt;/q&gt; You can drink as many as you can fit in your stomach if you&#39;re trying to cure it fast, but it&#39;s probably best to stick to one per day if you&#39;re being economical. Kinda tastes like if you took every plant in the mint family (including lavendar, basil, rosemary, and various flavors of mint itself), extracted their basic essence, and mixed them all together.&quot;,
image: &quot;Wonders/wardwater.png&quot;
}&gt;&gt;

&lt;&lt;set setup.itemMoney = {
name: &quot;Money!&quot;,
weight: null,
cost: null,
count: 0,
desc: &quot;If you&#39;re confident you won&#39;t need them to buy anything here, you can also exchange your dubloons for other currencies! One dubloon to $100 USD, or the equivalent in whatever currency you prefer. No, you can&#39;t exchange the other way around, Mx. Moneybags. And you should probably only save this for after you return from your adventure, since other currencies won&#39;t really help you around here.&lt;br&gt;&lt;br&gt;&lt;q&gt;But wait,&lt;/q&gt; I hear you say, &lt;q&gt;why is everything in this shop so ridiculously expensive, then?&lt;/q&gt; Aside from being made with great care to withstand the rigors of the Abyss, these tools actually have to be made directly here in Outset Town, with materials from inside or very near the Abyss, so that they don&#39;t decay when brought inside it. Procuring the materials and producing these tools locally isn&#39;t easy.&lt;br&gt;&lt;br&gt;Yes, ignoring the Abyss and just leaving here with a cool $30,000 is an option, if you prefer that to unique magical Relics. Don&#39;t expect a second stipend later on!&lt;br&gt;&lt;br&gt;By the way, did you know that dubloons themselves are near-weightless? I mean, I guess it &lt;i&gt;does&lt;/i&gt; make sense that a society so focused around diving would create an easily-portable currency.&quot;,
image: &quot;Surface/money.png&quot;
}&gt;&gt;

&lt;&lt;set setup.itemVendFood = {
name: &quot;Food Rations&quot;,
weight: 0.3,
cost: 3,
count: 0,
desc: &quot;A bag containing one day&#39;s worth of food rations. They contain different, much more exotic assortments of flavors than what you can buy in Outset Town, but functionally they&#39;re the same.&quot;,
image: &quot;Wonders/rations.png&quot;
}&gt;&gt;

&lt;&lt;set setup.itemVendWater = {
name: &quot;Water&quot;,
weight: 0.8,
cost: 2,
count: 0,
desc: &quot;One day&#39;s worth of drinking water. Just like the water bottles sold in Outset Town, these quickly fall apart and biodegrade with astonishing speed after drinking. It&#39;s unclear if it&#39;s an environmental thing or an exploitative capitalism thing.&quot;,
image: &quot;Wonders/water.png&quot;
}&gt;&gt;

&lt;&lt;set setup.itemVendFlask = {
name: &quot;Flask&quot;,
weight: 0.2,
cost: 6,
count: 0,
desc: &quot;Just like the ones in Outset Town, these can be used as a durable, endlessly refillable water vessel. Unlike in Outset Town, refills aren&#39;t free here...instead, you can insert 1 dubloon into a slot on the side of the machine, and a tap will release enough water to fill up one flask exactly.&quot;,
image: &quot;Wonders/flask.png&quot;
}&gt;&gt;

&lt;&lt;set setup.itemVendMedkit = {
name: &quot;Medkit&quot;,
weight: 0.7,
cost: 12,
count: 0,
desc: &quot;A box packed full of everything you could possibly need to treat a wound down here. Works just like the ones in Outset Town, but they managed to pack it just a bit more lightly here.&quot;,
image: &quot;Wonders/medkit.png&quot;
}&gt;&gt;

&lt;&lt;set $items = [$item1, $item2, $item3, $item4, $item5, $item6, $item7, $item8, $item9, $item10, $item11, $item12, $item13, $item14, $item15, $item16, $item17, $item18, $item19, $item20, $item21, $item22, $item23, $item24, $item25, $item26]&gt;&gt;
&lt;&lt;set $vaultItems = $items&gt;&gt;</tw-passagedata><tw-passagedata pid="103" name="Layer1 1" tags="layer1" position="350,1350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $currentLayer = 1&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer1&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;if $dubloons &lt; 0&gt;&gt;
	&lt;&lt;set $debt += parseInt(Math.round(-1 * $dubloons * 1.2))&gt;&gt;
	&lt;&lt;set $dubloons = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l1intro.png&#39;]]
!Layer 1 - Arcadia&#39;s Garden
@@Stepping across the sparse grasses, eyes occasionally catching on some flowers that are much more vulvic than any you&#39;ve seen before, or perhaps a rock formation that seems far too phallic to be natural, you proceed down the relatively tranquil first layer of the Abyss. The town already begins to disappear from view above you, and below you is nothing but gentle, lush slopes leading further into the dark.

Traveling back to the surface from here will take 1 day, and will cost 10 corruption. Leaving the abyss also requires that you don&#39;t have any negative corruption points even if you plan to come back.

[[Walk through the first layer of the Abyss|Layer1 Hub]]
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL1 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer1 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="104" name="Layer1 Hub" tags="layer1" position="475,1350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $visitL1 = 1&gt;&gt;&lt;&lt;set $currentLayer = 1&gt;&gt;
&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;

You find yourself amidst the slightly-off natural splendor of the first layer.&lt;br&gt;&lt;br&gt; What do you want to do while you&#39;re here?&lt;br&gt;&lt;br&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp == 1&gt;&gt;
Crawling up a tree you spot an odd looking caterpillar, it almost looks like a disembodied human phallus, but it seems to have sharp spines rather than hair. You probably wouldn&#39;t want to put this is any places you&#39;d usually put a cock.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 2&gt;&gt;
In the distance you can hear some people yelling about something, but you can&#39;t quite make it out. When you get a bit closer, you can&#39;t seem to find any people, but you do see some spare clothes on the ground and some rustling in the bush nearby. Rather than waiting for the people to return, you choose to move on.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 3&gt;&gt;
Near the top of the layer, you notice a completely normal woman carrying a full pack trying to aproach the surface, but she seems to be having a great difficulty moving forward. &quot;Why can&#39;t I just leave?&quot; She calls out in exasperation to no one in particular. It seems the Abyss itself is impeding her, so you couldn&#39;t help her even if you tried.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 4 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
Khemia turns towards you smugly, &quot;You know $app.name, this whole layer is a breeze if you&#39;ve been around a few times. I think we could probably clear out anything worth doing in less than a day if we took the right shortcuts. This is barely even a speed bump on our path to the bottom of the Abyss for the right people. And who do you think knows the shortcuts?&quot; He smiles widely and puffs out his chest, gesturing to himself with his thumb before leading you down the most efficient path to your destination.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 5 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;
You spot Saeko crouching near a tree stump with some mold grown over it, writing in a notebook. She looks up at you and comments, &quot;You know, this isn&#39;t really a tree stump. It&#39;s a fungus that&#39;s shaped itself like a dead tree, an interesting case of mimicry.&quot; She digs up a bit of the dirt by the base of the apparent stump and reveals a gray texture leaking a creamy white liquid below the surface. &quot;I wonder what this is doing? The ecology here is so strange, even though it&#39;s so close to the surface...&quot; Her musings trail off, but she stands up and you get moving again towards your destination.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;



&lt;&lt;if !isPlaying(&quot;layer1&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer1&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $forageWater == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0 || $items[21].count&gt;0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer1 Threats]]
[[Check for food and water you can forage for|Layer1 Forage]]
[[Search for relics|Layer1 Relics]]
[[Take on curses to purge your corruption|Layer1 Curses]]
[[Look for any wonders you can take advantage|Layer1 Wonders]]
[[View the Layer 1 habitation option|Layer1 Habitation]]

[[Look up towards the surface|Layer1 Ascend]]
[[Look down at the next layer|Layer1 Exit]]</tw-passagedata><tw-passagedata pid="105" name="Layer1 Threats" tags="image layer1" position="600,1350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-threats.png&#39;]]

[[Return to exploring layer 1|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="106" name="Layer1 Relics" tags="layer1 cards nobr" position="725,1350" size="100,100">&lt;h1&gt;Relics&lt;/h1&gt;

&lt;p&gt;
@@.floatr;[img[setup.ImagePath+&#39;icon.png&#39;]]@@

If there were ever any powerful, versatile, noteworthy Relics to be found in such an early layer, they were likely claimed by someone else by now. Of course, almost any Relic can be useful under the right circumstances or with some lateral thinking &amp;mdash; these are just a bit harder to find applications for than the rarer Relics you can find deeper in.
&lt;br&gt;&lt;br&gt;
Some Relic may be particularly well-hidden or require significant detours, causing them to incur a day cost in the search for them, in addition to the standard corruption cost.
&lt;/p&gt;

&lt;p&gt;[[Continue exploring the first layer|Layer1 Hub]]&lt;/p&gt;

&lt;&lt;RelicGrid `[&quot;Star Compass&quot;, &quot;Rømer Stones&quot;, &quot;Creepy Doll&quot;, &quot;Giddy Reaper&quot;, &quot;Silk Twister&quot;, &quot;Vertebra Key&quot;, &quot;Chain of Lorelei&quot;, &quot;Hive Tassel&quot;, &quot;Smitten Mitt&quot;]`&gt;&gt;

&lt;p&gt;[[Continue exploring the first layer|Layer1 Hub]]&lt;/p&gt;</tw-passagedata><tw-passagedata pid="107" name="Layer1 Curses" tags="image layer1" position="850,1350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-curses.png&#39;]]&lt;&lt;GenderCorrected&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement A&quot;) || $StoredCurse.name == &quot;Libido Reinforcement A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Libido Reinforcement A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse1]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gender Reversal A&quot;) || $StoredCurse.name == &quot;Gender Reversal A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gender Reversal A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse2]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness A&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Asset Robustness A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse3]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction A&quot;) || $StoredCurse.name == &quot;Clothing Restriction A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Clothing Restriction A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse4]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness A&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness B&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness C&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness D&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness E&quot;)&gt;&gt;
	&lt;&lt;set _anyAssetRob=true&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _anyAssetRob=false&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $StoredCurse.name == &quot;Asset Robustness A&quot; || $StoredCurse.name == &quot;Asset Robustness B&quot;|| $StoredCurse.name == &quot;Asset Robustness C&quot;|| $StoredCurse.name == &quot;Asset Robustness D&quot;|| $StoredCurse.name == &quot;Asset Robustness E&quot;&gt;&gt;
	&lt;&lt;set _anyAssetRobMM=true&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _anyAssetRobMM=false&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Shrunken Assets&quot; || _anyAssetRob || _anyAssetRobMM&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Shrunken Assets]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse5]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hair Removal&quot;) || $StoredCurse.name == &quot;Hair Removal&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Hair Removal]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse6]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Perma-dye&quot;) || $StoredCurse.name == &quot;Perma-dye&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Perma-dye]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse7]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Freckle Speckle&quot;) || $StoredCurse.name == &quot;Freckle Speckle&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Freckle Speckle]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse8]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Knife-ear&quot;) || $StoredCurse.name == &quot;Knife-ear&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Knife-ear]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse9]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _temp1 =$HeightLog.filter(e =&gt; e.name === &quot;Dizzying Heights&quot;).length&gt;&gt;
&lt;&lt;if _temp1 &lt; 5 || ($StoredCurse.name == &quot;Dizzying Heights&quot; &amp;&amp; _temp1 &lt; 4 &amp;&amp; $ManagedMisfortuneActive==false)&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Dizzying Heights]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;) &amp;&amp; $StoredCurse.name != &quot;Dizzying Heights&quot;&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse10]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Increased Sensitivity&quot;) || $StoredCurse.name == &quot;Increased Sensitivity&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Increased Sensitivity]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse11]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Refractory Refactorization&quot;) || $StoredCurse.name == &quot;Refractory Refactorization&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Refractory Refactorization]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer1 Curses][$StoredCurse = $curse12]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;
[[Allow the Abyss to bestow a random curse upon you|Layer1 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="108" name="Layer1 Forage" tags="image layer1" position="975,1350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for water in Cloudpools|Layer1 Forage][$forageWater = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for water|Layer1 Forage][$forageWater = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for food from Blisshrooms|Layer1 Forage][$forageFood = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer1 Forage][$forageFood = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from the layer|Layer1 Flasks]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="109" name="Layer1 Wonders" tags="image layer1" position="1100,1350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-wonders.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $playerCurses.length &gt; 0&gt;&gt;
	&lt;&lt;if $iconUsed == 0&gt;&gt;
		Would you like to use the Icon of Mercy?&lt;br&gt;&lt;br&gt;
		[[Yes, use the Icon|Layer1 Icon]]&lt;br&gt;
		&lt;&lt;else&gt;&gt;
		You have already used the Icon of Mercy, you may not use it again.&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	You have no curses to remove, there&#39;s no need to use the Icon.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;back [[Layer1 Hub]]&gt;&gt;</tw-passagedata><tw-passagedata pid="110" name="Layer1 Habitation" tags="image layer1" position="1225,1350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $lewdCrit=10&gt;&gt;
&lt;&lt;set $inhumanCrit=10&gt;&gt;
&lt;&lt;set $AgeCrit=10&gt;&gt;
&lt;&lt;set $DubCrit=250&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
&lt;&lt;set $total_value_relics = $ownedRelics[$i].value + $total_value_relics&gt;&gt;
&lt;&lt;/for&gt;&gt;

	&lt;&lt;if $corruption &gt;= 0 &amp;&amp; $debt &lt;= 0&gt;&gt;
		Note: This ending is simply a possible future for you, assuming you go with the flow for the rest of your life. If you want to avoid them using the Companions, Relics, and Curses you have obtained, then you will be able to, as long as they are within the bounds of the habitation option you have selected.&lt;br&gt;&lt;br&gt;
		&lt;&lt;HeightCorrected&gt;&gt; &lt;&lt;BreastCorrected&gt;&gt; &lt;&lt;Lewdness&gt;&gt; &lt;&lt;Inhuman&gt;&gt;
	&lt;&lt;if $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew LInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew LInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew LInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew LInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew HInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew HInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew HInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 LLew HInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew LInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew LInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew LInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew LInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew HInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew HInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew HInhum LAge HDub]]
	&lt;&lt;else&gt;&gt;
		[[Choose to settle in Outcast village|L1 HLew HInhum LAge LDub]]
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;elseif $corruption &lt; 0&gt;&gt;
		You must have a corruption value of 0 or greater to choose a habitation option.
	&lt;&lt;else&gt;&gt;
		You must pay off all of your debt to settle down for habitation on the surface. You have $debt dubloons of debt, which you can pay at the Administrative Building.
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="111" name="Layer1 Exit" tags="layer1" position="100,1475" size="100,100">Descending to the next layer will take 2 days. How are your supplies of food and water? It&#39;s only going to get harder from here.

You notice the air is a bit more humid and the plants are a bit greener as you approach the path towards the second layer.

[[Stay on layer 1|Layer1 Hub]]
[[Descend down to the second layer|Layer2 1]]</tw-passagedata><tw-passagedata pid="112" name="Layer1 Cherry" tags="layer1" position="225,1475" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer1 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer1 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer1 Cherry Mix]]</tw-passagedata><tw-passagedata pid="113" name="Layer1 Cherry Relic" tags="layer1" position="350,1475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,8)&gt;&gt;
&lt;&lt;set $temp2 = random(0,8)&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,8)&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;
&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;
&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="114" name="Layer1 Cherry Curse" tags="layer1" position="475,1475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11)&gt;&gt;
&lt;&lt;set $temp2 = random(0,11)&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11)&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2) &amp;&amp; ($temp1 + $temp2 !== 6 &amp;&amp; (Math.abs($temp1 - $temp2) !== 2))&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 1.5), 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt; corruption respectively.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $temp1==9&gt;&gt;
	&lt;&lt;set $temp1=$temp2&gt;&gt;
	&lt;&lt;set $temp2=9&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $temp1==1&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse2)&gt;&gt;
&lt;&lt;elseif $temp1==2&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse3)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact A&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $temp1==4&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse5)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
&lt;&lt;if $temp2==1&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse2)&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==2&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse3)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact A&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==4&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse5)&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==9&gt;&gt;
	&lt;&lt;set $dizzyCount +=1&gt;&gt;
	&lt;&lt;if $HeightIncrease == 0&gt;&gt;
		Would you like to increase or descrease your height?&lt;br&gt;
		&lt;&lt;radiobutton &quot;$HeightIncrease &quot; -1 checked&gt;&gt; Decrease&lt;br&gt;
		&lt;&lt;radiobutton &quot;$HeightIncrease &quot; 1 &gt;&gt; Increase&lt;br&gt;
	&lt;&lt;elseif $HeightIncrease == 1&gt;&gt;
		You feel yourself growing even more.&lt;br&gt;
	&lt;&lt;else&gt;&gt;
		You feel yourself shrinking even more.&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;link &quot;Continue on to the rest of the layer&quot; &quot;Layer1 Hub&quot;&gt;&gt;
		&lt;&lt;set $playerCurses.push($curse10)&gt;&gt;&lt;&lt;set $HeightLog.push($curse10)&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement A&quot;)&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse1)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="115" name="Layer1 Cherry Mix" tags="layer1" position="600,1475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,8)&gt;&gt;
&lt;&lt;set $temp2 = random(0,11)&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $playerCurses[$playerCurses.length - 1].corr = Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $corruption += $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1), 0))&gt;&gt; corruption respectively.&lt;&lt;nobr&gt;&gt;
&lt;br&gt;
&lt;&lt;if $temp2==1&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse2)&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==2&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse3)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact A&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==4&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse5)&gt;&gt;[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;elseif $temp2==9&gt;&gt;
	&lt;&lt;set $dizzyCount +=1&gt;&gt;
	&lt;&lt;if $HeightIncrease == 0&gt;&gt;
		Would you like to increase or descrease your height?&lt;br&gt;
		&lt;&lt;radiobutton &quot;$HeightIncrease &quot; -1 checked&gt;&gt; Decrease&lt;br&gt;
		&lt;&lt;radiobutton &quot;$HeightIncrease &quot; 1 &gt;&gt; Increase&lt;br&gt;
	&lt;&lt;elseif $HeightIncrease == 1&gt;&gt;
		You feel yourself growing even more.&lt;br&gt;
	&lt;&lt;else&gt;&gt;
		You feel yourself shrinking even more.&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;link &quot;Continue on to the rest of the layer&quot; &quot;Layer1 Hub&quot;&gt;&gt;
		&lt;&lt;set $playerCurses.push($curse10)&gt;&gt;&lt;&lt;set $HeightLog.push($curse10)&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
[[Continue on to the rest of the layer|Layer1 Hub]]
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement A&quot;)&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse1)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="116" name="Layer1 Icon" tags="layer1" position="725,1475" size="100,100">[img[setup.ImagePath+&#39;Wonders/iconofmercy.png&#39;]]

After spending a few days seeking it out, you find a well-known site where cursed travelers can remove a curse that the Abyss forced upon them, at the cost of losing the corruption points it granted you.

Choose the curse you wish to remove:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $playerCurses.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print $playerCurses[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print &quot;[[Remove|Icon Removal][$temp to $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="117" name="Pick up the Star Compass" tags="layer1" position="850,1475" size="100,100">&lt;&lt;set $ownedRelics.push($relic1)&gt;&gt;&lt;&lt;set $corruption -= ($relic1.corr - $corRed)&gt;&gt;

You have successfully taken the $relic1.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

This may not be very useful in most circumstances, but perhaps at some point in the depths of the Abyss the knowledge of which direction is down may actually be useful.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="118" name="Pick up the Rømer Stones" tags="layer1" position="975,1475" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $ownedRelics.push($relic2)&gt;&gt;
&lt;&lt;set $corruption -= ($relic2.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic2.time&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic2.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

While they aren&#39;t useful on their own, perhaps you can take these stones back to the Relic Workshop on the surface and make something useful with them?

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="119" name="Pick up the Creepy Doll" tags="layer1" position="1100,1475" size="100,100">&lt;&lt;set $ownedRelics.push($relic3)&gt;&gt;&lt;&lt;set $corruption -= ($relic3.corr - $corRed)&gt;&gt;

&lt;&lt;if $app.appAge &gt; 13&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Maru&quot;)&gt;&gt;

As you and Maru search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. Maru notices your discovery, but looks worried and comments, &quot;Why isn&#39;t the table rotting? I feel like something&#39;s wrong here...&quot; his voice trails off, letting the comment hang for a moment more than you&#39;re both comfortable with.

You try to comfort Maru, but he insists he isn&#39;t afraid of the doll. &quot;It reminds me of something I used to play with, I think. But it can&#39;t be...&quot; At the same time, you get sense that it is almost exactly like a doll you had as a child, except you know you definitely didn&#39;t have a doll like this one. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

&quot;I don&#39;t thik we should take it.&quot; Maru crosses his arms, but after a few more words of encouragement from you, he accepts your decision. It can&#39;t really cause many problems, it&#39;s just a doll, right?

Recognizing the doll&#39;s mysterious properties and potential value, you overcome your aversion and take it with you. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was.

&lt;&lt;elseif $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;

As you and Saeko search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. Saeko notices your discovery, and eagerly inspects the find commenting, &quot;Very curious, the table seems to be perfectly intact. I wonder if the relic has some influence on how the miasma or environment is decaying the structure here. Perhaps we aren&#39;t the only ones who feel an aversion to it?&quot; She ponders the possibility for a moment, but doesn&#39;t come to any solid conclusion.

As you listen to her comments, you get sense that it is almost exactly like a doll you had as a child, except you know you definitely didn&#39;t have a doll like this one. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

&quot;I&#39;m skeptical about the utility of this relic, but I am curious about its properties.&quot; You give your answer to her unasked question by picking up the doll and adding it to your relic collection. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was.

&lt;&lt;else&gt;&gt;

As you search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. You get shivers in your spine and it almost seems like the doll is staring at you while you stare at it. In fact, it seems almost exactly like a doll you had as a child, except you know you definitely didn&#39;t have a doll like this one. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

Recognizing the doll&#39;s mysterious properties and potential value, you overcome your aversion and take it with you. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was.

&lt;&lt;/if&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Maru&quot;)&gt;&gt;

As you and Maru search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. You get shivers in your spine and it almost seems like the doll is staring at you while you stare at it. In fact, it seems almost exactly like a doll you would play with now, except you know you definitely don&#39;t have a doll like this one. It really makes you feel like a child when you look at it, as if you want to play with it and are repulsed by it at the same time. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

Maru notices your discovery, but looks worried and comments, &quot;Why isn&#39;t the table rotting? I feel like something&#39;s wrong here...&quot; his voice trails off, letting the comment hang for a moment more than you&#39;re both comfortable with.

You try to comfort Maru, but he insists he isn&#39;t afraid of the doll. &quot;It reminds me of something I used to play with, I think. But it can&#39;t be...&quot; It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

&quot;I don&#39;t thik we should take it.&quot; Maru crosses his arms, but after a few more words of encouragement from you, he accepts your decision. It can&#39;t really cause many problems, it&#39;s just a doll, right?

Recognizing the doll&#39;s mysterious properties and potential value, you overcome your aversion and take it with you. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was. As you place it in your bag, you almost get a sense that maybe you could make use of the tea table to complete the tea party with the doll, but you shake off the thought, despite looking like a child.

&lt;&lt;elseif $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;

As you and Saeko search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. You get shivers in your spine and it almost seems like the doll is staring at you while you stare at it. In fact, it seems almost exactly like a doll you would play with now, except you know you definitely don&#39;t have a doll like this one. It really makes you feel like a child when you look at it, as if you want to play with it and are repulsed by it at the same time. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

Saeko notices your discovery, and eagerly inspects the find commenting, &quot;Very curious, the table seems to be perfectly intact. I wonder if the relic has some influence on how the miasma or environment is decaying the structure here. Perhaps we aren&#39;t the only ones who feel an aversion to it?&quot; She ponders the possibility for a moment, but doesn&#39;t come to any solid conclusion.

Recognizing the doll&#39;s mysterious properties and potential value, you overcome your aversion and take it with you. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was. As you place it in your bag, you almost get a sense that maybe you could make use of the tea table to complete the tea party with the doll, but you shake off the thought, despite looking like a child.

&lt;&lt;else&gt;&gt;

As you search for an interesting doll you&#39;ve heard about, you come across the decaying jusk of a house. It looks as if someone once lived here, but it has been long since abandoned to be degraded by the forces of the Abyss.

You enter the ruined home, and after exploring each of the rooms, you happen to come across a perfectly preserved tea table, with a strange looking doll sitting in a chair. You get shivers in your spine and it almost seems like the doll is staring at you while you stare at it. In fact, it seems almost exactly like a doll you would play with now, except you know you definitely don&#39;t have a doll like this one. It really makes you feel like a child when you look at it, as if you want to play with it and are repulsed by it at the same time. It fits right into the uncanny zone of feeling familiar, yet intensely alien in a way that makes you feel strong discomfort just from looking at it.

Recognizing the doll&#39;s mysterious properties and potential value, you overcome your aversion and take it with you. As you pick it up, you catch a glimpse of the doll smiling, but when you look at it more closely you can tell that its sewn mouth is as static as it ever was. As you place it in your bag, you almost get a sense that maybe you could make use of the tea table to complete the tea party with the doll, but you shake off the thought, despite looking like a child.

&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;You have successfully taken the $relic3.name relic.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="120" name="Pick up the Giddy Reaper" tags="layer1" position="1225,1475" size="100,100">&lt;&lt;set $ownedRelics.push($relic4)&gt;&gt;&lt;&lt;set $corruption -= ($relic4.corr - $corRed)&gt;&gt;

You have successfully taken the $relic4.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="121" name="Pick up the Silk Twister" tags="layer1" position="100,1600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic5)&gt;&gt;
&lt;&lt;set $corruption -= ($relic5.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic5.time&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic5.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="122" name="Pick up the Vertebra Key" tags="layer1" position="225,1600" size="100,100">&lt;&lt;set $ownedRelics.push($relic6)&gt;&gt;&lt;&lt;set $corruption -= ($relic6.corr - $corRed)&gt;&gt;

You have successfully taken the $relic6.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="123" name="Pick up the Chain of Lorelei" tags="layer1" position="350,1600" size="100,100">&lt;&lt;set $ownedRelics.push($relic7)&gt;&gt;&lt;&lt;set $corruption -= ($relic7.corr - $corRed)&gt;&gt;

You have successfully taken the $relic7.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can wear this choker to change your voice, which may influence how some people perceive you.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="124" name="Pick up the Hive Tassel" tags="layer1" position="475,1600" size="100,100">&lt;&lt;set $ownedRelics.push($relic8)&gt;&gt;&lt;&lt;set $corruption -= Math.max(($relic8.corr - $corRed), 0)&gt;&gt;

As you wander through a grove of trees in search of the mysterious tassel that&#39;s somehow connected to the bees, you notice something new. A constant buzzing surrounds you all at once, as if you were swallowed by a swarm of bees. And in fact, when you glance at the trees, you can see that their bark is now impossible to make out, instead covered in layers of yellow and black insects moving over each other.

Then they begin to take flight, filling the air with black and yellow bugs and filling your ears with an intense droning sound.

As you&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; and your companions&lt;&lt;/if&gt;&gt; brace for the pain of the piercing stingers and nearly panic, you realize none of the bees are hurting you. In fact, none seem to be landing on you at all, leaving you a space of about a meter of peace within the ordered chaos of the swarm.

The strange sight in front of you also gives you the chance to notice a few odd things. Firstly, the bees seem strangely proportioned, as if their heads were too big for their bodies, making them almost look like a different type of insect altogether if it weren&#39;t for their coloration and behavior. Second, the apparent bees are not moving randomly, they seem to be pairing up and rubbing their bodies quite vigorously against each other before leaving and moving to a new partner. It occurs to you that perhaps you&#39;re in the middle of an orgy for these pseudo-bees. Third, you hear a second buzzing sound, one that sounds less like the buzzing of a bee and more like someone hitting wood together very quickly.

As you investigate the new sound, you spot a tree with a few branches vibrating and smacking against each other, with the apparent culprit being a small scrap of cloth gently wrapped around one of the branches. Spotting your goal, you&#39;re easily able to pull the vibrating tassel away from the tree, and as you leave the copulating swarm, the tassel becomes still, leaving only the strong smell of honey and its honeycomb pattern to signify there&#39;s anything unusual about it.


You have successfully taken the $relic8.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="125" name="Pick up the Smitten Mitt" tags="layer1" position="600,1600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic9)&gt;&gt;
&lt;&lt;set $corruption -= ($relic9.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic9.time&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic9.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 1|Layer1 Relics]]
[[Continue exploring the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="126" name="Take on Libido Reinforcement A" tags="layer1" position="725,1600" size="100,100">&lt;&lt;set $playerCurses.push($curse1)&gt;&gt;&lt;&lt;set $corruption += $curse1.corr&gt;&gt;

You have successfully taken on the $curse1.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="127" name="Take on Gender Reversal A" tags="layer1" position="850,1600" size="100,100">&lt;&lt;set $playerCurses.push($curse2)&gt;&gt;&lt;&lt;set $corruption += $curse2.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse2)&gt;&gt;

You have successfully taken on the $curse2.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="128" name="Take on Asset Robustness A" tags="layer1" position="975,1600" size="100,100">&lt;&lt;set $playerCurses.push($curse3)&gt;&gt;&lt;&lt;set $corruption += $curse3.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse3)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact A&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

You have successfully taken on the $curse3.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="129" name="Take on Clothing Restriction A" tags="layer1" position="1100,1600" size="100,100">&lt;&lt;set $playerCurses.push($curse4)&gt;&gt;&lt;&lt;set $corruption += $curse4.corr&gt;&gt;

A sudden compulsion washes over you, you need to get of your accessories, immediately. It&#39;s like they have suddenly become an unbearably uncomfortable burden on your mind. Whether it is a hat, a necklace, or a ring, you cannot accept keeping it on your body for any longer.

While it doesn&#39;t cause you any physical pain or anything like that, you do feel a fixation on removing it as soon as possible, as if you had a form of selective OCD that made your remove all of your accesories. And you know that from now on, you won&#39;t be wearing any accesories in the future, at least not of your own free will.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="130" name="Take on Shrunken Assets" tags="layer1" position="1225,1600" size="100,100">&lt;&lt;set $playerCurses.push($curse5)&gt;&gt;&lt;&lt;set $corruption += $curse5.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse5)&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;
You feel an intense squeezing sensation between your legs, as if something was squeezing your cock extremely tightly, but not in a pleasurable way. It isn&#39;t quite painful either, almost like someone had their hand gripped around your girth and squeezed as hard as they could all around it, but without any movement or sensations of rubbing the surface, just the squeezing. And it just keeps squeezing as if the pressure was resisting your current size and was pushing part of you back into your body.&lt;br&gt;&lt;br&gt;

After a few moments of this sensation, it fades, leaving you to deal with the aftermath. When you check yourself, it looks like your penis has almost entirely disappeared, leaving only a small nub, more reminiscent of a clitoris than your previous size. A quick mental estimation tells you that it is now only 1cm (0.5in) long, with a proportional width. This is quite a dramatic change, hopefully you can come to accept your new body.
&lt;&lt;elseif $app.sex == &quot;female&quot;&gt;&gt;
You feel an intense squeezing sensation on your breasts, but it isn&#39;t like someone&#39;s hand squeezing them in a pleasurable way. It feels like a pressure evenly distributed across them, like if you&#39;re deep underwater, but only on your chest. After a moment, the pressure increases, feeling like it is pushing your flesh into your abdomen, even if there&#39;s nowhere for it to go.&lt;br&gt;&lt;br&gt;

Instinctively, your hands move up to your chest in response to the strange sensation, and you feel your flesh squirming and pulsing under your fingers. It feels like your body is trying to burst out of some imaginary constraint, but is failing, and each attempt is more feeble than the last. And after a few more attempts, your body succumbs and the sensation fades, leaving you with much smaller assets than you had before. A quick evaluation tells you that you seem to have AA cup breasts now, with no way to increase that size.
&lt;&lt;elseif $app.sex == &quot;futa&quot;&gt;&gt;
You feel an intense squeezing sensation between your legs, as if something was squeezing your cock extremely tightly, but not in a pleasurable way. It isn&#39;t quite painful either, almost like someone had their hand gripped around your girth and squeezed as hard as they could all around it, but without any movement or sensations of rubbing the surface, just the squeezing. And it just keeps squeezing as if the pressure was resisting your current size and was pushing part of you back into your body.&lt;br&gt;&lt;br&gt;

After a few moments of this sensation, it fades, leaving you to deal with the aftermath. When you check yourself, it looks like your penis has almost entirely disappeared, leaving only a small nub, more reminiscent of a clitoris than your previous size. A quick mental estimation tells you that it is now only 1cm (0.5in) long, with a proportional width.&lt;br&gt;&lt;br&gt;

Just when you feel like the effect is done, you feel an intense squeezing sensation on your breasts, but it isn&#39;t like someone&#39;s hand squeezing them in a pleasurable way. It feels like a pressure evenly distributed across them, like if you&#39;re deep underwater, but only on your chest. After a moment, the pressure increases, feeling like it is pushing your flesh into your abdomen, even if there&#39;s nowhere for it to go.&lt;br&gt;&lt;br&gt;

Instinctively, your hands move up to your chest in response to the strange sensation, and you feel your flesh squirming and pulsing under your fingers. It feels like your body is trying to burst out of some imaginary constraint, but is failing, and each attempt is more feeble than the last. And after a few more attempts, your body succumbs and the sensation fades, leaving you with much smaller assets than you had before. A quick evaluation tells you that you seem to have AA cup breasts now, with no way to increase that size.

&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="131" name="Take on Hair Removal" tags="layer1" position="100,1725" size="100,100">&lt;&lt;set $playerCurses.push($curse6)&gt;&gt;&lt;&lt;set $corruption += $curse6.corr&gt;&gt;

You suddenly feel a tingling sensation over your whole body below your scalp, which suddenly becomes very itchy as each of the hair follicles on your body expels any hair they held within them and then shrivels up forever. A cursory feel of your body reveals that your skin is much smoother, aside from any existing marks or scars you have. It feels as if your whole body has been waxed, but even more than that in some way, as you know none of the hair will ever return, nor could you create a facsimile of hair anywhere on your body.

You shiver at the sensation, but it quickly passes. You&#39;re left with shaking the remaining residue out of your clothes so that it doesn&#39;t cause you to get itchy later on your journey.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="132" name="Take on Perma-dye" tags="layer1" position="225,1725" size="100,100">&lt;&lt;set $playerCurses.push($curse7)&gt;&gt;&lt;&lt;set $corruption += $curse7.corr&gt;&gt;

A brief wave of ice washes through your hair, or at least that&#39;s what it feels like as the pigments in your hair seem to have instantaneously swapped with new ones.

After the sudden wash, you instinctively reach a hand above your head to grab a lock of your hair and bring it before your eyes to see what&#39;s happened to it. The hair feels like a completely normal temperature, so that was apparently only an illusory sensation, but the change of color was real. You can see that your hair seems as if it had always been its new color. Now, what color do you see?

Please enter your new hair color:

&lt;&lt;textbox &quot;$curse7.variation&quot; &quot;turquoise&quot; &quot;Layer1 Curses&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="133" name="Take on Freckle Speckle" tags="layer1" position="350,1725" size="100,100">&lt;&lt;set $playerCurses.push($curse8)&gt;&gt;&lt;&lt;set $corruption += $curse8.corr&gt;&gt;

A brief period of tingling on your cheeks was immediately followed by a similar tingling over your whole body. As you reach up one of your hands, you notice that a number of distinctive freckles cover your skin over your entire body, being especially noticeable on your face.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="134" name="Take on Knife-ear" tags="layer1" position="475,1725" size="100,100">&lt;&lt;set $playerCurses.push($curse9)&gt;&gt;&lt;&lt;set $corruption += $curse9.corr&gt;&gt;

Your ears suddenly have an incredible itching on their tip, and as you reach upwards to feel what&#39;s going on, you feel the flesh reshaping itself into a new form. The flesh flows outward, extending the itching sensation, as your ears become longer and gain a pointed tip. The itching fades, but your ears still feel a little more sensitive than they did before.

It seems that you now look like either an elf out of a storybook or someone who really wants to look like a elf, for whatever reason. Hopefully you don&#39;t mind the occasion odd look if you return to the surface like this.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="135" name="Take on Dizzying Heights" tags="layer1" position="600,1725" size="100,100">&lt;&lt;set $corruption += $curse10.corr&gt;&gt;&lt;&lt;set $dizzyCount +=1&gt;&gt;
You have successfully taken on the $curse10.name curse. Hopefully you are ok with accepting the permanent consequences.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $HeightIncrease == 0&gt;&gt;
	Would you like to increase or descrease your height?&lt;br&gt;
	&lt;&lt;radiobutton &quot;$HeightIncrease &quot; -1 checked&gt;&gt; Decrease&lt;br&gt;
	&lt;&lt;radiobutton &quot;$HeightIncrease &quot; 1 &gt;&gt; Increase&lt;br&gt;
&lt;&lt;elseif $HeightIncrease == 1&gt;&gt;
	You feel yourself growing even more.&lt;br&gt;
&lt;&lt;else&gt;&gt;
	You feel yourself shrinking even more.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;link &quot;Accept more curses from the first layer&quot; &quot;Layer1 Curses&quot;&gt;&gt;
	&lt;&lt;set $playerCurses.push($curse10)&gt;&gt;&lt;&lt;set $HeightLog.push($curse10)&gt;&gt;
&lt;&lt;/link&gt;&gt;

&lt;&lt;if $escBalDepl==0&gt;&gt;
	&lt;&lt;link &quot;Return to exploring layer 1&quot; &quot;Layer1 Hub&quot;&gt;&gt;
		&lt;&lt;set $playerCurses.push($curse10)&gt;&gt;&lt;&lt;set $HeightLog.push($curse10)&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;link &quot;Return to your balloon&quot; &quot;Escape Balloon L1&quot;&gt;&gt;
		&lt;&lt;set $playerCurses.push($curse10)&gt;&gt;&lt;&lt;set $HeightLog.push($curse10)&gt;&gt;
	&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="136" name="Take on Increased Sensitivity" tags="layer1" position="725,1725" size="100,100">&lt;&lt;set $playerCurses.push($curse11)&gt;&gt;&lt;&lt;set $corruption += $curse11.corr&gt;&gt;

A brief tingle passes between your legs&lt;&lt;if $app.breasts &gt; 0&gt;&gt; and your breasts&lt;&lt;/if&gt;&gt;, causing you to immediately come to attention at the momentary sensitivity. You have to stop as you are instantly made aware of the sensation of your underwear touching your skin, and your own movements have become distracting.

&lt;&lt;if $app.sex == &quot;female&quot;&gt;&gt;You can feel yourself moisten under your panties, causing you to figdet slightly with your legs, causing you to once again feel the touch of the fabric against yourself, exacerbating the issue.&lt;&lt;else&gt;&gt;You can feel yourself harden in your pants, causing you to rub against them even harder, creating a cycle that results in you being as erect as you have ever been in your life.&lt;&lt;/if&gt;&gt;

You pause for a moment to catch your breath and wait for the sensation to pass, but it never does. It seems this is your new baseline of sensitivity from now on. You won&#39;t be going back to the way things were before, you&#39;ll just need to learn to deal with the new stimulation of any touch between your legs. It should be very pleasant when you&#39;re intentionally taking advantage of your newly increased sensitivity though.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="137" name="Take on Refractory Refactorization" tags="layer1" position="850,1725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Increased Sensitivity&quot;)&gt;&gt;
&lt;&lt;set $curse12.appDesc = &quot;You do not have a refractory period, and can orgasm several times in a row. Sex is like a long sequence of orgasms for you. &quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set $curse12.appDesc = &quot;You do not have a refractory period, and can orgasm several times in a row. &quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $playerCurses.push($curse12)&gt;&gt;&lt;&lt;set $corruption += $curse12.corr&gt;&gt;

You have successfully taken on the $curse12.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the first layer|Layer1 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 1|Layer1 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="138" name="Icon Removal" tags="layer1" position="975,1725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption -= $playerCurses[$temp].corr&gt;&gt;
&lt;&lt;set $iconUsed = 1&gt;&gt;
&lt;&lt;set $tempTime=3&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
/* 
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = (Math.max(3 - $timeRed + $status.penalty, 0))&gt;&gt;
&lt;&lt;set $timeL1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL1 += $tempTime&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
			&lt;&lt;set $GenderLog.push($ForageFoodMajor)&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0)&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0)&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL1 += 1&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
				&lt;&lt;set $GenderLog.push($ForageWaterMajor)&gt;&gt;
			&lt;&lt;/for&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
*/
&lt;&lt;set $targetCurse=$playerCurses[$temp]&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
The curse of $playerCurses[$temp].name has been successfully removed and your corruption has been refunded.
&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;

[[Continue exploring the layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="139" name="Layer1 Ascend" tags="layer1" position="1100,1725" size="100,100">Traveling back to the surface from here will take 1 day, and will cost 10 corruption. Leaving the abyss also requires that you don&#39;t have any negative corruption points even if you plan to come back.
&lt;&lt;if $corruption &gt;= 10&gt;&gt;
[[Continue your ascent|Layer1 Ascend2]]&lt;&lt;else&gt;&gt;
You must have 0 or more corruption after traveling in order to return to the surface. Because the trip back to the surface costs 10 corruption points, you must have a value of at least 10 corruption points before ascending. Return to the Abyss and accept more curses to be able to return to the surface world.
&lt;&lt;/if&gt;&gt;
[[Turn back and continue your business on the first layer|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="140" name="Layer1 Flasks" tags="layer1" position="1225,1725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL1 += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/cloudpools.png&#39;]]

&lt;&lt;if $abyssKnow == 0&gt;&gt;
You dip each of your flasks into the miasma-contaminated water in some of the lower cloudpools where it has collected. As you take a test-sip of the water you feel a subtle pulsing through your body, as if your body were trying to expand as quickly as it could. Despite this side-effect, you need the water, so you continue to fill your flasks for your future travels.
&lt;&lt;else&gt;&gt;
Using your knowledge of the Abyss, you specifically look to make sure you can get some good water directly from the clouds. You spot a couple easy pools where you could easily get a drink, but avoid the tainted water in favor of the pure water from a gentle waterfall you come across along your path. A taste test confirms that the water is indeed pure and you fill all of your empty flasks in preparation of continuing your journey.
&lt;&lt;/if&gt;&gt;
[[Return to exploring your food and water options on this layer|Layer1 Forage]]</tw-passagedata><tw-passagedata pid="141" name="Layer1 Curses Random" tags="" position="100,1850" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,11)&gt;&gt;
	&lt;&lt;if ($temp1 == 0) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement A&quot;) &amp;&amp; $StoredCurse.name != &quot;Libido Reinforcement A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 1) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gender Reversal A&quot;) &amp;&amp; $StoredCurse.name != &quot;Gender Reversal A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $temp == 2 &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Asset Robustness A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;)) &amp;&amp; $StoredCurse.name != &quot;Asset Robustness A&quot; &amp;&amp; $StoredCurse.name != &quot;Shrunken Assets&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 3) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction A&quot;) &amp;&amp; $StoredCurse.name != &quot;Clothing Restriction A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _playerCurseRobust = ($playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness A&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness B&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness C&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness D&quot;)|| $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness E&quot;))&gt;&gt;
	&lt;&lt;set _StoredCurseRobust = ($StoredCurse.name == &quot;Shrunken Assets&quot; || $StoredCurse.name == &quot;Asset Robustness A&quot;|| $StoredCurse.name == &quot;Asset Robustness B&quot;|| $StoredCurse.name == &quot;Asset Robustness C&quot;|| $StoredCurse.name == &quot;Asset Robustness D&quot; || $StoredCurse.name ==  &quot;Asset Robustness E&quot;)&gt;&gt;
	&lt;&lt;if ($temp1 == 4) &amp;&amp; !_playerCurseRobust &amp;&amp; !_StoredCurseRobust&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 5) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hair Removal&quot;) &amp;&amp; $StoredCurse.name != &quot;Hair Removal&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 6) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Perma-dye&quot;) &amp;&amp; $StoredCurse.name != &quot;Perma-dye&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 7) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Freckle Speckle&quot;) &amp;&amp; $StoredCurse.name != &quot;Freckle Speckle&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 8) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Knife-ear&quot;) &amp;&amp; $StoredCurse.name != &quot;Knife-ear&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set _temp2 =$HeightLog.filter(e =&gt; e.name === &quot;Dizzying Heights&quot;).length&gt;&gt;
	&lt;&lt;if ($temp1 == 9) &amp;&amp; _temp2 &lt; 5 || ($StoredCurse.name == &quot;Dizzying Heights&quot; &amp;&amp; _temp2 &lt; 4 &amp;&amp; $ManagedMisfortuneActive==false)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if ($temp1 == 10) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Increased Sensitivity&quot; &amp;&amp; $StoredCurse.name != &quot;Increased Sensitivity&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 11) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Refractory Refactorization&quot; &amp;&amp; $StoredCurse.name != &quot;Refractory Refactorization&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="142" name="Layer1 Threat1 Ascend" tags="layer1" position="225,1850" size="100,100">&lt;&lt;set $timeL2T1 -= 4&gt;&gt;
[img[setup.ImagePath+&#39;Threats/opportunisticbandits.png&#39;]]

How are you going to deal with the bandits surrounding you?


&lt;&lt;if $items[14].count&gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	What you lack in numbers you make up for in fighting quality, at least Khemia does. You see him already reaching for his sword. You would only need to give him a signal. You feel certain that the bandits would flee with no issues upon seeing Khemia with his sword.
	[[Let Khemia and his sword deal with these jokers|Layer1 Hub]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 2&gt;&gt;
	If these bandits thought you would traverse the dangers of the abyss unprepared, they are very much mistaken. If they see that you have a real weapon, they should leave you alone.
	[[Fire 2 warning shots with your pistol to scare them off|Layer1 Hub][$items[20].count -= 2]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Use the power of the Brave Vector and scare away the bandits. If they hear a few pebbles crashing into the ground, they won&#39;t want to get any closer.
[[Scare them off with the Brave Vector|Layer1 Hub]]
&lt;&lt;/if&gt;&gt;

Perhaps giving them what they want is the safer route. You can always collect more relics anyway, right?
[[Hand over some of the relics you&#39;ve collected|Relic surrender][$surrVal to 0 ]]


Use the following option only if you have specifically considered your inventory and made a plan of how to use it to either flee from or overpower the bandits.
[[Use a combination of relics not mentioned above you believe would be able to deal with the bandits|Layer1 Hub]]</tw-passagedata><tw-passagedata pid="143" name="Relic surrender" tags="layer1" position="350,1850" size="100,100">[img[setup.ImagePath+&#39;Threats/opportunisticbandits.png&#39;]]

Nervously, you begin going trough your bag, attempting to decide which relics to surrender and which to keep, if any...

&lt;&lt;if $surrVal &lt; 145&gt;&gt;
Choose the relic you would like to hand over:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Creepy Doll&quot; &amp;&amp; $creepydoll.affec &gt; 5&gt;&gt;
			You will never hand over your Dolly.. euh Creepy Doll you mean&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Chain of Lorelei&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Hand over|Relic surrender][$colwear=0, $surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;

		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Heart-stealing Stole&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Hand over|Relic surrender][$hsswear=0, $surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;

		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Sibyl Blend&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Relic surrender][$SibylBuff=0,$surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;World Stone&quot; &amp;&amp; $LilyPromise&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Relic surrender][$surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $companionLily.affec-=(3-$hsswear)]]&quot;&gt;&gt; &lt;br&gt; You promised Lily she could use the World Stone. Although you are not exactly selling it, you feel she would still be dissapointed if you gave it away &lt;br&gt;

		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Everhevea&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Relic surrender][$surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $items[2].count-=2]]&quot;&gt;&gt;

		&lt;&lt;else&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; worth &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Hand over|Relic surrender][$surrVal += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

	The bandits seem unsatisfied. One places a hand on the handle of a rusted blade, as if to remind you what&#39;s at stake here. One of them pushes you to hurry.&lt;br&gt;
	&lt;&lt;say $Banditleader&gt;&gt; Come on! Don&#39;t be greedy now, if you know what&#39;s good for you then you&#39;ll hand over a bit more and we&#39;ll all be happy, right?&lt;&lt;/say&gt;&gt;
&lt;&lt;else&gt;&gt;
  	The apparent bandit leader smiles widely. &lt;&lt;say $Banditleader&gt;&gt; Yeah, now we&#39;re talking. Off you go now, until next time.&lt;&lt;/say&gt;&gt; She waves you off and gives a toothy grin, showing some yellowing teeth as she picks through the loot you left her.
	[[Make your escape|Layer1 Hub]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="144" name="L1 LLew LInhum HAge HDub" tags="image ending layer1" position="475,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]

When you first saw Outcast village you already fell in love. Its rustic charm endeared you. So even though you weren&#39;t too severely effected by the curses from the abyss, you decided you wanted to stay here anyway. Over time you quickly became closely connected with the rest of the small community. You enjoyed your life for the most part, but as time grew on you started to miss some of the ammenities the top side could provide you. Although you still went to the surface on occasion to enjoy those, you started to wonder if there wasn&#39;t something that could be done in Outcast village. You debated it a bit with the rest of the community and decided to put the fortune you had left over from your abyss diving days into water turbines to improve the power available for the village. Over time this modernised the town a bit as appliances from the surface started pouring in, but in the end Outcast village never really lost its rustic feel. For your efforts the community promoted you to the mayor of the town, which you gladly accepted. With a community of around 300 people it was more a title than a job anyway. And so you lived a long, comfortable and quiet life in Outcast village.</tw-passagedata><tw-passagedata pid="145" name="L1 LLew LInhum HAge LDub" tags="image ending layer1" position="600,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]

When you first saw Outcast village you already fell in love. Its rustic charm endeared you. So even though you weren&#39;t too severely effected by the curses from the abyss, you decided you wanted to stay here anyway. Over time you quickly became closely connected with the rest of the small community. You enjoyed your life for the most part, but as time grew on you started to miss some of the ammenities the top side could provide you. Although you still went to the surface on occasion to enjoy those, you started to wonder if there wasn&#39;t something that could be done in Outcast village. Unfortunatly you didn&#39;t have the means to help the community out in any significant way. It didn&#39;t matter - the slow life in Outcast village started to grow on you more and more. Some days after helping out in the fields you found that you could just enjoy yourself sitting near a water edge and laying back in the grass, listening to the sounds of nature around you. You became a valued and central member in the community of Outcast village, spending many evenings drinking and sharing stories about your abyss diving days. In the end you lived a simple but happy life in Outcast village</tw-passagedata><tw-passagedata pid="146" name="L1 LLew LInhum LAge HDub" tags="image ending layer1" position="725,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]

At some point enough is enough, and with your body regressed at much as yours was you felt it would be better to just call it quits. With your apperent young age you felt it would be difficult to return to the surface so you settled in Outcast village. While you could see various other ex-adventures that had also regressed quite far, most seem at least to still be at a teenager level, and you felt you were being treated more like a kid than the rest. Of course you looked at ways to provide for yourself but that proved more difficult than you thought. You couldn&#39;t help out in the fields around town and working on some of the construction projects was even more impossible. If it weren&#39;t for your considerable savings after your abyss diving adventure you wouldn&#39;t have known what to do. Outcast village was very accomodating to regressed divers so you were able to buy a place for yourself and maintain yourself for a while. You decided to still be frugal though, not knowing how long it would take before your could work for your own food. Before long some people in the community understood what was going on, and before you knew it you felt like you were constantly surrounded by people, bringing food or treating you to a dinner. Sometimes you felt you were being babysat by 300 people, but at the same time being looked after by 300 people also felt nice. The family across the streat was especially nice, at some point you spend more than half the nights eating at their place. The days you stayed at home the father of the family would still check up on you in the morning and in the evening the mother would often stop by to bring you some left over dinner (which tasted suspiciously fresh). She never left before giving you a big kiss and a big hug. Over time you became sort of the town mascot and everywhere you go people greeted you and asked if they could help you with stuff. When you first started to live Outcast village you worried that growing back up by yourself would be really hard, but after a few years it was clear that your family that helped you all along the way was now bigger than ever.</tw-passagedata><tw-passagedata pid="147" name="L1 LLew LInhum LAge LDub" tags="image ending layer1" position="850,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]

At some point enough is enough, and with your body regressed at much as yours was you felt it would be better to just call it quits. With your apperent young age you felt it would be difficult to return to the surface so you settled in Outcast village. While you could see various other ex-adventures that had also regressed quite far, most seem at least to still be at a teenager level. With not much left over from your abyss diving expedition you felt at a loss. You couldn&#39;t help out in the fields around town and working on some of the construction projects was even more impossible. Luckily the rest of the small community quickly recognised your plight. A small family basically adopted you into their household. Over time they really started to feel like a real family too. You looked up to your new stepdad, he worked so hard in the village but when he came home he always had time mess around with you, giving you horserides on his neck. He really loved his new little &lt;&lt;BreastCorrected&gt;&gt;&lt;&lt;PerceivedGender&gt;&gt;. Your older stepsister wasn&#39;t always nice to you, she seemed to enjoy treating you like a little kid most out of everybody as she new it stung you a bit. When she was babysitting you she would sometimes give you her old sippycup instead of a regular glass to drink. While it annoyed you it wasn&#39;t all bad as she tended to forget she was teasing you after a while and started to genuinely play games with you. And finally there was your new stepmother, although she didn&#39;t tease you with your regressed condition she simply couldn&#39;t help herself pampering you as much as she did. This also annoyed you at first but over time you started to love every second of it. She was bathing you, doing your hair, dressing you and even feeding you during dinner. As the years would go by this would slowly grow less and less, while the love for you new family only increased. Nevertheless, after many many years thoughts about venturing into the deeper layers of the abyss were entering your mind again...</tw-passagedata><tw-passagedata pid="148" name="L1 LLew HInhum HAge HDub" tags="image ending layer1" position="975,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="149" name="L1 LLew HInhum HAge LDub" tags="image ending layer1" position="1100,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="150" name="L1 LLew HInhum LAge HDub" tags="image ending layer1" position="1225,1850" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="151" name="L1 LLew HInhum LAge LDub" tags="image ending layer1" position="100,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="152" name="L1 HLew LInhum HAge HDub" tags="image ending layer1" position="225,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="153" name="L1 HLew LInhum HAge LDub" tags="image ending layer1" position="350,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="154" name="L1 HLew LInhum LAge HDub" tags="image ending layer1" position="475,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="155" name="L1 HLew LInhum LAge LDub" tags="image ending layer1" position="600,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="156" name="L1 HLew HInhum HAge HDub" tags="image ending layer1" position="725,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]

[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="157" name="L1 HLew HInhum HAge LDub" tags="image ending layer1" position="850,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="158" name="L1 HLew HInhum LAge HDub" tags="image ending layer1" position="975,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="159" name="L1 HLew HInhum LAge LDub" tags="image ending layer1" position="1100,1975" size="100,100">[img[setup.ImagePath+&#39;Habitation/outcastvillage.png&#39;]]
[[test:go to end|Habitation Ending]]</tw-passagedata><tw-passagedata pid="160" name="Escape Balloon L1" tags="layer1" position="1225,1975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 1&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer1&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer1&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
The trip through this layer is brief and almost indistinguishable to a trip in a balloon in the skies of the surface, with the more mundane world outside the Abyss so close.

Your body feels a bit strange after moving upwards through the miasma so quickly giving a bit of a shock to your system, but hopefully you picked up enough curses along the way to successfully ascend to the surface.

&lt;&lt;if $corruption &gt;= 10&gt;&gt;[[Ascend to next layer|Surface Hub][$corruption -= (10 - $corRed), $escBalDepl=0]]&lt;&lt;/if&gt;&gt;
[[Hover on this layer to take in a curse|Layer1 Curses]]
[[Get off the balloon on this layer|Layer1 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="161" name="Layer1 Preview" tags="image layer1" position="100,2100" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l1intro.png&#39;]]

@@.layerTitle;LAYER 1 - ARCADIA&#39;S GARDEN@@

You see yourself standing in the fields of a vibrant valley, with a few trees nearby that don&#39;t quite seem normal. Suddenly the image shifts and you see the splendor of the relics that are available on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 2-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="162" name="DollEnd" tags="" position="225,2100" size="100,100">When you go to sleep, you dream once again.

You dream about the playroom you were in, with your dolly.

Your tattered pink dress doesn&#39;t look tattered at all anymore. It looks just like your dolly&#39;s dress. In fact, you started to look more like your dolly as well. But that&#39;s okay. It makes you look like a cute pair of twins after all.

You have tea time with your dolly, chatting away about how beautiful your dresses are, how tasty your tea is, and how nice it is to spend this time together.

You also play house with your dolly, taking turns switching who is the mommy and who is the baby. And once you get tired of playing you cuddle with your dolly until you fall a sleep again, just so you could play with her more the next day! It&#39;s so much fun!

Over time she even grows a lot so you can cuddle better! That&#39;s so nice of your dolly, she is the best! She&#39;s so considerate of you, making sure you&#39;re always content and comfortable where you are.

Sometimes you get a feeling like you lost something. Somethin precious to you that is now gone and locked away. But the feeling never lasts long as you sink back into your happy and comfortable life.

&lt;&lt;say $rndM&gt;&gt; Look! There they are! We found &#39;em! &lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndF&gt;&gt; I don&#39;t know... They look pretty creepy to me.&lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndM&gt;&gt; Duh, that&#39;s why they are called the Creepy Twin Dolls. What else did you expect? &lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndF&gt;&gt; What do you think they do? I heard they&#39;re creepy, but there must be something more. Nothing is simple down here. &lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndM&gt;&gt; I don&#39;t know. But a relic is relic. Worst case scenario we just sell &#39;em. But, who knows, they might just do something awesome! Here, take one, I&#39;ll keep the other.&lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndF&gt;&gt; You know what, now that I&#39;m holding one it actually doesn&#39;t feel as creepy anymore. In a weird way, it feels comforting. I think maybe I&#39;ll just keep her.&lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndM&gt;&gt; Haha, that was a quick 180! But I sort of get what you mean. They can be our good luck charms, maybe they&#39;ll help keep us alive.&lt;&lt;/say&gt;&gt;
&lt;&lt;say $rndF&gt;&gt; Yeah, exactly. I think I&#39;ll call mine $mc.name.&lt;&lt;/say&gt;&gt;

@@.layerTitle;GAME OVER@@</tw-passagedata><tw-passagedata pid="163" name="Layer2 1" tags="layer2" position="350,2100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $currentLayer = 2&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer2&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;set $timeL2T1 = 0&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l2intro.png&#39;]]
!Layer 2 - Dewdrop Rain Underbrush
@@As you enter the second layer, the clear open fields of the first gradually give way to a convoluted mass of trees, vines, and thorns, a thicket more dense than any you&#39;ve ever seen. You proceed further down, the inscrutable tangle of plant matter growing taller and taller above you, eventually completely shielding the first layer from view. You feel a light pinprick on your nose and look up, thinking it to be rain, but no - these drops are falling from the plants above you, tiny dewdrops coalescing on the vines, falling down as a light drizzle at first, gathering yet more water as they fall through the enormous jungle, and finally reachiing the roots of some of the tallest trees as a veritable monsoon.

This layer is filled with a very dense growth of vines, bushes, and other plant life that impedes you and makes movement very time-consuming. Having a way to clear them out of your way would make navigation much easier. Subtract 1 day from every time on this layer (including the cost of going up or down layers) if you have a sword with you to cut through the flora.

[[Walk through the second layer of the Abyss|Layer2 Hub]]
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL2 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer2 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="164" name="Layer2 Hub" tags="layer2" position="475,2100" size="100,100">&lt;&lt;set $currentLayer = 2&gt;&gt;&lt;&lt;set $visitL2 = 1&gt;&gt;&lt;&lt;if $timeL2T1 &lt; 4 || $hiredCompanions.length &gt; 3&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;The dew continually drips down around you, creating the illusion of a rainstorm without clouds. The atmosphere is heavy, partially with humdity, but mainly with the ever-present, creeping corruption of the miasma.

This layer is filled with a vey dense growth of vines, bushes, and other plant life that impedes you and makes movement very time-consuming. Having a way to clear them out of your way would make navigation much easier. Subtract 1 day from every time on this layer (including the cost of going up or down layers) if you have a sword with you to cut through the flora.

What do you want to do while you&#39;re here?

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp == 1&gt;&gt;
Above you, a blood-curdling screech fills the air. Freezing in fear, a bird seems to fly from the canopy above you, paying no mind to you on the ground. Strangely, it looks almost like a hawk, but as if its mouth were turned sideways and it&#39;s wings were a bit too sharp-edged to match any bird you&#39;ve seen before. However, you don&#39;t get a chance to get a good look at it before it flaps it&#39;s wings and and leaves you once again with only the sound of the dripping rain. &lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 2&gt;&gt;
At one point along your path, you spot a tangle of vines that seem to rustle slightly, but upon further inspection there is nothing inside them. After spending a minute watching them, you realize the sound comes from the speed at which the vines are growing, which seems to be a few centimeters a minute. You also hear a crunch, which seems to originate from the long-deadbskeleton of a small mammal being crushed by the vines. Wisely, you decide to move on and conclude this would not be a good place to make camp. &lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 3 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Lily&quot;)&gt;&gt;
You hear a loud hissing sound in one of the bushes nearby, and suddenly Saeko stops your group from moving forward. &quot;Wait, we have to go around here. I&#39;m not sure what would make a sound like that here, but I suspect it&#39;s not a good idea to find out. Lily almost walks forward on her own and rapidly comments, &quot;I don&#39;t know either! I really want to find out though! It can&#39;t be that bad if it&#39;s only on the second layer, right?&quot; Saeko grabs her collar and sighs, &quot;I believe I heard of a certain diver who thought similarly, but he was lost a few years ago. Better not to fall prey to some unkown venomous creature here.&quot; Lily hesitates, but eventually agrees and your group ends up going around the potential threat.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 4 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
A small feline-looking creature approaches you and gives a little mewling sound. As you hesitate with how to react, Cherry bends down and rubs it behind one of its furry ears. Her expression is blank and she sighs as the feline mews, whispering under her breath, &lt;q&gt;I remember this being fun. Why isn&#39;t this fun anymore?&lt;/q&gt; She stands up and steps back, giving you a chance o touch the feline, feeling that it feels much softer than you&#39;d expect, as if it were a sack of blubber rather than a cat. But after a few minutes, it gets tired of your touches and tightens up as it scampers away. Cherry is staring at the sky, letting the rain run down her face with no resistance. &lt;&lt;if $hiredCompanions.includes(&quot;Maru&quot;)&gt;&gt;Maru walks over to her and gives her a big, warm hug, but despite reaching her arms around him, her expression never changes.&lt;&lt;/if&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $forageWater == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1 &amp;&amp; $mudHunt == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer by spending 1 bullet each day to hunt mudgrazers&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;elseif $forageFood == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer by finding flanberries to eat.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer2&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer2&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer2 Threats]]
[[Check for food and water you can forage for|Layer2 Forage]]
[[Search for relics|Layer2 Relics]]
[[Take on curses to purge your corruption|Layer2 Curses]]
[[Look for any wonders you can take advantage|Layer2 Wonders]]
[[View the Layer 2 habitation option|Layer2 Habitation]]

[[Look up towards the surface|Layer2 Ascend 1]]
[[Look down at the next layer|Layer2 Exit]]&lt;&lt;else&gt;&gt;

You hear a quiet growling in the distance. After only a few more moments, it isn&#39;t in the distance any more, and it isn&#39;t quiet. A great 4-legged beast slobbers as it blocks your path.

[[Deal with the Baying Gourmet|Layer2 Threat1 Main]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="165" name="Layer2 Cherry" tags="layer2" position="600,2100" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer2 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer2 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer2 Cherry Mix]]</tw-passagedata><tw-passagedata pid="166" name="Layer2 Threats" tags="image layer2" position="725,2100" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-threats.png&#39;]]

[[Return to exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="167" name="Layer2 Forage" tags="image layer2" position="850,2100" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.

Note: If you try to forage for meat, but run out of bullets or don&#39;t have a gun, you will forage for some flanberries instead, with any side effects that may entail.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for water in Bewitcher Plants|Layer2 Forage][$forageWater = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for water in Bewitcher Plants|Layer2 Forage][$forageWater = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for flanberries for food|Layer2 Forage][$forageFood = 1, $mudHunt = 0]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;print &quot;[[Start foraging for Mudgrazers for food|Layer2 Forage][$forageFood = 1, $mudHunt = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer2 Forage][$forageFood = 0, $mudHunt = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from the layer|Layer2 Flasks]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="168" name="Layer2 Relics" tags="layer2 cards nobr" position="975,2100" size="100,100">&lt;&lt;if $timeL2T1 &lt; 4 || $hiredCompanions.length &gt; 3&gt;&gt;

&lt;h1&gt;Relics&lt;/h1&gt;

&lt;p&gt;
@@.floatr;[img[setup.ImagePath+&#39;icon.png&#39;]]@@

Some Relics may have special obstacles that must be overcome and certain supplies required in order to reach them. If you cannot retrieve such Relics, @@.unreachable;red text@@ will tell you why.
&lt;br&gt;&lt;br&gt;
By default, your companions&#39; reward for coming down here with you is the dubloons you hired them with (and the experience of travelling the Abyss and possibly learing useful information), and the won&#39;t be taking any Relics home. Maybe you&#39;d like to give a few Relics to them as gifts? It could really improve your relationship, especially if you give them Relics in line with their goals or personality. After all, if you forge a lifelong bond with them, you&#39;ll still get to see and use those gifted Relics whenever you&#39;re with them!
&lt;/p&gt;

&lt;p&gt;[[Continue exploring the second layer|Layer2 Hub]]&lt;/p&gt;

&lt;&lt;RelicGrid `[&quot;Firmament Pigment&quot;, &quot;Pearly Gates&quot;, &quot;World Stone&quot;, &quot;Forest&#39;s Gift&quot;, &quot;Harmless Harmony&quot;, &quot;Umbra Trident&quot;, &quot;Event Horizon&quot;, &quot;Heart-stealing Stole&quot;, &quot;Effacing Asperity&quot;, &quot;Wholly Ale&quot;, &quot;Memoir Remnant&quot;, &quot;Gleam Dazer&quot;]`&gt;&gt;

&lt;p&gt;[[Continue exploring the second layer|Layer2 Hub]]&lt;/p&gt;

&lt;&lt;else&gt;&gt;

&lt;p&gt;You hear a quiet growling in the distance. After only a few more moments, it isn&#39;t in the distance any more, and it isn&#39;t quiet. A great 4-legged beast slobbers as it blocks your path.&lt;/p&gt;

&lt;p&gt;[[Deal with the Baying Gourmet|Layer2 Threat1 Main]]&lt;/p&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="169" name="Layer2 Curses" tags="image layer2" position="1100,2100" size="100,100">&lt;&lt;GenderCorrected&gt;&gt;[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-curses.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement B&quot;) || $StoredCurse.name == &quot;Libido Reinforcement B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Libido Reinforcement B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse13]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gender Reversal B&quot;) || $StoredCurse.name == &quot;Gender Reversal B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gender Reversal B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse14]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness B&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness B&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Asset Robustness B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse15]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Age Reduction A&quot;) || $StoredCurse.name == &quot;Age Reduction A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Age Reduction A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse16]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Fluffy Ears&quot;) || $StoredCurse.name == &quot;Fluffy Ears&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Fluffy Ears]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse17]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Fluffy Tail&quot;) || $StoredCurse.name == &quot;Fluffy Tail&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Fluffy Tail]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse18]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Maximum Fluff&quot;) || $StoredCurse.name == &quot;Maximum Fluff&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Maximum Fluff]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse19]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Heat/Rut&quot;) || $StoredCurse.name == &quot;Heat/Rut&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Heat/Rut]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse20]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lightweight&quot;) || $StoredCurse.name == &quot;Lightweight&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Lightweight]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse21]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sex Switcheroo&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;) || $StoredCurse.name == &quot;Sex Switcheroo&quot; || $StoredCurse.name == &quot;Futa Fun&quot;&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Sex Switcheroo]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse22]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sex Switcheroo&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;) || $StoredCurse.name == &quot;Sex Switcheroo&quot; || $StoredCurse.name == &quot;Futa Fun&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Futa Fun]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse23]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Blushing Virgin&quot;) || $StoredCurse.name == &quot;Blushing Virgin&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Blushing Virgin]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer2 Curses][$StoredCurse = $curse24]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer2 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="170" name="Layer2 Wonders" tags="image layer2" position="1225,2100" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-wonders.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if ($visitL3 == 0) &amp;&amp; ($brokerUsed == 0) &amp;&amp; ($corruption &gt; -100)&gt;&gt;
	Would you like to use the Empty-handed Broker?&lt;br&gt;&lt;br&gt;
	[[Yes, use the Broker|Layer2 Broker]]
	&lt;&lt;else&gt;&gt;
	You have already used the Empty-handed Broker or traveled further into the Abyss, you may not use it now.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if ($starUsed == 0) &amp;&amp; ($hiredCompanions.length &gt; 0)&gt;&gt;
	Would you like to use the Fate-crossing Star?&lt;br&gt;&lt;br&gt;
	[[Yes, bathe in the Star&#39;s lake|Layer2 Star 1]]&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	You must have companions and have not already used the Fate-crossing Star before if you wish to swap bodies with someone.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;back [[Layer2 Hub]]&gt;&gt;</tw-passagedata><tw-passagedata pid="171" name="Layer2 Habitation" tags="image layer2" position="100,2225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-habitation.png&#39;]]
&lt;&lt;nobr&gt;&gt;
&lt;&lt; set $lewdCrit=12&gt;&gt;
&lt;&lt; set $inhumanCrit =12&gt;&gt;
&lt;&lt; set $AgeCrit =10&gt;&gt;
&lt;&lt; set $DubCrit =250&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
&lt;&lt;set $total_value_relics = $ownedRelics[$i].value + $total_value_relics&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;br&gt;&lt;&lt;return&gt;&gt;&lt;br&gt;&lt;br&gt;

	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the second layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

/*&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0 &amp;&amp; $debt &lt;= 0&gt;&gt;
		Note: This ending is simply a possible future for you, assuming you go with the flow for the rest of your life. If you want to avoid them using the Companions, Relics, and Curses you have obtained, then you will be able to, as long as they are within the bounds of the habitation option you have selected.&lt;br&gt;&lt;br&gt;
		&lt;&lt;HeightCorrected&gt;&gt; &lt;&lt;BreastCorrected&gt;&gt; &lt;&lt;Lewdness&gt;&gt; &lt;&lt;Inhuman&gt;&gt;
	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;) &amp;&amp; $app.heightCor&lt;140&gt;&gt;
		[[Choose to settle in Downcast village|L2 Gooey end]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew LInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew LInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew LInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew LInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew HInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew HInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew HInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 LLew HInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew LInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew LInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew LInhum LAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew LInhum LAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew HInhum HAge HDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew HInhum HAge LDub]]
	&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew HInhum LAge HDub]]
	&lt;&lt;else&gt;&gt;
		[[Choose to settle in Downcast village|L2 HLew HInhum LAge LDub]]
	&lt;&lt;elseif $corruption &lt; 0&gt;&gt;
		You must have a corruption value of 0 or greater to choose a habitation option.
	&lt;&lt;else&gt;&gt;
		You must pay off all of your debt to settle down for habitation on the surface. You have $debt dubloons of debt, which you can pay at the Administrative Building.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;return&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
*/</tw-passagedata><tw-passagedata pid="172" name="Layer2 Ascend 1" tags="layer2" position="225,2225" size="100,100">Returning to the first layer will take 4 days, and cost 15 corruption.

[[Continue your ascent|Layer2 Ascend2]]
[[Turn back and continue your business on the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="173" name="Layer2 Exit" tags="layer2" position="350,2225" size="100,100">Descending to the next layer will take 5 days. As you travel further down, the layer tend to get larger, both vertically and horizontally.

Accessing drinkable water tends to get a but more difficult from here on out, so having a fair emergency supply of water would be a good idea before continuing onward. At a minimum, about a week&#39;s worth of water should be enough to avoid the worst case scenario.

[[Stay on layer 2|Layer2 Hub]]
[[Descend down to the third layer|Layer2 Exit2]]</tw-passagedata><tw-passagedata pid="174" name="Layer2 Cherry Relic" tags="layer2" position="475,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 9&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 9&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 9&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="175" name="Layer2 Cherry Curse" tags="layer2" position="600,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 12&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 12&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 12&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2) &amp;&amp; ($temp1 + $temp2 !== 43 &amp;&amp; (Math.abs($temp1 - $temp2) !== 1))&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;if $temp1==15 || $temp2==15&gt;&gt;
	&lt;&lt;set AgeLog.push($curse16)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.
&lt;&lt;if $curses[$temp1].name ==  &quot;Fluffy Ears&quot; || $curses[$temp2].name ==  &quot;Fluffy Ears&quot;&gt;&gt;

	What type of ears would you like to gain?

	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry cat&quot; checked&gt;&gt; Cat
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;fluffy dog&quot; &gt;&gt; Dog
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;floppy cow&quot; &gt;&gt; Cow
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry monkey&quot; &gt;&gt; Monkey
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry rabbit&quot; &gt;&gt; Rabbit
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry fox&quot; &gt;&gt; Fox
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry mouse&quot; &gt;&gt; Mouse
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;pig&quot; &gt;&gt; Pig
	&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry horse&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Fluffy Tail&quot; || $curses[$temp2].name ==  &quot;Fluffy Tail&quot;&gt;&gt;

	What type of tail would you like to gain?

	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;flowing cat&quot; checked&gt;&gt; Cat
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;wagging dog&quot; &gt;&gt; Dog
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;lazy cow&quot; &gt;&gt; Cow
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;prehensile monkey&quot; &gt;&gt; Monkey
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;fluffy rabbit&quot; &gt;&gt; Rabbit
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;bushy fox&quot; &gt;&gt; Fox
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;long mouse&quot; &gt;&gt; Mouse
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;twisted pig&quot; &gt;&gt; Pig
	&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;swaying horse&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $curses[$temp1].name ==  &quot;Maximum Fluff&quot; || $curses[$temp2].name ==  &quot;Maximum Fluff&quot;&gt;&gt;
	What type of fur would you like to gain?

	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cat-furred&quot; checked&gt;&gt; Cat
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;dog-furred&quot; &gt;&gt; Dog
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cow-furred&quot; &gt;&gt; Cow
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;monkey-furred&quot; &gt;&gt; Monkey
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;rabbit-furred&quot; &gt;&gt; Rabbit
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;fox-furred&quot; &gt;&gt; Fox
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;mouse-furred&quot; &gt;&gt; Mouse
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;pig-furred&quot; &gt;&gt; Pig
	&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;horse-furred&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;


[[Continue on to the rest of the layer|Layer2 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Gender Reversal B&quot; || $curses[$temp2].name ==  &quot;Gender Reversal B&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse14)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Asset Robustness B&quot; || $curses[$temp2].name == &quot;Asset Robustness B&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse15)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact B&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Sex Switcheroo&quot; || $curses[$temp2].name ==  &quot;Sex Switcheroo&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse22)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Futa Fun&quot; || $curses[$temp2].name ==  &quot;Futa Fun&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse23)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Libido Reinforcement B&quot; || $curses[$temp2].name ==  &quot;Libido Reinforcement B&quot; &gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse13)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="176" name="Layer2 Cherry Mix" tags="layer2" position="725,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 9&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 12&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;if $temp2==15&gt;&gt;
	&lt;&lt;set AgeLog.push($curse16)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.floor(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.
&lt;&lt;if $curses[$temp2].name == &quot;Fluffy Ears&quot;&gt;&gt;

What type of ears would you like to gain?

&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry cat&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;fluffy dog&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;floppy cow&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry monkey&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry rabbit&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry fox&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry mouse&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;pig&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry horse&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Fluffy Tail&quot;&gt;&gt;

What type of tail would you like to gain?

&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;flowing cat&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;wagging dog&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;lazy cow&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;prehensile monkey&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;fluffy rabbit&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;bushy fox&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;long mouse&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;twisted pig&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;swaying horse&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;&lt;&lt;if $curses[$temp2].name == &quot;Maximum Fluff&quot;&gt;&gt;
What type of fur would you like to gain?

&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cat-furred&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;dog-furred&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cow-furred&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;monkey-furred&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;rabbit-furred&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;fox-furred&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;mouse-furred&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;pig-furred&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;horse-furred&quot; &gt;&gt; Horse
&lt;&lt;/if&gt;&gt;


[[Continue on to the rest of the layer|Layer2 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Gender Reversal B&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse14)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Asset Robustness B&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse15)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact B&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Sex Switcheroo&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse22)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Futa Fun&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse23)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==  &quot;Libido Reinforcement B&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse13)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="177" name="Layer2 Broker" tags="layer2" position="850,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption += 100&gt;&gt;
&lt;&lt;set $brokerUsed = 1&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/empty-handedbroker.png&#39;]]

After spending a few days seeking out the statue you heard may grant you a boon on this layer, you find it past a glade surrounded by dark, foreboding trees.

As you place your hand on the alabaster hand of demonic statue before you, a shiver runs through your spine. You have a sense that the corruption is closing in on you, and for a moment you feel acute claustrophobia. But after another moment it passes, and as long as you keep your corruption above 0, you should be fine and come out on top of this deal.

[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="178" name="Layer2 Star 1" tags="layer2" position="975,2225" size="100,100">[img[setup.ImagePath+&#39;Wonders/fate-crossingstar.png&#39;]]

After spending a few days seeking out the site where the star seems to have fallen, you find a lake surrounded by rugged rocks, slightly out of place among the dripping forest that surrounds it.

You step into the cool, clear water of the lake. It&#39;s surprisingly comfortable given the circumstances, but something in your head itches just the slghtest bit as you immerse yourself in the water.

In the morning, you wake up to a very different circumstance. Whose body do you wake up in?

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print $hiredCompanions[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print &quot;[[Switch|Layer2 Star 2][$temp to $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="179" name="Layer2 Star 2" tags="layer2" position="1100,2225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp2 = $carryWeight&gt;&gt;
&lt;&lt;set $carryWeight = $hiredCompanions[$temp].carry&gt;&gt;
&lt;&lt;set $corruption += 70&gt;&gt;
&lt;&lt;set $starUsed = 1&gt;&gt;
&lt;&lt;set $swapComp = $temp&gt;&gt;
&lt;&lt;set $tempTime = 3&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;set $hiredCompanions[$swapComp].carry = $temp2&gt;&gt;
&lt;&lt;CarryAdjust&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You&#39;ve woken up in the body of $hiredCompanions[$swapComp].name! And $hiredCompanions[$swapComp].name has woken up in your body!

How do you feel? Did you ask your companion before the switch? Be prepared for your relationship to change if they didn&#39;t want this.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp = $app.osex&gt;&gt;
&lt;&lt;set $temp2 = $app.gender&gt;&gt;
&lt;&lt;set $app.osex = $hiredCompanions[$swapComp].osex&gt;&gt;
&lt;&lt;set $app.sex = $hiredCompanions[$swapComp].osex&gt;&gt;
&lt;&lt;set $app.breasts = $hiredCompanions[$swapComp].obreasts&gt;&gt;
&lt;&lt;set $app.penis = $hiredCompanions[$swapComp].openis&gt;&gt;
&lt;&lt;set $app.ogender = $hiredCompanions[$swapComp].ogender&gt;&gt;
&lt;&lt;set $app.oheight = $hiredCompanions[$swapComp].oheight&gt;&gt;
&lt;&lt;set $app.height = $app.oheight + $app.modheight&gt;&gt;
&lt;&lt;set $app.hairColor = $hiredCompanions[$swapComp].hairColor&gt;&gt;
&lt;&lt;set $app.skinColor = $hiredCompanions[$swapComp].skinColor&gt;&gt;
&lt;&lt;set $app.desc += $hiredCompanions[$swapComp].appDesc&gt;&gt;

&lt;&lt;set $app.switch=true&gt;&gt;
&lt;&lt;Update_MC_Speech&gt;&gt;

&lt;&lt;if $hiredCompanions[$swapComp].name==&quot;Maru&quot;&gt;&gt;
	&lt;&lt;set $companionMaru.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionMaru.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionMaru.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionMaru.affec -= (7-$hsswear)&gt;&gt;
	&lt;&lt;set $companionMaru.swap = true&gt;&gt;

	&lt;&lt;say $companionMaru&gt;&gt; Huh? what happened to me? Why do I feel so strange? And why am I also standing right there?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Your old body points at you, a look of confusion across their face.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; I&#39;m sorry Maru, I had to do this. Trust me, it&#39;s better for the whole expedition in the long run.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionMaru&gt;&gt; You took my body? How... I... &lt;&lt;/say&gt;&gt;&lt;br&gt;
	He breaks down in tears. It&#39;s strange to see your old body sobbing from this perspective.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Please stop crying, we might even be able to reverse this eventually with another wonder!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionMaru&gt;&gt; You think? Do you promise to change me back if we do?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Absolutely! &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;elseif $hiredCompanions[$swapComp].name==&quot;Lily&quot;&gt;&gt;
	&lt;&lt;set $companionLily.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionLily.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionLily.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionLily.affec -= (7-$hsswear)&gt;&gt;
	&lt;&lt;set $companionLily.swap = true&gt;&gt;
		&lt;&lt;say $companionLily&gt;&gt; What the hell? Why do I see myself over there?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Your old body points towards you accusingly.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; I&#39;m sorry Lily, I had to do this. Trust me it&#39;s better for the whole expedition in the long run&lt;&lt;/say&gt;&gt;&lt;br&gt;
	As Lily looks down she notices she is not in her own body anymore.&lt;br&gt;&lt;br&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
	&lt;&lt;say $companionLily&gt;&gt; What? I&#39;m your body now? Oh my god, I&#39;ve turned into a man?! No I can&#39;t be! My beautiful face, I...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She&#39;s gone in a full blown meltdown, bumbling incoherently&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt;Lily! Snap out of it! There are worse things than...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Lily fixes her gaze at you and punches you in the face. You fall back, shocked&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt; WORSE THAN THIS!?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	You look back up to her in shock, afraid that she may become even more violent. Looking back at you she softens slightly.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt; Ah shit, I&#39;m sorry. I shouldn&#39;t have hit you, especially since it would now count as a guy hitting a girl.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She scowls at that thought.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; It&#39;s okay, I guess I deserved that one.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt; Yeah, you kind of did. But at the very least I should avoid damaging that perfect face while you&#39;re borrowing it. Be sure to return it to me soon, okay?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She gives you a bit of a wry smile and you nod in approval. You have never seen her so angry as just now and feel that she is probably still just as angry, even if she isn&#39;t showing it overtly. Apparently she valued her own body even more than you thought.&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $companionLily.affec-=-3&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;say $companionLily&gt;&gt; What? I&#39;m your body now? But my beautiful angelic face and my...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She looks as if she is a about to have a meltdown, but then she grits her teeth and begins walking towards you.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt; You better fix this right now!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She grabs you by your collar, looking like she might choke the life out of you.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Stop! Stop! I promise I&#39;ll try to fix it if I find a way!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionLily&gt;&gt; IF? you better pray for your own sake that there is a way!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	You gulp. You have never seen her so angry. Apparently she valued her own body even more than you thought.&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif $hiredCompanions[$swapComp].name==&quot;Khemia&quot;&gt;&gt;
	&lt;&lt;set $companionKhemia.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionKhemia.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionKhemia.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionKhemia.affec -= (7-$hsswear)&gt;&gt;
	&lt;&lt;set $companionKhemia.swap = true&gt;&gt;
	&lt;&lt;say $companionKhemia&gt;&gt; I feel weird, $mc.name. Why do I feel so sluggish?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; I&#39;m sorry Khemia, I had to do this. Trust me it&#39;s better for the whole expedition in the long run.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	It seems he only just now notices that he is looking at his own former body.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionKhemia&gt;&gt; What the hell?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	He looks down at himself and sees he is now the inhabitant of your former body instead of his own.&lt;br&gt;&lt;br&gt;
	&lt;&lt;if $temp==&#39;female&#39;&gt;&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; You asshole! You switched our bodies? Do you know how long I&#39;ve trained that body you now STOLE from me?!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		He stomps over as he seems ready to punch you in the face. His smaller feminine body however, looks much less intimidating as it struts over to you in a fit.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt; Whoa, hold on, lets talk this out!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; There is nothing to talk about, asshole. Not only did you steal my body, but on top off that I&#39;m now stuck as a freaking chick as well!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt; Look, it might not even be permanent, who knows?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; WHO KNOWS? I KNOW I&#39;M GOING TO FUCK YOU UP IF THIS IS PERMANENT!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;set $companionKhemia.affec-=3&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; You asshole! you switched our bodies? Do you know how long I&#39;ve trained that body you now STOLE from me?!&lt;&lt;/say&gt;&gt;&lt;br&gt;
		He stomps over as he seems ready to punch you in the face.&lt;br&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt; Whoa hold on, hold on, lets talk this out&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; There is nothing to talk about asshole. You stole my body, and in the Abyss we call people who steal things bandits, and I know how to handle bandits...&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $mc&gt;&gt; Look, it might not even be permanent, who knows?&lt;&lt;/say&gt;&gt;&lt;br&gt;
		&lt;&lt;say $companionKhemia&gt;&gt; For your sake, it better not be... I guess I&#39;ll keep you safe for now, since you are holding my body hostage.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $hiredCompanions[$swapComp].name==&quot;Cherry&quot;&gt;&gt;
	&lt;&lt;set $companionCherry.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionCherry.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionCherry.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionCherry.affec -= (5-$hsswear)&gt;&gt;
	&lt;&lt;set $companionCherry.swap = true&gt;&gt;
	&lt;&lt;say $companionCherry&gt;&gt; Huh? What happened? Why am I looking at myself?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; I&#39;m sorry Cherry, I had to do this. Trust me, it&#39;s better for the whole expedition in the long run.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionCherry&gt;&gt; You switched bodies with me?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She looks down in silence. After a while you decide to speak up.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Are you okay, Cherry?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionCherry&gt;&gt; I don&#39;t know... I thought after all this time I really stopped caring... But if that&#39;s true, why do I still feel sad now?&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Ah, again, sorry I had to do this. If I can find a way to reverse this I absolutely will.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionCherry&gt;&gt; You saying that makes me a little less sad, I think.&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;elseif $hiredCompanions[$swapComp].name==&quot;Cloud&quot;&gt;&gt;
	&lt;&lt;set $companionCloud.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionCloud.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionCloud.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionCloud.affec -= (7-$hsswear)&gt;&gt;
	&lt;&lt;set $companionCloud.swap = true&gt;&gt;
	&lt;&lt;say $companionCloud&gt;&gt; There&#39;s something wrong...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	He immediately sticks two fingers in his throat and starts to throw up.&lt;br&gt;
	&lt;&lt;say $companionCloud&gt;&gt; Quick, water, somebody! I think I&#39;ve been poisoned, I&#39;m hallucinating and I feel wrong.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Stop! Look, I&#39;m sorry Cloud, but I had to do this, I switched our bodies. Trust me, it&#39;s better for the whole expedition in the long run&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Cloud seems to calm down and look at you with an icy glare.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionCloud&gt;&gt; You fucking traitor, how could you? I trusted you, and trust is the most important thing on an expedition like this.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Again, I&#39;m sorry Cloud, if there is a way to switch our bodies ba...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionCloud&gt;&gt; You think I care about the body? Well, okay, maybe a little, but it&#39;s more that we were supposed to have each others backs down here. And you just screwed me over big time. But you know what, the jokes on you &#39;cause more than a few people want your new face dead. You better stick with me real close if you know what&#39;s good for you.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	You gulp&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Yes, sir!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionCloud&gt;&gt; And after this expedition&#39;s over, you&#39;re comming with me, because I can&#39;t really show up to some people looking like this...&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;elseif $hiredCompanions[$swapComp].name==&quot;Saeko&quot;&gt;&gt;
	&lt;&lt;set $companionSaeko.genderVoice = $temp2&gt;&gt;
	&lt;&lt;if $temp==&#39;male&#39;&gt;&gt;
		&lt;&lt;set $companionSaeko.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $companionSaeko.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $mc.imageIcon=$hiredCompanions[$swapComp].imageIcon&gt;&gt;
	&lt;&lt;set $companionSaeko.affec -= (7-$hsswear)&gt;&gt;
	&lt;&lt;set $companionSaeko.swap = true&gt;&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; Huh? What is...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She inspects her own body and than looks up at her former body. You see her eyes go wide in sudden realization.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; Tell me you didn&#39;t use the Fate Crossing Star pond to switch our bodies?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Uh, I&#39;m sorry, I kinda did. But it was for the benefit of...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	You stop talking as you see Saeko already sniffeling and on the verge of breaking down. After a moment of silence she partially collects herself.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; I suppose I get it. Two people just switching bodies is better than one member becoming more increasingly hindered by curses. I get it. I get it.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She still sniffles a bit between mumbling. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Look, its just like you said. I...&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; I SAID I GET IT!&lt;&lt;/say&gt;&gt;&lt;br&gt;
	You fall silent for a bit.&lt;br&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; If it makes you feel better, I&#39;ll promise to switch back our bodies as soon as I can.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	Saeko rolls her eyes dramatically in response. &lt;br&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; Yeah, no problem, we&#39;ll just use the other body switching wonder we know of to trade back. &lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $mc&gt;&gt; Great! Where is it?&lt;&lt;/say&gt;&gt;&lt;br&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; You&#39;re eiher an idiot or cruel, and I honestly can&#39;t tell which right now.&lt;&lt;/say&gt;&gt;&lt;br&gt;
	She walks off with your body, still clearly very much annoyed.
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.length&gt;1&gt;&gt;
The rest of your companions are clearly not aproving of your action as well&lt;br&gt;&lt;br&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Maru&quot;) &amp;&amp; $companionMaru.swap==false&gt;&gt;
	&lt;&lt;set $companionMaru.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionMaru&gt;&gt; That&#39;s not nice... &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Lily&quot;) &amp;&amp; $companionLily.swap==false&gt;&gt;
	&lt;&lt;set $companionLily.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionLily&gt;&gt; How could you?! &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $companionKhemia.swap==false&gt;&gt;
	&lt;&lt;set $companionKhemia.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionKhemia&gt;&gt; Not cool! Why would you do that? &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;) &amp;&amp; $companionCherry.swap==false&gt;&gt;
	&lt;&lt;set $companionCherry.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionCherry&gt;&gt; I thought you were different... &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;) &amp;&amp; $companionCloud.swap==false&gt;&gt;
	&lt;&lt;set $companionCloud.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionCloud&gt;&gt; Tsk. Untrustworthy... &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $companionSaeko.swap==false&gt;&gt;
	&lt;&lt;set $companionSaeko.affec -= (3-$hsswear)&gt;&gt;
	&lt;&lt;say $companionSaeko&gt;&gt; Your modus operandi has been noted... &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

[[Continue exploring the layer|Layer2 Hub]]
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="180" name="Take on Libido Reinforcement B" tags="layer2" position="1225,2225" size="100,100">&lt;&lt;set $playerCurses.push($curse13)&gt;&gt;&lt;&lt;set $corruption += $curse13.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse13)&gt;&gt;

You have successfully taken on the $curse13.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="181" name="Take on Gender Reversal B" tags="layer2" position="100,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse14)&gt;&gt;&lt;&lt;set $corruption += $curse14.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse14)&gt;&gt;

You have successfully taken on the $curse14.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="182" name="Take on Asset Robustness B" tags="layer2" position="225,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse15)&gt;&gt;&lt;&lt;set $corruption += $curse15.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse15)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact B&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

You have successfully taken on the $curse15.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="183" name="Take on Age Reduction A" tags="layer2" position="350,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse16)&gt;&gt;&lt;&lt;set $corruption += $curse16.corr&gt;&gt;&lt;&lt;set $AgeLog.push($curse16)&gt;&gt;

You have successfully taken on the $curse16.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="184" name="Take on Fluffy Ears" tags="layer2" position="475,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse17)&gt;&gt;&lt;&lt;set $corruption += $curse17.corr&gt;&gt;

You have successfully taken on the $curse17.name curse. Hopefully you are ok with accepting the permanent consequences.

What type of ears would you like to gain?

&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry cat&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;fluffy dog&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;floppy cow&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry monkey&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry rabbit&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry fox&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry mouse&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;pig&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse17.variation&quot; &quot;furry horse&quot; &gt;&gt; Horse

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="185" name="Take on Fluffy Tail" tags="layer2" position="600,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse18)&gt;&gt;&lt;&lt;set $corruption += $curse18.corr&gt;&gt;

A shiver runs down your spine, but it doesn&#39;t stop at the bottom. The shiver continues towards an imaginary extension of your spine that moves outward from directly above your butt. You involuntarily squirm at first, due to the unfamiliar sensation, but after a few seconds you&#39;re able to accomodate it and accept it as just another physical sensation, like your body was adapting to the new sensory inputs.

When you look behind you to see what happened, you&#39;re surprised by the sight of a fluffy tail that seems to respond to your thoughts! It&#39;s your own tail, a part of your own body! This may take some time to get used to.

What type of tail did you gain?

&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;flowing cat&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;wagging dog&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;lazy cow&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;prehensile monkey&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;fluffy rabbit&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;bushy fox&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;long mouse&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;twisted pig&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse18.variation&quot; &quot;swaying horse&quot; &gt;&gt; Horse

[[Accept more curses from the second layer|Layer2 Curses][$app.tail.push($tail)]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub][$app.tail.push($tail)]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2][$app.tail.push($tail)]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="186" name="Take on Maximum Fluff" tags="layer2" position="725,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse19)&gt;&gt;&lt;&lt;set $corruption += $curse19.corr&gt;&gt;

You have successfully taken on the $curse19.name curse. Hopefully you are ok with accepting the permanent consequences.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hair Removal&quot;)&gt;&gt;
	&lt;&lt;print &quot;&lt;br&gt;You have lost the corruption gained from Hair Removal.&lt;br&gt;&quot;&gt;&gt;&lt;&lt;set $corruption -= 5&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
What type of fur would you like to gain?

&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cat-furred&quot; checked&gt;&gt; Cat
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;dog-furred&quot; &gt;&gt; Dog
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;cow-furred&quot; &gt;&gt; Cow
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;monkey-furred&quot; &gt;&gt; Monkey
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;rabbit-furred&quot; &gt;&gt; Rabbit
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;fox-furred&quot; &gt;&gt; Fox
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;mouse-furred&quot; &gt;&gt; Mouse
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;pig-furred&quot; &gt;&gt; Pig
&lt;&lt;radiobutton &quot;$curse19.variation&quot; &quot;horse-furred&quot; &gt;&gt; Horse

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="187" name="Take on Heat/Rut" tags="layer2" position="850,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse20)&gt;&gt;&lt;&lt;set $corruption += $curse20.corr&gt;&gt;

You have successfully taken on the $curse20.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="188" name="Take on Lightweight" tags="layer2" position="975,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse21)&gt;&gt;&lt;&lt;set $corruption += $curse21.corr&gt;&gt;

You have successfully taken on the $curse21.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="189" name="Take on Sex Switcheroo" tags="layer2" position="1100,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse22)&gt;&gt;&lt;&lt;set $corruption += $curse22.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse22)&gt;&gt;

You have successfully taken on the $curse22.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="190" name="Take on Futa Fun" tags="layer2" position="1225,2350" size="100,100">&lt;&lt;set $playerCurses.push($curse23)&gt;&gt;&lt;&lt;set $corruption += $curse23.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse23)&gt;&gt;

You have successfully taken on the $curse23.name curse. Hopefully you are ok with accepting the permanent consequences.

You seem to have been one of the people this curse leaves with both a penis and a vagina, a true futa, as the name of this curse implies. And it seems like your new parts did scale with your old ones!

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="191" name="Take on Blushing Virgin" tags="layer2" position="100,2475" size="100,100">&lt;&lt;set $playerCurses.push($curse24)&gt;&gt;&lt;&lt;set $corruption += $curse24.corr&gt;&gt;

You have successfully taken on the $curse24.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the second layer|Layer2 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 2|Layer2 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="192" name="Pick up the Firmament Pigment" tags="layer2" position="225,2475" size="100,100">&lt;&lt;set $ownedRelics.push($relic10)&gt;&gt;&lt;&lt;set $corruption -= ($relic10.corr - $corRed)&gt;&gt;

You have successfully taken the $relic1.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="193" name="Pick up the Pearly Gates" tags="layer2" position="350,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic11)&gt;&gt;
&lt;&lt;set $corruption -= ($relic11.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic11.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic11.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="194" name="Pick up the World Stone" tags="layer2" position="475,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic12)&gt;&gt;
&lt;&lt;set $corruption -= ($relic12.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic12.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic12.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can try working out with this Relic. It can both improve your muscle tone and your carrying capacity if you exercise regularly.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="195" name="Pick up the Forest&#39;s Gift" tags="layer2" position="600,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic13)&gt;&gt;
&lt;&lt;set $corruption -= ($relic13.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic13.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic13.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="196" name="Pick up the Harmless Harmony" tags="layer2" position="725,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic14)&gt;&gt;
&lt;&lt;set $corruption -= ($relic14.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic14.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic14.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="197" name="Pick up the Umbra Trident" tags="layer2" position="850,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic15)&gt;&gt;
&lt;&lt;set $corruption -= ($relic15.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic15.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic15.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="198" name="Pick up the Event Horizon" tags="layer2" position="975,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic16)&gt;&gt;
&lt;&lt;set $corruption -= ($relic16.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic16.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic16.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="199" name="Pick up the Heart-stealing Stole" tags="layer2" position="1100,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic17)&gt;&gt;
&lt;&lt;set $corruption -= ($relic17.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic17.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic17.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You may want to start wearing this Relic regularly, it can significantly speed up how long it takes your companions to warm up to you.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="200" name="Pick up the Effacing Asperity" tags="layer2" position="1225,2475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic18)&gt;&gt;
&lt;&lt;set $corruption -= ($relic18.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic18.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic18.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="201" name="Pick up the Wholly Ale" tags="layer2" position="100,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic19)&gt;&gt;
&lt;&lt;set $corruption -= ($relic19.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic19.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic19.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="202" name="Pick up the Memoir Remnant" tags="layer2" position="225,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic20)&gt;&gt;
&lt;&lt;set $corruption -= ($relic20.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic20.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic20.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="203" name="Pick up the Gleam Dazer" tags="layer2" position="350,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic21)&gt;&gt;
&lt;&lt;set $corruption -= ($relic21.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic21.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic21.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can use this Relic to see into your future and see what awaits you on the layer below the one you currently inhabit.

[[Continue searching for the relics of layer 2|Layer2 Relics]]
[[Continue exploring the second layer|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="204" name="Layer2 Threat1 Main" tags="image layer2" position="475,2600" size="100,100">&lt;&lt;set $timeL2T1 -= 4&gt;&gt;
[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-threats.png&#39;]]

How do you want to deal with the beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	A simple beast like this could be fought off by even an amateur using a human weapon, like a sword.&lt;br&gt;[[Fight it off with your sword|Layer2 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 2&gt;&gt;
	While the beast is large and burly, a few shots from a gun will easily bring it down.&lt;br&gt;
	[[Shoot it 3 times with your pistol|Layer2 Hub][$items[20].count -= 3]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[1].count &gt; 4&gt;&gt;
	The ravenous creature doesn&#39;t want much besides food. Luckily you have an ample supply, so you could give it some of your rations and cause it to leave you alone.&lt;br&gt;
	[[Feed it 5 days of your food rations|Layer2 Hub][$items[1].count -= 5]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.length &gt; 3&gt;&gt;
	[[Scare it off with your large group of companions|Layer2 Hub]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun and is able to easily dispatch the beast with only a few well-placed shots.
[[Defeat it with the Brave Vector|Layer2 Hub]]
&lt;&lt;/if&gt;&gt;

[[Allow it to overpower you|Layer2 Hub][$status.duration = (4 - $statRed), $status.penalty = 1]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the beast approaches you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer2 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer2 Hub]]</tw-passagedata><tw-passagedata pid="205" name="Layer2 Flasks" tags="layer2" position="600,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL1 += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/bewitcherplants.png&#39;]]

&lt;&lt;if $abyssKnow == 0&gt;&gt;
You dip each of your flasks into the miasma-contaminated rainwater dripping all around you. You know that this will likely increase the size of your future family, but you need the water. Better to become a little bit more corrupted than to die of dehydration, right?
&lt;&lt;else&gt;&gt;
Using your knowledge of the Abyss, you look around briefly before finding the Bewitcher Plants you were looking for. Carefully, you extract water from the flowers, checking it to make sure it&#39;s pure before giving it a taste.

A few tests and you can confirm you have pure water to fill your flasks with! Now is a great time to collect water for your future travels.
&lt;&lt;/if&gt;&gt;

[[Return to exploring your food and water options on this layer|Layer2 Forage]]</tw-passagedata><tw-passagedata pid="206" name="Layer2 Exit2" tags="layer2" position="725,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;set $tempTime=5&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;

	&lt;&lt;if $timeL2T1 &gt; 3 &amp;&amp; $hiredCompanions.length &lt; 4&gt;&gt;
	During your long hike towards the third layer you hear a quiet growling in the distance. After only a few more moments, it isn&#39;t in the distance any more, and it isn&#39;t quiet. A great 4-legged beast slobbers as it blocks your path. &lt;br&gt;&lt;br&gt;

	[[Deal with the Baying Gourmet|Layer2 Threat1 Descend]]
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $tempTime = 1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
/* 	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL2 += 1&gt;&gt;
				&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $bewitchBabies += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL2 += 1&gt;&gt;
	&lt;&lt;if $mudHunt == 1 &amp;&amp; $items[20].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[20].count -= 1&gt;&gt;
	&lt;&lt;elseif $mudHunt == 0&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $LibidoLog.push($ForageFoodMajor )&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $lastFlan=$time+1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;*/
&lt;&lt;/for&gt;&gt;

&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
Subtle changes in your surroundings continue, large rocks start to appear in your path, and the entire terrain changes from the lush rainforest you previously found yourself in to a more temperate forest. But slowly the trees become more sparse and the rocks become more common.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Enter the deep caverns|Layer3 1]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="207" name="Layer2 Threat1 Descend" tags="image layer2" position="850,2600" size="100,100">&lt;&lt;set $timeL2T1 -= 4&gt;&gt;
[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-threats.png&#39;]]

How do you want to deal with the beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	A simple beast like this could be fought off by even an amateur using a human weapon, like a sword.&lt;br&gt;[[Fight it off with your sword|Layer2 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 2&gt;&gt;
	While the beast is large and burly, a few shots from a gun will easily bring it down.&lt;br&gt;
	[[Shoot it 3 times with your pistol|Layer2 Exit2][$items[20].count -= 3]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[1].count &gt; 4&gt;&gt;
	The ravenous creature doesn&#39;t want much besides food. Luckily you have an ample supply, so you could give it some of your rations and cause it to leave you alone.&lt;br&gt;
	[[Feed it 5 days of your food rations|Layer2 Exit2][$items[1].count -= 5]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.length &gt; 3&gt;&gt;
	[[Scare it off with your large group of companions|Layer2 Exit2]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun and is able to easily dispatch the beast with only a few well-placed shots.
[[Defeat it with the Brave Vector|Layer2 Exit2]]
&lt;&lt;/if&gt;&gt;

[[Allow it to overpower you|Layer2 Hub][$status.duration = (4 - $statRed), $status.penalty = 1]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the beast approaches you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer2 Exit2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer2 Exit2]]</tw-passagedata><tw-passagedata pid="208" name="Layer2 Ascend2" tags="layer2" position="975,2600" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;set $tempTime=5&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;
	&lt;&lt;if $timeL2T1 &gt; 3 &amp;&amp; $hiredCompanions.length &lt; 4&gt;&gt;
		&lt;br&gt;During your long hike back up towards the first layer you hear a quiet growling in the distance. After only a few more moments, it isn&#39;t in the distance any more, and it isn&#39;t quiet. A great 4-legged beast slobbers as it blocks your path. &lt;br&gt;&lt;br&gt;

		[[Deal with the Baying Gourmet|Layer2 Threat1 Ascend]]&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $items[1].count &gt; 9&gt;&gt;
			&lt;&lt;set $timeL2T1 += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $tempTime=1&gt;&gt;
		&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
/*	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL2 += 1&gt;&gt;
				&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $bewitchBabies += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL2 += 1&gt;&gt;
	&lt;&lt;if $mudHunt == 1 &amp;&amp; $items[20].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[20].count -= 1&gt;&gt;
	&lt;&lt;elseif $mudHunt == 0&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $LibidoLog.push($ForageFoodMajor )&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $lastFlan=$time+1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;  */
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption -= (15 - $corRed)&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You continue your hike and try to keep somewhat dry from the droplets continually falling on your head, but eventually the dripping halts. You find yourself first in a sparse forest, then eventually back to the open, picturesque plains of the first layer.
&lt;&lt;BreastCorrected&gt;&gt;
&lt;&lt;appGender&gt;&gt;
&lt;&lt;HeightCorrected&gt;&gt;
&lt;&lt;Threat1Criterion&gt;&gt;
&lt;&lt;if $threat1Crit == 1&gt;&gt;
	&lt;br&gt;Worn down by the long trek up through the dense jungle of the previous layer, you&#39;re relieved when you finally reach the bridge to the Outcast Village. However, upon approaching the bridge a figure appears from behind a column.

	&lt;&lt;say $Banditleader&gt;&gt; Well now, what do we have here?&lt;&lt;/say&gt;&gt;

	Turning around, you find yourself surrounded by a group of bandits, shrouded in ragged cloaks, emerging from the bushes behind you.

	&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $hiredCompanions.length &lt; 1&gt;&gt;
		&lt;&lt;say $Banditleader&gt;&gt; It looks like a &lt;&lt;PerceivedStature&gt;&gt; &lt;&lt;PerceivedGender&gt;&gt; all by &lt;&lt;ObjectivePronoun&gt;&gt;self, with an awful lot of valuable stuff for 1 person. How about we take that stuff of your hands so you don&#39;t have to worry about it anymore, hmm?&lt;&lt;/say&gt;&gt;
	&lt;&lt;elseif $hiredCompanions.length == 1 &amp;&amp; $app.appAge&gt;13 &gt;&gt;
		&lt;&lt;say $Banditleader&gt;&gt; It looks like a &lt;&lt;PerceivedStature&gt;&gt; &lt;&lt;PerceivedGender&gt;&gt; on date with &lt;&lt;PossesivePronoun&gt;&gt; love. You seem to be carrying more than you need for your date, hmm? How about we take some of that stuff off your hands, so you don&#39;t have to worry about it anymore?&lt;&lt;/say&gt;&gt;
	&lt;&lt;elseif $hiredCompanions.length == 1 &amp;&amp; $app.appAge&lt;=13 &gt;&gt;
		&lt;&lt;say $Banditleader&gt;&gt; It looks like a &lt;&lt;PerceivedStature&gt;&gt; &lt;&lt;PerceivedGender&gt;&gt; on a stroll with &lt;&lt;PossesivePronoun&gt;&gt; babysitter. It seems you&#39;re carrying a lot of adult stuff that you don&#39;t really need. How about we take that stuff of your hands, so you don&#39;t have to worry about it anymore, hmm?&lt;&lt;/say&gt;&gt; &lt;br&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;say $Banditleader&gt;&gt; It looks like a &lt;&lt;PerceivedStature&gt;&gt; &lt;&lt;PerceivedGender&gt;&gt; with &lt;&lt;PossesivePronoun&gt;&gt; merry band of losers. Don&#39;t worry, we wont bite. As long as you do as we ask, we&#39;re very friendly. How about we take that stuff off your hands, so you don&#39;t have to worry about keeping it safe anymore, hmm?&lt;&lt;/say&gt;&gt;&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/nobr&gt;&gt;

	[[Deal with the opportunistic bandits|Layer1 Threat1 Ascend]]&lt;br&gt;
&lt;&lt;else&gt;&gt;

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

	[[Return to the first layer|Layer1 Hub]]
&lt;&lt;/if&gt;&gt;



&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="209" name="Layer2 Threat1 Ascend" tags="image layer2" position="1100,2600" size="100,100">&lt;&lt;set $timeL2T1 -= 4&gt;&gt;
[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-threats.png&#39;]]

How do you want to deal with the beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	A simple beast like this could be fought off by even an amateur using a human weapon, like a sword.&lt;br&gt;[[Fight it off with your sword|Layer2 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 2&gt;&gt;
	While the beast is large and burly, a few shots from a gun will easily bring it down.&lt;br&gt;
	[[Shoot it 3 times with your pistol|Layer2 Ascend2][$items[20].count -= 3]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[1].count &gt; 4&gt;&gt;
	The ravenous creature doesn&#39;t want much besides food. Luckily you have an ample supply, so you could give it some of your rations and cause it to leave you alone.&lt;br&gt;
	[[Feed it 5 days of your food rations|Layer2 Ascend2][$items[1].count -= 5]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.length &gt; 3&gt;&gt;
	[[Scare it off with your large group of companions|Layer2 Ascend2]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun and is able to easily dispatch the beast with only a few well-placed shots.
[[Defeat it with the Brave Vector|Layer2 Ascend2]]
&lt;&lt;/if&gt;&gt;

[[Allow it to overpower you|Layer2 Ascend2][$status.duration = (4 - $statRed), $status.penalty = 1]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the beast approaches you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer2 Ascend2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer2 Ascend2]]</tw-passagedata><tw-passagedata pid="210" name="Layer2 Curses Random" tags="" position="1225,2600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,11) + 12&gt;&gt;

	&lt;&lt;if ($temp1 == 11) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement B&quot;) &amp;&amp; $StoredCurse.name != &quot;Libido Reinforcement B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 12) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gender Reversal B&quot;) &amp;&amp; $StoredCurse.name != &quot;Gender Reversal B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp == 13)&amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Asset Robustness B&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;)) &amp;&amp; $StoredCurse.name != &quot;Asset Robustness B&quot; &amp;&amp; $StoredCurse.name != &quot;Shrunken Assets&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 14) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Age Reduction A&quot;) &amp;&amp; $StoredCurse.name != &quot;Age Reduction A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 15) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Fluffy Ears&quot;) &amp;&amp; $StoredCurse.name != &quot;Fluffy Ears&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 16) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Fluffy Tail&quot;) &amp;&amp; $StoredCurse.name != &quot;Fluffy Tail&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 17) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Maximum Fluff&quot;) &amp;&amp; $StoredCurse.name != &quot;Maximum Fluff&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 18) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Heat/Rut&quot;) &amp;&amp; $StoredCurse.name != &quot;Heat/Rut&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 19) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Lightweight&quot;) &amp;&amp; $StoredCurse.name != &quot;Lightweight&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 21) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Sex Switcheroo&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;)) &amp;&amp; $StoredCurse.name != &quot;Sex Switcheroo&quot; &amp;&amp; $StoredCurse.name != &quot;Futa Fun&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 21) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Sex Switcheroo&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;)) &amp;&amp; $StoredCurse.name != &quot;Sex Switcheroo&quot; &amp;&amp; $StoredCurse.name != &quot;Futa Fun&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if ($temp1 == 23) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Blushing Virgin&quot;) &amp;&amp; $StoredCurse.name != &quot;Blushing Virgin&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="211" name="Escape Balloon L2" tags="layer2" position="100,2725" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 2&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer2&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer2&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
The drops of the rain create a constant pattering sound on the surface of your balloon. Luckily it is soundly weather-proof, but a significant amount of the water drips down onto you, making your journey through this layer suitably wet, similar to the trip down.

[[Ascend to next layer|Escape Balloon L1][$corruption -= (15 - $corRed)]]
[[Hover on this layer to take in a curse|Layer2 Curses]]
[[Get off the balloon on this layer|Layer2 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="212" name="L2 LLew LInhum HAge HDub" tags="ending" position="225,2725" size="100,100">Its been a long journey but everything needs to end. After long contemplation, you decide that it is time to settle down and enjoy your life. With all the money you made you even had the chance to improve the lives of a lot of people. So you chose to stay on the second layer, where you could really make a difference. The first thing you needed to do was gain their trust, so you imported food from the first layer and surface. that act brings you into the good books of almost everyone and allows you to takel the next biggest problem. The criminal activity in the second layer was even worse than expected, but you had an idea how to solve it. You talked to the mayor of the Village and after a little &quot;donation&quot; he allows you to start a police force. With the money you had left you founded expeditions to get more relics which you sold to pay the police force and keep importing food. This continued some time and you became quickly the most popular person on the second layer and even got elected as the mayor. Under your rule Downcast village grow almost to twice its original size. one of your most ingenious ideas was to turn it into a beloved tourist spot. Sometimes you start to miss your old life, the excitement the adventure, and even the struggle to survive. But then you look down on the city you helpt to create and remember why you gave it all up, You wanted to do good in the Abyss, and by god you did it.</tw-passagedata><tw-passagedata pid="213" name="L2 LLew LInhum HAge LDub" tags="ending" position="350,2725" size="100,100">You are done with this.
You started so full of hope, dreams and energy, you thought with enough determination and time you would make it to the deepest part of the Abyss ... and now look at you, your spirit is broken, your money gone and your dreams dashed. And so you find yourself back in the second layer, the heavy rain hammering on you as to remind you of your failure. The only good thing that happened to you on this good forsaken journey is that you became strong or maybe you should call it cunning or perhapse experienced, it doesn&#39;t matter anyways. What counts is getting results and your Abyss experienced learned you how to get results, that&#39;s stremgth in itself. And you are going to use this strength to your advantage like you should have done from the start. The most important lessons that you learned are 1. Kill or be killed 2. take what you need and then a little more and 3. No regrets no mercy. The Abyss is cold and uncaring and you adapted quickly to it. So you start the rest of your life. Soon everyone knows and fears you. You are feard as one of the best mercenary or assasins, not only on the second layer but also on the first and even the surface.  Your off days are spent drinking to forget, but it never wörks for long since the nightmares are just a drink too much and a drink too few away, always lurking in the back of your head.</tw-passagedata><tw-passagedata pid="214" name="L2 LLew LInhum LAge HDub" tags="ending" position="475,2725" size="100,100">After a long time wandering in the Abyss you are tired.
You have seen wonders and horrors alike and survived till now.
But you had to pay a heavy price. most of your autonomy is gone. You look down on yourself and see once again your childish body as the heavy rain of the second layer purs down on you.
But not everything is hopeless. On your grueling travels through the abys you made quite the fortune, making you one of the richest persons around.
But you still have the body and with that, the strength of a child, that and sporadic acts of childishness are problems you cannot overcome alone.
So you seek out the help of somebody strong who can protect you, and you find Dimitry who is willing to help you out in exchange for your coin. Dimitry lives in a slightly bigger house than common and is one of the nicest and strongest people in the second layer. It was a gamble to go to him for help but of all the people he was well known for having a soft spot for children as well as being honorable.
Soon you and Dimitry are growing closer and what began as a business deal has started to feel like a real family.
He protects you from the more unsavory people of the second layer and even trains you to hunt and fight better than before your glory days. He supports you when you wake up in the night plagued by nightmares from your old diving days. He listens to your tales about the wonders that you have seen and laughs and jokes with you. Once you are old enough again you start to hunt to support Demitry since the money you had was long spent and once your fully grown you plan to start delving again this time to support your new family.</tw-passagedata><tw-passagedata pid="215" name="L2 LLew LInhum LAge LDub" tags="ending" position="600,2725" size="100,100">You don’t know when it happened bur you remember you where in Downcast village when it happened. You just broke down. The Abyss had stripped you of most of you maturity and at the benefit of what? You don’t know if this childlike body was finally influencing your mental state or if it was the burden of constant struggle in general, but you broke down and you broke down hard. You cried so hard that even with constant rain of the second layer it was still clear that tears were flowing freely from your eyes. At some point a man stopped in front of you and asked what the matter was, half brawling and half stuttering you explained the whole story. He listens attentively, while you pour your heart out. At some point you calmed down and he speaks up for the first time in a while. ‘So you don’t have a lot of coin on you? Hmm there might be not much I can do than…’ He falls quiet for a while. ‘Look kid, there is something like a kids day care just ahead. In this town we have a lot of, let’s call them ‘unplanned kids’ being born. Maybe they can help you out as well, that’s all I offer’. You head towards the prescribed location and find an elderly lady with two younger aids looking over a bunch of kids, some even younger than you are. When you offer your last earnings for some food and shelter they look at each other but accept your offer anyway. They next few days you are looked after by them, although you get the feeling you are still being kept away from most of the kids, maybe its because they suspect you aren’t a normal kid or maybe it’s because they don’t want trouble with the parents of the kids who get pick-up at the end of the day. But all in all you are happy that you at least have some place to stay. You even see the man that gave you the lifesaving tip a couple of times walking by, as you wave happily to him. After a while though the old lady approaches you with the bad news that they have to put you out on the street again as they can’t support you without financial backing. You find yourself one the street once more, but within an hour the same man from before is in front of you again. ‘What happened?’ He grunts. ’They kicked me out because I had no money anymore’ you snicker. ‘How can they…?! Urgh I’ll have a word with them..’ and he walks off. He is back within a mere moments and he just waves you over. You don’t know how he did but you were allowed back. Things changed a little after that. The man, which you learned is called Dimitry started to actually visit you and would ask how they were treating you. While you didn’t care at first that you weren’t allowed to play with the other kids, you still felt somewhat adult after all, you started feeling left out and complained about it to Dimitry. That was the last time you played by yourself. As years went by Dimitry suddenly said you were going home with him that night. ‘Look kid, I just like it better when I can keep an eye on you. Besides I can teach you some fighting and hunting’. You still kept going to the day care during most days as Dimitry had to, in his word, ‘make sure you and I keep a roof over our heads’ but you spend more and more time with him. As you aged again and you become more proficient in the skills Dimitry learned you, you were more determined to ever to use them to pay him back. Pay him back for what you know he did for you, but also for what you suspected you didn’t know he did for you.</tw-passagedata><tw-passagedata pid="216" name="L2 LLew HInhum HAge HDub" tags="" position="725,2725" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="217" name="L2 LLew HInhum HAge LDub" tags="ending" position="850,2725" size="100,100">It&#39;s dark and cold in the cave you use as a refuge.
You had an interesting time in the Abyss. You saw amazing wonders and horrifying nightmares. But you paid a steep price for your adventure, you are unrecognizable as the one who started this journey, and your monstrous appearance scares even the strongest mercenary on the second layer. So you run to this cave just outside Downcast village where you now live.
Suddenly you hear a soft voice &quot; Are you the beast that understands the human language? or better known as the transformed adventurer?.&quot;
&quot;how do you know me?&quot; you ask. &quot;My employe knows a lot.&quot; the voice answers still not showing itself. &quot;If you have enough of this cave come to this address.&quot; And then the voice is gone, outside you find a piece of paper. Sometime later you sit before a smiling man. He is not quite fat but still a bit plump and has a long mustache. &quot;Nice to meet you my name is mister Gerard Reed and I want to hire you as my personal bodyguard&quot;.&quot;... Why?&quot; is all you can muster after your initial reception surprise. &quot;Because you look like a monster... and have to be quite strong if the Abyss blessing has progressed this far, so what do you say? You don&#39;t have to do a lot just look menacing and help with the ... business a bit. In exchange, you will have a roof over your head and food on the table ... I think thats better than a cave don&#39;t you agree?&quot;. Well, what options do you have really, So you work for Mister G. Reed and become one of his most valued ... employes sowing fear and panic in the hearts of any who would oppose him.</tw-passagedata><tw-passagedata pid="218" name="L2 LLew HInhum LAge HDub" tags="" position="975,2725" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="219" name="L2 LLew HInhum LAge LDub" tags="" position="1100,2725" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="220" name="L2 HLew LInhum HAge HDub" tags="ending" position="1225,2725" size="100,100">They say money and power corrupt people, but they never delved into the Abyss.
No. the Abyss corrupts people and the money and power help you to cope with that, so it&#39;s only natural that you need more money.
After going around Downcast village looking to simply buy people to sate your sexual urges you suddenly find yourself in the office of mister Gerard Reed. &#39;So word on the street is that you trying to buy people. Now tell me are you a rich addict or an over enthousiastic investor&#39;. He leans back in his big leather office chair. &quot;A bit of both I guess&#39; You stammer, already feeling the heat rising in your body again. &#39;And I was hoping you could help, you see I have specific idea..&#39; You continue with some more determination. &#39;Why do you think I would be interesed in this idea of yours? I mainly wanted to meet you because you were kicking up dust. I don&#39;t like people kicking up dust in my little village&#39; He says with a bit of an agetated tone. &#39;I suggest you you use all that money you apperently have to enjoy your retirement diver&#39;. You scrape your throat, feeling a bit desperate. &quot;.Well, I do have enough to get me started but my funds will run out rather quickly and the idea I had in mind is euh.. how should I call it. It needs someone who can deal with delicate maters.&quot;
&quot;Eleborate&quot; Mr. Reed says with a light sparkle in his eyes and you know you have his full attention.
&quot;Have you ever hört of the nymphs of the third layer?&quot;.&quot;They are a myth&quot; he says dismissively. &quot;Not at all I&#39;ve seen them myself, all I need from you is help me fund an expedition down to the third layer, then we capture them sell some of them to rich assholes up on the surface, and with the rest, we can open a high-class brothel never seen on either layer or the surface. which will make us richer and bring tourism down to this layer&quot;.  &quot;What about collateral should your expedition fail?&quot; He says with a dark expression. &quot;You can have all my cash&quot; You say seriously. You actually don&#39;t care about the money anyway, or the potential revenue your buisness idea can generate. Ever since you got those curses you have had an almost uncontrollable sex craving and it seems to just get worse. Strangely enough the wealth of money you accuired has only made you pickier. A cheap whore just doesn&#39;t do it for you anymore, you need something exclusive and exotic. That&#39;s why this expedition must succeed.
After three grueling days where you have to take what you can to quench your ... thirst the expedition finally returns. You hired the best of the best, they were expensive but it was worth it and they return with six new Nymph slaves. Finally, you have something worthy on hand to quench your lust. Their beauty is beyond comparison and to you they look like living liquid gems.
After selling one to some dude on the surface you open the brothel with Mister Reed.
&quot;Well, what did I tell you ?&quot; you ask with a grin after your first session.
&quot;They sure are easy on the eyes and they have a lot of buisness potential.&quot; He says with a wicked grin on his face. You can hardly hide your own excitement. &quot;have you already sampled one?&quot;. Reed looks over to you with predotory smile and greedy glimmer in his eyes. &quot;No, I haven&#39;t and I&#39;ll think I&#39;ll leave it to paying customers to sample them. More importantly when are planning to start the next expedition?&quot;. &quot;Well since they are going to make us a lot of money, &quot;You say while janking on one of the leashes around the necks of the slaves, &quot; I think we can start our next one in 2 months. Maybe we can send them down to the fourth this time, the Abyss is like a garden. We just have to pluck the ripest fruits and sell them so we can continue to harvest, hahahaha &quot;
After that exchange, you return to your new slave/toy for another round of *well-deserved* stress release. Soon your brothel becomes the biggest and best visited one in all of the Abyss. You have something for every taste: Nymphs, Nomades, but also normal humans. Your hunters also managed to get Lizard girls, dog and catgirls, most of which used to be divers, and one even got two succubi after a hard and dangerous visit to the 5th layer. Now you are one of the richest persons, maybe second only to Mr Reed, in the Abyss. you have your own harem of beautiful &#39;toys&#39; who do anything your sick and deranged heart demands. Talk of you and your brothel even reaches the surface, and while you might be reviled there from time to time people come down and admit they are actually pretty jealous of you. Yes, you can really be proud of yourself you think while sampling the newest product for your customers. You are such a hard worker.</tw-passagedata><tw-passagedata pid="221" name="L2 HLew LInhum HAge LDub" tags="" position="100,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="222" name="L2 HLew LInhum LAge HDub" tags="" position="225,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="223" name="L2 HLew LInhum LAge LDub" tags="" position="350,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="224" name="L2 HLew HInhum HAge HDub" tags="" position="475,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="225" name="L2 HLew HInhum HAge LDub" tags="" position="600,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="226" name="L2 HLew HInhum LAge HDub" tags="" position="725,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="227" name="L2 HLew HInhum LAge LDub" tags="" position="850,2850" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="228" name="Layer2 Preview" tags="image layer2" position="975,2850" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l2intro.png&#39;]]

@@.layerTitle;LAYER 2 - DEWDROP RAIN UNDERBRUSH@@

You see yourself standing under the cover of a dense rainforrest, with great trees covering your view and continuous rain pouring down through the layers of branches and vines. Suddenly the image shifts and you see the splendor of the relics that are available on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 3-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="229" name="L2 Gooey end" tags="ending" position="1100,2850" size="100,100">You stand on the cupboard directly over the two man, a small camera relic in hand waiting for the perfect moment.
&quot;Are you sure mister Reed won&#39;t find out about this ?&quot;, &quot; He is very ... unkind to traitors and what you are planning is ... . &quot;He won&#39;t find out, the plan is as safe as safe can be, and afterward we&#39;ll be richer than he could ever imagine&quot;. the two man leave after checking the windows and locking the door and you start your job. You jump down from the cupboard without hurting yourself thanks to your slime-like body and look for the plans on the desk. Once you found them you use your camera to photograph them and crawl back up to the cupboard once again using your slime-like properties. Smiling to yourself you leave through a mousehole. At first, you were devastated by your new body, you tried your best to continue your journey with your small and slimy body but in the end, you had to give up. stranded on the second layer you cursed your fate. You survived the first month by stealing. You ended up getting crushed and squished more times than you can count but always bouncing back once everyone left thanks to your slimy body. After a while, mister Reed approached you with an offer to work as a spy for him. Mister Reed is one of the most dangerous people in the upper layers of the Abyss he has connections reaching all the way up to the surface and some rumors say even down on the fourth layer.
 After a while you finally make it back to your boss.
 &quot;Gerard I finally got them&quot; You say presenting him the camera. After working for him for many years now you are on a first-name basis with him.&quot;Oh just what i was expecting i take it you have undeniable proof ?&quot;.&quot;Of course who do you think I am, some amateur?&quot;, &quot;They were cunning though, it took weeks to find their headquarter&quot;.
&quot;Well you did well. As always, I might add. You should take a break before heading out again.&quot; He says.  &quot;I would really like to get my hands on whatever they were try to steal in the end&quot;.You muse.
&quot;And I need to prepare a fitting punishment for them... Did they really think they could get away with trying to pin the blame on me for whatever they were after, fools..&quot;. You just shrug your shoulders and leave. What happens next is none of your business, as long as you get paid you are happy. In the end you started to understand why some people call curses a blessing.</tw-passagedata><tw-passagedata pid="230" name="Layer3 1" tags="layer3" position="1225,2850" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $currentLayer = 3&gt;&gt;

&lt;&lt;set $timeL3T1 = 0&gt;&gt;
&lt;&lt;set $timeL3T2 = 0&gt;&gt;

&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer3&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l3intro.png&#39;]]
!Layer 3 - Veins of Tartarus
@@As you reach the end of the second layer and the everpresent rain gradually abates, the terrain of the Abyss slowly begins to change alongside your march downward. The space between the rock formations you&#39;ve been hiking down begins to shrink, the smaller rock outcroppings meerging into singular masses of land. Before long, the Abyss begins to feel less like a single pt and more like many tunnels burrowing through the earth, twisting and turning into themselves to form a massive, incomprehensible cave network. Whenever you speak, your own voice echoes back to beckon you further down.

The miasma produces no light in this layer, and these dark, twisted caverns are slow to navigate without a light source, such as a torch or flashlight. If you have such a source of light, you may subtract 1 day from all the time costs on this page. Remember that if you&#39;re using torches, they will last for exactly one choice in this layer - including ascending or descending layers.

The Abyss has various bioluminescent moss, mushrooms, and so on scattered about, so exploring these caves wihout a source of light isn&#39;t so implossible or as much of suicide mission as exploring caves on the surface without a light source would be - though doing so would still be quite difficult down here.

[[Walk through the third layer of the Abyss|Layer3 Hub]]&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL3 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer3 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="231" name="Layer3 Hub" tags="layer3" position="100,2975" size="100,100">&lt;&lt;set $currentLayer = 3&gt;&gt;&lt;&lt;if $timeL3T1 &lt; 6 &amp;&amp; $timeL3T2 &lt; 5&gt;&gt;&lt;&lt;set $visitL3 = 1&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;Your steps echo as you walk through the seemingly endless, dimly-lit caves of the third layer. Occasionally a small sound comes from some direction, but you can&#39;t tell which. The light from the glowing fungus and plants on the walls seems off to you. As helpful as it is, it leaves you with a yearning to see the sun above the surface again soon.

The miasma produces no light in this layer, and these dark, twisted caverns are slow to navigate without a light source, such as a torch or flashlight. If you have such a source of light, you may subtract 1 day from all the time costs on this page. Remember that if you&#39;re using torches, they will last for exactly one choice in this layer - including ascending or descending layers.

What do you want to do while you&#39;re here?

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp == 1&gt;&gt;
As you walk through the caverns of the third layer, you come across what initally seems to be a clear pond, a potential source of clean water! But upon further inspection, you realize that rather than water, it is a slime that is a very transluscent blue color. Luckily you noticed it in time and didn&#39;t consume any, but it serves as a reminder that strange things lurk in these tunnels. You notice a small crab suspended in the slime, apparently one that didn&#39;t recognize the difference between the slime and water until it was too late. &lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 2&gt;&gt;
You notice a scurrying out of the corner of your eye on one of the walls. Preparing yourself for the worst, you ready yourself for a fight against whatever you noticed, but instead you spot a few glowing, scurrying crabs, each about 5 centimeters across, using their claws to clip some fungus and consume it. The color of the crabs seems almost like the color of the light given off by the fungus. Perhaps this is a part of the ecosystem here?&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 3&gt;&gt;
A few glowing crabs skitter in front of you and quickly dart into a hole in the wall. You notice what they&#39;re running from a moment after them as a small bundle of tentacles slides across the ground, reaching a long arm forward to grab one of the crabs. Once it has a hold of the crab, it seems to extend a number of tiny feeler tentacles that gently caress the crab over its entire body and over time work themselves into all of the crab&#39;s orifices. After a minute of infiltration, the tentacle blob turns around to where it came, crab in tow, and seems to be more leasuirely in its pace. Something inside you feels some empathy for that crab, given your own situation in the Abyss.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $items[9].count &gt; 0 &amp;&amp; $torchUse == 0&gt;&gt;
	&lt;br&gt;[[Use torches to ward of some threats at the cost of 1 torch per travel|Layer3 Hub][$torchUse = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $torchUse == 1&gt;&gt;
	&lt;br&gt;[[Stop using torches to ward of threats|Layer3 Hub][$torchUse = 0]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;You are not able to forage for daily water on this layer, due to the nature of the water source&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer3&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer3&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer3 Threats]]
[[Check for food and water you can forage for|Layer3 Forage]]
[[Search for relics|Layer3 Relics]]
[[Take on curses to purge your corruption|Layer3 Curses]]
[[Look for any wonders you can take advantage|Layer3 Wonders]]
[[View the Layer 3 habitation option|Layer3 Habitation]]

[[Look up towards the surface|Layer3 Ascend 1]]
[[Look down at the next layer|Layer3 Exit1]]&lt;&lt;elseif $timeL3T2 &lt; 5&gt;&gt;
Out of nowhere, you notice a slimy tendril reaching towards you from the darkness in front of you. As it rapidly closes in on you, the fact that the only thing the tentacle is attached to is a mass of more tentacles becomes apparent, and it becomes clear what you&#39;re dealing with. It appears that you&#39;ve caught the attention of a lesser tentacle beast.

[[Deal with the lesser tentacle beast|Layer3 Threat1 Main]]&lt;&lt;else&gt;&gt;
As you wander through the semi-darkness by only the dimmest natural light, you bump into something wet. When you look down, you realize it&#39;s actually a transparent slime you didn&#39;t notice due to the dark! It seems like you&#39;ve been caught by a slackslime.

[[Deal with the slackslime|Layer3 Threat2 Main]]&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="232" name="Layer3 Threats" tags="image layer3" position="225,2975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-threats.png&#39;]]

[[Return to exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="233" name="Layer3 Forage" tags="image layer3" position="350,2975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for Crystalline Confectionaries for food|Layer3 Forage][$forageFood = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer3 Forage][$forageFood = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from Underground Rivers|Layer3 Flasks]]&lt;br&gt;
&lt;&lt;else&gt;&gt;
You need empty flasks to fill them with water from the Underground Rivers.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="234" name="Layer3 Relics" tags="layer3 cards nobr" position="475,2975" size="100,100">&lt;&lt;if $timeL3T1 &lt; 6 &amp;&amp; $timeL3T2 &lt; 5&gt;&gt;

&lt;h1&gt;Relics&lt;/h1&gt;

&lt;p&gt;
@@.floatr;[img[setup.ImagePath+&#39;icon.png&#39;]]@@

The Abyss is a huge place. The Relics listed in these sections are only a small peek at all the different kinds of Relics that physically exist in the Abyss. These ones simply represent all the possibilities you&#39;re fated to potentially find on your adventure. This also naturally means that there are a fair deal of them being traded around the surface right now, though at the moment they&#39;re mostly held by private individuals seeking them for collections. It&#39;s safe to assume that any world domination Relics haven&#39;t made their way into circulation yet, or you would have heard about them.
&lt;/p&gt;

&lt;p&gt;[[Continue exploring the third layer|Layer3 Hub]]&lt;/p&gt;

&lt;&lt;RelicGrid `[&quot;Sibyl Blend&quot;, &quot;Pangea Shaker&quot;, &quot;From Seafoam&quot;, &quot;Orbweaver&quot;, &quot;Soulseeker&quot;, &quot;Tranquility Knell&quot;, &quot;Lightning Rook&quot;, &quot;Acrobatic Accord&quot;, &quot;Managed Misfortune&quot;, &quot;Breathless Exhale&quot;, &quot;Sharing Shears&quot;, &quot;Rose-tinted Spectacles&quot;]`&gt;&gt;

&lt;p&gt;[[Continue exploring the third layer|Layer3 Hub]]&lt;/p&gt;

&lt;&lt;elseif $timeL3T2 &lt; 5&gt;&gt;

&lt;p&gt;Out of nowhere, you notice a slimy tendril reaching towards you from the darkness in front of you. As it rapidly closes in on you, the fact that the only thing the tentacle is attached to is a mass of more tentacles becomes apparent, and it becomes clear what you&#39;re dealing with. It appears that you&#39;ve caught the attention of a lesser tentacle beast.&lt;/p&gt;

&lt;p&gt;[[Deal with the lesser tentacle beast|Layer3 Threat1 Main]]&lt;/p&gt;

&lt;&lt;else&gt;&gt;

&lt;p&gt;As you wander through the semi-darkness by only the dimmest natural light, you bump into something wet. When you look down, you realize it&#39;s actually a transparent slime you didn&#39;t notice due to the dark! It seems like you&#39;ve been caught by a slackslime.&lt;/p&gt;

&lt;p&gt;[[Deal with the slackslime|Layer3 Threat2 Main]]&lt;/p&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="235" name="Layer3 Curses" tags="image layer3" position="600,2975" size="100,100">&lt;&lt;GenderCorrected&gt;&gt;[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-curses.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;) || $StoredCurse.name == &quot;Submissiveness Rectification A&quot; || $StoredCurse.name == &quot;Power Dome&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Submissiveness Rectification A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse25]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gender Reversal C&quot;) || $StoredCurse.name == &quot;Gender Reversal C&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gender Reversal C]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse26]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness C&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness C&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Asset Robustness C]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse27]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;) || $StoredCurse.name == &quot;Clothing Restriction B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Clothing Restriction B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse28]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;) || $StoredCurse.name == &quot;Submissiveness Rectification A&quot; || $StoredCurse.name == &quot;Power Dome&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Power Dom]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse29]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;20/20000000&quot;) || $StoredCurse.name == &quot;20/20000000&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on 20/20000000]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse30]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Comic Relief&quot;) || $StoredCurse.name == &quot;Comic Relief&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Comic Relief]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse31]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Equal Opportunity&quot;) || $StoredCurse.name == &quot;Equal Opportunity&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Equal Opportunity]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse32]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Absolute Pregnancy&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Pregnancy&quot; || $StoredCurse.name == &quot;Absolute Birth Control&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Absolute Pregnancy]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse33]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _pregCurse = $playerCurses.some(e =&gt; e.name === &quot;Absolute Pregnancy&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Wacky Wombs&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Omnitool&quot;) || $StoredCurse.name == &quot;Absolute Pregnancy&quot; || $StoredCurse.name == &quot;Wacky Wombs&quot; || $StoredCurse.name == &quot;Omnitool&quot;&gt;&gt;
&lt;&lt;if _pregCurse || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Birth Control&quot;&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Absolute Birth Control]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse34]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($playerCurses.some(e =&gt; e.name === &quot;Wacky Wombs&quot;) &amp;&amp; $app.womb&gt;1)|| ($playerCurses.some(e =&gt; e.name === &quot;Wacky Wombs&quot;) &amp;&amp; $StoredCurse.name == &quot;Wacky Wombs&quot;) || ( $app.womb&gt;1 &amp;&amp; $StoredCurse.name == &quot;Wacky Wombs&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Birth Control&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Wacky Wombs]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse35]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Omnitool&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Omnitool&quot; || $StoredCurse.name == &quot;Absolute Birth Control&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Omnitool]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse36]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;) || $StoredCurse.name == &quot;Gooey&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gooey]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse37]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Rainbow Swirl&quot;) || $StoredCurse.name == &quot;Rainbow Swirl&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Rainbow Swirl]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse38]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Double Pepperoni&quot;) || $StoredCurse.name == &quot;Double Pepperoni&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Double Pepperoni]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse39]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Literal Blushing Virgin&quot;) || $StoredCurse.name == &quot;Literal Blushing Virgin&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Literal Blushing Virgin]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer3 Curses][$StoredCurse = $curse40]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer3 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="236" name="Layer3 Wonders" tags="image layer3" position="725,2975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-wonders.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $scalesUsed == 0&gt;&gt;
Would you like to use the Gossamery Scales to gain dubloons based on your corruption?&lt;br&gt;
[[Yes, use the Scales to gain dubloons|Layer3 Scales 1]]&lt;br&gt;&lt;br&gt;
Would you like to use the Gossamery Scales to gain corruption based on your dubloons?&lt;br&gt;
[[Yes, use the Scales to gain corruption|Layer3 Scales 2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
You have already used the scales on your journey. You may not use them again.
&lt;&lt;/if&gt;&gt;
&lt;&lt;if ($hiredCompanions.length &gt; 0) &amp;&amp; ($skewedForced &lt; 4)&gt;&gt;
	Would you like to use the Skewed Shrine to give a curse to one of your willing companions at the cost of &lt;&lt;print ($skewedUsed * 5)&gt;&gt; dubloons?&lt;br&gt;
	&lt;&lt;link &quot;Yes, travel to the Skewed Shrine to transfer a curse&quot; &quot;Layer3 Skewed1a&quot;&gt;&gt;
		&lt;&lt;set $tempTime = 3&gt;&gt;
		&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
	Would you like to use the Skewed Shrine to force a curse on one of your unwilling companions at the cost of &lt;&lt;print ($skewedUsed * 5)&gt;&gt; dubloons?&lt;br&gt;
	&lt;&lt;link &quot;Yes, travel to the Skewed Shrine to force a curse&quot; &quot;Layer3 Skewed 2a&quot;&gt;&gt;
		&lt;&lt;set $tempTime = 3&gt;&gt;
		&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
	&lt;&lt;elseif $skewedForced &gt; 4&gt;&gt;
	None of your companions trust you at this shrine. None will get close enough for you to use the shrine with them. They watch you with eyes full of fear and anger, as if they could bolt at any moment and leave you alone in the Abyss.&lt;br&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	You must have companions if you would like to use the Skewed Shrine.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;[[Layer3 Hub]]&gt;&gt;</tw-passagedata><tw-passagedata pid="237" name="Layer3 Habitation" tags="image layer3" position="850,2975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the third layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="238" name="Layer3 Ascend 1" tags="layer3" position="975,2975" size="100,100">Ascending to the previous layer will take 6 days, and cost 25 corruption.

In case you were wondering, there is one straight-shot passage through this layer between layers two and four that baloons funnel into on their way up through the Abyss. However, the sides of the tunnel are coated in a concentrated form of miasma that make it essentially impossible to get through without using a balloon or another way of flying.

[[Continue your ascent|Layer3 Ascend2]]
[[Turn back and continue your business on the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="239" name="Layer3 Exit1" tags="layer3" position="1100,2975" size="100,100">Descending further still will take 6 days. The tunnels are so twisted and involve so much turning around and climbing up and down that the trip through the layer is about the same length, whether you&#39;re ascending or descending.

Easily-accessible foraged food isn&#39;t guaranteed from here on. Taking a gun with plenty of ammunition is advised if you wish to continue living off the land.

In the deeper parts of the layer, a cold breeze occasionally blows through the caverns, hinting at something frigid deeper below.

[[Turn back and continue your business on the third layer|Layer3 Hub]]
[[Continue your descent to the fourth layer|Layer3 Exit2]]</tw-passagedata><tw-passagedata pid="240" name="Layer3 Ascend2" tags="layer3" position="1225,2975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;set $tempTime=6&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;
	&lt;&lt;set $tempTime=1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;	
/* 		&lt;&lt;set $timeL3T1 += 1&gt;&gt;
	&lt;&lt;if !setup.haveTravelLightSource()&gt;&gt;
		&lt;&lt;set $timeL3T2 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL3 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
		&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $foodL3 += $tempTime&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMajor)&gt;&gt;
			&lt;&lt;/for&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMinor)&gt;&gt;
			&lt;&lt;/for&gt;&gt;
		&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $time += 1&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	*/

	&lt;&lt;if $timeL3T1 &gt; 5&gt;&gt;

		&lt;br&gt;Out of nowhere, you notice a slimy tendril reaching towards you from the darkness in front of you. As it rapidly closes in on you, the fact that the only thing the tentacle is attached to is a mass of more tentacles becomes apparent, and it becomes clear what you&#39;re dealing with. It appears that you&#39;ve caught the attention of a lesser tentacle beast.&lt;br&gt;&lt;br&gt;

		[[Deal with the lesser tentacle beast|Layer3 Threat1 Ascend]]&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $timeL3T2 &gt; 4&gt;&gt;
		&lt;br&gt;As you wander through the semi-darkness by only the dimmest natural light, you bump into something wet. When you look down, you realize it&#39;s actually a transparent slime you didn&#39;t notice due to the dark! It seems like you&#39;ve been caught by a slackslime.&lt;br&gt;&lt;br&gt;

		[[Deal with the slackslime|Layer3 Threat2 Ascend]]&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/for&gt;&gt;
&lt;&lt;if $layerExitTime == 0&gt;&gt;
	&lt;&lt;set $corruption -= (25 - $corRed)&gt;&gt;
	&lt;br&gt;You continue through the dark winding caverns for days on end. After a long and monotonous journey, broken up only by evading threats that may have interrupted you, you notice that the caves are opening up. The sheer stone walls morphing into large rock formations, then shrinking and making way for the jungle of the second layer. A familiar sound of eternal rainfall welcomes you back to the second layer.
	&lt;br&gt;&lt;br&gt;&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
	&lt;br&gt;[[Return to the second layer|Layer2 Hub]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="241" name="Layer3 Scales 1" tags="layer3" position="100,3100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp = Math.round($corruption / 5)&gt;&gt;
&lt;&lt;set $dubloons += $temp&gt;&gt;&#39;
&lt;&lt;set $scalesUsed = 1&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/gossameryscales.png&#39;]]

The moment you touch the scales you feel a slight shock, almost like static. As you flinch away from them you notice a clinking sound of metal hitting metal. After only a blink you see some dubloons on the once-empty scales! After you count them, you find that you have gained $temp dubloons!

Once you pick them up, the luster of the scales fades, indicating that they will not allow you to use their power again.

[[Continue exploring the layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="242" name="Layer3 Scales 2" tags="layer3" position="225,3100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp = Math.round($dubloons / 5)&gt;&gt;
&lt;&lt;set $corruption += $temp&gt;&gt;
&lt;&lt;set $scalesUsed = 1&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/gossameryscales.png&#39;]]

You place all of your dubloons on one side of the scale, hoping that they will reward you for you investment and savings. The moment you place the final dubloon on the scale, you feel a gentle pulse of... from the scales. It felt warm and vaguely soothing, as if it were purging you of a part of the miasma&#39;s corrupting effects.

You have gained $temp corruption points!

As you pick up the dubloons from the scales, you notice that the luster of the scales seems to have faded. Perhaps they only had tht final use left in them or perhaps they will only serve to help you one time. Regardless, you won&#39;t be using them again on this journey.

[[Continue exploring the layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="243" name="Layer3 Skewed1a" tags="layer3" position="350,3100" size="100,100">[img[setup.ImagePath+&#39;Wonders/slantedshrine.png&#39;]]

Which curse would you like to transfer to your willing companion? It can&#39;t be too bad if they agreed to take it on.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for _companion range $hiredCompanions&gt;&gt;
	&lt;&lt;capture _companion&gt;&gt;
		&lt;&lt;for $j = 0; $j &lt; $playerCurses.length; $j++&gt;&gt;
			&lt;&lt;if $j==0&gt;&gt;
				&lt;&lt;print &quot;_companion.name doesn&#39;t mind taking:&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;if setup.willingCurses[_companion.name].includes($playerCurses[$j].name)&gt;&gt;
				&lt;&lt;capture $j&gt;&gt;
					&lt;&lt;print &quot;$playerCurses[$j].name&quot;&gt;&gt;
					&lt;&lt;link &quot;Choose&quot; &quot;Layer3 Skewed1a&quot;&gt;&gt;
						&lt;&lt;set _companion.curses.push($playerCurses[$j])&gt;&gt;
						&lt;&lt;set $targetCurse = $playerCurses[$j]&gt;&gt;
						&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
						&lt;&lt;set $dubloons -= ($skewedUsed * 5)&gt;&gt;
						&lt;&lt;set $skewedUsed += 1&gt;&gt;
					&lt;&lt;/link&gt;&gt;&lt;br&gt;
				&lt;&lt;/capture&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[On second thought, maybe a more forceful approach is warrented|Layer3 Skewed 2a]]
[[Return to exploring layer 3|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="244" name="Layer3 Skewed 2a" tags="layer3" position="475,3100" size="100,100">[img[setup.ImagePath+&#39;Wonders/slantedshrine.png&#39;]]

Which curse would you like to force on your unwilling companion?

You hear a muffled sound from your incapacitated companion as you ponder your options.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $playerCurses.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print $playerCurses[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print &quot;[[Choose|Layer3 Skewed2b][$temp to $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;return&gt;&gt;</tw-passagedata><tw-passagedata pid="245" name="Take on Submissiveness Rectification A" tags="layer3" position="600,3100" size="100,100">&lt;&lt;set $playerCurses.push($curse25)&gt;&gt;&lt;&lt;set $corruption += $curse25.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse25)&gt;&gt;
You have successfully taken on the $curse25.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="246" name="Take on Asset Robustness C" tags="layer3" position="725,3100" size="100,100">&lt;&lt;set $playerCurses.push($curse27)&gt;&gt;&lt;&lt;set $corruption += $curse27.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse27)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact C&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

You have successfully taken on the $curse27.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="247" name="Take on Clothing Restriction B" tags="layer3" position="850,3100" size="100,100">&lt;&lt;if $app.breasts &gt; 4&gt;&gt;&lt;&lt;set $curse28.appDesc += &quot;A shame, because you&#39;d really appreciate the support for your breasts. &quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set $playerCurses.push($curse28)&gt;&gt;&lt;&lt;set $corruption += $curse28.corr&gt;&gt;

You have successfully taken on the $curse28.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="248" name="Take on Power Dom" tags="layer3" position="975,3100" size="100,100">&lt;&lt;set $playerCurses.push($curse29)&gt;&gt;&lt;&lt;set $corruption += $curse29.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse29)&gt;&gt;
You have successfully taken on the $curse29.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="249" name="Take on 20/20000000" tags="layer3" position="1100,3100" size="100,100">&lt;&lt;set $playerCurses.push($curse30)&gt;&gt;&lt;&lt;set $corruption += $curse30.corr&gt;&gt;

You have successfully taken on the $curse30.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="250" name="Take on Comic Relief" tags="layer3" position="1225,3100" size="100,100">&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;)&gt;&gt;&lt;&lt;set $curse31.appDesc += &quot;It&#39;s especially annoying, because no one ever lets you take charge! &quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set $playerCurses.push($curse31)&gt;&gt;&lt;&lt;set $corruption += $curse31.corr&gt;&gt;

You have successfully taken on the $curse31.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="251" name="Take on Equal Opportunity" tags="layer3" position="100,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse32)&gt;&gt;&lt;&lt;set $corruption += $curse32.corr&gt;&gt;

You have successfully taken on the $curse32.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="252" name="Take on Absolute Pregnancy" tags="layer3" position="225,3225" size="100,100">&lt;&lt;if $app.vagina == 0 || $app.womb == 0&gt;&gt;&lt;&lt;set $curse33.appDesc += &quot;Hope you&#39;re happy with paying child support! &quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $curse33.appDesc += &quot;Hope you&#39;re happy with constant pregnancy! &quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set $playerCurses.push($curse33)&gt;&gt;&lt;&lt;set $corruption += $curse33.corr&gt;&gt;

You have successfully taken on the $curse33.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="253" name="Take on Absolute Birth Control" tags="layer3" position="350,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse34)&gt;&gt;&lt;&lt;set $corruption += $curse34.corr&gt;&gt;

You have successfully taken on the $curse34.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="254" name="Take on Wacky Wombs" tags="layer3" position="475,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse35)&gt;&gt;&lt;&lt;set $corruption += $curse35.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse35)&gt;&gt;

You have successfully taken on the $curse35.name curse. Hopefully you are ok with accepting the permanent consequences.

What is the location of the womb you would like to add?
&lt;&lt;if $app.womb==0&gt;&gt; 
	&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;throat&quot; checked&gt;&gt; Throat
	&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;urethra&quot; &gt;&gt; Urethra
	&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;anus&quot; &gt;&gt; Anus
	&lt;&lt;if $app.vagina &gt; 0 &gt;&gt;
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;vagina&quot; &gt;&gt; Vagina
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;throat&quot; checked&gt;&gt; Throat
	&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;urethra&quot; &gt;&gt; Urethra
	&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;anus&quot; &gt;&gt; Anus
	&lt;&lt;if $app.vagina &gt; 0 &gt;&gt;
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;vagina&quot; &gt;&gt; Vagina
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;


[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="255" name="Take on Omnitool" tags="layer3" position="600,3225" size="100,100">&lt;&lt;if $app.vagina == 1 || $app.womb &gt; 0&gt;&gt;&lt;&lt;set $curse36.appDesc += &quot;You can get pregnant even from having sex with monsters and animals. &quot;&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $curse36.appDesc += &quot;You can even impregnate monsters and animals. &quot;&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;set $playerCurses.push($curse36)&gt;&gt;&lt;&lt;set $corruption += $curse36.corr&gt;&gt;

You have successfully taken on the $curse36.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="256" name="Take on Gooey" tags="layer3" position="725,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse37)&gt;&gt;&lt;&lt;set $corruption += $curse37.corr&gt;&gt;

A sudden wave of nausea washes over your entire body, as if your stomach was turning inside out inside of you. You heave to vomit, but nothing comes out, instead the feeling of nausea increases.

You dry heave again, and again, but nothing comes out and the sensation only becomes more and more intense. You squeeze your fists tightly in frustration, but strangely your fingers seem to almost sink into the flesh of you palm.

The feeling of nausea wanes and you finally have a chance to examine your body for any changes. At first glance, you don&#39;t seem any different, but that only lasts for one glance, as your whole body seems more fluid, more gooey.

A few quick experiments indicate that your whole body is now made of some goo-like substance that is malleable, but always returns to your base shape if deformed. Luckily you still seem to be about as strong as you were before, but the sensation of moving is always a little different. Maybe it&#39;s because you don&#39;t have the same sort of muscles or skin or some other part of your body, but everything is just a little bit different.

Despite the drastic change, you don&#39;t have much time to ponder it as you do need to get moving once again eventually. It will certainly be a big change in your life to be a being of slime and goo rather than flesh and bone for the rest of your life.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="257" name="Take on Rainbow Swirl" tags="layer3" position="850,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse38)&gt;&gt;&lt;&lt;set $corruption += $curse38.corr&gt;&gt;

You have successfully taken on the $curse38.name curse. Hopefully you are ok with accepting the permanent consequences.

Please enter your new skin/eye color:

&lt;&lt;textbox &quot;$curse38.variation&quot; &quot;pink&quot; &quot;Layer3 Curses&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="258" name="Take on Double Pepperoni" tags="layer3" position="975,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse39)&gt;&gt;&lt;&lt;set $corruption += $curse39.corr&gt;&gt;

You have successfully taken on the $curse39.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="259" name="Take on Literal Blushing Virgin" tags="layer3" position="1100,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse40)&gt;&gt;&lt;&lt;set $corruption += $curse40.corr&gt;&gt;

You have successfully taken on the $curse40.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="260" name="Take on Gender Reversal C" tags="layer3" position="1225,3225" size="100,100">&lt;&lt;set $playerCurses.push($curse26)&gt;&gt;&lt;&lt;set $corruption += $curse26.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse26)&gt;&gt;

You have successfully taken on the $curse26.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the third layer|Layer3 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 3|Layer3 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L3]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="261" name="Layer3 Flasks" tags="layer3" position="100,3350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $riverVisit = 1&gt;&gt;
&lt;&lt;set $tempTime = (Math.max(3 -$abyssKnow, 0))&gt;&gt;

&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL3 += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/undergroundrivers.png&#39;]]

After spending $tempTime days searching for a river, you manage to eventually find one. In an effort to replenish the water it cost you to get here, you fill all your flasks, taking in the cool, fresh water.

As predicted, the water is pure and you can drink it without side effects!

[[Return to exploring your food and water options on this layer|Layer3 Forage]]</tw-passagedata><tw-passagedata pid="262" name="Layer3 Skewed2b" tags="layer3" position="225,3350" size="100,100">[img[setup.ImagePath+&#39;Wonders/slantedshrine.png&#39;]]

Which companion would you like to force the curse of $playerCurses[$temp].name on?

The magic of the shrine wisps through the air menacingly as your victim struggles helplessly.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;print $hiredCompanions[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;
	
	
	&lt;&lt;print &quot;[[Transfer|Layer3 Skewed Apply][$hiredCompanions[$i].curses.push($playerCurses[$temp]), $temp2=$i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="263" name="Layer3 Skewed Apply" tags="layer3" position="350,3350" size="100,100">[img[setup.ImagePath+&#39;Wonders/slantedshrine.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $targetCurse = $playerCurses[$temp]&gt;&gt;
&lt;&lt;include &quot;CurseRemoval&quot; &gt;&gt;
&lt;&lt;set $dubloons -= ($skewedUsed * 5)&gt;&gt;
&lt;&lt;set $skewedUsed += 1&gt;&gt;
&lt;&lt;set $skewedForced += 1&gt;&gt;
&lt;&lt;set _companionName = $hiredCompanions[$temp2].name&gt;&gt;
&lt;&lt;set _affectionPenalty = 4 - $hsswear&gt;&gt;
&lt;&lt;include &quot;Companion Mistreatment Reaction&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Stand in front of the shrine to force another curse|Layer3 Skewed 2a][$choice1=0,$choice2=0]]
[[On second thought, maybe a more diplomatic approach would be advisable|Layer3 Skewed1a][$choice1=0,$choice2=0]]
[[Continue with your journey|Layer3 Hub][$choice1=0,$choice2=0]]</tw-passagedata><tw-passagedata pid="264" name="Layer3 Threat1 Main" tags="layer3" position="475,3350" size="100,100">&lt;&lt;set $timeL3T1 -= 6&gt;&gt;
[img[setup.ImagePath+&#39;Threats/lessertentaclebeast.png&#39;]]

How do you want to deal with the tentacle beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	You can fight it with a sword, but it&#39;s dangerous. You&#39;d likely end up with mild injuries increasing your next 3 travel times by 1 days each.&lt;br&gt;
	[[Fight it off with your sword yourself|Layer3 Hub][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off without taking any injuries or penalties, if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer3 Hub][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 10&gt;&gt;
	Due to its amorphous nature, it will take at least 11 bullets to take down the monster.&lt;br&gt;
	[[Shoot it with your pistol|Layer3 Hub][$items[20].count -= (11 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily pebbles to use as ammo are abundant in the rocky caves of this layer.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer3 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, it will give you a very thorough tentacle fucking, leaving you with a serious limp, increasing your next 3 travel times by 2 days each. &lt;br&gt;
[[Allow it to overpower you|Layer3 Hub][$status.duration = (3 - $statRed), $status.penalty = 2]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the tentacles close in on you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer3 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="265" name="Layer3 Threat2 Main" tags="layer3" position="600,3350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;set $timeL3T2 -= 5&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
	&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $items[0].count -= $tempTime&gt;&gt;
&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;set $timeL3 += $tempTime&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/slackslime.png&#39;]]

The ameboid creature that has trapped you seem to hiss slightly, then you smell something a little strange before your muscles completely relax. It seems that no matter how much you try, you aren&#39;t able to move at all.

The slime moves slowly, but surely over your paralyzed body and into your most sensitive locations. Even though you can&#39;t move, you can feel every moment the creature spends milking your sexual fluids for protein.

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
The slime lets you go after only 1 day, perhaps feeling some sense of kinship with a slimey being such as yourself.
&lt;&lt;else&gt;&gt;
The process lasts two days before the slime finally moves on and allows you to go on your way.
&lt;&lt;/if&gt;&gt;

[[You continue on your way after the slime releases you|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="266" name="Layer3 Threat1 Ascend" tags="layer3" position="725,3350" size="100,100">&lt;&lt;set $timeL3T1 -= 6&gt;&gt;
[img[setup.ImagePath+&#39;Threats/lessertentaclebeast.png&#39;]]

How do you want to deal with the tentacle beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	You can fight it with a sword, but it&#39;s dangerous. You&#39;d likely end up with mild injuries increasing your next 3 travel times by 1 days each.&lt;br&gt;
	[[Fight it off with your sword yourself|Layer3 Ascend2][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off without taking any injuries or penalties, if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer3 Ascend2][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 10&gt;&gt;
	Due to its amorphous nature, it will take at least 11 bullets to take down the monster.&lt;br&gt;
	[[Shoot it with your pistol|Layer3 Ascend2][$items[20].count -= (11 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily pebbles to use as ammo are abundant in the rocky caves of this layer.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer3 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, it will give you a very thorough tentacle fucking, leaving you with a serious limp, increasing your next 3 travel times by 2 days each. &lt;br&gt;
[[Allow it to overpower you|Layer3 Ascend2][$status.duration = (3 - $statRed), $status.penalty = 2]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the tentacles close in on you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer3 Ascend2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer3 Ascend2]]</tw-passagedata><tw-passagedata pid="267" name="Layer3 Threat2 Ascend" tags="layer3" position="850,3350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;set $timeL3T2 -= 5&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
	&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $items[0].count -= $tempTime&gt;&gt;
&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;set $timeL3 += $tempTime&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/slackslime.png&#39;]]

The ameboid creature that has trapped you seem to hiss slightly, then you smell something a little strange before your muscles completely relax. It seems that no matter how much you try, you aren&#39;t able to move at all.

The slime moves slowly, but surely over your paralyzed body and into your most sensitive locations. Even though you can&#39;t move, you can feel every moment the creature spends milking your sexual fluids for protein.

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
The slime lets you go after only 1 day, perhaps feeling some sense of kinship with a slimey being such as yourself.
&lt;&lt;else&gt;&gt;
The process lasts two days before the slime finally moves on and allows you to go on your way.
&lt;&lt;/if&gt;&gt;

[[You continue on your way after the slime releases you|Layer3 Ascend2]]</tw-passagedata><tw-passagedata pid="268" name="Layer3 Cherry" tags="layer3" position="975,3350" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer3 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer3 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer3 Cherry Mix]]</tw-passagedata><tw-passagedata pid="269" name="Layer3 Cherry Relic" tags="layer3" position="1100,3350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 21&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 21&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 21&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="270" name="Layer3 Cherry Curse" tags="layer3" position="1225,3350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,15) + 24&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 24&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,15) + 24&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2) &amp;&amp; ($temp1 + $temp2 !== 52 &amp;&amp; (Math.abs($temp1 - $temp2) !== 65))&amp;&amp; ($temp1 + $temp2 !== 6 &amp;&amp; (Math.abs($temp1 - $temp2) !== 1))&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.
&lt;&lt;if $curses[$temp1].name ==  &quot;Wacky Wombs&quot; || $curses[$temp2].name ==  &quot;Wacky Wombs&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse35)&gt;&gt;
	&lt;&lt;if $app.womb==0&gt;&gt; 
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;throat&quot; checked&gt;&gt; Throat
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;urethra&quot; &gt;&gt; Urethra
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;anus&quot; &gt;&gt; Anus
		&lt;&lt;if $vagina &gt; 0 &gt;&gt;
			&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;vagina&quot; &gt;&gt; Vagina
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;throat&quot; checked&gt;&gt; Throat
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;urethra&quot; &gt;&gt; Urethra
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;anus&quot; &gt;&gt; Anus
		&lt;&lt;if $vagina &gt; 0 &gt;&gt;
			&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;vagina&quot; &gt;&gt; Vagina
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Rainbow Swirl&quot; || $curses[$temp2].name ==  &quot;Rainbow Swirl&quot; &gt;&gt;

Please enter your new skin/eye color:

&lt;&lt;textbox &quot;$curse38.variation&quot; &quot;pink&quot; &quot;Layer3 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

[[Continue on to the rest of the layer|Layer3 Hub]]&lt;&lt;/if&gt;&gt;

&lt;&lt;nobr&gt;&gt;ss
&lt;&lt;if $curses[$temp1].name ==  &quot;Submissiveness Rectification A&quot; || $curses[$temp2].name ==  &quot;Submissiveness Rectification A&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse25)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Gender Reversal C&quot; || $curses[$temp2].name == &quot;Gender Reversal C&quot;  &gt;&gt;
	&lt;&lt;set $GenderLog.push($curse26)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Asset Robustness C&quot; || $curses[$temp2].name ==  &quot;Asset Robustness C&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse27)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact C&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Power Dom&quot; || $curses[$temp2].name ==  &quot;Power Dom&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse29)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="271" name="Layer3 Cherry Mix" tags="layer3" position="100,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 21&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 24&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.

&lt;&lt;if $curses[$temp2].name == &quot;Wacky Wombs&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse35)&gt;&gt;
	What is the location of the womb you would like to add?
	&lt;&lt;if $app.womb==0&gt;&gt; 
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;throat&quot; checked&gt;&gt; Throat
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;urethra&quot; &gt;&gt; Urethra
		&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;anus&quot; &gt;&gt; Anus
		&lt;&lt;if $vagina &gt; 0 &gt;&gt;
			&lt;&lt;radiobutton &quot;$curse35.variation1&quot; &quot;vagina&quot; &gt;&gt; Vagina
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;throat&quot; checked&gt;&gt; Throat
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;urethra&quot; &gt;&gt; Urethra
		&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;anus&quot; &gt;&gt; Anus
		&lt;&lt;if $vagina &gt; 0 &gt;&gt;
			&lt;&lt;radiobutton &quot;$curse35.variation2&quot; &quot;vagina&quot; &gt;&gt; Vagina
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $curses[$temp2].name ==&quot;Rainbow Swirl&quot;&gt;&gt;

Please enter your new skin/eye color:

&lt;&lt;textbox &quot;$curse38.variation&quot; &quot;pink&quot; &quot;Layer3 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

[[Continue on to the rest of the layer|Layer3 Hub]]&lt;&lt;/if&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Submissiveness Rectification A&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse25)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Gender Reversal C&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse26)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Asset Robustness C&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse27)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact C&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Power Dom&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse29)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="272" name="Layer3 Exit2" tags="layer3" position="225,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;set $tempTime = 6&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;

	&lt;&lt;set $tempTime = 1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	/* 
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL3 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
		&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $foodL3 += 1&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMajor)&gt;&gt;
			&lt;&lt;/for&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
				&lt;&lt;set $AgeLog.push($ForageFoodMinor)&gt;&gt;
			&lt;&lt;/for&gt;&gt;
		&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $time += 1&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	*/

	&lt;&lt;if $timeL3T1 &gt; 5&gt;&gt;

		&lt;br&gt;Out of nowhere, you notice a slimy tendril reaching towards you from the darkness in front of you. As it rapidly closes in on you, the fact that the only thing the tentacle is attached to is a mass of more tentacles becomes apparent, and it becomes clear what you&#39;re dealing with. It appears that you&#39;ve caught the attention of a lesser tentacle beast.&lt;br&gt;&lt;br&gt;

		[[Deal with the lesser tentacle beast|Layer3 Threat1 Descend]]&lt;br&gt;&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if $timeL3T2 &gt; 4&gt;&gt;
		&lt;br&gt;As you wander through the semi-darkness by only the dimmest natural light, you bump into something wet. When you look down, you realize it&#39;s actually a transparent slime you didn&#39;t notice due to the dark! It seems like you&#39;ve been caught by a slackslime.&lt;br&gt;&lt;br&gt;

		[[Deal with the slackslime|Layer3 Threat2 Descend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $layerExitTime == 0&gt;&gt;
	&lt;&lt;nobr&gt;&gt;
	&lt;&lt;set $timeL4T1 = 0&gt;&gt;
	&lt;&lt;/nobr&gt;&gt;
	You continue through the dark winding caverns for days on end. After a long and monotonous journey, broken up only by evading threats that may have interrupted you, you notice that the caves are opening up. But rather than the wet forest from above, you feel the air getting colder, and occasionally notice frost on the walls of the caves.

	Eventually you notice a bright, cool light at the end of the tunnel, it seems like you&#39;ve made it to the end of the third layer.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

	[[Emerge onto the fourth layer|Layer4 1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="273" name="Layer3 Threat1 Descend" tags="layer3" position="350,3475" size="100,100">&lt;&lt;set $timeL3T1 -= 6&gt;&gt;
[img[setup.ImagePath+&#39;Threats/lessertentaclebeast.png&#39;]]

How do you want to deal with the tentacle beast moving in on you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
	You can fight it with a sword, but it&#39;s dangerous. You&#39;d likely end up with mild injuries increasing your next 3 travel times by 1 days each.&lt;br&gt;
	[[Fight it off with your sword yourself|Layer3 Exit2][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off without taking any injuries or penalties, if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer3 Exit2][$status.duration = (3 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 10&gt;&gt;
	Due to its amorphous nature, it will take at least 11 bullets to take down the monster.&lt;br&gt;
	[[Shoot it with your pistol|Layer3 Exit2][$items[20].count -= (11 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily pebbles to use as ammo are abundant in the rocky caves of this layer.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer3 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, it will give you a very thorough tentacle fucking, leaving you with a serious limp, increasing your next 3 travel times by 2 days each. &lt;br&gt;
[[Allow it to overpower you|Layer3 Exit2][$status.duration = (3 - $statRed), $status.penalty = 2]]&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the tentacles close in on you, you suddenly hear an ethereal voice talking to you, seeming to come from nowhere and all around at the same time.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will disappear. &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth radiates from the Creepy Doll, ushering you to hold it close and invite it into yout heart.&lt;br&gt;&lt;br&gt;

&lt;&lt;link &quot;Hold the doll tight and squeeze your eyes shut&quot; &quot;Layer3 Exit2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer3 Exit2]]</tw-passagedata><tw-passagedata pid="274" name="Layer3 Threat2 Descend" tags="layer3" position="475,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;set $timeL3T2 -= 5&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
	&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $items[0].count -= $tempTime&gt;&gt;
&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;set $timeL3 += $tempTime&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/slackslime.png&#39;]]

The ameboid creature that has trapped you seem to hiss slightly, then you smell something a little strange before your muscles completely relax. It seems that no matter how much you try, you aren&#39;t able to move at all.

The slime moves slowly, but surely over your paralyzed body and into your most sensitive locations. Even though you can&#39;t move, you can feel every moment the creature spends milking your sexual fluids for protein.

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;)&gt;&gt;
The slime lets you go after only 1 day, perhaps feeling some sense of kinship with a slimey being such as yourself.
&lt;&lt;else&gt;&gt;
The process lasts two days before the slime finally moves on and allows you to go on your way.
&lt;&lt;/if&gt;&gt;

[[You continue on your way after the slime releases you|Layer3 Exit2]]</tw-passagedata><tw-passagedata pid="275" name="Pick up the Sibyl Blend" tags="layer3" position="600,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic22)&gt;&gt;
&lt;&lt;set $corruption -= ($relic22.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic22.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic22.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can choose to start using this Relic to reduce the travel times to all future Relics by 1 day each.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="276" name="Pick up the Pangea Shaker" tags="layer3" position="725,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic23)&gt;&gt;
&lt;&lt;set $corruption -= ($relic23.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic23.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic23.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="277" name="Pick up the From Seafoam" tags="layer3" position="850,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic24)&gt;&gt;
&lt;&lt;set $corruption -= ($relic24.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic24.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic24.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="278" name="Pick up the Orbweaver" tags="layer3" position="975,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic25)&gt;&gt;
&lt;&lt;set $corruption -= ($relic25.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic25.time&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic25.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="279" name="Pick up the Soulseeker" tags="layer3" position="1100,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic26)&gt;&gt;
&lt;&lt;set $corruption -= ($relic26.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic26.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic26.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="280" name="Pick up the Tranquility Knell" tags="layer3" position="1225,3475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic27)&gt;&gt;
&lt;&lt;set $corruption -= ($relic27.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic27.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic27.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

Perhaps this Relic could be useful to evade a predator that senses its prey based on sound or vibrations?

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="281" name="Pick up the Lightning Rook" tags="layer3" position="100,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic28)&gt;&gt;
&lt;&lt;set $corruption -= ($relic28.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic22.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic28.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="282" name="Pick up the Acrobatic Accord" tags="layer3" position="225,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic29)&gt;&gt;
&lt;&lt;set $corruption -= ($relic29.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic29.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic29.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="283" name="Pick up the Managed Misfortune" tags="layer3" position="350,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic30)&gt;&gt;
&lt;&lt;set $corruption -= ($relic30.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic30.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic30.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="284" name="Pick up the Breathless Exhale" tags="layer3" position="475,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic31)&gt;&gt;
&lt;&lt;set $corruption -= ($relic31.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic31.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic31.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="285" name="Pick up the Sharing Shears" tags="layer3" position="600,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic32)&gt;&gt;
&lt;&lt;set $corruption -= ($relic32.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic32.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic32.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="286" name="Pick up the Rose-tinted Spectacles" tags="layer3" position="725,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic33)&gt;&gt;
&lt;&lt;set $corruption -= ($relic33.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic33.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic33.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 3|Layer3 Relics]]
[[Continue exploring the third layer|Layer3 Hub]]</tw-passagedata><tw-passagedata pid="287" name="Layer3 Curses Random" tags="" position="850,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _pregCurse = $playerCurses.some(e =&gt; e.name === &quot;Absolute Pregnancy&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Wacky Wombs&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Omnitool&quot;) || $StoredCurse.name == &quot;Absolute Pregnancy&quot; || $StoredCurse.name == &quot;Wacky Wombs&quot; || $StoredCurse.name == &quot;Omnitool&quot;&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,11) + 24&gt;&gt;
	&lt;&lt;if ($temp1 == 24) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;) || $StoredCurse.name == &quot;Submissiveness Rectification A&quot; || $StoredCurse.name == &quot;Power Dom&quot;) &gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 25) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gender Reversal C&quot;) &amp;&amp; $StoredCurse.name != &quot;Gender Reversal C&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $temp == 26 &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Asset Robustness C&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness C&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 27) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;) &amp;&amp; $StoredCurse.name != &quot;Clothing Restriction B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 28) &amp;&amp; !(playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification B&quot;))&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 29) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;20/20000000&quot;) &amp;&amp; $StoredCurse.name != &quot;20/20000000&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 30) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Comic Relief&quot;) &amp;&amp; $StoredCurse.name != &quot;Comic Relief&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 31) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Equal Opportunity&quot;) &amp;&amp; $StoredCurse.name != &quot;Equal Opportunity&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 32) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Absolute Pregnancy&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Pregnancy&quot; || $StoredCurse.name == &quot;Absolute Birth Control&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 33) &amp;&amp; !_pregCurse &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) &amp;&amp; $StoredCurse.name != &quot;Absolute Birth Control&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 34) &amp;&amp; !($app.womb &gt; 1 || ($playerCurses.some(e =&gt; e.name === &quot;Wacky Wombs&quot;) &amp;&amp;  $StoredCurse.name = &quot;Wacky Wombs&quot;) ||$playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Birth Control&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 35) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Omnitool&quot;) || || $StoredCurse.name == &quot;Omnitool&quot; || $playerCurses.some(e =&gt; e.name === &quot;Absolute Birth Control&quot;) || $StoredCurse.name == &quot;Absolute Birth Control&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 36) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gooey&quot;) &amp;&amp; $StoredCurse.name != &quot;Gooey&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 37) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Rainbow Swirl&quot;) &amp;&amp; $StoredCurse.name != &quot;Rainbow Swirl&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 38) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Double Pepperoni&quot;) &amp;&amp; $StoredCurse.name != &quot;Double Pepperoni&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 39) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Literal Blushing Virgin&quot;) &amp;&amp; $StoredCurse.name != &quot;Literal Blushing Virgin&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="288" name="Escape Balloon L3" tags="layer3" position="975,3600" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 3&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer3&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer3&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
The float through this layer is pretty uneventful, as the tunnel is dark around your balloon, not giving you much to see aside from an occasional patch of bioluminescent mushrooms growing on the walls. Luckily you seem to be able to move through the complex of tunnels relatively smoothly in your balloon.

[[Ascend to next layer|Escape Balloon L2][$corruption -= (25 - $corRed)]]
[[Hover on this layer to take in a curse|Layer3 Curses]]
[[Get off the balloon on this layer|Layer3 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="289" name="Layer3 Preview" tags="image layer3" position="1100,3600" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l3intro.png&#39;]]

@@.layerTitle;LAYER 3 - VEINS OF TARTARUS@@

You see yourself standing in the middle of a dark, dry cavern, with a few spots of what seems to be glowing fungus on the side of the cave to give you a chance to see the shape of the stone around you. Suddenly the image shifts and you see the splendor of the relics that are available on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 4-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="290" name="Layer4 1" tags="layer4" position="1225,3600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer4&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $currentLayer = 4&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l4intro.png&#39;]]
!Layer 4 - Hoarfrost Wastes
@@You finally emerge from the tunnels of the third layer and are given the least warm greeting to the fourth possible: a blast of chilling air that you feel settling into your bones near-instantly. Eyes adjusting once more to the Miasmal light, your first look at the layer is of a blanket of snow extending far into the fog-covered horizon, punctuated by small glacial mountains as the ground slowly meaners downward. miasma-produced winds sometimes dislodge buildups of ice on the ceiling, causing it to drift down to the ground as snow or hail. What little begetation there is struglle to survuve in this layer grows small and sparse.

This layer is enveloped in a bitter, piercing cold, strengthened by Miasma to effectively penetrate any kind of insulating clothing or similar protection. Your only option for staying warm is an active source that radiates heat. Without somehing easily portable, like a torch, you&#39;ll need to frequently stop to take shelter to start campfires. If you have a portable heat source, you may subtract 2 days from all time costs on this page. The 5 romer stones together don&#39;t quite produce enough heat to keep you warm on their own.

[[Walk through the fourth layer of the Abyss|Layer4 Hub]]&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL4 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer4 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="291" name="Layer4 Hub" tags="layer4" position="100,3725" size="100,100">&lt;&lt;set $currentLayer = 4&gt;&gt;&lt;&lt;if $visitL4 == 0&gt;&gt;&lt;&lt;set $endSpectre = $time&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $timeL4T1 &lt; 7&gt;&gt;&lt;&lt;set $visitL4 = 1&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;The deep cold of this layer seems to penetrate any clothing and shelter you rely on. Snow drifts gently to the ground around you, and everwhere you look is coated in either a powder of snow or a layer of clear, frozen ice. Your only relef is when you take the time to stop at camp to eat, drink, and enjoy the warmth of your nightly campfire.

This layer is enveloped in a bitter, piercing cold, strengthened by Miasma to effectively penetrate any kind of insulating clothing or similar protection. Your only option for staying warm is an active source that radiates heat. Without somehing easily portable, like a torch, you&#39;ll need to frequently stop to take shelter to start campfires. If you have a portable heat source, you may subtract 2 days from all time costs on this page. The 5 romer stones together don&#39;t quite produce enough heat to keep you warm on their own.

&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;


&lt;&lt;if $warmCloth &amp;&amp; !$dollevent2&gt;&gt;
	&lt;&lt;set $heat=1&gt;&gt;
	You put on the self-warming winter clothes. The romer stones give off a small amount of heat at the locations where you incorperated them in the gear. At first you still feel cold and you wonder if it&#39;s going to be warm enough in the end. After a while though, the insulation does its job trapping the heat and you feel almost comfortable in it.&lt;br&gt;&lt;br&gt;


&lt;&lt;else&gt;&gt;

	&lt;&lt;if $dollevent2 &amp;&amp; $warmCloth&gt;&gt;
		By now you have accepted that you can&#39;t take of the tattered pink dress. But when you try to put the self-warming winter clothes over your tattered dress you faint, only to wake up with the winter clothes off and neatly folded in your hands again. Looking at the doll you swear you can see it grinning at you. It seems you are stuck using other sources of heat. If only you could burn that acursed doll..&lt;br&gt;&lt;br&gt;

	&lt;&lt;elseif $dollevent2 &amp;&amp; !$warmCloth&gt;&gt;
		Dressed in only your tattered pink dress you shiver from the freezing cold. You whish you had something warmer to wear. At the same time you wonder if you could even wear something warmer now that you are in this cursed dress. Damn that doll..&lt;br&gt;&lt;br&gt;

	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $items[9].count &gt; 0 &amp;&amp; $heat == 0 &amp;&amp; $torchUse == 0&gt;&gt;
	[[Use torches to reduce travel times on this layer by 2 days each at the cost of 1 torch per travel|Layer4 Hub][$torchUse = 1]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $heat == 1 &amp;&amp; $torchUse == 0&gt;&gt;
	[[Use your non-disposable heat source to reduce travel times on this layer by 2 days per travel|Layer4 Hub][$torchUse = 1]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $torchUse == 1 &amp;&amp; $heat == 0&gt;&gt;
	[[Stop using torches to reduce travel time|Layer4 Hub][$torchUse = 0]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $torchUse == 1 &amp;&amp; $heat == 1&gt;&gt;
	[[Stop using your reusable heat source to reduce travel time|Layer4 Hub][$torchUse = 0]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $forageWater == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;if $slingshot == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer with your Brave Vector, allowing you to hunt with no daily bullet cost.&quot;&gt;&gt;
	&lt;&lt;elseif $items[20].count &lt; 2&gt;&gt;
	&lt;&lt;print &quot;You need a gun and at least 2 bullets to be able to hunt flairabou for your daily food on this layer.&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer, costing you 2 bullets a day in hunting.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer4&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer4&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
What do you want to do while you&#39;re here?&lt;br&gt;
&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer4 Threats]]
[[Check for food and water you can forage for|Layer4 Forage]]
[[Search for relics|Layer4 Relics]]
[[Take on curses to purge your corruption|Layer4 Curses]]
[[Look for any wonders you can take advantage|Layer4 Wonders]]
[[View the Layer 4 habitation option|Layer4 Habitation]]

[[Look up towards the surface|Layer4 Ascend 1]]
[[Look down at the next layer|Layer4 Exit1]]&lt;&lt;else&gt;&gt;

A great hissing sound, as if a blimp were leaking its helium, fills your ears as a dark form descends on you from above. A monstrous beast floats above your head and unveils its tentacles in preparation of its attempt to shovel you into its enormous maw.

[[Deal with the Drifting Swallower|Layer4 Threat1 Main]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="292" name="Layer4 Cherry" tags="layer4" position="225,3725" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer4 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer4 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer4 Cherry Mix]]</tw-passagedata><tw-passagedata pid="293" name="Layer4 Threats" tags="image layer4" position="350,3725" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-threats.png&#39;]]

[[Return to exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="294" name="Layer4 Forage" tags="image layer4" position="475,3725" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.
&lt;&lt;if $HeightIncrease == &quot;0&quot; &amp;&amp; $forageFood == 1&gt;&gt;
Would you like to increase or descrease your height due to eating flairabou meat?

&lt;&lt;radiobutton &quot;$HeightIncrease&quot; -1 checked&gt;&gt; Decrease
&lt;&lt;radiobutton &quot;$HeightIncrease&quot; 1 &gt;&gt; Increase

&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for water in Algal Meltwater|Layer4 Forage][$forageWater = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for water|Layer4 Forage][$forageWater = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for food from Flairabou|Layer4 Forage][$forageFood = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer4 Forage][$forageFood = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from the layer|Layer4 Flasks]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="295" name="Layer4 Relics" tags="layer4 cards nobr" position="600,3725" size="100,100">&lt;&lt;if $timeL4T1 &lt; 7&gt;&gt;

&lt;p&gt;
@@.floatr;[img[setup.ImagePath+&#39;icon.png&#39;]]@@

The Brave Vector Relic you can find here is a perfect example of something you might want the Relic Workshop to modify on the surface. With a few simple modifications, it could work as a kind of debris gun, firing whatever rocks and rubble you can find down here at high velocity towards enemies...or perhaps even other Relics, though you would need to be quite careful to ensure that fired Relics don&#39;t break upon impact. It can also be used more generally for any Relic invention where you&#39;d like some component to be moving really, really fast.
&lt;/p&gt;

&lt;p&gt;[[Continue exploring the fourth layer|Layer4 Hub]]&lt;/p&gt;

&lt;&lt;RelicGrid `[&quot;Ghost-righter Writing Down&quot;, &quot;Gilded Prison&quot;, &quot;Omoikane Circuit&quot;, &quot;Afar Wanderer&quot;, &quot;Kin Shifter&quot;, &quot;Brave Vector&quot;, &quot;Devil&#39;s Own&quot;, &quot;Verve Cell&quot;,&quot;Vessel Vivisector&quot;, &quot;Sated Artist&quot;, &quot;Timekeeper&#39;s Keepsake&quot;, &quot;Creator&#39;s Bolt&quot;, &quot;Perpetual Repose&quot;, &quot;Toral Wave&quot;, &quot;Flamel&#39;s Folly&quot;]`&gt;&gt;

&lt;p&gt;[[Continue exploring the fourth layer|Layer4 Hub]]&lt;/p&gt;

&lt;&lt;else&gt;&gt;

&lt;p&gt;A great hissing sound, as if a blimp were leaking its helium, fills your ears as a dark form descends on you from above. A monstrous beast floats above your head and unveils its tentacles in preparation of its attempt to shovel you into its enormous maw.&lt;/p&gt;

&lt;p&gt;[[Deal with the Drifting Swallower|Layer4 Threat1 Main]]&lt;/p&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="296" name="Layer4 Curses" tags="image layer4" position="725,3725" size="100,100">&lt;&lt;GenderCorrected&gt;&gt;[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-curses.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _clothCurse = $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) || $StoredCurse.name == &quot;Crossdress Your Heart&quot; || $StoredCurse.name == &quot;Clothing Restriction B&quot; || $StoredCurse.name == &quot;Clothing Restriction C&quot;&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement C&quot;)  || $StoredCurse.name == &quot;Libido Reinforcement C&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Libido Reinforcement C]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse41]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) || $StoredCurse.name == &quot;Lactation Rejuvination A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Lactation Rejuvination A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse42]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness D&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness D&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Asset Robustness D]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse43]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Age Reduction B&quot;) || $StoredCurse.name == &quot;Age Reduction B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Age Reduction B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse44]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sleep Tight&quot;) ||  $StoredCurse.name == &quot;Sleep Tight&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Sleep Tight]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse45]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Sweet Dreams&quot;) || $StoredCurse.name == &quot;Sweet Dreams&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Sweet Dreams]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse46]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) || $StoredCurse.name == &quot;Hypno Happytime&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Hypno Happytime]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse47]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;) || $StoredCurse.name == &quot;Crossdress Your Heart&quot; || $StoredCurse.name == &quot;Futa Fun&quot; || _clothCurse&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Crossdress Your Heart]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse48]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lie Detector&quot;) || $StoredCurse.name == &quot;Lie Detector&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Lie Detector]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse49]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Megadontia&quot;) || $StoredCurse.name == &quot;Megadontia&quot;&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Megadontia]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse50]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Softie&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Hard Mode&quot;) || $StoredCurse.name == &quot;Softie&quot; || $StoredCurse.name == &quot;Hard Mode&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Softie]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse51]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Softie&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Hard Mode&quot;) || $StoredCurse.name == &quot;Softie&quot; || $StoredCurse.name == &quot;Hard Mode&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Hard Mode]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse52]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lingual Leviathan&quot;) || $StoredCurse.name == &quot;Lingual Leviathan&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Lingual Leviathan]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse53]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Tipping the Scales&quot;) || $StoredCurse.name == &quot;Tipping the Scales&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Tipping the Scales]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse54]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Reptail&quot;) || $StoredCurse.name == &quot;Reptail&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Reptail]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse55]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Cold Blooded&quot;) || $StoredCurse.name == &quot;Cold Blooded&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Cold Blooded]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer4 Curses][$StoredCurse = $curse56]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer4 Curses Random]]


&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="297" name="Layer4 Wonders" tags="image layer4" position="850,3725" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-wonders.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if ($hiredCompanions.length &gt; 0) &amp;&amp; ($steadyForced &lt; 4)&gt;&gt;
	Would you like to use the Steady Shrine to copy a curse to one of your willing companions at the cost of &lt;&lt;print ($skewedUsed * 5)&gt;&gt; dubloons?&lt;br&gt;
	&lt;&lt;link &quot;Yes, use the Steady Shrine to copy a curse&quot; &quot;Layer4 Steady1a&quot;&gt;&gt;
		&lt;&lt;set $tempTime = 3&gt;&gt;
		&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
	Would you like to use the Steady Shrine to force a curse on one of your unwilling companions at the cost of &lt;&lt;print ($skewedUsed * 5)&gt;&gt; dubloons?&lt;br&gt;
	&lt;&lt;link &quot;Yes, use the Steady Shrine to force a curse&quot; &quot;Layer4 Steady 2a&quot;&gt;&gt;
		&lt;&lt;set $tempTime = 3&gt;&gt;
		&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $steadyForced &gt; 4&gt;&gt;
	None of your companions trust you at this shrine anymore. None will get close enough for you to use the shrine with them. They watch you with eyes full of fear and anger, as if they could bolt at any moment and leave you alone in the Abyss.&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
	You must have companions if you would like to use the Steady Shrine.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if ($purityUsed == 0)&gt;&gt;
	Would you like to use the Purity Tree?&lt;br&gt;
	[[Yes, choose what you want to do with the tree|Layer4 Purity 1]]&lt;br&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	You can only use the rare species of purity tree one time.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return to exploring the layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="298" name="Layer4 Habitation" tags="image layer4" position="975,3725" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the fourth layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="299" name="Layer4 Ascend 1" tags="layer4" position="1100,3725" size="100,100">Backtracking through to the caverns of the previous layer will take you 7 days and cost 35 corruption.

[[Continue your ascent|Layer4 Ascend2]]
[[Turn back and continue your business on the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="300" name="Layer4 Exit1" tags="layer4" position="1225,3725" size="100,100">Between this layer and the next is a kilometers-long sheer drop with a near-featureless wall of slippery wall of rock and ice on all sides. Paths and tunnels onward to the next layer exist, but they&#39;re very slow and meandering, and taking these down to the next layer, combined with the time trekking through the main body of this layer, will take 19 days by default. If you have rope wih you, you can instead descend right through this dividing space in a much shorter time, and the whole trip will only take 8 days. Remember that the return trip takes longer than the trip down, either way.

The air seems to get drier as you proceed further down. You might want to stockpile plenty of water before continuing on, probably around 2 weeks worth at a minimum.

[[Turn back and continue your business on the fourth layer|Layer4 Hub]]
[[Continue your descent to the fifth layer|Layer4 Exit2]]</tw-passagedata><tw-passagedata pid="301" name="Layer4 Threat1 Main" tags="layer4" position="100,3850" size="100,100">&lt;&lt;set $timeL4T1 -= 7&gt;&gt;
[img[setup.ImagePath+&#39;Threats/driftingswallower.png&#39;]]

How do you want to deal with the creature descending upon you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he would be seriously injured by fighting it, increasing your next 6 travel times by 1 day each if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer4 Hub][$status.duration = (6 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($joyousSword == 1 || $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
You can arm Khemia with your more powerful Relic sword and he will be able to defeat the creature without any major issues after a brief battle.&lt;br&gt;
[[Allow Khemia to defeat it with his Relic blade|Layer4 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 4&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 5 bullets to take it down due to the way it moves around and evades your shots.&lt;br&gt;
	[[Shoot it with your pistol|Layer4 Hub][$items[20].count -= (5 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, and a ranged weapon can efficiently bring down a swallower.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer4 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Tranquility Knell&quot;)&gt;&gt;
The Drifting Swallower detects its prey by the vibrations that surround them, but the Tranquility Knell silences the noise in both the air and all other media, meaning the vibrations are nearly silenced and the Swallower is left nearly blind. This effect should give you 30 minutes where the creature is unable to find you, allowing you to escape unnoticed until you are out of range.&lt;br&gt;
[[Escape with the Tranquility Knell|Layer4 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, prepare to be vored! It will swallow you whole and you will spend the next 3 days inside of its large stomach being tickled and lightly burned by gastric juices lapping over your whole body. After you are eventually expelled from the creature, you&#39;ll be left with persistant light burns, increasing all travel costs by 1 day until you are cured. This will not heal without a medkit.&lt;br&gt;
[[Allow it to overpower you|Layer4 Hub][$status.duration = 99, $status.penalty = 1]]

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;As the nightmarish beast drifts closer to you, you suddenly hear a voice talking to you.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will dissapear &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth is radiating from the doll you found&lt;br&gt;
&lt;&lt;link &quot;Hold the doll tight and close your eyes&quot; &quot;Layer4 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="302" name="Take on Libido Reinforcement C" tags="layer4" position="225,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse41)&gt;&gt;&lt;&lt;set $corruption += $curse41.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse41)&gt;&gt;

You have successfully taken on the $curse41.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="303" name="Take on Lactation Rejuvination A" tags="layer4" position="350,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse42)&gt;&gt;&lt;&lt;set $corruption += $curse42.corr&gt;&gt;

You have successfully taken on the $curse42.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="304" name="Take on Asset Robustness D" tags="layer4" position="475,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse43)&gt;&gt;&lt;&lt;set $corruption += $curse43.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse43)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact D&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

You have successfully taken on the $curse43.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="305" name="Take on Age Reduction B" tags="layer4" position="600,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse44)&gt;&gt;&lt;&lt;set $corruption += $curse44.corr&gt;&gt;&lt;&lt;set $AgeLog.push($curse44)&gt;&gt;

You have successfully taken on the $curse44.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="306" name="Take on Sleep Tight" tags="layer4" position="725,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse45)&gt;&gt;&lt;&lt;set $corruption += $curse45.corr&gt;&gt;

You have successfully taken on the $curse45.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="307" name="Take on Sweet Dreams" tags="layer4" position="850,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse46)&gt;&gt;&lt;&lt;set $corruption += $curse46.corr&gt;&gt;

You have successfully taken on the $curse46.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="308" name="Take on Hypno Happytime" tags="layer4" position="975,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse47)&gt;&gt;&lt;&lt;set $corruption += $curse47.corr&gt;&gt;

You zone out for a moment, stopping in your tracks as a haze passes through your mind. It lasts for only a few moments, but leaves a permanet effect on your mind.

You know that from now on you are much more easily influenced and are particularly to any methods of propaganda, brainwashing, or hypnotism. Maybe you should keep someone you trust nearby to keep you safe from anyone who would want to expolit a vulnerable &lt;&lt;PerceivedGender&gt;&gt; such as yourself. Try not to get into any situation where anyone is trying to convince you of something you don&#39;t want to believe. You have a feeling that if someone got you to come to an MLM sales meeting, you might leave without your life savings.

Warning: This may make mental hazards deeper in the abyss much more dangerous!

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="309" name="Take on Crossdress Your Heart" tags="layer4" position="1100,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse48)&gt;&gt;&lt;&lt;set $corruption += $curse48.corr&gt;&gt;

You have successfully taken on the $curse48.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="310" name="Take on Lie Detector" tags="layer4" position="1225,3850" size="100,100">&lt;&lt;set $playerCurses.push($curse49)&gt;&gt;&lt;&lt;set $corruption += $curse49.corr&gt;&gt;

You have successfully taken on the $curse49.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="311" name="Take on Megadontia" tags="layer4" position="100,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse50)&gt;&gt;&lt;&lt;set $corruption += $curse50.corr&gt;&gt;

You have successfully taken on the $curse50.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="312" name="Take on Softie" tags="layer4" position="225,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse51)&gt;&gt;&lt;&lt;set $corruption += $curse51.corr&gt;&gt;

You have successfully taken on the $curse51.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="313" name="Take on Hard Mode" tags="layer4" position="350,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse52)&gt;&gt;&lt;&lt;set $corruption += $curse52.corr&gt;&gt;

You have successfully taken on the $curse52.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="314" name="Take on Lingual Leviathan" tags="layer4" position="475,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse53)&gt;&gt;&lt;&lt;set $corruption += $curse53.corr&gt;&gt;

You have successfully taken on the $curse53.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="315" name="Take on Tipping the Scales" tags="layer4" position="600,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse54)&gt;&gt;&lt;&lt;set $corruption += $curse54.corr&gt;&gt;

You have successfully taken on the $curse54.name curse. Hopefully you are ok with accepting the permanent consequences.

Please enter your new scale color:

&lt;&lt;textbox &quot;$curse54.variation&quot; &quot;green&quot; &quot;Layer4 Curses&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="316" name="Take on Reptail" tags="layer4" position="725,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse55)&gt;&gt;&lt;&lt;set $corruption += $curse55.corr&gt;&gt;

A shiver runs down your spine, but it doesn&#39;t stop at the bottom. The shiver continues towards an imaginary extension of your spine that moves outward from directly above your butt. You involuntarily squirm at first, due to the unfamiliar sensation, but after a few seconds you&#39;re able to accomodate it and accept it as just another physical sensation, like your body was adapting to the new sensory inputs.

When you look behind you to see what happened, you&#39;re surprised by the sight of a large, spiked, scaled reptile tail that seems to respond to your thoughts! It&#39;s your own tail, a part of your own body! This may take some time to get used to.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="317" name="Take on Cold Blooded" tags="layer4" position="850,3975" size="100,100">&lt;&lt;set $playerCurses.push($curse56)&gt;&gt;&lt;&lt;set $corruption += $curse56.corr&gt;&gt;

You have successfully taken on the $curse56.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fourth layer|Layer4 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 4|Layer4 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L4]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="318" name="Layer4 Flasks" tags="layer4" position="975,3975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL4 += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/algalmeltwater.png&#39;]]

&lt;&lt;if $abyssKnow == 0&gt;&gt;
You ignite your campfire and melt some of the snow from the ground around you, slowly turning parts of the frozen wasteland around you into life-sustaining water. However, the moment you taste the water, you notice a strange taste, the hint of miasma, and feel a throbbing in your groin. You feel like this water is likely to have some effect on you down there.
&lt;&lt;else&gt;&gt;
Using your knowledge of the Abyss, you specifically look to make sure you can get some good water directly from the bluish-green snow that is found occasionally around the layer. The water has a slight green tint and a lightly minty flavor, but it seems pure and safe to you, allowing you to continue your journey with a larger store of water than before.
&lt;&lt;/if&gt;&gt;
[[Return to exploring your food and water options on this layer|Layer4 Forage]]</tw-passagedata><tw-passagedata pid="319" name="Layer4 Steady1a" tags="layer4" position="1100,3975" size="100,100">[img[setup.ImagePath+&#39;Wonders/steadyshrine.png&#39;]]

Which curse would you like to transfer to your willing companion? It can&#39;t be too bad if they agreed to take it on.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for _companion range $hiredCompanions&gt;&gt;
	&lt;&lt;capture _companion&gt;&gt;
		&lt;&lt;for $j = 0; $j &lt; $playerCurses.length; $j++&gt;&gt;
			&lt;&lt;if $j==0&gt;&gt;
				&lt;&lt;print &quot;_companion.name doesn&#39;t mind taking:&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;/if&gt;&gt;
			&lt;&lt;set _curse = $playerCurses[$j]&gt;&gt;
			&lt;&lt;if setup.willingCurses[_companion.name].includes(_curse.name) &amp;&amp; !_companion.curses.some(e=&gt; e.name === _curse.name )&gt;&gt;
				&lt;&lt;capture _curse&gt;&gt;
					&lt;&lt;print &quot;_curse.name&quot;&gt;&gt;
					&lt;&lt;link &quot;Choose&quot; &quot;Layer4 Steady1a&quot;&gt;&gt;
						&lt;&lt;set _companion.curses.push(_curse)&gt;&gt;
						&lt;&lt;set $corruption += Math.round(_curse.corr / 2 ) &gt;&gt;
						/* The CYOA states that the cost counter is shared between shrines. */
						&lt;&lt;set $dubloons -= ($skewedUsed * 5)&gt;&gt;
						&lt;&lt;set $skewedUsed += 1&gt;&gt;
					&lt;&lt;/link&gt;&gt;&lt;br&gt;
				&lt;&lt;/capture&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[On second thought, maybe a more forceful approach is warrented|Layer4 Steady 2a]]
[[Return to exploring layer 4|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="320" name="Layer4 Steady 2a" tags="layer4" position="1225,3975" size="100,100">[img[setup.ImagePath+&#39;Wonders/steadyshrine.png&#39;]]

Which curse would you like to force on your unwilling companion?

You hear a muffled sound from your incapacitated companion as you ponder your options.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $playerCurses.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print $playerCurses[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print &quot;[[Choose|Layer4 Steady2b][$temp to $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;return&gt;&gt;</tw-passagedata><tw-passagedata pid="321" name="Layer4 Purity 1" tags="layer4" position="100,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $purityUsed = 1&gt;&gt;
&lt;&lt;set $tempTime = 5&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/puritytree.png&#39;]]

What would you like to do with the Purity Tree?
&lt;&lt;if setup.haveCuttingTool()&gt;&gt;
You can chop down the dead purity tree and use the 4 pieces to make crude protective gear for a total of +60 corruption immediately.

[[Chop down the tree and make crude protective gear|Layer4 Hub][$corruption += 60]]

You could also chop down the tree and save the wood pieces as relics, which you can either bring back to the surface and sell for 35 dubloons each or use the Relic Workshop to gain +25 corruption per section of wood (100 total).

[[Chop down the tree and save the pieces to use them on the surface|Layer4 Hub][$ownedRelics.push($purityPlank), $ownedRelics.push($purityPlank), $ownedRelics.push($purityPlank), $ownedRelics.push($purityPlank)]]
&lt;&lt;/if&gt;&gt;

If you can&#39;t or don&#39;t want to cut down the tree, you can burn it down and bathe in the raw cleansing smoke to gain +20 corruption one time.

[[Burn down the tree and bathe in its smoke|Layer4 Hub][$corruption += 20]]

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="322" name="Layer4 Steady2b" tags="layer4" position="225,4100" size="100,100">[img[setup.ImagePath+&#39;Wonders/steadyshrine.png&#39;]]

Which companion would you like to force the curse of $playerCurses[$temp].name on?

The magic of the shrine wisps through the air menacingly as your victim struggles helplessly.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $hiredCompanions.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if !$hiredCompanions[$i].curses.some(e=&gt; e.name === $playerCurses[$temp].name ) &gt;&gt;
		&lt;&lt;print $hiredCompanions[$i].name&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print &quot;[[Transfer|Layer4 Steady Apply][$hiredCompanions[$i].curses.push($playerCurses[$temp]), $temp2=$i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="323" name="Layer4 Steady Apply" tags="layer4" position="350,4100" size="100,100">[img[setup.ImagePath+&#39;Wonders/steadyshrine.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption += Math.round($playerCurses[$temp].corr / 2)&gt;&gt;
&lt;&lt;set $dubloons -= ($skewedUsed * 5)&gt;&gt;
&lt;&lt;set $skewedUsed += 1&gt;&gt;
&lt;&lt;set $skewedForced += 1&gt;&gt;
&lt;&lt;set _companionName = $hiredCompanions[$temp2].name&gt;&gt;
&lt;&lt;set _affectionPenalty = 3 - $hsswear&gt;&gt;
&lt;&lt;include &quot;Companion Mistreatment Reaction&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Stand in front of the shrine to force another curse|Layer4 Steady 2a][$convoStart=1,$choice1=0,$choice2=0]]
[[On second thought, maybe a more diplomatic approach would be advisable|Layer4 Steady1a][$convoStart=1,$choice1=0,$choice2=0]]
[[Continue with your journey|Layer4 Hub][$convoStart=1,$choice1=0,$choice2=0]]</tw-passagedata><tw-passagedata pid="324" name="Pick up the Ghost-righter Writing Down" tags="layer4" position="475,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic34)&gt;&gt;
&lt;&lt;set $corruption -= ($relic34.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic34.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic34.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="325" name="Pick up the Gilded Prison" tags="layer4" position="600,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic35)&gt;&gt;
&lt;&lt;set $corruption -= ($relic35.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic35.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic35.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="326" name="Pick up the Omoikane Circuit" tags="layer4" position="725,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic36)&gt;&gt;
&lt;&lt;set $corruption -= ($relic36.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic36.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic36.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="327" name="Pick up the Afar Wanderer" tags="layer4" position="850,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic37)&gt;&gt;
&lt;&lt;set $corruption -= ($relic37.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic37.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic37.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="328" name="Pick up the Kin Shifter" tags="layer4" position="975,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic38)&gt;&gt;
&lt;&lt;set $corruption -= ($relic38.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic38.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic38.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can use this Relic to copy other Relics you have to get more uses out of them or just get a great value by copying other valuable Relics!

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="329" name="Pick up the Brave Vector" tags="layer4" position="1100,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic39)&gt;&gt;
&lt;&lt;set $corruption -= ($relic39.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic39.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic39.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

While this Relic may not be very functional in its current form as a bent pipe, a trip to the Relic Workshop could transform it into a powerful and efficient weapon.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="330" name="Pick up the Devil&#39;s Own" tags="layer4" position="1225,4100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic40)&gt;&gt;
&lt;&lt;set $corruption -= ($relic40.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic40.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic40.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

If you have Cherry, this Relic will provide the useful boon of a single use reroll of her Chaotic Luck.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="331" name="Pick up the Verve Cell" tags="layer4" position="100,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic41)&gt;&gt;
&lt;&lt;set $corruption -= ($relic41.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic41.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic41.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="332" name="Pick up the Vessel Vivisector" tags="layer4" position="225,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic42)&gt;&gt;
&lt;&lt;set $corruption -= ($relic42.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic42.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic42.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="333" name="Pick up the Sated Artist" tags="layer4" position="350,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic43)&gt;&gt;
&lt;&lt;set $corruption -= ($relic43.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic43.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic43.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="334" name="Pick up the Timekeeper&#39;s Keepsake" tags="layer4" position="475,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic44)&gt;&gt;
&lt;&lt;set $corruption -= ($relic44.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic44.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic44.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="335" name="Pick up the Creator&#39;s Bolt" tags="layer4" position="600,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic45)&gt;&gt;
&lt;&lt;set $corruption -= ($relic45.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic45.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic45.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="336" name="Pick up the Perpetual Repose" tags="layer4" position="725,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic46)&gt;&gt;
&lt;&lt;set $corruption -= ($relic46.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic46.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic46.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="337" name="Pick up the Toral Wave" tags="layer4" position="850,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic47)&gt;&gt;
&lt;&lt;set $corruption -= ($relic47.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic47.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic47.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

A source of electricity like this would be hard to use in combat, but perhaps if you had some way to safely channel it and fight with it then it could be more effective?

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="338" name="Pick up the Flamel&#39;s Folly" tags="layer4" position="975,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic48)&gt;&gt;
&lt;&lt;set $corruption -= ($relic48.corr - $corRed)&gt;&gt;
&lt;&lt;set $tempTime = $relic48.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic48.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 4|Layer4 Relics]]
[[Continue exploring the fourth layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="339" name="Layer4 Exit2" tags="layer4" position="1100,4225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;

	&lt;&lt;if $items[11].count &gt; 0 || $rope &gt; 0&gt;&gt;
		&lt;&lt;set $tempTime = 8&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $tempTime = 19&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;

	&lt;&lt;set $tempTime = 1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
	
	&lt;&lt;if $timeL4T1 &gt; 6&gt;&gt;
		&lt;br&gt;During your long trip down towards the fifth layer you hear a great hissing sound, as if a blimp were leaking its helium, fills your ears as a dark form descends on you from above. A monstrous beast floats above your head and unveils its tentacles in preparation of its attempt to shovel you into its enormous maw.

		[[Deal with the Drifting Swallower|Layer4 Threat1 Descend]]&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
/*
	&lt;&lt;if $items[1].count &gt; 9&gt;&gt;
		&lt;&lt;set $timeL4T1 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1 &amp;&amp; (($items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 1) || $slingshot == 1)&gt;&gt;
	&lt;&lt;if $slingshot == 0&gt;&gt;
		&lt;&lt;set $items[20].count -= Math.max((2 * $tempTime) - $bullRed, 1)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $foodL4 += 1&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;set $HeightLog.push($ForageFoodMajor)&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $HeightLog.push($ForageFoodMinor)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL4 += 1&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $algalSize += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
	&lt;&lt;set $time += 1&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	*/
&lt;&lt;/for&gt;&gt;

&lt;&lt;if $layerExitTime == 0&gt;&gt;
	&lt;br&gt;
	You continue your hike and try to keep somewhat warm despite the bone-chilling cold and your treacherous journey along the pit of sheer ice. As you get closer to the bottom, the temperature rises and the air starts to dry out.&lt;br&gt;&lt;br&gt;

	&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;

	[[Continue to the Fifth layer|Layer5 1]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="340" name="Layer4 Ascend2" tags="layer4" position="1225,4225" size="100,100">&lt;&lt;nobr&gt;&gt;

&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;set $tempTime = 7&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeSetup&quot;&gt;&gt;
	&lt;&lt;set $layerExitTime=$tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $layerExitTime; $layerExitTime &gt;0; $layerExitTime--&gt;&gt;

	&lt;&lt;set $tempTime = 1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;

	&lt;&lt;if $timeL4T1 &gt; 6&gt;&gt;
		&lt;br&gt;
	During your long hike back up towards the third layer you hear a great hissing sound, as if a blimp were leaking its helium, fills your ears as a dark form descends on you from above. A monstrous beast floats above your head and unveils its tentacles in preparation of its attempt to shovel you into its enormous maw.

	[[Deal with the Drifting Swallower|Layer4 Threat1 Ascend]]&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	/* 
	&lt;&lt;if $items[1].count &gt; 9&gt;&gt;
		&lt;&lt;set $timeL4T1 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1 &amp;&amp; (($items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 1) || $slingshot == 1)&gt;&gt;
	&lt;&lt;if $slingshot == 0&gt;&gt;
		&lt;&lt;set $items[20].count -= Math.max((2 * $tempTime) - $bullRed, 1)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $foodL4 += 1&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;set $HeightLog.push($ForageFoodMajor)&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $HeightLog.push($ForageFoodMinor)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL4 += 1&gt;&gt;
		&lt;&lt;if $abyssKnow == 0&gt;&gt;
			&lt;&lt;set $algalSize += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
	&lt;&lt;set $time += 1&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;*/
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $corruption -= (35 - $corRed)&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You continue your hike and try to keep somewhat warm despite the bone-chilling cold, but eventually the temperature starts to rise. However, once you&#39;ve gotten to the comfortable warmth of the cave systems, you find the light is once again disappearing, leaving you in the dim darkness of the third layer.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Return to the third layer|Layer3 Hub]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="341" name="Layer4 Threat1 Ascend" tags="layer4" position="100,4350" size="100,100">&lt;&lt;set $timeL4T1 -= 7&gt;&gt;
[img[setup.ImagePath+&#39;Threats/driftingswallower.png&#39;]]

How do you want to deal with the creature descending upon you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he would be seriously injured by fighting it, increasing your next 6 travel times by 1 day each if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer4 Ascend2][$status.duration = (6 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($joyousSword == 1 || $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
You can arm Khemia with your more powerful Relic sword and he will be able to defeat the creature without any major issues after a brief battle.&lt;br&gt;
[[Allow Khemia to defeat it with his Relic blade|Layer4 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 4&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 5 bullets to take it down due to the way it moves around and evades your shots.&lt;br&gt;
	[[Shoot it with your pistol|Layer4 Ascend2][$items[20].count -= (5 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, and a ranged weapon can efficiently bring down a swallower.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer4 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Tranquility Knell&quot;)&gt;&gt;
The Drifting Swallower detects its prey by the vibrations that surround them, but the Tranquility Knell silences the noise in both the air and all other media, meaning the vibrations are nearly silenced and the Swallower is left nearly blind. This effect should give you 30 minutes where the creature is unable to find you, allowing you to escape unnoticed until you are out of range.&lt;br&gt;
[[Escape with the Tranquility Knell|Layer4 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

If you allow it to overpower you, prepare to be vored! It will swallow you whole and you will spend the next 3 days inside of its large stomach being tickled and lightly burned by gastric juices lapping over your whole body. After you are eventually expelled from the creature, you&#39;ll be left with persistant light burns, increasing all travel costs by 1 day until you are cured. This will not heal without a medkit.&lt;br&gt;
[[Allow it to overpower you|Layer4 Ascend2][$status.duration = 99, $status.penalty = 1]]

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;As the nightmarish beast drifts closer to you, you suddenly hear a voice talking to you.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will dissapear &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth is radiating from the doll you found&lt;br&gt;
&lt;&lt;link &quot;Hold the doll tight and close your eyes&quot; &quot;Layer4 Ascend2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer4 Ascend2]]</tw-passagedata><tw-passagedata pid="342" name="Layer4 Threat1 Descend" tags="layer4" position="225,4350" size="100,100">&lt;&lt;set $timeL4T1 -= 7&gt;&gt;
[img[setup.ImagePath+&#39;Threats/driftingswallower.png&#39;]]

How do you want to deal with the creature descending upon you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he would be seriously injured by fighting it, increasing your next 6 travel times by 1 day each if you let him fight for you.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer4 Exit2][$status.duration = (6 - $statRed), $status.penalty = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($joyousSword == 1 || $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
You can arm Khemia with your more powerful Relic sword and he will be able to defeat the creature without any major issues after a brief battle.&lt;br&gt;
[[Allow Khemia to defeat it with his Relic blade|Layer4 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 4&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 5 bullets to take it down due to the way it moves around and evades your shots.&lt;br&gt;
	[[Shoot it with your pistol|Layer4 Exit2][$items[20].count -= (5 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, and a ranged weapon can efficiently bring down a swallower.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer4 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Tranquility Knell&quot;)&gt;&gt;
The Drifting Swallower detects its prey by the vibrations that surround them, but the Tranquility Knell silences the noise in both the air and all other media, meaning the vibrations are nearly silenced and the Swallower is left nearly blind. This effect should give you 30 minutes where the creature is unable to find you, allowing you to escape unnoticed until you are out of range.&lt;br&gt;
[[Escape with the Tranquility Knell|Layer4 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, prepare to be vored! It will swallow you whole and you will spend the next 3 days inside of its large stomach being tickled and lightly burned by gastric juices lapping over your whole body. After you are eventually expelled from the creature, you&#39;ll be left with persistant light burns, increasing all travel costs by 1 day until you are cured. This will not heal without a medkit.&lt;br&gt;
[[Allow it to overpower you|Layer4 Exit2][$status.duration = 99, $status.penalty = 1]]

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;As the nightmarish beast drifts closer you, you suddenly hear a voice talking to you.&lt;br&gt;&lt;br&gt;

&lt;&lt;say $creepydoll&gt;&gt;Don&#39;t be scared, nobody will hurt you. Just hold me tight and all the bad things will dissapear &lt;&lt;/say&gt;&gt;&lt;br&gt;

A pleasant warmth is radiating from the doll you found&lt;br&gt;
&lt;&lt;link &quot;Hold the doll tight and close your eyes&quot; &quot;Layer4 Exit2&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the beasts|Layer4 Exit2]]</tw-passagedata><tw-passagedata pid="343" name="Layer4 Cherry Relic" tags="layer4" position="350,4350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,14) + 33&gt;&gt;
&lt;&lt;set $temp2 = random(0,14) + 33&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,14) + 33&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer4 Hub]]</tw-passagedata><tw-passagedata pid="344" name="Layer4 Cherry Curse" tags="layer4" position="475,4350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,15) + 40&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 40&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,15) + 40&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2) &amp;&amp; ($temp1 + $temp2 !== 43 &amp;&amp; (Math.abs($temp1 - $temp2) !== 1))&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;if $temp1==43 || $temp2==43&gt;&gt;
	&lt;&lt;set AgeLog.push($curse44)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.
&lt;&lt;if $curses[$temp1].name ==  &quot;Tipping the Scales&quot; || $curses[$temp2].name ==  &quot;Tipping the Scales&quot;&gt;&gt;

Please enter your new scale color:

&lt;&lt;textbox &quot;$curse54.variation&quot; &quot;green&quot; &quot;Layer4 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

[[Continue on to the rest of the layer|Layer4 Hub]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp1].name ==  &quot;Asset Robustness D&quot; || $curses[$temp2].name ==  &quot;Asset Robustness D&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse43)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact D&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $curses[$temp1].name ==  &quot;Libido Reinforcement C&quot; || $curses[$temp2].name ==  &quot;Asset Robustness D&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse41)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="345" name="Layer4 Cherry Mix" tags="layer4" position="600,4350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,14) + 33&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 40&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $playerCurses[$playerCurses.length - 1].corr = Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $corruption += $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
&lt;&lt;if $temp2==43&gt;&gt;
	&lt;&lt;set AgeLog.push($curse44)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1), 0))&gt;&gt; corruption respectively.&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Tipping the Scales&quot;)&gt;&gt;

Please enter your new scale color:

&lt;&lt;textbox &quot;$app.skinColor&quot; &quot;green&quot; &quot;Layer4 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

[[Continue on to the rest of the layer|Layer4 Hub]]

&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness D&quot;)&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse43)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact D&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement C&quot;)&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse41)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="346" name="Layer4 Curses Random" tags="" position="725,4350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _clothCurse = $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) || $StoredCurse.name == &quot;Clothing Restriction B&quot; || $StoredCurse.name == &quot;Clothing Restriction C&quot; || $StoredCurse.name == &quot;Crossdress Your Heart&quot;&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,15) + 40&gt;&gt;
	&lt;&lt;if ($temp1 == 40) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement C&quot;) &amp;&amp; $StoredCurse.name != &quot;Libido Reinforcement C&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 41) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) &amp;&amp; $StoredCurse.name != &quot;Lactation Rejuvination A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $temp == 42 &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Asset Robustness D&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name != &quot;Asset Robustness D&quot; || $StoredCurse.name != &quot;Shrunken Assets&quot;)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 43) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Age Reduction B&quot;) &amp;&amp; $StoredCurse.name != &quot;Age Reduction B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 44) &amp;&amp; !playerCurses.some(e =&gt; e.name === &quot;Sleep Tight&quot;) &amp;&amp; $StoredCurse.name != &quot;Sleep Tight&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 45) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Sweet Dreams&quot;) &amp;&amp; $StoredCurse.name != &quot;Sweet Dreams&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 46) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $StoredCurse.name != &quot;Hypno Happytime&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 47) &amp;&amp; !($playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Futa Fun&quot;) || $StoredCurse.name == &quot;Crossdress Your Heart&quot; || $StoredCurse.name == &quot;Futa Fun&quot; || _clothCurse )&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 48) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Lie Detector&quot;) &amp;&amp; $StoredCurse.name != &quot;Lie Detector&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 49) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Megadontia&quot;) &amp;&amp; $StoredCurse.name != &quot;Megadontia&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 50) &amp;&amp; $playerCurses.some(e =&gt; e.name === &quot;Softie&quot;) &amp;&amp; $StoredCurse.name != &quot;Softie&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 51) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hard Mode&quot;) &amp;&amp; $StoredCurse.name != &quot;Hard Mode&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 52) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Lingual Leviathan&quot;) &amp;&amp; $StoredCurse.name != &quot;Lingual Leviathan&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 53) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Tipping the Scales&quot;) &amp;&amp; $StoredCurse.name != &quot;Tipping the Scales&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 54) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Reptail&quot;) &amp;&amp; $StoredCurse.name != &quot;Reptail&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 55) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Cold Blooded&quot;) &amp;&amp; $StoredCurse.name != &quot;Cold Blooded&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="347" name="Escape Balloon L4" tags="layer4" position="850,4350" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 4&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer4&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer4&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
The chills of this layer don&#39;t seem to abate one bit when you aren&#39;t on the ground. You do feel a bit of relief to move rapidly through the enormous vertical tunnel at the lowest point of the ice though, rather than an agozing climb through the steep cliffs and frozen tunnels.

[[Ascend to next layer|Escape Balloon L3][$corruption -= (35 - $corRed)]]
[[Hover on this layer to take in a curse|Layer4 Curses]]
[[Get off the balloon on this layer|Layer4 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="348" name="Layer4 Preview" tags="image layer4" position="975,4350" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l4intro.png&#39;]]

@@.layerTitle;LAYER 4 - HOARFROST WASTES@@

You see yourself trudging through thick layers of snow, and even with only your sight to view the layer, a deep sense of chills runs through you, as if the cold here were able to seep into your very being. Suddenly the image shifts and you see the splendor that you could find on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 5-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="349" name="Layer5 1" tags="layer5" position="1100,4350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer5&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $currentLayer = 5&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;set $timeL5T1 = 0&gt;&gt;
&lt;&lt;set $timeL5T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l5intro.png&#39;]]
!Layer 5 - Windswept Potpouri Sands
@@As you descend thrugh the huge vertical shaft, the walls lining it slowly begin to become smoother, warmer, and drier. Before long, it transitions completely from a wall of ice into a wall of sandstone. As the shaft begins to open up horizontally into the fifth layer proper, the wind, previously gentle and cold, begins to roar beneath you, whipping up the vast expanse of sand in this layer into neat-perpetual sandstorms. But sand isn&#39;t the only thing being scattered about by the wind.

For an area that otherwise bears such a strong resemblance to a surface desert, this layer is positively brimming with beautiful, colorful foliage, the petals of which chaotically dance in the wind, painting a shower of color against the backdrop of he ever-shifting dunes, and filling your nose with the scents of the world&#39;s best-stocked flower shop. Even the living flowers are astonishingly dry and fragrant, having long abandoned water and instead adapted to survive entirely on Miasma. Dotted about the layer, ruins carved from sandstone hide ancient secrets, telling the story of a long-gone civilization in a long-dead language.

[[Walk through the fifth layer of the Abyss|Layer5 Hub]]&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL5 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer5 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="350" name="Layer5 Hub" tags="layer5" position="1225,4350" size="100,100">&lt;&lt;set $currentLayer = 5&gt;&gt;&lt;&lt;if $timeL5T1 &lt; 7 &amp;&amp; $timeL5T2 &lt; 11&gt;&gt;&lt;&lt;set $visitL5 = 1&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;Your hike through the scorching heat of the sand dunes of the fifth layer, trying to keep yourself from overheating while you travel. Luckily you can enjoy the scent of the exotic flowers found all around the layer and seemingly always in bloom. In the distance you can spot the ruins of some long-dead civilization, apparently worn down by the Abyss until all that&#39;s left is the ruins you can search to find relics on this layer.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $coolCloth &amp;&amp; !$dollevent2&gt;&gt;
	&lt;&lt;set $cool=1&gt;&gt;
	You put on the self-cooling clothes. The romer stones that you incorporated in it feel like small air-conditioning units. And while the clothes are light, they still cover you well and soon you feel them cool your entire body. You feel as if you could run a mile in these clothes and still not overheat, even in this scorching landscape. It looks like you&#39;ll be able to cover more distance wearing this than you would normally be able to. This reduces all travel costs by 1 day on this layer.&lt;br&gt;&lt;br&gt;

&lt;&lt;elseif $dollevent2 &amp;&amp; $coolCloth&gt;&gt;

	By now you have accepted that you can&#39;t take off the tattered pink dress. But when you attempt to put the self-cooling clothes over your tattered dress, you faint, only to wake up with the summer clothes off and neatly folded in your hands once again. Looking at the doll, you swear you can see it grinning at you. It seems you are stuck sweating it out in this worn-down dress. If only it would be little hotter so that acursed doll would go up in flames...&lt;br&gt;&lt;br&gt;

&lt;&lt;elseif $dollevent2 &amp;&amp; !$coolCloth&gt;&gt;
	Dressed in only your tattered pink dress you feel very exposed to the heat on this layer. You wish you had something cooler and more protective to wear to protect you. At the same time you wonder if you could even wear something else now that you are stuck in this cursed dress. Damn that doll...&lt;br&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;You are not able to forage for daily water on this layer, due to the nature of the water source&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer5&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer5&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
What do you want to do while you&#39;re here?&lt;br&gt;
&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer5 Threats]]
[[Check for food and water you can forage for|Layer5 Forage]]
[[Search for relics|Layer5 Relics]]
[[Take on curses to purge your corruption|Layer5 Curses]]
[[Look for any wonders you can take advantage|Layer5 Wonders]]
[[View the Layer 5 habitation option|Layer5 Habitation]]

[[Look up towards the surface|Layer5 Ascend 1]]
[[Look down at the next layer|Layer5 Exit1]]&lt;&lt;elseif $timeL5T1 &lt; 7&gt;&gt;
A rumbling in the ground disturbs your typical walk through the fifth layer. You know that it&#39;s a Dune Devouring Borer coming for you because of the water you&#39;ve been carrrying, and now you need to be able to get away or defeat it.

[[Deal with the Dune Devouring Borer|Layer5 Threat2 Main]]
&lt;&lt;else&gt;&gt;
When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up, but you&#39;ll need to decide what to do with the swarm today.

[[Deal with the Mayfly Scuttler|Layer5 Threat1 Main]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="351" name="Layer5 Cherry" tags="layer5" position="100,4475" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer5 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer5 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer5 Cherry Mix]]</tw-passagedata><tw-passagedata pid="352" name="Layer5 Threat2 Main" tags="layer5" position="225,4475" size="100,100">&lt;&lt;set $timeL5T2 -= 9&gt;&gt;
[img[setup.ImagePath+&#39;Threats/dunedevouringborer.png&#39;]]

How do you want to deal with the enormous worm approaching you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off, but even he would be injured by fighting it, taking one day to recover.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer5 Hub][$time += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	The sword Joyous Sunder is a truly terrifying weapon in the hands of an expert like Khemia, allowing him to defeat a worm without even being injured himself.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer5 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can run away, but this requires sacrificing 10 days of water to distract the worm to give you a chance to get away.&lt;br&gt;
	[[Use 10 days of water as a distraction to get away|Layer5 Hub][$items[0].count -= 10]]&lt;br&gt;&lt;br&gt;
If you allow it to overpower you, prepare to be vored! However, this will be much more brutal than what may have occured on the previous layer. In this case you will almost certainly die after being eaten by a worm you can&#39;t fight off. It&#39;s reccomended you don&#39;t allow that to happen.
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the worms|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="353" name="Layer5 Threat1 Main" tags="layer5" position="350,4475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 -= 7&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/mayflyscuttler.png&#39;]]

When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up. They scarlet bugs produce a potent aphrodisiac venom, so if you choose to go out into the swarm, and succumb to the venom to participate in a day of sexual debauchery. On the other hand, you can stay in one of the ruins for the day and avoid the swarms altogether. Either choice will cost you one day.

[[Walk out into the swarm and enjoy the sexual festivities|Layer5 Hub]]

[[Hide out in the ruins for the day|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="354" name="Layer5 Threats" tags="image layer5" position="475,4475" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-threats.png&#39;]]

[[Return to exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="355" name="Layer5 Forage" tags="image layer5" position="600,4475" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for Crumbleweed for food|Layer5 Forage][$forageFood = 1]]&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer5 Forage][$forageFood = 0]]&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from an Oasis|Layer5 Flasks]]&lt;br&gt;&lt;br&gt;
&lt;&lt;else&gt;&gt;
You need empty flasks to fill them with water from the Oasis.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can also wait at the Oasis if you&#39;d like to pass the time while waiting for something. How many days would you like to wait at the oasis?&lt;br&gt;
&lt;&lt;textbox &quot;$temp&quot; &quot;0&quot;&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;link &quot;Wait&quot; &quot;Layer5 Forage&quot;&gt;&gt;
	&lt;&lt;if $items[2].count + $items[3].count &gt;= 5&gt;&gt;
		&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
			&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
				&lt;&lt;set $items[3].count += 1&gt;&gt;
				&lt;&lt;set $items[2].count -= 1&gt;&gt;
				&lt;&lt;set $waterL5 += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;break&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/for&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $items[3].count = $items[2].count + $items[3].count&gt;&gt;
		&lt;&lt;set $items[2].count = 0&gt;&gt;
		&lt;&lt;set $items[0].count += (5 - $items[3].count)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $tempTime = parseInt($temp)&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="356" name="Layer5 Relics" tags="layer5 cards nobr" position="725,4475" size="100,100">&lt;&lt;if $timeL5T1 &lt; 7 &amp;&amp; $timeL5T2 &lt; 11&gt;&gt;

&lt;p&gt;
@@.floatr;[img[setup.ImagePath+&#39;icon.png&#39;]]@@

Every Relic in this layer is found in one of the many ruins that are carved into the landscape, and in keeping with the architectural theme seen throughout this layer, they&#39;re all guarded by complex and dangerous traps. Whoever built these traps was certainly clever about them &amp;mdash; you&#39;ll run into tripwire right where you&#39;d normally expect a pressure plate, question why these ancient-looking ruins appear to have some kind of laser-light sensors, and sometimes see traps seemingly activate on their own with no action on your part. In any case, avoiding them altogether just by being careful isn&#39;t practical, and you&#39;ll see one &lt;b&gt;&lt;i&gt;every time&lt;/i&gt; you try to take a Relic&lt;/b&gt; from this layer.
&lt;/p&gt;

&lt;&lt;if $status.duration &gt; 0&gt;&gt;
&lt;p class=&quot;warning&quot;&gt;As you are currently suffering from a status condition, triggering a booby trap now could be &lt;b&gt;fatal&lt;/b&gt;.&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
&lt;&lt;if $items[4].count &gt; 0&gt;&gt;
[[Use a medkit to cure your status condition instantly|passage()][$status.penalty = 0, $status.duration = 0, $items[4].count -=1]]&lt;br&gt;
&lt;&lt;else&gt;&gt;
You do not have a medkit to cure your status condition.&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
[[Continue exploring the fifth layer|Layer5 Hub]]
&lt;/p&gt;

&lt;div class=&quot;cards-grid&quot;&gt;
&lt;&lt;set _totalRelics = $ownedRelics.concat($soldRelics)&gt;&gt;
&lt;&lt;set _layerRelics = [&quot;Pocket Hoard&quot;, &quot;Sunbeam&quot;, &quot;Moonwatcher&quot;, &quot;Siren&#39;s Call&quot;, &quot;Zelus Band&quot;, &quot;Everhevea&quot;, &quot;Reflex Emblem&quot;, &quot;Twin Polaris&quot;, &quot;Superpositional Skewer&quot;, &quot;Empath Coil&quot;, &quot;Heavenly Merrymaker&quot;, &quot;Vain Sculpt&quot;]&gt;&gt;
&lt;&lt;for _i = 0; _i &lt; _layerRelics.length; _i++&gt;&gt;
&lt;div&gt;
&lt;&lt;set _name = _layerRelics[_i]&gt;&gt;
&lt;&lt;set _relic = $relics.find(r =&gt; r.name === _name)&gt;&gt;
[img[setup.ImagePath + _relic.pic]]
&lt;h2&gt;_name&lt;/h2&gt;
&lt;p class=&quot;cost&quot;&gt;
Cost: &lt;&lt;print _relic.corr&gt;&gt; corruption
&lt;&lt;if _relic.time &gt; 0&gt;&gt;
+ &lt;&lt;print _relic.time&gt;&gt; day&lt;&lt;if _relic.time &gt; 1&gt;&gt;s&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;&lt;if _totalRelics.some(e =&gt; e.name === _name)&gt;&gt;
Already taken
&lt;&lt;elseif _name === &quot;Moonwatcher&quot; &amp;&amp; !setup.havePotentialLightSource()&gt;&gt;
@@.unreachable;Located in a dark, sealed chamber with a light-activated lock. Requires a source of light.@@
&lt;&lt;elseif _name === &quot;Twin Polaris&quot; &amp;&amp; setup.calcCarriedWeight() + $hiredCompanions.length * 60 &lt; 90&gt;&gt;
@@.unreachable;Located in a sealed chamber locked by a pressure switch that must be held down with 90 kg of weight. The weight you and your companions can currently put on the switch is only &lt;&lt;print (setup.calcCarriedWeight() + $hiredCompanions.length * 60).toFixed(1)&gt;&gt; kg.@@
&lt;&lt;elseif _name === &quot;Empath Coil&quot; &amp;&amp; ($items[20].count &lt; 1 || $items[13].count &lt; 1) &amp;&amp; $slingshot == 0&gt;&gt;
@@.unreachable;Located in a sealed chamber locked by a switch on the ceiling, far out of reach. Can be hit with a pistol, using 1 bullet.@@
&lt;&lt;else&gt;&gt;
&lt;&lt;print &quot;[[Pick up the &quot; + _name + &quot;|Layer5 Booby][$temp = &quot; + (_i + 1) + &quot;, $booby = &quot; + (_i % 3 + 1) + &quot;]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;&lt;print _relic.desc&gt;&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;&lt;print _relic.weight&gt;&gt; kg,
&lt;&lt;print _relic.value&gt;&gt; dubloons
&lt;/p&gt;
&lt;/div&gt;
&lt;&lt;/for&gt;&gt;
&lt;/div&gt;

&lt;p&gt;[[Continue exploring the fifth layer|Layer5 Hub]]&lt;/p&gt;

&lt;&lt;elseif $timeL5T1 &lt; 7&gt;&gt;

&lt;p&gt;A rumbling in the ground disturbs your typical walk through the fifth layer. You know that it&#39;s a Dune Devouring Borer coming for you because of the water you&#39;ve been carrrying, and now you need to be able to get away or defeat it.&lt;/p&gt;

&lt;p&gt;[[Deal with the Dune Devouring Borer|Layer5 Threat2 Main]]&lt;/p&gt;

&lt;&lt;else&gt;&gt;

&lt;p&gt;When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up, but you&#39;ll need to decide what to do with the swarm today.&lt;/p&gt;

&lt;p&gt;[[Deal with the Mayfly Scuttler|Layer5 Threat1 Main]]&lt;/p&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="357" name="Layer5 Curses" tags="image layer5" position="850,4475" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-curses.png&#39;]]&lt;&lt;GenderCorrected&gt;&gt;


&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement D&quot;)  || $StoredCurse.name == &quot;Libido Reinforcement D&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Libido Reinforcement D]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse57]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gender Reversal D&quot;) || $StoredCurse.name == &quot;Gender Reversal D&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gender Reversal D]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse58]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification A&quot;) || $StoredCurse.name == &quot;Pleasure Respecification A&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Pleasure Respecification A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse59]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) ||  $StoredCurse.name == &quot;Crossdress Your Heart&quot; ||  $StoredCurse.name == &quot;Clothing Restriction C&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Clothing Restriction C]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse60]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Massacre Manicure&quot;) ||  $StoredCurse.name == &quot;Massacre Manicure&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Massacre Manicure]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse61]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;DoS&quot;) || $StoredCurse.name == &quot;DoS&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on DoS]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse62]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;DoM&quot;) || $StoredCurse.name == &quot;DoM&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on DoM]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse63]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hijinks Ensue&quot;) ||  $StoredCurse.name == &quot;Hijinks Ensue&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Hijinks Ensue]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse64]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Flower Power&quot;) || $StoredCurse.name == &quot;Flower Power&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Flower Power]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse65]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Cellulose&quot;) || $StoredCurse.name == &quot;Cellulose&quot;&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Cellulose]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse66]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Chlorophyll&quot;) || $StoredCurse.name == &quot;Chlorophyll&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Chlorophyll]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse67]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Pheromones&quot;) || $StoredCurse.name == &quot;Pheromones&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Pheromones]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse68]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Carapacian&quot;) || $StoredCurse.name == &quot;Carapacian&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Carapacian]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse69]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hemospectrum&quot;) || $StoredCurse.name == &quot;Hemospectrum&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Hemospectrum]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse70]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Wriggly Antennae&quot;) || $StoredCurse.name == &quot;Wriggly Antennae&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Wriggly Antennae]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse71]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Eggxellent&quot;) || $StoredCurse.name == &quot;Eggxellent&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Eggxellent]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer5 Curses][$StoredCurse = $curse72]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer5 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="358" name="Layer5 Wonders" tags="image layer5" position="975,4475" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-wonders.png&#39;]]

Do you want to walk through the One-sided Tunnel and send your items back up to the surface?

[[Walk through the tunnel|Layer5 Tunnel]]
&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Superpositional Skewer&quot;) &amp;&amp; $items[7].count &gt; 0&gt;&gt;

	You can also utilize your Superpositional Skewer to sync with your commerce balloon, then swap it with a rock or something after you leave the Tunnel, which would allow you to instantly retrieve your items if you wish to. 

	[[Use the Superpositional Skewer to save 1 commerce balloon, then enter the Tunnel|Layer5 Tunnel][$tunnelSkewer = 1]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $vaultTimer == 0&gt;&gt;
Do you want to walk to the Mirage Vault to activate it for the first time?
&lt;&lt;else&gt;&gt;
Do you want to check on the Mirage Vault and see if it&#39;s open?
&lt;&lt;/if&gt;&gt;

[[Walk to the Mirage Vault door|Layer5 Vault]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="359" name="Layer5 Habitation" tags="image layer5" position="1100,4475" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the fifth layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="360" name="Layer5 Ascend 1" tags="layer5" position="1225,4475" size="100,100">Returning to layer four and passing through the long dividing area will take a very long time without a rope. Combined with the time spent backtracking through this layer, the whole trip would take 24 days. With some rope to climb you can overcome the fault much faster, although it is still quite a long climb, and the whole trip would take 11 days.

Either way, it will also cost 50 corruption.

[[Continue your ascent|Layer5 Ascend2]]
[[Turn back and continue your business on the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="361" name="Layer5 Exit1" tags="layer5" position="100,4600" size="100,100">Layer 5 is the last layer that anyone on the surface currently has any reliable knowledge of. Reports of what lies further below often contain vague strange, and contradictory information, and few emerging from dives that venture lower are in a state to be reporting information to begin with. This means that sources like the Encyclopedia Abyssia are unlikely to be helpful from here on. If you understand this, and still wish to descend further to depths beyond humanity&#39;s current understanding, the trip will take 13 days.

[[Turn back and continue your business on the fifth layer|Layer5 Hub]]
[[Continue your descent to the sixth layer|Layer5 Exit2]]</tw-passagedata><tw-passagedata pid="362" name="Layer5 Flasks" tags="layer5" position="225,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $oasisVisit = 1&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = (Math.max(4 - $timeRed + $status.penalty - ($oasisVisit * 2) - $abyssKnow + (Math.trunc($hexflame / 10)), 0))&gt;&gt;
&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/oasis.png&#39;]]

After spending $tempTime days searching for an oasis, you manage to eventually find one. In an effort to replenish the water it cost you to get here, you fill all your flasks, taking in the cool, fresh water, a rare relief from the punishing heat and dryness of this layer.

As predicted, the water is pure and you can drink it without side effects!

[[Return to exploring your food and water options on this layer|Layer5 Forage]]</tw-passagedata><tw-passagedata pid="363" name="Layer5 Booby" tags="layer5" position="350,4600" size="100,100">While searching the ruins for the Relic, you have triggered a booby trap!
&lt;small&gt;Hehe, booby.&lt;/small&gt;

[img[setup.ImagePath+&#39;Threats/boobytraps.png&#39;]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _trapAvoided = true&gt;&gt;
&lt;&lt;if $booby == 1&gt;&gt;

&lt;&lt;set $booby1 += 1&gt;&gt;
&lt;&lt;if $booby1 &gt;= 3&gt;&gt;
	Having dealt with this kind of trap before, you recognize the sound of a boulder being released and immediately start running. You reach a safe spot just before the boulder would crush your limbs.
&lt;&lt;else&gt;&gt;
	After springing the trigger, a boulder comes rolling down the hallway after you!
	&lt;&lt;set _trapAvoided = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $booby == 2&gt;&gt;

&lt;&lt;set $booby2 += 1&gt;&gt;
&lt;&lt;if $booby2 &gt;= 3&gt;&gt;
	While the trigger was too well hidden to be spotted, you did notice the small holes in the wall that arrows would be coming from. You positioned yourself carefully, so all the arrows whizz by you harmlessly when you do trigger the trap.
&lt;&lt;else&gt;&gt;
	After springing the trigger, a barrage of arrows flies out the walls towards you!
	&lt;&lt;set _trapAvoided = false&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;elseif $booby == 3&gt;&gt;

&lt;&lt;set $booby3 += 1&gt;&gt;
&lt;&lt;if $booby3 &gt;= 3&gt;&gt;
	As you feel the tiniest movement below your feet, you immediately spread your arms and find something to hold on to. Not a moment too soon, as the trapdoor where you were just standing collapses into a pit of skittering scorpions. Fortunately, you are able to move on safely.
&lt;&lt;else&gt;&gt;
	After springing the trigger, a trapdoor opens beneath where you are standing, causing you to fall into a pit of skittering scorpions!
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Forest&#39;s Gift&quot;)&gt;&gt;
		&lt;br&gt;&lt;br&gt;
		Fortunately for you, the scorpions in the pit are merely mundane scorpions, rather than an Abyss-twisted analogue of them. And because of your Relic the Forest&#39;s Gift, the scorpions are actually friendly towards you, rather than upset that you invaded the pit they live in. A brief conversation explaining what happened leads to them pointing you towards a safe exit, allowing safe and easy escape from the pit.
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _trapAvoided = false&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\

&lt;&lt;if _trapAvoided&gt;&gt;
	[[Move on to retrieve the Relic|Layer5 Booby2]]
&lt;&lt;else&gt;&gt;
	[[Accept the injuries|Layer5 Booby Damage]]

	Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to evade the trap.
	[[Use a combination of relics not mentioned above you believe would be able to overpower the trap|Layer5 Booby2]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="364" name="Layer5 Booby Damage" tags="layer5" position="475,4600" size="100,100">&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	The damage from the booby trap, combined with your untreated status condition proves to be fatal. Your journey ends here.

	&lt;h1 class=&quot;gameover&quot;&gt;Game Over&lt;/h1&gt;
&lt;&lt;else&gt;&gt;
	The booby trap has caused you serious injury, increasing all travel times by 3 days until you use a medkit.
	[[Continue the search for the Relic|Layer5 Booby2][$status.duration += 99, $status.penalty += 3]]
	&lt;&lt;if $items[4].count &gt; 0&gt;&gt;\
		[[Use a medkit to cure your status and continue the search for the Relic|Layer5 Booby2][$status.penalty = 0, $status.duration = 0, $items[4].count -=1]]
	&lt;&lt;/if&gt;&gt;\
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="365" name="Layer5 Booby2" tags="layer5" position="600,4600" size="100,100">Having dealt with the booby trap, you are able to move forwards freely and obtain your prize.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $temp == 1&gt;&gt;
[[Pick up the Pocket Hoard|Pocket Hoard]]
&lt;&lt;elseif $temp == 2&gt;&gt;
[[Pick up Sunbeam|Sunbeam]]
&lt;&lt;elseif $temp == 3&gt;&gt;
[[Pick up the Moonwatcher|Moonwatcher]]
&lt;&lt;elseif $temp == 4&gt;&gt;
[[Pick up the Siren&#39;s Call|Siren&#39;s Call]]
&lt;&lt;elseif $temp == 5&gt;&gt;
[[Pick up the Zelus Band|Zelus Band]]
&lt;&lt;elseif $temp == 6&gt;&gt;
[[Pick up the Everhevea|Everhevea]]
&lt;&lt;elseif $temp == 7&gt;&gt;
[[Pick up the Reflex Emblem|Reflex Emblem]]
&lt;&lt;elseif $temp == 8&gt;&gt;
[[Pick up the Twin Polaris|Twin Polaris]]
&lt;&lt;elseif $temp == 9&gt;&gt;
[[Pick up the Superpositional Skewer|Superpositional Skewer]]
&lt;&lt;elseif $temp == 10&gt;&gt;
[[Pick up the Empath Coil|Empath Coil]]
&lt;&lt;elseif $temp == 11&gt;&gt;
[[Pick up the Heavenly Merrymaker|Heavenly Merrymaker]]
&lt;&lt;elseif $temp == 12&gt;&gt;
[[Pick up the Vain Sculpt|Vain Sculpt]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="366" name="Pocket Hoard" tags="layer5" position="725,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic49)&gt;&gt;
&lt;&lt;set $corruption -= ($relic49.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic49.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic49.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

A trip to the One-sided Tunnel might be worthwhile now to empower your new Relic and make it truly useful.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="367" name="Sunbeam" tags="layer5" position="850,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic50)&gt;&gt;
&lt;&lt;set $corruption -= ($relic50.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic50.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic50.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

This Relic can only see its true potential unleashed in the hands of a skilled swordsman, such as Khemia.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="368" name="Moonwatcher" tags="layer5" position="975,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic51)&gt;&gt;
&lt;&lt;set $corruption -= ($relic51.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic51.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic51.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="369" name="Siren&#39;s Call" tags="layer5" position="1100,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic52)&gt;&gt;
&lt;&lt;set $corruption -= ($relic52.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic52.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic52.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="370" name="Zelus Band" tags="layer5" position="1225,4600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic53)&gt;&gt;
&lt;&lt;set $corruption -= ($relic53.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic53.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic53.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="371" name="Everhevea" tags="layer5" position="100,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic54)&gt;&gt;
&lt;&lt;set $corruption -= ($relic54.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic54.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic54.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

The Everhevea can be used as 2 flasks for as long as you hold it, so at the very least you have gained some additional water storage.

[[Continue searching for the relics of layer 5|Layer5 Relics][ $items[2].count+=2]]
[[Continue exploring the fifth layer|Layer5 Hub][$items[2].count+=2]]</tw-passagedata><tw-passagedata pid="372" name="Reflex Emblem" tags="layer5" position="225,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic55)&gt;&gt;
&lt;&lt;set $corruption -= ($relic55.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic55.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic55.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="373" name="Twin Polaris" tags="layer5" position="350,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic56)&gt;&gt;
&lt;&lt;set $corruption -= ($relic56.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic56.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic56.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="374" name="Superpositional Skewer" tags="layer5" position="475,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic57)&gt;&gt;
&lt;&lt;set $corruption -= ($relic57.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic57.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic57.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="375" name="Empath Coil" tags="layer5" position="600,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic58)&gt;&gt;
&lt;&lt;set $corruption -= ($relic58.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic58.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic58.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

This may be able to channel electricity, but without a source that ability is not useful.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="376" name="Heavenly Merrymaker" tags="layer5" position="725,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic59)&gt;&gt;
&lt;&lt;set $corruption -= ($relic59.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic59.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic59.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="377" name="Vain Sculpt" tags="layer5" position="850,4725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic60)&gt;&gt;
&lt;&lt;set $corruption -= ($relic60.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic60.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic60.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 5|Layer5 Relics]]
[[Continue exploring the fifth layer|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="378" name="Take on Libido Reinforcement D" tags="layer5" position="975,4725" size="100,100">&lt;&lt;set $playerCurses.push($curse57)&gt;&gt;&lt;&lt;set $corruption += $curse57.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse57)&gt;&gt;

You have successfully taken on the $curse57.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="379" name="Take on Gender Reversal D" tags="layer5" position="1100,4725" size="100,100">&lt;&lt;set $playerCurses.push($curse58)&gt;&gt;&lt;&lt;set $corruption += $curse58.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse58)&gt;&gt;

You have successfully taken on the $curse58.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="380" name="Take on Pleasure Respecification A" tags="layer5" position="1225,4725" size="100,100">&lt;&lt;set $playerCurses.push($curse59)&gt;&gt;&lt;&lt;set $corruption += $curse59.corr&gt;&gt;

You have successfully taken on the $curse59.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="381" name="Take on Clothing Restriction C" tags="layer5" position="100,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse60)&gt;&gt;&lt;&lt;set $corruption += $curse60.corr&gt;&gt;

You have successfully taken on the $curse60.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="382" name="Take on Massacre Manicure" tags="layer5" position="225,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse61)&gt;&gt;&lt;&lt;set $corruption += $curse61.corr&gt;&gt;

You have successfully taken on the $curse61.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="383" name="Take on DoS" tags="layer5" position="350,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse62)&gt;&gt;&lt;&lt;set $corruption += $curse62.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse62)&gt;&gt;
You have successfully taken on the $curse62.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="384" name="Take on DoM" tags="layer5" position="475,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse63)&gt;&gt;&lt;&lt;set $corruption += $curse63.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse63)&gt;&gt;
You have successfully taken on the $curse63.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="385" name="Take on Hijinks Ensue" tags="layer5" position="600,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse64)&gt;&gt;&lt;&lt;set $corruption += $curse64.corr&gt;&gt;

You have successfully taken on the $curse64.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="386" name="Take on Flower Power" tags="layer5" position="725,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse65)&gt;&gt;&lt;&lt;set $corruption += $curse65.corr&gt;&gt;

You have successfully taken on the $curse65.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="387" name="Take on Cellulose" tags="layer5" position="850,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse66)&gt;&gt;&lt;&lt;set $corruption += $curse66.corr&gt;&gt;

You have successfully taken on the $curse66.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="388" name="Take on Carapacian" tags="layer5" position="975,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse69)&gt;&gt;&lt;&lt;set $corruption += $curse69.corr&gt;&gt;

You have successfully taken on the $curse69.name curse. Hopefully you are ok with accepting the permanent consequences.

Please enter your new exoskeleton color:

&lt;&lt;textbox &quot;$curse69.variation&quot; &quot;shiny black&quot; &quot;Layer5 Curses&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="389" name="Take on Hemospectrum" tags="layer5" position="1100,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse70)&gt;&gt;&lt;&lt;set $corruption += $curse70.corr&gt;&gt;

You have successfully taken on the $curse70.name curse. Hopefully you are ok with accepting the permanent consequences.

What would you like your new blood (or maybe hemolymph, depending on how human you still are) color to be?

&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;blue&quot; checked&gt;&gt; Blue
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;purple&quot; &gt;&gt; Purple
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;green&quot; &gt;&gt; Green
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;yellow&quot; &gt;&gt; Yellow
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;orange&quot; &gt;&gt; Orange
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;pink&quot; &gt;&gt; Pink
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;black&quot; &gt;&gt; Black
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;white&quot; &gt;&gt; White

[[Accept more curses from the fifth layer|Layer5 Curses]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="390" name="Take on Wriggly Antennae" tags="layer5" position="1225,4850" size="100,100">&lt;&lt;set $playerCurses.push($curse71)&gt;&gt;&lt;&lt;set $corruption += $curse71.corr&gt;&gt;

You have successfully taken on the $curse71.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="391" name="Take on Eggxellent" tags="layer5" position="100,4975" size="100,100">&lt;&lt;set $playerCurses.push($curse72)&gt;&gt;&lt;&lt;set $corruption += $curse72.corr&gt;&gt;

You have successfully taken on the $curse72.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="392" name="Layer5 Curses Random" tags="layer5" position="225,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,15) + 56&gt;&gt;
	&lt;&lt;if ($temp1 == 56) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement D&quot;) &amp;&amp; $StoredCurse.name != &quot;Libido Reinforcement D&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 57) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gender Reversal D&quot;) &amp;&amp; $StoredCurse.name != &quot;Gender Reversal D&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 58) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification A&quot;) &amp;&amp; $StoredCurse.name != &quot;Pleasure Respecification A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 59) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Crossdress Your Heart&quot;) &amp;&amp; $StoredCurse.name != &quot;Clothing Restriction C&quot; &amp;&amp; $StoredCurse.name != &quot;Crossdress Your Heart&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 60) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Massacre Manicure&quot;) &amp;&amp; $StoredCurse.name != &quot;Massacre Manicure&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 61) &amp;&amp; !(playerCurses.some(e =&gt; e.name === &quot;DoS&quot;)) &amp;&amp; $StoredCurse.name != &quot;DoS&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 62) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;DoM&quot;) &amp;&amp; $StoredCurse.name != &quot;DoM&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 63) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hijinks Ensure&quot;) &amp;&amp; $StoredCurse.name != &quot;Hijinks Ensure&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 64) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Flower Power&quot;) &amp;&amp; $StoredCurse.name != &quot;Flower Power&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 65) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Cellulose&quot;) &amp;&amp; $StoredCurse.name != &quot;Cellulose&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 66) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Chlorophyll&quot;) &amp;&amp; $StoredCurse.name != &quot;Chlorophyll&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 67) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Pheromones&quot;) &amp;&amp; $StoredCurse.name != &quot;Pheromones&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 68) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Carapacian&quot;) &amp;&amp; $StoredCurse.name != &quot;Carapacian&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 69) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hemospectrum&quot;) &amp;&amp; $StoredCurse.name != &quot;Hemospectrum&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 70) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Wriggly Antennae&quot;) &amp;&amp; $StoredCurse.name != &quot;Wriggly Antennae&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 71) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Eggxellent&quot;) &amp;&amp; $StoredCurse.name != &quot;Eggxellent&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="393" name="Take on Chlorophyll" tags="layer5" position="350,4975" size="100,100">&lt;&lt;set $playerCurses.push($curse67)&gt;&gt;&lt;&lt;set $corruption += $curse67.corr&gt;&gt;

You have successfully taken on the $curse67.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="394" name="Take on Pheromones" tags="layer5" position="475,4975" size="100,100">&lt;&lt;set $playerCurses.push($curse68)&gt;&gt;&lt;&lt;set $corruption += $curse68.corr&gt;&gt;

You have successfully taken on the $curse68.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the fifth layer|Layer5 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 5|Layer5 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L5]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="395" name="Layer5 Cherry Relic" tags="layer5" position="600,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 48&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 48&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 48&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer5 Hub]]

&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer5 Cherry Relic&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;

		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="396" name="Layer5 Cherry Curse" tags="layer5" position="725,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,15) + 56&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 56&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,15) + 56&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.

&lt;&lt;if $curses[$temp1].name ==  &quot;Hemospectrum&quot; || $curses[$temp2].name == &quot;Hemospectrum&quot;&gt;&gt;

What would you like your new blood (or maybe hemolymph, depending on how human you still are) color to be?

&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;blue&quot; checked&gt;&gt; Blue
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;purple&quot; &gt;&gt; Purple
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;green&quot; &gt;&gt; Green
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;yellow&quot; &gt;&gt; Yellow
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;orange&quot; &gt;&gt; Orange
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;pink&quot; &gt;&gt; Pink
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;black&quot; &gt;&gt; Black
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;white&quot; &gt;&gt; White

[[Continue on to the rest of the layer|Layer5 Hub]]

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $curses[$temp1].name ==  &quot;Carapacian&quot; || $curses[$temp2].name ==  &quot;Carapacian&quot;&gt;&gt;

Please enter your new exoskeleton color:

&lt;&lt;textbox &quot;$curse69.variation&quot; &quot;shiny black&quot; &quot;Layer5 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

/*&lt;&lt;if !($curses[$temp1].name ==  &quot;Hemospectrum&quot; || $curses[$temp2].name ==  &quot;Hemospectrum&quot;)&gt;&gt;[[Continue on to the rest of the layer|Layer5 Hub]]&lt;&lt;elseif !$playerCurses.some(e =&gt; e.name === &quot;Carapacian&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hemospectrum&quot;)&gt;&gt;[[Continue on to the rest of the layer|Layer5 Hub]]&lt;&lt;/if&gt;&gt;
*/
&lt;&lt;/if&gt;&gt;
[[Continue on to the rest of the layer|Layer5 Hub]]
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Gender Reversal D&quot; || $curses[$temp2].name == &quot;Gender Reversal D&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse58)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Libido Reinforcement D&quot; || $curses[$temp2].name == &quot;Libido Reinforcement D&quot; &gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse57)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;DoS&quot; || $curses[$temp2].name == &quot;DoS&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse62)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;DoM&quot; || $curses[$temp2].name == &quot;DoM&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse63)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer5 Cherry Curse&quot;&gt;&gt;
		&lt;&lt;set $targetCurse = $curses[$temp1]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp1].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;

		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="397" name="Layer5 Cherry Mix" tags="layer5" position="850,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 48&gt;&gt;
&lt;&lt;set $temp2 = random(0,15) + 56&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $playerCurses[$playerCurses.length - 1].corr = Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $corruption += $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1), 0))&gt;&gt; corruption respectively.

&lt;&lt;if $curses[$temp2].name == &quot;Hemospectrum&quot;&gt;&gt;

What would you like your new blood (or maybe hemolymph, depending on how human you still are) color to be?

&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;blue&quot; checked&gt;&gt; Blue
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;purple&quot; &gt;&gt; Purple
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;green&quot; &gt;&gt; Green
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;yellow&quot; &gt;&gt; Yellow
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;orange&quot; &gt;&gt; Orange
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;pink&quot; &gt;&gt; Pink
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;black&quot; &gt;&gt; Black
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$curse70.variation&quot; &quot;white&quot; &gt;&gt; White

[[Continue on to the rest of the layer|Layer5 Hub]]

&lt;&lt;/if&gt;&gt;

&lt;&lt;if $curses[$temp2].name == &quot;Carapacian&quot;&gt;&gt;

Please enter your new exoskeleton color:

&lt;&lt;textbox &quot;$curse69.variation&quot; &quot;shiny black&quot; &quot;Layer5 Hub&quot;&gt;&gt;

&lt;&lt;else&gt;&gt;

/*&lt;&lt;if !$playerCurses.some(e =&gt; e.name === &quot;Hemospectrum&quot;)&gt;&gt;[[Continue on to the rest of the layer|Layer5 Hub]]&lt;&lt;elseif !$playerCurses.some(e =&gt; e.name === &quot;Carapacian&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Hemospectrum&quot;)&gt;&gt;[[Continue on to the rest of the layer|Layer5 Hub]]&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;*/
[[Continue on to the rest of the layer|Layer5 Hub]]
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Gender Reversal D&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse58)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Libido Reinforcement D&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse57)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;DoS&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse62)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;DoM&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse63)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer5 Cherry Mix&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="398" name="Layer5 Tunnel" tags="layer5" position="975,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/one-sidedtunnel.png&#39;]]

After walking through the tunnel for about 5 or 6 hours (it&#39;s hard to precisely keep track in there), you find yourself back at the same entrance you started walking into, despite absolutely never turning around.

And as soon as the harsh light of the fifth layer touches you, you notice your pack is suddenly much lighter! It seems that all of the items you brought with you into the Abyss have disappeared, presumably sent to the surface at a location which is suddenly intuitively available to your mind. &lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Pocket Hoard&quot;)&gt;&gt;

Testing your Pocket Hoard, you stick a hand into the pink rucksack, but find you can easily stick your whole arm in. In fact, there doesn&#39;t seem to be any limit to what you can fit into the rucksack, as long as it fits into the opening, but you can easily retrieve anything you put in. You have successfully activated your Pocket Hoard! Your carrying capacity is now effectively infinite, and the value of your Pocket Hoard has increased to 100 dubloons.
&lt;&lt;/if&gt;&gt;

[[Return to exploring level 5|Layer5 Hub]]
&lt;&lt;/if&gt;&gt;&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tunnelUsed = 1&gt;&gt;
&lt;&lt;set $tunnelDubloons = $dubloons&gt;&gt;
&lt;&lt;set $dubloons = 0&gt;&gt;
&lt;&lt;if $tunnelSkewer == 1&gt;&gt;
	&lt;&lt;set $items[7].count -= 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $vaultFound == 1&gt;&gt;
	&lt;&lt;set $vaultMedkits = Math.max(items[4].count, 0)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 4; $i &lt; $items.length; $i++&gt;&gt;
	&lt;&lt;set $vaultItems[$i].count += $items[$i].count&gt;&gt;
	&lt;&lt;set $items[$i].count = 0&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if $vaultFound == 1&gt;&gt;
	&lt;&lt;set $items[4].count = $vaultMedkits&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Pocket Hoard&quot;)&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name==&quot;Pocket Hoard&quot; &gt;&gt;
		&lt;&lt;set $ownedRelics[$i].value = 100&gt;&gt;
		&lt;&lt;set $ownedRelics[$i].active = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $tunnelSkewer == 1&gt;&gt;
	&lt;&lt;set $items[7].count += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="399" name="Layer5 Vault" tags="layer5" position="1100,4975" size="100,100">[img[setup.ImagePath+&#39;Wonders/miragevault.png&#39;]]
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $vaultWait == 0&gt;&gt;
	&lt;&lt;set $tempTime = 3&gt;&gt;
	&lt;&lt;include &quot;Layer5Time&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $vaultWait = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $vaultTimer == 0&gt;&gt;
&lt;&lt;set $vaultTimer = $time&gt;&gt;
&lt;br&gt;&lt;br&gt; You touch your hand against the ancient door and the number 60 appears on it, as if there was either a very high-resolution LCD inside the glass or some magic inside it had awakened by your touch.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if (60 - $time + $vaultTimer) &gt; -6&gt;&gt;
The timer on the door reads &lt;&lt;print (60 - $time + $vaultTimer)&gt;&gt;.

You can wait here for a while if you&#39;d like to check when the door is open. If you&#39;d like to wait, enter the number of days you&#39;d like to wait and choose to wait.
&lt;&lt;textbox &quot;$temp&quot; &quot;0&quot;&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;link &quot;Wait&quot; &quot;Layer5 Vault&quot;&gt;&gt;
	&lt;&lt;set $tempTime = parseInt($temp)&gt;&gt;
	&lt;&lt;set $vaultWait = 1&gt;&gt;
	&lt;&lt;include &quot;GeneralTimeStats&quot;&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if (60 - $time + $vaultTimer) &gt; 0&gt;&gt;
The door remains locked. You must wait until the timer is between 0 and -5 for it to open and reveal the treasures within.
&lt;&lt;elseif (60 - $time + $vaultTimer) &lt; 1 &amp;&amp; (60 - $time + $vaultTimer) &gt; -6&gt;&gt;
The door to the Vault has opened! When you touch the panel, the doors gently open to reveal the treasures within and aid you on our journey.

Inside the vault you find 200 dubloons, 9 days of food rations, 9 days of bottled water, and 3 medkits!

You pick up your haul and continue forward through the Abyss, morale boosted by the successful vault expedition.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $items[0].count += 9&gt;&gt;
&lt;&lt;set $items[1].count += 9&gt;&gt;
&lt;&lt;set $items[4].count += 3&gt;&gt;
&lt;&lt;set $dubloons += 200&gt;&gt;
&lt;&lt;set $vaultFound = 1&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;else&gt;&gt;
The timer has passed its endpoint, there is no more door and no more vault that you can find. Was it ever real? There&#39;s no way to know, but you can tell it certainly isn&#39;t here now.
&lt;&lt;/if&gt;&gt;

[[Return to exploring level 5|Layer5 Hub]]</tw-passagedata><tw-passagedata pid="400" name="Layer5 Ascend2" tags="layer5" position="1225,4975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $items[11].count &gt; 0 || $rope == 1&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(11 - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)) - $cool, 0))&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(24 - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)), 0))&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;

&lt;&lt;set $timeL5 += 1&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 += 1&gt;&gt;
&lt;&lt;set $time += 1&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += 1&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;set $crumbleFluid += 5&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $crumbleFluid += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count -= 1&gt;&gt;
		&lt;&lt;set $items[2].count += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $items[0].count -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $timeL5T2 &gt; 8&gt;&gt;

&lt;br&gt;A rumbling in the ground disturbs your typical walk through the fifth layer. You know that it&#39;s a Dune Devouring Borer coming for you because of the water you&#39;ve been carrrying, and now you need to be able to get away or defeat it.&lt;br&gt;&lt;br&gt;

[[Deal with the Dune Devouring Borer|Layer5 Threat2 Ascend]]&lt;br&gt;&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL5T1 &gt; 6&gt;&gt;
		&lt;br&gt;When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up, but you&#39;ll need to decide what to do with the swarm today. &lt;br&gt;&lt;br&gt;

[[Deal with the Mayfly Scuttler|Layer5 Threat1 Ascend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption -= (50 - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You continue through the scorching desert for days on end, until you eventually reach the contrasting bitter cold of the fourth layer. But before you can do anything on the fourth layer, you need to spend many days in the agonizingly slow climb through the enormous crevasse at its bottom. After many days of climbing, you&#39;re back to the snowy wastes of the fourth layer proper.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Return to the fourth layer|Layer4 Hub]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="401" name="Layer5 Threat2 Ascend" tags="layer5" position="100,5100" size="100,100">&lt;&lt;set $timeL5T2 -= 9&gt;&gt;
[img[setup.ImagePath+&#39;Threats/dunedevouringborer.png&#39;]]

How do you want to deal with the enormous worm approaching you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off, but even he would be injured by fighting it, taking one day to recover.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer5 Ascend2][$time += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	The sword Joyous Sunder is a truly terrifying weapon in the hands of an expert like Khemia, allowing him to defeat a worm without even being injured himself.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer5 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can run away, but this requires sacrificing 10 days of water to distract the worm to give you a chance to get away.&lt;br&gt;
	[[Use 10 days of water as a distraction to get away|Layer5 Ascend2][$items[0].count -= 10]]&lt;br&gt;&lt;br&gt;
If you allow it to overpower you, prepare to be vored! However, this will be much more brutal than what may have occured on the previous layer. In this case you will almost certainly die after being eaten by a worm you can&#39;t fight off. It&#39;s reccomended you don&#39;t allow that to happen.
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the worms|Layer5 Ascend2]]</tw-passagedata><tw-passagedata pid="402" name="Layer5 Threat1 Ascend" tags="layer5" position="225,5100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 -= 7&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/mayflyscuttler.png&#39;]]

When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up. They scarlet bugs produce a potent aphrodisiac venom, so if you choose to go out into the swarm, and succumb to the venom to participate in a day of sexual debauchery. On the other hand, you can stay in one of the ruins for the day and avoid the swarms altogether. Either choice will cost you one day.

[[Walk out into the swarm and enjoy the sexual festivities|Layer5 Ascend2]]

[[Hide out in the ruins for the day|Layer5 Ascend2]]</tw-passagedata><tw-passagedata pid="403" name="Layer5 Exit2" tags="layer5" position="350,5100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime = (Math.max(13 - $timeRed + $status.penalty + (Math.trunc($hexflame / 10))- $cool, 0))&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;

&lt;&lt;set $timeL5 += 1&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 += 1&gt;&gt;
&lt;&lt;set $time += 1&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += 1&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;set $crumbleFluid += 5&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $crumbleFluid += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count -= 1&gt;&gt;
		&lt;&lt;set $items[2].count += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $items[0].count -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $timeL5T2 &gt; 8&gt;&gt;

&lt;br&gt;A rumbling in the ground disturbs your typical walk through the fifth layer. You know that it&#39;s a Dune Devouring Borer coming for you because of the water you&#39;ve been carrrying, and now you need to be able to get away or defeat it.&lt;br&gt;&lt;br&gt;

[[Deal with the Dune Devouring Borer|Layer5 Threat2 Descend]]&lt;br&gt;&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL5T1 &gt; 6&gt;&gt;
		&lt;br&gt;When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up, but you&#39;ll need to decide what to do with the swarm today. &lt;br&gt;&lt;br&gt;

[[Deal with the Mayfly Scuttler|Layer5 Threat1 Descend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $timeL6T1 = 0&gt;&gt;
&lt;&lt;set $timeL6T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You continue through the scorching desert for days on end, but the heat only seems to get more intense. But the smell is different, you catch a whiff of more exotic, meaty scents than the fragrance of the flowers of the fifth layer. As the ground begins to change from sand to a more organic texture, you know you&#39;re approaching the sixth layer.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Descend to the sixth layer|Layer6 1]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="404" name="Layer5 Threat2 Descend" tags="layer5" position="475,5100" size="100,100">&lt;&lt;set $timeL5T2 -= 9&gt;&gt;
[img[setup.ImagePath+&#39;Threats/dunedevouringborer.png&#39;]]

How do you want to deal with the enormous worm approaching you?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off, but even he would be injured by fighting it, taking one day to recover.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer5 Exit2][$time += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	The sword Joyous Sunder is a truly terrifying weapon in the hands of an expert like Khemia, allowing him to defeat a worm without even being injured himself.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer5 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can run away, but this requires sacrificing 10 days of water to distract the worm to give you a chance to get away.&lt;br&gt;
	[[Use 10 days of water as a distraction to get away|Layer5 Exit2][$items[0].count -= 10]]&lt;br&gt;&lt;br&gt;
If you allow it to overpower you, prepare to be vored! However, this will be much more brutal than what may have occured on the previous layer. In this case you will almost certainly die after being eaten by a worm you can&#39;t fight off. It&#39;s reccomended you don&#39;t allow that to happen.
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the worms|Layer5 Exit2]]</tw-passagedata><tw-passagedata pid="405" name="Layer5 Threat1 Descend" tags="layer5" position="600,5100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 -= 7&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/mayflyscuttler.png&#39;]]

When you wake up in the morning, you hear an enormous amount of buzzing in the air, luckily you managed to stay out of the swarm when you woke up. They scarlet bugs produce a potent aphrodisiac venom, so if you choose to go out into the swarm, and succumb to the venom to participate in a day of sexual debauchery. On the other hand, you can stay in one of the ruins for the day and avoid the swarms altogether. Either choice will cost you one day.

[[Walk out into the swarm and enjoy the sexual festivities|Layer5 Exit2]]

[[Hide out in the ruins for the day|Layer5 Exit2]]</tw-passagedata><tw-passagedata pid="406" name="Escape Balloon L5" tags="layer5" position="725,5100" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 5&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer5&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer5&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
As you float gently above the scorching dunes below, you notice that even up here in your balloon, you can feel the uncomfortable heat of this layer&#39;s climate. Luckily you won&#39;t need to endure it on a long hike through the sand here, instead you can enjoy a relaxing float up to the layer above.

[[Ascend to next layer|Escape Balloon L4][$corruption -= (50 - $corRed + (5 * Math.trunc($hexflame / 10))) ]]
[[Hover on this layer to take in a curse|Layer5 Curses]]
[[Get off the balloon on this layer|Layer5 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="407" name="Layer5 Preview" tags="image layer5" position="850,5100" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l5intro.png&#39;]]

@@.layerTitle;LAYER 5 - WINDSWEPT POTPOURI SANDS@@

You see yourself hiking over immense sand dunes while dry storms of brightly colored petals rage by. Suddenly the image shifts and you see the splendor that you could find on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 6-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="408" name="Layer5Time" tags="" position="975,5100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = (Math.max((1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)) - $cool), 0))&gt;&gt;
&lt;&lt;set $timeL5 += $tempTime&gt;&gt;
&lt;&lt;if ($items[0].count + $items[3].count) &gt; 10&gt;&gt;
	&lt;&lt;set $timeL5T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL5T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL5 += $tempTime&gt;&gt;
	&lt;&lt;if $abyssKnow == 0&gt;&gt;
		&lt;&lt;set $crumbleFluid += (5 * $tempTime)&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $crumbleFluid += $tempTime&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL5 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="409" name="Layer6 1" tags="layer6" position="1100,5100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer6&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $currentLayer = 6&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l6intro.png&#39;]]
!Layer 6 - Cinders of Dis
@@The first hint of the sixth layer is a strong smell of smoke overwhelming your nostrils - a savory, meaty kind of smoke, almost like the smell of barbeque. It almost feels like the flowers beneath you are caressing your feet, but the air gets hotter and hotter as you head further down, and as the flowers begin to become charred and burned awar, the real culprit becomes clear: a squirming carpet of tentacles, thousands or millions of tiny villi completely covering almost every surface on the path ahead, forming an entire field of squirming creatures.

They grow taller as you proceed, until you&#39;re wading through a thicket or navel-high tentacles, prodding and rubbing against your most sensitive areas. By this point, the heat has become truly intense, almost sauna-like. It&#39;s so hot that great swathes of the tentacle fields are actually aflame, thousands of tendrils being birned away and perpetually springing up again, a land of flesh doused in fire: a perfect vision of Hell. Some of the fire are in a familiar orange-red hue, while other come in more exotic greens, pinks, and purples, only lightly tickling when they lap at your skin. Small pieces of rubble, perhaps of some ancient structures, litter the layer...but the tentacles and flames have long since crushed and burned them into unrecognizable, meaningless rock.

[[Walk through the sixth layer of the Abyss|Layer6 Hub]]&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL6 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer6 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="410" name="Layer6 Hub" tags="layer6" position="1225,5100" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 6&gt;&gt;&lt;&lt;if $timeL6T1 &lt; 15 &amp;&amp; ($timeL6T2 &lt; 8 || $dragonKill &gt; 4)&gt;&gt;&lt;&lt;set $visitL6 = 1&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;


As you wander the burning hellscape of the sixth layer, you have to periodically kick away tentacles attempting to grope your lower body. The trip is unpleasant and surreal, but you have to continue to reach your goals.&lt;br&gt;&lt;br&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $coolCloth &amp;&amp; !$dollevent2&gt;&gt;
	&lt;&lt;set $cool=1&gt;&gt;
	You put on the self-cooling clothes. The romer stones that you incorperated in it feel like small airconditioning units although the clothes are light they still cover you very well and soon you feel them cool your entire body. You feel like you could run a mile in these clothes and still not overheat in this hellish landscape you find yourself. It looks like you&#39;ll be able to cover more distance wearing this than you would normally be able to, reducing all travel costs on this layer by 1 day.&lt;br&gt;&lt;br&gt;

&lt;&lt;elseif $dollevent2 &amp;&amp; $coolCloth&gt;&gt;

	By now you have accepted that you can&#39;t take of the tattered pink dress. But when you try to put the self-cooling clothes over your tattered dress you faint, only to wake up with the summer clothes off and neatly folded in your hands again. Looking at the doll you swear you can see it grinning at you. It seems you are stuck sweating it out in this worn down dress. If only it would be little hoter so that acursed doll would go up in flames..&lt;br&gt;&lt;br&gt;

&lt;&lt;elseif $dollevent2 &amp;&amp; !$coolCloth&gt;&gt;
	Dressed in only your tattered pink dress you feel very exposed to the heat on this layer. You whish you had something cooler and more insulating to wear to protect you. At the same time you wonder if you could even wear something else now that you are in this cursed dress. Damn that doll..&lt;br&gt;&lt;br&gt;

&lt;&lt;/if&gt;&gt;


&lt;&lt;if $forageWater == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily water on this layer&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;print &quot;You are currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;You are not currently foraging for your daily food on this layer&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer6&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer6&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;What do you want to do while you&#39;re here?&lt;br&gt;
&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
[[Learn about the threats on this layer|Layer6 Threats]]&lt;br&gt;
[[Check for food and water you can forage for|Layer6 Forage]]&lt;br&gt;
[[Search for relics|Layer6 Relics]]&lt;br&gt;
[[Take on curses to purge your corruption|Layer6 Curses]]&lt;br&gt;
[[Look for any wonders you can take advantage|Layer6 Wonders]]&lt;br&gt;
[[View the Layer 6 habitation option|Layer6 Habitation]]&lt;br&gt;
&lt;br&gt;
[[Look up towards the surface|Layer6 Ascend 1]]&lt;br&gt;
[[Look down at the next layer|Layer6 Exit1]]

&lt;&lt;elseif $timeL6T2 &gt; 7 &amp;&amp; $dragonKill &lt; 5&gt;&gt;
A thunderous roar disturbs you as your tread across the slimy, tentacled-ground of the sixth layer. At first you don&#39;t see the source of the sound, but after a moment you look up and see an enormous Fell Dragon approaching with great speed. It lets out a stream of fire as a warning before roaring again and landing in front of you with it&#39;s head held high and a subtle stream of liquid fire dribbling from the corner of its mouth. It is demanding tribute for you carrying your wealth in these lands, and now is your chance to pay it.&lt;br&gt;&lt;br&gt;

[[Deal with the Fell Dragon|Layer6 Threat2 Main]]
&lt;&lt;else&gt;&gt;
Your walk across the sixth layer continues as normal, and you bat away some harassing tentacles, but something was different about these?&lt;br&gt;&lt;br&gt;

They push against you more persistantly than normal, but as you resist thr ground itself buckles and shifts. Barely managing to leap away in time, it seems that you&#39;ve stumbled across a fully grown Greater Tentacle Beast!&lt;br&gt;&lt;br&gt;

[[Deal with the Greater Tentacle Beast|Layer6 Threat1 Main1]]
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="411" name="Layer6 Cherry" tags="layer6" position="100,5225" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer6 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer6 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer6 Cherry Mix]]</tw-passagedata><tw-passagedata pid="412" name="Layer6 Threats" tags="image layer6" position="225,5225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-threats.png&#39;]]

[[Return to exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="413" name="Layer6 Forage" tags="image layer6" position="350,5225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-foraging.png&#39;]]

If you decide to start foraging for food or water, it means that you will not reduce your stored food rations or water supply while consuming time on tasks in this layer, but you will not obtain more supplies by starting to forage here.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for water in The River Dycx|Layer6 Forage][$forageWater = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for water|Layer6 Forage][$forageWater = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;[[Start foraging for food from Omen Eyes|Layer6 Forage][$forageFood = 1]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;print &quot;[[Stop foraging for food|Layer6 Forage][$forageFood = 0]]&quot;&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
[[Fill your empty flasks with water from the layer|Layer6 Flasks]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the rest of the layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="414" name="Layer6 Relics" tags="image layer6" position="475,5225" size="100,100">&lt;&lt;if $timeL4T1 &lt; 7&gt;&gt;&lt;&lt;set $totalRelics = $ownedRelics.concat($soldRelics)&gt;&gt;[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-relics.png&#39;]]

&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Ring of the Devourer&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Ring of the Devourer]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Pulse Bloom&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Pulse Bloom]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Out of Mind&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Out of Mind]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Still Film&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Still Film]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Forbidden Grimoire&quot;) || ($items[15].count == 0 &amp;&amp; $scuba == 0)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Forbidden Grimoire]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Luminous Phantasmagoria&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Luminous Phantasmagoria]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Relativity Eye&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Relativity Eye]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Return to Sender&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Return to Sender]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Yliaster Materia&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Yliaster Materia]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Aeonglass&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Aeonglass]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Apparatus Diaboli&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Apparatus Diaboli]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Heavy is the Head&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Heavy is the Head]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

[[Continue exploring the sixth layer|Layer6 Hub]]

&lt;&lt;else&gt;&gt;

A great hissing sound, as if a blimp were leaking its helium, fills your ears as a dark form descends on you from above. A monstrous beast floats above your head and unveils its tentacles in preparation of it&#39;s attempt to shovel you into its enormous maw.

[[Deal with the Drifting Swallower|Layer6 Threat1 Main1]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="415" name="Layer6 Curses" tags="image layer6" position="600,5225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-curses.png&#39;]]&lt;&lt;GenderCorrected&gt;&gt;


&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification B&quot;)  || $playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;)  || $StoredCurse.name == &quot;Submissiveness Rectification B&quot; || $StoredCurse.name == &quot;Power Dom&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Submissiveness Rectification B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse73]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination B&quot;) || $StoredCurse.name == &quot;Lactation Rejuvination B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Lactation Rejuvination B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse74]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification B&quot;) || $StoredCurse.name == &quot;Pleasure Respecification B&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Pleasure Respecification B]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse75]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Age Reduction C&quot;) || $StoredCurse.name == &quot;Age Reduction C&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Age Reduction C]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse76]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.takenCurseCount(&quot;Horny&quot;) &gt;= 2&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Horny]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse77]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Drawing Spades&quot;) || $StoredCurse.name == &quot;Drawing Spades&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Drawing Spades]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse78]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Tattoo Tally&quot;) || $StoredCurse.name == &quot;Tattoo Tally&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Tattoo Tally]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse79]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Leaky&quot;) ||  $StoredCurse.name == &quot;Leaky&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Leaky]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse80]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Wandering Hands&quot;) || $StoredCurse.name == &quot;Wandering Hands&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Wandering Hands]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse81]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.takenCurseCount(&quot;Semen Demon&quot;) &gt;= 4&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Semen Demon]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse82]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.takenCurseCount(&quot;Quota&quot;) &gt;= 4&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Quota]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse83]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.takenCurseCount(&quot;In the Limelight&quot;) &gt;= 4&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on In the Limelight]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer6 Curses][$StoredCurse = $curse84]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer6 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="416" name="Layer6 Wonders" tags="image layer6" position="725,5225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-wonders.png&#39;]]

Do you want to approach the Maw of Kimaris to get a copy of a relic from a higher layer?

[[Approach the Maw|Layer6 Maw1]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="417" name="Layer6 Habitation" tags="image layer6" position="850,5225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the sixth layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="418" name="Layer6 Ascend 1" tags="layer6" position="975,5225" size="100,100">Returning to the fragrant desert of the previous layer will take 15 days of trekking, and cost 65 corruption.

[[Continue your ascent|Layer6 Ascend2]]
[[Turn back and continue your business on the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="419" name="Layer6 Exit1" tags="layer6" position="1100,5225" size="100,100">There is no indication of what you might find beyond layer 6. There are a few hints of a paved path that once existed before being crushed to pieces by the tentacles&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;, but none of your companions have even heard a rumor of where it might lead&lt;&lt;/if&gt;&gt;. Do you want to push further into the unknown depths of the Abyss?

Traversing down and past this hell will take 16 days.

[[Turn back and continue your business on the sixth layer|Layer6 Hub]]
[[Continue your descent to the seventh layer|Layer6 Exit2]]</tw-passagedata><tw-passagedata pid="420" name="Layer6 Threat2 Main" tags="layer6" position="1225,5225" size="100,100">&lt;&lt;set $timeL6T2 -= 8&gt;&gt;
[img[setup.ImagePath+&#39;Threats/felldragon.png&#39;]]

How do you want to deal with the awe-inspiring dragon flying above your head?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 1&gt;&gt;
The dragon takes care to avoid Khemia at close range, so he won&#39;t have a chance to use Sunbeam this time, at least not if he wants to make it out alive. &lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off one time, but even he would be moderately burned by fighting it, increasing all travel times by 2 until you used a medkit on him. You will be able to get it&#39;s hoard of 50 dubloons when you kill it though.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Hub][$status.duration = 99, $status.penalty = 2, $khemiaDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Joyous Sunder sword he will be able to defeat a dragon with only minor burns, increasing your next 3 travel times by 2 days each.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $khemiaDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Toral Wave&quot;) &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Empath Coil&quot;) &amp;&amp; $electricDragon == 0&gt;&gt;
While the Fell Dragons are immune to most conventional methods of attack, you can combine the power of the Toral Wave with the Empath Coil to electrocute the dragon. A single touch can stun the dragon, allowing follow-up attacks that can take it down. This method is only likely to work once, but it can effective. Even this method isn&#39;t safe though, leaving you with minor injuries that will increase your next 3 travel times by 2 days each.&lt;br&gt;
	[[Use your Relics to electrocute the dragon|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $electricDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can appease the dragon by offering it 100 dubloons. It would graciously allow you to live and keep the rest of your hoard if you want, though keep in mind another one might come your way if you&#39;re still holding enough to attract them in 8 days.&lt;br&gt;
	[[Offer 100 dubloons to appease the dragon|Layer6 Hub][$dubloons -= 100]]&lt;br&gt;&lt;br&gt;
If you try to run away without fighting to keep your dubloons safe, prepare to be severely burned before you manage to get away. This will increase all travel times by 4 days until you can get it healed and it will take 2 medkits to heal it!&lt;br&gt;
	[[Try to run and accept the consequences|Layer6 Hub][$status.duration = 99, $status.penalty = 4, $dubloons += 50, $dragonBurn = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm. You may only use each combination 1 time before the dragons learn from experience and overcome the weakness, making that strategy unusable a second time.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the dragons|Layer6 Hub][$dragonKill += 1, $dubloons += 50]]</tw-passagedata><tw-passagedata pid="421" name="Layer6 Threat1 Main1" tags="layer6" position="100,5350" size="100,100">&lt;&lt;set $timeL6T1 -= 15&gt;&gt;
[img[setup.ImagePath+&#39;Threats/greatertentaclebeast.png&#39;]]

As the enormous tentacle beast approaches, you must quickly decide on a course of action for defeating it, or fall into its slimy clutches and allow it to use you to sate its lust.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 18&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 19 bullets to take it down due its amorphous form and enormous size. But even despite those limitations, a ranged weapon like a gun is probably the safest way to take one of these down.&lt;br&gt;
	[[Shoot it with your pistol|Layer6 Hub][$items[20].count -= (19 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily ranged combat doesn&#39;t pose as much of a risk as melee against a great beast such as this one.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer6 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
Relying on your own swordplay will allow you to put up a minimum amount of resistance and tire it out a bit, leaving incapacitated for 10 days straight.&lt;br&gt;
	[[Fight it off with a sword|Layer6 Threat1 Main2][$tentacleFucked = 10]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with a sword and use a medkit to cure the status|Layer6 Hub][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)&gt;&gt;
Using the power of Sunbeam to fight it yourself is better than using a sword, but only marginally so. It will leave you tentacle fucked for 9 days after the battle.&lt;br&gt;
	[[Fight it off with Sunbeam|Layer6 Threat1 Main2][$tentacleFucked = 9]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with Sunbeam and use a medkit to cure the status|Layer6 Hub][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he wouldn&#39;t be able to get away safely, becoming immobilized for 2 days if you let him fight for you with a sword.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer6 Threat1 Main2][$tentacleFucked = 2, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with a sword and use a medkit to cure his status|Layer6 Hub][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with Sunbeam, he&#39;ll be more effective, but even then he&#39;d be left incapacitated from the various numbing agents for a full day.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Threat1 Main2][$tentacleFucked = 1, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with Sunbeam and use a medkit to cure his status|Layer6 Hub][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with the Joyous Sunder, he&#39;ll be much more effective, to the point that he&#39;d be able to defeat the beast without sustaining any major injuries himself, an impressive feat even for someone like him.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer6 Hub]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, you will be completely ravaged by the enormous beast. This will be incredibly pleasurable at the time, with powerful numbing agents making sure you don&#39;t feel any pain during the process, and only feel the pleasure. But after it&#39;s over, you&#39;ll be in a sorry state, being left completely incapacitated for a full 12 days unless you use a medkit. This is especially dangerous since it leaves you only a few days left until your next encounter with one of the beasts.&lt;br&gt;
[[Allow it to overpower you|Layer6 Threat1 Main2][$tentacleFucked = 12]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Allow it to overpower you and use a medkit to cure the status|Layer6 Hub][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the titanic tentacle beast approaches you, suddenly you hear a voice talking to you.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $creepydoll&gt;&gt;Oh, this one looks really scary! But don&#39;t worry, I&#39;ll make him go away. You might need to keep your eyes closed a little longer than normal, but just keep holding me tight and everything will be ok, I promise. &lt;&lt;/say&gt;&gt;&lt;br&gt;

An intense, yet somehow comforting, warmth radiates from the Creepy Doll. You sense that it is a deep and powerful energy, but somehow, other descriptions of it elude you.&lt;br&gt;&lt;br&gt;
&lt;&lt;link &quot;Hold the doll very tight and shut your eyes shut for a long time&quot; &quot;Layer6 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to defeat the beast|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="422" name="Layer6 Flasks" tags="layer6" position="225,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;if $items[2].count &gt; 0&gt;&gt;
		&lt;&lt;set $items[3].count += 1&gt;&gt;
		&lt;&lt;set $items[2].count -= 1&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;set $hexflame += 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
		&lt;&lt;set $hexflame += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[img[setup.ImagePath+&#39;Foraging/riverdycx.png&#39;]]

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0&gt;&gt;
In an incredible collaboration with colleagues on the surface, Saeko managed to develop some incredibly innovative water filtration techniques. The water purified from the River Dycx using this technique is absolutely safe to drink, and it even has a pleasant, slightly sweet, cinnamon flavor to it. If this were more easily accessible maybe you could sell this as a unique drink to people on the surface.
&lt;&lt;else&gt;&gt;
There is a very easily accessible source of water on this layer, the River Dycx, which is bright red and leaves a cinnamon-like aftertaste in your mouth. Unfortunately it also leaves a bit of a burning hole in your heart, causing you to gain an additional jinxed flame counter for each day of water you drink here, making it even more unpleasant to leave. Watch out for how much water you drink here or you may find yourself never able to leave.
&lt;&lt;/if&gt;&gt;
[[Return to exploring your food and water options on this layer|Layer6 Forage]]</tw-passagedata><tw-passagedata pid="423" name="Layer6 Maw1" tags="image layer6" position="350,5350" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-wonders.png&#39;]]
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $totalRelics = $ownedRelics.concat($soldRelics)&gt;&gt;
&lt;&lt;set $tempTime = 3&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;nobr&gt;&gt;
You may pick up a new relic for 10 dubloons and 1.5x its corruption cost:&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; 59; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if !$totalRelics.some(e =&gt; e.name === $relics[$i].name) &amp;&amp; $relics[$i].name != &quot;Kin Shifter&quot;&gt;&gt;
		&lt;&lt;print &quot;[[$relics[$i].name|Layer6 Maw1][$temp = $i, $dubloons -= 10, $corruption -= Math.round(Math.max(($relics[$i].corr * 3 / 2) - $corRed, 10)), $ownedRelics.push($relics[$i])]]&quot;&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print Math.round(Math.max(($relics[$i].corr * 3 / 2) - $corRed, 10))&gt;&gt;&lt;&lt;print &quot; corruption points&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;&lt;br&gt;
You may pick up a copy of an old relic for 20 dubloons and 2x its corruption cost:&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; 59; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if $totalRelics.some(e =&gt; e.name === $relics[$i].name) &amp;&amp; $relics[$i].name != &quot;Kin Shifter&quot;&gt;&gt;
		&lt;&lt;print &quot;[[$relics[$i].name|Layer6 Maw1][$temp = $i, $dubloons -= 20, $corruption -= Math.round(Math.max(($relics[$i].corr * 2) - $corRed, 10)), $ownedRelics.push($relics[$i])]]&quot;&gt;&gt;&lt;&lt;print &quot; &quot;&gt;&gt;&lt;&lt;print Math.round(Math.max(($relics[$i].corr * 2) - $corRed, 10))&gt;&gt;&lt;&lt;print &quot; corruption points&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Return to exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="424" name="Pick up the Ring of the Devourer" tags="layer6" position="475,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic61)&gt;&gt;
&lt;&lt;set $corruption -= ($relic61.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic61.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic61.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="425" name="Pick up the Pulse Bloom" tags="layer6" position="600,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic62)&gt;&gt;
&lt;&lt;set $corruption -= ($relic62.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic62.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic62.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="426" name="Pick up the Out of Mind" tags="layer6" position="725,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic63)&gt;&gt;
&lt;&lt;set $corruption -= ($relic63.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic63.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic63.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="427" name="Pick up the Still Film" tags="layer6" position="850,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic64)&gt;&gt;
&lt;&lt;set $corruption -= ($relic64.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic64.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic64.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="428" name="Pick up the Forbidden Grimoire" tags="layer6" position="975,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic65)&gt;&gt;
&lt;&lt;set $corruption -= ($relic65.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic65.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic65.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

You can use this to improve the boons granted by your companions one time, choose the beneficiary wisely.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="429" name="Pick up the Luminous Phantasmagoria" tags="layer6" position="1100,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic66)&gt;&gt;
&lt;&lt;set $corruption -= ($relic66.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic66.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic66.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="430" name="Pick up the Relativity Eye" tags="layer6" position="1225,5350" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic67)&gt;&gt;
&lt;&lt;set $corruption -= ($relic67.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic67.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;


You have successfully taken the $relic67.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="431" name="Pick up the Return to Sender" tags="layer6" position="100,5475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic68)&gt;&gt;
&lt;&lt;set $corruption -= ($relic68.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic68.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic68.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="432" name="Pick up the Yliaster Materia" tags="layer6" position="225,5475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic69)&gt;&gt;
&lt;&lt;set $corruption -= ($relic69.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic69.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic69.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="433" name="Pick up the Aeonglass" tags="layer6" position="350,5475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic70)&gt;&gt;
&lt;&lt;set $corruption -= ($relic70.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic70.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic70.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="434" name="Pick up the Apparatus Diaboli" tags="layer6" position="475,5475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic71)&gt;&gt;
&lt;&lt;set $corruption -= ($relic71.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic71.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic71.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="435" name="Pick up the Heavy is the Head" tags="layer6" position="600,5475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic72)&gt;&gt;
&lt;&lt;set $corruption -= ($relic72.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic72.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer6Time&quot;&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic72.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 6|Layer6 Relics]]
[[Continue exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="436" name="Take on Submissiveness Rectification B" tags="layer6" position="725,5475" size="100,100">&lt;&lt;set $playerCurses.push($curse73)&gt;&gt;&lt;&lt;set $corruption += $curse73.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse73)&gt;&gt;
You have successfully taken on the $curse73.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="437" name="Take on Lactation Rejuvination B" tags="layer6" position="850,5475" size="100,100">&lt;&lt;set $playerCurses.push($curse74)&gt;&gt;&lt;&lt;set $corruption += $curse74.corr&gt;&gt;

You have successfully taken on the $curse74.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="438" name="Take on Pleasure Respecification B" tags="layer6" position="975,5475" size="100,100">&lt;&lt;set $playerCurses.push($curse75)&gt;&gt;&lt;&lt;set $corruption += $curse75.corr&gt;&gt;

You have successfully taken on the $curse75.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="439" name="Take on Age Reduction C" tags="layer6" position="1100,5475" size="100,100">&lt;&lt;set $playerCurses.push($curse76)&gt;&gt;&lt;&lt;set $corruption += $curse76.corr&gt;&gt;&lt;&lt;set $AgeLog.push($curse76)&gt;&gt;

You have successfully taken on the $curse76.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="440" name="Take on Horny" tags="layer6" position="1225,5475" size="100,100">&lt;&lt;set $playerCurses.push($curse77)&gt;&gt;&lt;&lt;set $corruption += $curse77.corr&gt;&gt;

Suddenly, you are struck with a splitting headache, in an almost literal sense as you can almost feel your skull splitting apart. Luckily, you aren&#39;t dying, but a shape is emerging from your skull, and it seems to be a demonic-looking horn. The pain subsides as you feel the horn pushing out of your head, but sensations on the horn still feel tender, as if it were an especially sensitive part of your body.

Naturally, you reach up to touch your new addition and confirm that indeed it is hard, made of some bone-like material, but it is also quite sensitive. You can feel even the most tender touch when you caress the horn and perhaps it might even be pleasurable to touch in a certain way? This might be a part of your body you&#39;ll have to experiment with later, when you have some free time.

You have successfully taken on the $curse77.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="441" name="Take on Drawing Spades" tags="layer6" position="100,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse78)&gt;&gt;&lt;&lt;set $corruption += $curse78.corr&gt;&gt;

You have successfully taken on the $curse78.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="442" name="Take on Tattoo Tally" tags="layer6" position="225,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse79)&gt;&gt;&lt;&lt;set $corruption += $curse79.corr&gt;&gt;

You have successfully taken on the $curse79.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="443" name="Take on Leaky" tags="layer6" position="350,5600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $playerCurses.push($curse80)&gt;&gt;&lt;&lt;set $corruption += $curse80.corr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You have successfully taken on the $curse80.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="444" name="Take on Wandering Hands" tags="layer6" position="475,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse81)&gt;&gt;&lt;&lt;set $corruption += $curse81.corr&gt;&gt;

You have successfully taken on the $curse81.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="445" name="Take on Semen Demon" tags="layer6" position="600,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse82)&gt;&gt;&lt;&lt;set $corruption += $curse82.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse82)&gt;&gt;

You have successfully taken on the $curse82.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="446" name="Take on Quota" tags="layer6" position="725,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse83)&gt;&gt;&lt;&lt;set $corruption += $curse83.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse83)&gt;&gt;

You have successfully taken on the $curse83.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="447" name="Take on In the Limelight" tags="layer6" position="850,5600" size="100,100">&lt;&lt;set $playerCurses.push($curse84)&gt;&gt;&lt;&lt;set $corruption += $curse84.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse84)&gt;&gt;

You have successfully taken on the $curse84.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the sixth layer|Layer6 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 6|Layer6 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L6]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="448" name="Layer6 Curses Random" tags="layer6" position="975,5600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,11) + 72&gt;&gt;
	&lt;&lt;if ($temp1 == 72) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Submissiveness Rectification B&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Power Dom&quot;) &amp;&amp; $StoredCurse.name != &quot;Submissiveness Rectification B&quot; &amp;&amp; $StoredCurse.name != &quot;Power Dom&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 73) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Lactation rejuvination B&quot;) &amp;&amp; $StoredCurse.name != &quot;Lactation rejuvination B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 74) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Pleasure Respecification B&quot;) &amp;&amp; $StoredCurse.name != &quot;Pleasure Respecification B&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 75) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Age Reduction C&quot;) &amp;&amp; $StoredCurse.name != &quot;Age Reduction C&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 76) &amp;&amp; setup.takenCurseCount(&quot;Horny&quot;) &lt; 2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 77) &amp;&amp; !playerCurses.some(e =&gt; e.name === &quot;Drawing Spades&quot;) &amp;&amp; $StoredCurse.name != &quot;Drawing Spades&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 78) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Tattoo Tally&quot;) &amp;&amp; $StoredCurse.name != &quot;Tattoo Tally&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 79) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Leaky&quot;) &amp;&amp; $StoredCurse.name != &quot;Leaky&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 80) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Wandering Hands&quot;) &amp;&amp; $StoredCurse.name != &quot;Wandering Hands&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 81) &amp;&amp; setup.takenCurseCount(&quot;Semen Demon&quot;) &lt; 4&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 82) &amp;&amp; setup.takenCurseCount(&quot;Quota&quot;) &lt; 4&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 83) &amp;&amp; setup.takenCurseCount(&quot;In the Limelight&quot;) &lt; 4&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="449" name="Layer6 Cherry Relic" tags="layer6" position="1100,5600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 60&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 60&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 60&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer6 Hub]]

&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer6 Cherry Relic&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;

		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="450" name="Layer6 Cherry Curse" tags="layer6" position="1225,5600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 72&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 72&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 72&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer6 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Semen Demon&quot; || $curses[$temp2].name == &quot;Semen Demon&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse82)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Quota&quot; || $curses[$temp2].name == &quot;Quota&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse83)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Limelight&quot; || $curses[$temp2].name == &quot;Limelight&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse84)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Age Reduction C&quot; || $curses[$temp2].name == &quot;Age Reduction C&quot;&gt;&gt;
	&lt;&lt;set $AgeLog.push($curse76)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer6 Cherry Mix&quot;&gt;&gt;
		&lt;&lt;set $targetCurse = $curses[$temp1]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp1].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="451" name="Layer6 Cherry Mix" tags="layer6" position="100,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 60&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 72&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floot(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $playerCurses[$playerCurses.length - 1].corr = Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $corruption += $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1), 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer6 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp2].name ==&quot;Semen Demon&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse82)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Quota&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse83)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Limelight&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse84)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Age Reduction C&quot;&gt;&gt;
	&lt;&lt;set $AgeLog.push($curse76)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer6 Cherry Mix&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="452" name="Layer6 Threat1 Main2" tags="layer6" position="225,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = $tentacleFucked&gt;&gt;
&lt;&lt;set $timeL6 += $tempTime&gt;&gt;
&lt;&lt;set $hexflame += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $khemiaFucked == 0&gt;&gt;
After an intense encounter with the greater tentacle beast, you are left in a sorry state, needing to be left stationary for $tentacleFucked days. Slowly you regain your sensations and manage to prepare yourself to get going and continue your travels on the sixth layer.
&lt;&lt;else&gt;&gt;&lt;&lt;set $khemiaFucked = 0&gt;&gt;
Khemia is not in a good state after the battle, even with his experience, he obviously wasn&#39;t ready to deal with a fully grown tentacle beast on his own. He dealt a lot of damage, but he&#39;s still incapacitated. Despite some claims of his that you can keep going, it&#39;s impossible to move on with him in this state, so you need to make camp and stay with him until he&#39;s recovered.
&lt;&lt;/if&gt;&gt;

[[Return to exploring the sixth layer|Layer6 Hub]]</tw-passagedata><tw-passagedata pid="453" name="Layer6 Ascend2" tags="layer6" position="350,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(15 - $timeRed + $status.penalty - $cool, 0))&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;

&lt;&lt;set $timeL6 += 1&gt;&gt;
&lt;&lt;set $hexflame += 1&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += 1&gt;&gt;
&lt;&lt;set $time += 1&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $timeL6T2 &gt; 7 &amp;&amp; $dragonKill &lt; 5&gt;&gt;

&lt;br&gt;A thunderous roar disturbs you as your tread across the slimy, tentacled-ground of the sixth layer. At first you don&#39;t see the source of the sound, but after a moment you look up and see an enormous Fell Dragon approaching with great speed. It lets out a stream of fire as a warning before roaring again and landing in front of you with it&#39;s head held high and a subtle stream of liquid fire dribbling from the corner of its mouth. It is demanding tribute for you carrying your wealth in these lands, and now is your chance to pay it.&lt;br&gt;&lt;br&gt;

[[Deal with the Fell Dragon|Layer6 Threat2 Ascend]]&lt;br&gt;&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL6T1 &gt; 14&gt;&gt;
		&lt;br&gt;Your walk across the sixth layer continues as normal, and you bat away some harassing tentacles, but something was different about these?&lt;br&gt;&lt;br&gt;

They push against you more persistantly than normal, but as you resist thr ground itself buckles and shifts. Barely managing to leap away in time, it seems that you&#39;ve stumbled across a fully grown Greater Tentacle Beast!&lt;br&gt;&lt;br&gt;

[[Deal with the Greater Tentacle Beast|Layer6 Threat1 Ascend1]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption -= (65 - $corRed)&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;set $timeL5T1 = 0&gt;&gt;
&lt;&lt;set $timeL5T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You continue through the flaming fields of tentacles for much longer than you&#39;d like, until you eventually reach the slightly less hellish heat of the fifth layer. The scent of burning meat is replaced with fragrant spices and the tentacles are replaced with sand, you&#39;ve made it out of hell.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Return to the fifth layer|Layer5 Hub]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="454" name="Layer6 Threat2 Ascend" tags="layer6" position="475,5725" size="100,100">&lt;&lt;set $timeL6T2 -= 8&gt;&gt;
[img[setup.ImagePath+&#39;Threats/felldragon.png&#39;]]

How do you want to deal with the awe-inspiring dragon flying above your head?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 1&gt;&gt;
The dragon takes care to avoid Khemia at close range, so he won&#39;t have a chance to use Sunbeam this time, at least not if he wants to make it out alive. &lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off one time, but even he would be moderately burned by fighting it, increasing all travel times by 2 until you used a medkit on him. You will be able to get it&#39;s hoard of 50 dubloons when you kill it though.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Ascend2][$status.duration = 99, $status.penalty = 2, $khemiaDragon = 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Joyous Sunder sword he will be able to defeat a dragon with only minor burns, increasing your next 3 travel times by 2 days each.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $khemiaDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Toral Wave&quot;) &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Empath Coil&quot;) &amp;&amp; $electricDragon == 0&gt;&gt;
While the Fell Dragons are immune to most conventional methods of attack, you can combine the power of the Toral Wave with the Empath Coil to electrocute the dragon. A single touch can stun the dragon, allowing follow-up attacks that can take it down. This method is only likely to work once, but it can effective. Even this method isn&#39;t safe though, leaving you with minor injuries that will increase your next 3 travel times by 2 days each.&lt;br&gt;
	[[Use your Relics to electrocute the dragon|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $electricDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can appease the dragon by offering it 100 dubloons. It would graciously allow you to live and keep the rest of your hoard if you want, though keep in mind another one might come your way if you&#39;re still holding enough to attract them in 8 days.&lt;br&gt;
	[[Offer 100 dubloons to appease the dragon|Layer6 Ascend2][$dubloons -= 100]]&lt;br&gt;&lt;br&gt;
If you try to run away without fighting to keep your dubloons safe, prepare to be severely burned before you manage to get away. This will increase all travel times by 4 days until you can get it healed and it will take 2 medkits to heal it!&lt;br&gt;
	[[Try to run and accept the consequences|Layer6 Ascend2][$status.duration = 99, $status.penalty = 4, $dubloons += 50, $dragonBurn = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm. You may only use each combination 1 time before the dragons learn from experience and overcome the weakness, making that strategy unusable a second time.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the dragons|Layer6 Ascend2][$dragonKill += 1, $dubloons += 50]]</tw-passagedata><tw-passagedata pid="455" name="Layer6 Threat1 Ascend1" tags="layer6" position="600,5725" size="100,100">&lt;&lt;set $timeL6T1 -= 15&gt;&gt;
[img[setup.ImagePath+&#39;Threats/greatertentaclebeast.png&#39;]]

As the enormous tentacle beast approaches, you must quickly decide on a course of action for defeating it, or fall into its slimy clutches and allow it to use you to sate its lust.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 18&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 19 bullets to take it down due its amorphous form and enormous size. But even despite those limitations, a ranged weapon like a gun is probably the safest way to take one of these down.&lt;br&gt;
	[[Shoot it with your pistol|Layer6 Ascend2][$items[20].count -= (19 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily ranged combat doesn&#39;t pose as much of a risk as melee against a great beast such as this one.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer6 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
Relying on your own swordplay will allow you to put up a minimum amount of resistance and tire it out a bit, leaving incapacitated for 10 days straight.&lt;br&gt;
	[[Fight it off with a sword|Layer6 Threat1 Ascend2][$tentacleFucked = 10]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with a sword and use a medkit to cure the status|Layer6 Ascend2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)&gt;&gt;
Using the power of Sunbeam to fight it yourself is better than using a sword, but only marginally so. It will leave you tentacle fucked for 9 days after the battle.&lt;br&gt;
	[[Fight it off with Sunbeam|Layer6 Threat1 Ascend2][$tentacleFucked = 9]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with Sunbeam and use a medkit to cure the status|Layer6 Ascend2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he wouldn&#39;t be able to get away safely, becoming immobilized for 2 days if you let him fight for you with a sword.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer6 Threat1 Ascend2][$tentacleFucked = 2, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with a sword and use a medkit to cure his status|Layer6 Ascend2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with Sunbeam, he&#39;ll be more effective, but even then he&#39;d be left incapacitated from the various numbing agents for a full day.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Threat1 Ascend2][$tentacleFucked = 1, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with Sunbeam and use a medkit to cure his status|Layer6 Ascend2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with the Joyous Sunder, he&#39;ll be much more effective, to the point that he&#39;d be able to defeat the beast without sustaining any major injuries himself, an impressive feat even for someone like him.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer6 Ascend2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, you will be completely ravaged by the enormous beast. This will be incredibly pleasurable at the time, with powerful numbing agents making sure you don&#39;t feel any pain during the process, and only feel the pleasure. But after it&#39;s over, you&#39;ll be in a sorry state, being left completely incapacitated for a full 12 days unless you use a medkit. This is especially dangerous since it leaves you only a few days left until your next encounter with one of the beasts.&lt;br&gt;
[[Allow it to overpower you|Layer6 Threat1 Ascend2][$tentacleFucked = 12]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Allow it to overpower you and use a medkit to cure the status|Layer6 Ascend2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the titanic tentacle beast approaches you, suddenly you hear a voice talking to you.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $creepydoll&gt;&gt;Oh, this one looks really scary! But don&#39;t worry, I&#39;ll make him go away. You might need to keep your eyes closed a little longer than normal, but just keep holding me tight and everything will be ok, I promise. &lt;&lt;/say&gt;&gt;&lt;br&gt;

An intense, yet somehow comforting, warmth radiates from the Creepy Doll. You sense that it is a deep and powerful energy, but somehow, other descriptions of it elude you.&lt;br&gt;&lt;br&gt;
&lt;&lt;link &quot;Hold the doll very tight and shut your eyes shut for a long time&quot; &quot;Layer6 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to defeat the beast|Layer6 Ascend2]]</tw-passagedata><tw-passagedata pid="456" name="Layer6 Threat1 Ascend2" tags="layer6" position="725,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = $tentacleFucked&gt;&gt;
&lt;&lt;set $timeL6 += $tempTime&gt;&gt;
&lt;&lt;set $hexflame += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $khemiaFucked == 0&gt;&gt;
After an intense encounter with the greater tentacle beast, you are left in a sorry state, needing to be left stationary for $tentacleFucked days. Slowly you regain your sensations and manage to prepare yourself to get going and continue your travels on the sixth layer.
&lt;&lt;else&gt;&gt;&lt;&lt;set $khemiaFucked = 0&gt;&gt;
Khemia is not in a good state after the battle, even with his experience, he obviously wasn&#39;t ready to deal with a fully grown tentacle beast on his own. He dealt a lot of damage, but he&#39;s still incapacitated. Despite some claims of his that you can keep going, it&#39;s impossible to move on with him in this state, so you need to make camp and stay with him until he&#39;s recovered.
&lt;&lt;/if&gt;&gt;

[[Return to exploring the sixth layer|Layer6 Ascend2]]</tw-passagedata><tw-passagedata pid="457" name="Layer6 Exit2" tags="layer6" position="850,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(16 - $timeRed + $status.penalty - $cool, 0))&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;

&lt;&lt;set $timeL6 += 1&gt;&gt;
&lt;&lt;set $hexflame += 1&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += 1&gt;&gt;
&lt;&lt;set $time += 1&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $timeL6T2 &gt; 7 &amp;&amp; $dragonKill &lt; 5&gt;&gt;

&lt;br&gt;A thunderous roar disturbs you as your tread across the slimy, tentacled-ground of the sixth layer. At first you don&#39;t see the source of the sound, but after a moment you look up and see an enormous Fell Dragon approaching with great speed. It lets out a stream of fire as a warning before roaring again and landing in front of you with it&#39;s head held high and a subtle stream of liquid fire dribbling from the corner of its mouth. It is demanding tribute for you carrying your wealth in these lands, and now is your chance to pay it.&lt;br&gt;&lt;br&gt;

[[Deal with the Fell Dragon|Layer6 Threat2 Descend]]&lt;br&gt;&lt;br&gt;

		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL6T1 &gt; 14&gt;&gt;
		&lt;br&gt;Your walk across the sixth layer continues as normal, and you bat away some harassing tentacles, but something was different about these?&lt;br&gt;&lt;br&gt;

They push against you more persistantly than normal, but as you resist thr ground itself buckles and shifts. Barely managing to leap away in time, it seems that you&#39;ve stumbled across a fully grown Greater Tentacle Beast!&lt;br&gt;&lt;br&gt;

[[Deal with the Greater Tentacle Beast|Layer6 Threat1 Descend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $forageWater = 0&gt;&gt;
&lt;&lt;set $forageFood = 0&gt;&gt;
&lt;&lt;set $timeL7T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You continue through the playfully ticklish yet hellishly searing tentacles for a long hike downward. You find some small hints of paved paths that have long since degraded, but no other indication of what is next for you, until suddenly you are faced with a metal barricade, signaling the end of the sixth layer and the start of the seventh.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Descend down to the seventh layer|Layer7 1]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="458" name="Layer6 Threat2 Descend" tags="layer6" position="975,5725" size="100,100">&lt;&lt;set $timeL6T2 -= 8&gt;&gt;
[img[setup.ImagePath+&#39;Threats/felldragon.png&#39;]]

How do you want to deal with the awe-inspiring dragon flying above your head?


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 1&gt;&gt;
The dragon takes care to avoid Khemia at close range, so he won&#39;t have a chance to use Sunbeam this time, at least not if he wants to make it out alive. &lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;) &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Sunbeam relic he will be able to fight it off one time, but even he would be moderately burned by fighting it, increasing all travel times by 2 until you used a medkit on him. You will be able to get it&#39;s hoard of 50 dubloons when you kill it though.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Exit2][$status.duration = 99, $status.penalty = 2, $khemiaDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;) &amp;&amp; $khemiaDragon == 0&gt;&gt;
	Khemia has enough expertise with a blade that if you give him the Joyous Sunder sword he will be able to defeat a dragon with only minor burns, increasing your next 3 travel times by 2 days each.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $khemiaDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Toral Wave&quot;) &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Empath Coil&quot;) &amp;&amp; $electricDragon == 0&gt;&gt;
While the Fell Dragons are immune to most conventional methods of attack, you can combine the power of the Toral Wave with the Empath Coil to electrocute the dragon. A single touch can stun the dragon, allowing follow-up attacks that can take it down. This method is only likely to work once, but it can effective. Even this method isn&#39;t safe though, leaving you with minor injuries that will increase your next 3 travel times by 2 days each.&lt;br&gt;
	[[Use your Relics to electrocute the dragon|Layer6 Hub][$status.duration = 3, $status.penalty = 2, $electricDragon == 1, $dubloons += 50, $dragonKill += 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
You can appease the dragon by offering it 100 dubloons. It would graciously allow you to live and keep the rest of your hoard if you want, though keep in mind another one might come your way if you&#39;re still holding enough to attract them in 8 days.&lt;br&gt;
	[[Offer 100 dubloons to appease the dragon|Layer6 Exit2][$dubloons -= 100]]&lt;br&gt;&lt;br&gt;
If you try to run away without fighting to keep your dubloons safe, prepare to be severely burned before you manage to get away. This will increase all travel times by 4 days until you can get it healed and it will take 2 medkits to heal it!&lt;br&gt;
	[[Try to run and accept the consequences|Layer6 Exit2][$status.duration = 99, $status.penalty = 4, $dubloons += 50, $dragonBurn = 1]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/nobr&gt;&gt;

Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a worm. You may only use each combination 1 time before the dragons learn from experience and overcome the weakness, making that strategy unusable a second time.
[[Use a combination of relics not mentioned above you believe would be able to overpower one of the dragons|Layer6 Exit2][$dragonKill += 1, $dubloons += 50]]</tw-passagedata><tw-passagedata pid="459" name="Layer6 Threat1 Descend" tags="layer6" position="1100,5725" size="100,100">&lt;&lt;set $timeL6T1 -= 15&gt;&gt;
[img[setup.ImagePath+&#39;Threats/greatertentaclebeast.png&#39;]]

As the enormous tentacle beast approaches, you must quickly decide on a course of action for defeating it, or fall into its slimy clutches and allow it to use you to sate its lust.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $items[13].count &gt; 0 &amp;&amp; $items[20].count &gt; 18&gt;&gt;
	You can take it down effectively with a gun, but you&#39;ll need at least 19 bullets to take it down due its amorphous form and enormous size. But even despite those limitations, a ranged weapon like a gun is probably the safest way to take one of these down.&lt;br&gt;
	[[Shoot it with your pistol|Layer6 Exit2][$items[20].count -= (19 - $bullRed)]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $slingshot == 1&gt;&gt;
Your Brave Vector slingshot can be used like a gun, but it will take many shots to bring down the amorphous creature. Luckily ranged combat doesn&#39;t pose as much of a risk as melee against a great beast such as this one.&lt;br&gt;
[[Defeat it with the Brave Vector|Layer6 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0&gt;&gt;
Relying on your own swordplay will allow you to put up a minimum amount of resistance and tire it out a bit, leaving incapacitated for 10 days straight.&lt;br&gt;
	[[Fight it off with a sword|Layer6 Threat1 Descend2][$tentacleFucked = 10]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with a sword and use a medkit to cure the status|Layer6 Exit2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Sunbeam&quot;)&gt;&gt;
Using the power of Sunbeam to fight it yourself is better than using a sword, but only marginally so. It will leave you tentacle fucked for 9 days after the battle.&lt;br&gt;
	[[Fight it off with Sunbeam|Layer6 Threat1 Descend2][$tentacleFucked = 9]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Fight it off with Sunbeam and use a medkit to cure the status|Layer6 Exit2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	Khemia has enough expertise with a blade to be able to fight it off, but even he wouldn&#39;t be able to get away safely, becoming immobilized for 2 days if you let him fight for you with a sword.&lt;br&gt;
	[[Have Khemia fight it off with a sword|Layer6 Threat1 Descend2][$tentacleFucked = 2, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with a sword and use a medkit to cure his status|Layer6 Exit2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[14].count &gt; 0 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with Sunbeam, he&#39;ll be more effective, but even then he&#39;d be left incapacitated from the various numbing agents for a full day.&lt;br&gt;
	[[Have Khemia fight it off with Sunbeam|Layer6 Threat1 Descend2][$tentacleFucked = 1, $khemiaFucked = 1]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Have Khemia fight it off with Sunbeam and use a medkit to cure his status|Layer6 Exit2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $joyousSword == 1 &amp;&amp; $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	If you equip Khemia with the Joyous Sunder, he&#39;ll be much more effective, to the point that he&#39;d be able to defeat the beast without sustaining any major injuries himself, an impressive feat even for someone like him.&lt;br&gt;
	[[Have Khemia fight it off with Joyous Sunder|Layer6 Exit2]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
If you allow it to overpower you, you will be completely ravaged by the enormous beast. This will be incredibly pleasurable at the time, with powerful numbing agents making sure you don&#39;t feel any pain during the process, and only feel the pleasure. But after it&#39;s over, you&#39;ll be in a sorry state, being left completely incapacitated for a full 12 days unless you use a medkit. This is especially dangerous since it leaves you only a few days left until your next encounter with one of the beasts.&lt;br&gt;
[[Allow it to overpower you|Layer6 Threat1 Descend2][$tentacleFucked = 12]]&lt;br&gt;
	&lt;&lt;if $items[4].count &gt; 4&gt;&gt;[[Allow it to overpower you and use a medkit to cure the status|Layer6 Exit2][$items[4].count -= 1]]&lt;br&gt;&lt;&lt;/if&gt;&gt;&lt;br&gt;

&lt;&lt;if $hiredCompanions.length &lt; 1 &amp;&amp; $ownedRelics.some(e =&gt; e.name === &quot;Creepy Doll&quot;) &amp;&amp; $app.appAge&lt;18&gt;&gt;
&lt;br&gt;&lt;br&gt;As the titanic tentacle beast approaches you, suddenly you hear a voice talking to you.&lt;br&gt;&lt;br&gt;
&lt;&lt;say $creepydoll&gt;&gt;Oh, this one looks really scary! But don&#39;t worry, I&#39;ll make him go away. You might need to keep your eyes closed a little longer than normal, but just keep holding me tight and everything will be ok, I promise. &lt;&lt;/say&gt;&gt;&lt;br&gt;

An intense, yet somehow comforting, warmth radiates from the Creepy Doll. You sense that it is a deep and powerful energy, but somehow, other descriptions of it elude you.&lt;br&gt;&lt;br&gt;
&lt;&lt;link &quot;Hold the doll very tight and shut your eyes shut for a long time&quot; &quot;Layer6 Hub&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
&lt;&lt;/link&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
Use the following option only if you have specifically considered your inventory and made a plan of how to use what you have to take down a beast.
[[Use a combination of relics not mentioned above you believe would be able to defeat the beast|Layer6 Exit2]]</tw-passagedata><tw-passagedata pid="460" name="Layer6 Threat1 Descend2" tags="layer6" position="1225,5725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = $tentacleFucked&gt;&gt;
&lt;&lt;set $timeL6 += $tempTime&gt;&gt;
&lt;&lt;set $hexflame += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $khemiaFucked == 0&gt;&gt;
After an intense encounter with the greater tentacle beast, you are left in a sorry state, needing to be left stationary for $tentacleFucked days. Slowly you regain your sensations and manage to prepare yourself to get going and continue your travels on the sixth layer.
&lt;&lt;else&gt;&gt;&lt;&lt;set $khemiaFucked = 0&gt;&gt;
Khemia is not in a good state after the battle, even with his experience, he obviously wasn&#39;t ready to deal with a fully grown tentacle beast on his own. He dealt a lot of damage, but he&#39;s still incapacitated. Despite some claims of his that you can keep going, it&#39;s impossible to move on with him in this state, so you need to make camp and stay with him until he&#39;s recovered.
&lt;&lt;/if&gt;&gt;

[[Continue your descent to the seventh layer|Layer6 Exit2]]</tw-passagedata><tw-passagedata pid="461" name="Escape Balloon L6" tags="layer6" position="100,5850" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 6&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer6&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer6&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
You wait as your balloon rapidly ascends and you can watch the infernal fields of tentacles gently ungulating below and around you. A far cry from having to tread through them, you can take a moment to breathe in the subtle smell of sulfur wafting up to you, even as you float through the layer.

[[Ascend to next layer|Escape Balloon L5][$corruption -= (65 - $corRed)]]
[[Hover on this layer to take in a curse|Layer6 Curses]]
[[Get off the balloon on this layer|Layer6 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="462" name="Layer6 Preview" tags="image layer6" position="225,5850" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l6intro.png&#39;]]

@@.layerTitle;LAYER 6 - CINDERS OF DIS@@

You see yourself wading through a slimey field of slithering tentacles, with a deep heat and the smell of sulfur washing over you as you view the hell you are observing. Suddenly the image shifts and you see the splendor of the relics that are available on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 7-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="463" name="Layer6Time" tags="" position="350,5850" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = (Math.max((1+$SizeHandicap)*($tempTime  - $timeRed + $status.penalty -$cool), 0))&gt;&gt;
&lt;&lt;set $timeL6 += $tempTime&gt;&gt;
&lt;&lt;set $hexflame += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt; 199&gt;&gt;
	&lt;&lt;set $timeL6T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL6T1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL6 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1&gt;&gt;
			&lt;&lt;set $items[2].count += 1&gt;&gt;
			&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL6 += 1&gt;&gt;
		&lt;&lt;if !($hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;) &amp;&amp; $items[17].count &gt; 0)&gt;&gt;
			&lt;&lt;set $hexflame += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="464" name="Layer7 1" tags="layer7" position="475,5850" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer7&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $currentLayer = 7&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l7intro.png&#39;]]
!Layer 7 - Sealed City of Agartha
@@There is no gradual, graceful change in terrain dividing the sixth and seventh layers. The tentacles come to a sudden stop at a long series of metallic barricades, providin passage for travelers but apparently no surface for the tentacles to grow on. Grateful to leave behind the burning tendrils, you step through and are greeted with a sea of light, an enormous, city, buildings and roads expanding into the distance, yet also stacked haphazardly on top of each other in layers of chrome and neon, paved with metal. A microcosm of the Abyss itself, perhaps?

Yet for a city so large, it remains eerily quiet, the only sound being the quiet hum of robots patrolling the streets. There&#39;s no sign of any humans, or indeed any organic life at all. The city sleeps as robots silently perform their tasks, and it would be best to tread lightly, lest you wake it up.

This layer seems to be quite a bit smaller than the last few, and its paved roads are much easier to traverse. Ascending back into hell - that is, layer 6 - will take 7 days and cost 80 corruption.

[[Walk through the seventh layer of the Abyss|Layer7 Hub]]&lt;&lt;nobr&gt;&gt;&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;if $visitL7 == 0&gt;&gt;
	&lt;&lt;print &quot;[[Use Cherry&#39;s chaotic luck|Layer7 Cherry]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="465" name="Layer7 Preview" tags="image layer7" position="600,5850" size="100,100">As you bring the charm up to your eye and gaze deep into the red crystal, your vision fades and a new image comes clearly into view:

[img[setup.ImagePath+&#39;Layer Intros/l7intro.png&#39;]]

@@.layerTitle;LAYER 7 - SEALED CITY OF AGARTHA@@

You see yourself standing in the midst of an enormous mechanical city, surrounded by artificial lights, towering buildings, and robotic drones moving busily throughout the layer. Suddenly the image shifts and you see the splendor of the relics that are available on this layer.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-relics.png&#39;]]

As an image of the wonders you might find on this layer starts to come into focus, an intense feeling of humility washes through you.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-wonders.png&#39;]]

The mystical possibilities of the wonders fade from your view and you suddenly feel nauseous, as if a huge amount of miasma was suddenly sucked into your chest. You visualize the corruptions and curses that may afflict you in the layer below.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-curses.png&#39;]]

Finally the nauseous feeling passes but is replaced by a brief sense of terror as you get a glimpse of the threaths that await you on the layer

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-threats.png&#39;]]

Finally, the vision fades, leaving you standing once again where you were before, with only a brief sense of motion sickness as you orient yourself back to your physical body. As you look at the Gleam Dazer once again, you notice the relic is cracked and broken.
&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $ownedRelics.length==1&gt;&gt;
	&lt;&lt;set $temp=0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length &amp;&amp; !$endloop; $i++&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Gleam Dazer&quot; &gt;&gt;
			&lt;&lt;set $temp=$i&gt;&gt;
			&lt;&lt;set $endloop=false&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Return|$previewReturn][$soldRelics.push($ownedRelics[$temp]), $ownedRelics.deleteAt($temp), $endloop=false]]</tw-passagedata><tw-passagedata pid="466" name="Layer7 Hub" tags="layer7" position="725,5850" size="100,100">&lt;&lt;set $currentLayer = 7&gt;&gt;&lt;&lt;checkTime&gt;&gt;&lt;&lt;CarryAdjust&gt;&gt;&lt;&lt;if $dubloons &lt; 0&gt;&gt;[img[setup.ImagePath+&#39;Threats/taxdrone.png&#39;]]

A quiet humming sound descends upon you as you see the Taxdrone floating towards you from over a nearby building. You reach into your pack to get your typical dubloon payment, but then you realize something is wrong, you can&#39;t find any dubloons! Perhaps you didn&#39;t keep track of them properly? But it&#39;s too late to get any now, the taxes are already due.

The Taxdrone patiently requests that you submit your taxes as it displays a slot for you to deposit the dubloons into, but soon it realizes you will not be paying and the typically soft blue lights on the drone change to glaring red and an alarm sounds.

Within a moment you are restrained by nets made of light and you feel a prick on your neck. You notice the drone has stabbed you with a syringe, but at this point it&#39;s too late to resist and your consciousness begins to fade, leaving you to succumb to your fate.

You are now forced to become a permanent resident of Layer 7.

[[Awaken to your new life|Layer7 Tax End]]
&lt;&lt;elseif $timeL7T2 &lt; 6&gt;&gt;&lt;&lt;set $visitL7 = 1&gt;&gt;&lt;&lt;set $layerExit = 0&gt;&gt;You walk through an enormous city coated in chrome and neon. On each side of the streets you can see enormous buildings with no open doors for you to enter. There are thousands of skyscrapers, yet not one person or animal in the entire city. Mechanical beings small and large scurry and float past, seemingly oblivious to your presence, as you are able to move through the empty metropolis completely unhindered.

&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp &gt;= 19&gt;&gt;
&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;


&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $forageWater == 0&gt;&gt;
	&lt;&lt;print &quot;You are not able to forage for daily water on this layer, due to the nature of the water source.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;print &quot;You are not able to forage for daily food on this layer, due to the nature of the food source.&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;if !isPlaying(&quot;layer7&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer7&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;br&gt;
What do you want to do while you&#39;re here?&lt;br&gt;&lt;br&gt;
[[Use Items and Relics]]&lt;br&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[[Learn about the threats on this layer|Layer7 Threats]]
[[Check for food and water you can forage for|Layer7 Forage]]
[[Search for relics|Layer7 Relics]]
[[Take on curses to purge your corruption|Layer7 Curses]]
[[Look for any wonders you can take advantage|Layer7 Wonders]]
[[View the Layer 7 habitation option|Layer7 Habitation]]

[[Look up towards the surface|Layer7 Ascend 1]]
[[Look down at the next layer|Layer7 Exit1]]
&lt;&lt;else&gt;&gt;
A an enormous rumbling catches your attention as you walk through the seventh layer. A brief glance around reveals the source, an enormous, building-sized machine that is now rapidly approaching you. You consider running, but the Security Robot is moving at an incredible speed, leaving you no chance to get away.

&quot;ACCEPT REHABILITATION&quot; a synthetic voice calls out, with the huge robot nearly upon you.

And suddenly, it&#39;s here, reaching down to grab you with shining metallic arms and pull you into its shell.

[[Get rehabilitated|Layer7 Threat2 Main]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="467" name="Layer7 Cherry" tags="layer7" position="850,5850" size="100,100">[img[setup.ImagePath+&#39;Surface/cherry.png&#39;]]

How would you like to use Cherry&#39;s chaotic luck ability?

[[Get 2 random relics for half cost|Layer7 Cherry Relic]]
[[Get 2 random curses for +50% corruption|Layer7 Cherry Curse]]
[[Get 1 relic and 1 curse|Layer7 Cherry Mix]]</tw-passagedata><tw-passagedata pid="468" name="Layer7 Threats" tags="image layer7" position="975,5850" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-threats.png&#39;]]

[[Return to exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="469" name="Layer7 Forage" tags="image layer7" position="1100,5850" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-foraging.png&#39;]]

Which job would you like to work on today? Hopefully you can make a decent living in the hard labor available in this empty, automated city.

It is reccomended that you get creative with your relics and think of more efficient ways to do these tasks than the basic methods provided. If you have a suitable Relic for the task, you might find a specific option to use it, or you can estimate how effective a certain combination of Relics would be to do the job.

[[Work on Heavy Lifting]]
[[Work on Land Excavation]]
[[Work on City Painting]]
[[Work on Energy Generator]]
[[Work on Robo-prostitution]]

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="470" name="Layer7 Relics" tags="image layer7" position="1225,5850" size="100,100">&lt;&lt;if $dubloons &lt; 0&gt;&gt;

[img[setup.ImagePath+&#39;Threats/taxdrone.png&#39;]]

A quiet humming sound descends upon you as you see the Taxdrone floating towards you from over a nearby building. You reach into your pack to get your typical dubloon payment, but then you realize something is wrong, you can&#39;t find any dubloons! Perhaps you didn&#39;t keep track of them properly? But it&#39;s too late to get any now, the taxes are already due.

The Taxdrone patiently requests that you submit your taxes as it displays a slot for you to deposit the dubloons into, but soon it realizes you will not be paying and the typically soft blue lights on the drone change to glaring red and an alarm sounds.

Within a moment you are restrained by nets made of light and you feel a prick on your neck. You notice the drone has stabbed you with a syringe, but at this point it&#39;s too late to resist and your consciousness begins to fade, leaving you to succumb to your fate.

You are now forced to become a permanent resident of Layer 7.

[[Awaken to your new life|Layer7 Tax End]]

&lt;&lt;elseif $timeL7T2 &lt; 6&gt;&gt;\
&lt;&lt;set $totalRelics = $ownedRelics.concat($soldRelics)&gt;&gt;\
[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-relics.png&#39;]]

&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Daedalus Mechanism&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Daedalus Mechanism]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Blind Divine&quot;) || ($items[20].count &lt; 4 &amp;&amp; $slingshot == 0)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Blind Divine][$items[20].count -= 4 - (4 * $slingshot)]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Lambent Specter&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Lambent Specter]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Phoenix Obol&quot;) || !setup.havePotentialLightSource()&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Phoenix Obol]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Granted Granite&quot;) || setup.calcCarriedWeight() + ($hiredCompanions.length * 60) &lt; 200&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Granted Granite]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Joyous Sunder&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Joyous Sunder]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Azure Aozora&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Azure Aozora]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Glare Vantage&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Glare Vantage]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Final Stage&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Final Stage]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Solace Lace&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Solace Lace]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Red Thread Flourish&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Red Thread Flourish]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
&lt;&lt;nobr&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Triage Rain&quot;)&gt;&gt;
	&lt;&lt;else&gt;&gt;&lt;&lt;print &quot;[[Pick up the Triage Rain]]&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;

[[Continue exploring the seventh layer|Layer7 Hub]]

&lt;&lt;else&gt;&gt;

A an enormous rumbling catches your attention as you walk through the seventh layer. A brief glance around reveals the source, an enormous, building-sized machine that is now rapidly approaching you. You consider running, but the Security Robot is moving at an incredible speed, leaving you no chance to get away.

&quot;ACCEPT REHABILITATION&quot; a synthetic voice calls out, with the huge robot nearly upon you.

And suddenly, it&#39;s here, reaching down to grab you with shining metallic arms and pull you into its shell.

[[Get rehabilitated|Layer7 Threat2 Main]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="471" name="Layer7 Curses" tags="image layer7" position="100,5975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-curses.png&#39;]]&lt;&lt;GenderCorrected&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;set _table =  &quot;&lt;table&gt;&quot; &gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement E&quot;)  || $StoredCurse.name == &quot;Libido Reinforcement E&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Libido Reinforcement E]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse85]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Gender Reversal E&quot;) || $StoredCurse.name == &quot;Gender Reversal E&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Gender Reversal E]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse86]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Asset Robustness E&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) || $StoredCurse.name == &quot;Asset Robustness E&quot; || $StoredCurse.name == &quot;Shrunken Assets&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Asset Robustness E]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse87]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Urine Reamplification A&quot;) || $StoredCurse.name == &quot;Urine Reamplification A&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Urine Reamplification A]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse88]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Barter System&quot;) || $StoredCurse.name == &quot;Barter System&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Barter System]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse89]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Shared Space&quot;) || $StoredCurse.name == &quot;Shared Space&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Shared Space]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse90]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;) || $StoredCurse.name == &quot;Weakling&quot;&gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Weakling]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse91]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if setup.takenCurseCount(&quot;Random Orgasms&quot;) &gt;= 5&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Random Orgasms]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse92]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Beastly&quot;) || $StoredCurse.name == &quot;Beastly&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Beastly]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse93]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Creature of the Night&quot;) || $StoredCurse.name == &quot;Creature of the Night&quot; &gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Creature of the Night]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse94]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Minish-ish&quot;) || $StoredCurse.name == &quot;Minish-ish&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Minish-ish]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse95]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;) || $StoredCurse.name == &quot;Colossal-able&quot; &gt;&gt;
&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set _table += &quot;&lt;tr&gt;&lt;td&gt;[[Take on Colossal-able]]&lt;/td&gt;&quot;&gt;&gt;
	&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Managed Misfortune&quot;)&gt;&gt;
		&lt;&lt;if $ManagedMisfortuneActive&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;You can not store a new curse while you are still affected by the curse in Managed Misfortune.&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set _table += &quot;&lt;td&gt;or [[Store this curse in Managed Misfortune|Layer7 Curses][$StoredCurse = $curse96]]&lt;/td&gt;&lt;/tr&gt;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _table += &quot;&lt;/tr&gt;&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set _table +=  &quot;&lt;/table&gt;&quot; &gt;&gt;
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;print _table&gt;&gt;

[[Allow the Abyss to bestow a random curse upon you|Layer7 Curses Random]]

&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="472" name="Layer7 Wonders" tags="image layer7" position="225,5975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-wonders2.png&#39;]]

Do you want to visit the Clockwork Forge to swap Relic abilities?
[[Approach the Forge|Layer7 Forge1]]

Do you want to check out the Vend-o-matic 6900 to purchase new items?
[[Approach the Vend-o-matic|Layer7 Vend]]

Do you want to visit the Recycling Centers to recycle some of your Relics?
[[Approach the Recycling Centers|Layer7 Recycle]]

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="473" name="Layer7 Habitation" tags="image layer7" position="350,5975" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0&gt;&gt;
	[[Choose to stay on the seventh layer|Habitation Ending]]
	&lt;&lt;else&gt;&gt;
	You must have a corruption value of 0 or greater to choose a habitation option.
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="474" name="Layer7 Ascend 1" tags="layer7" position="475,5975" size="100,100">This layer seems to be a bit smaller than the last few, and its paved roads are much easier to traverse. Ascending back into hell - that is, layer 6 - will take 7 days of walking, and cost 80 corruption.

[[Continue your ascent|Layer7 Ascend2]]
[[Turn back and continue your business on the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="475" name="Layer7 Exit1" tags="layer7" position="600,5975" size="100,100">This is the last area where balloons of any kind can function.

If you head down, you will need to come back up on foot again before the shop&#39;s messenger, escape, or commerce balloons can ascend through the layers again. Anything could be down there, so it&#39;s probably best to stock up on all kinds of supplies (assume it may take weeks or months to get back) and take care of any unfinished business before proceeding further - you have a feeling that what lies beyond this layer is a level of danger that will make everything up until now seem laugably easy. Past this point, the Abyss probably stops playing fair and reasonable.

If you&#39;re not dissuade and will continue onward, it will take you 8 days to reach this layer&#39;s bottom.

[[Turn back and continue your business on the seventh layer|Layer7 Hub]]
[[Continue your descent to the eighth layer|Layer7 Exit2]]</tw-passagedata><tw-passagedata pid="476" name="Layer7 Threat2 Main" tags="layer7" position="725,5975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $timeL7T2 -= 6&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/securityrobot.png&#39;]]

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 3&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

Of course you can&#39;t tone it all out, but it&#39;s pretty easy to keep your eyes on what matters and you patiently wait until the time is up and you are released.

[[Return to exploring the city|Layer7 Hub]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 5&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society.

For some reason, you find yourself paying a but more attention to the videos and voices, and you realize that they&#39;re not actually as ridiculous as you first thought.

Sure, you&#39;re free right now, but with subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

Fine, you&#39;re an organic being, but the miraculous technology of the city could change that, they could change you so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Yeah, you do have goals of things you want to do, but why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are tempted to go back and take up residence here, but shake off the feeling and continue your journey.

[[Return to exploring the city|Layer7 Hub]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno == 5&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society. And yeah, you do wish you were a better member of society, don&#39;t you?

The arguments they are making actually make perfect sense, they seem to precisely match your own thoughts actually. As if they were molded to you (or the other way around.)

With subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

The miraculous technology of the city could change that, they could change your organic body so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are free to go, but you do not use that freedom.

Now is your chance, you&#39;ve found a place where you belong.

It&#39;s time to stay in your new home.

You tell the robot that you are ready to take your place as a gear in the mechanism of society and almost immediately a syringe comes out of the wall and pokes your neck. You smile as your consciousness fades.

[[Awaken to your new life|Layer7 Tax End]]

&lt;&lt;else&gt;&gt;

After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

The biggest threat here is your boredom, honestly. While you try to fall asleep the robot makes an effort to keep you awake, in a kind of minor psychological torture through annoyance.

Eventually you are released though, with no harm done, and ready to continue your journey in the seventh layer.

[[Return to exploring the city|Layer7 Hub]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="477" name="Pick up the Daedalus Mechanism" tags="layer7" position="850,5975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic73)&gt;&gt;
&lt;&lt;set $corruption -= ($relic73.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic73.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic73.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="478" name="Pick up the Blind Divine" tags="layer7" position="975,5975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic74)&gt;&gt;
&lt;&lt;set $corruption -= ($relic74.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic74.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic74.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

This Relic grants you the ability to see in any dark place, removing the need for light in most cases as long as you posess it.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="479" name="Pick up the Lambent Specter" tags="layer7" position="1100,5975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic75)&gt;&gt;
&lt;&lt;set $corruption -= ($relic75.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic75.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic75.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="480" name="Pick up the Phoenix Obol" tags="layer7" position="1225,5975" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic76)&gt;&gt;
&lt;&lt;set $corruption -= ($relic76.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic76.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic76.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="481" name="Pick up the Granted Granite" tags="layer7" position="100,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic77)&gt;&gt;
&lt;&lt;set $corruption -= ($relic77.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic77.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic77.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="482" name="Pick up the Joyous Sunder" tags="layer7" position="225,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic78)&gt;&gt;
&lt;&lt;set $corruption -= ($relic78.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic78.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic78.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="483" name="Pick up the Azure Aozora" tags="layer7" position="350,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic79)&gt;&gt;
&lt;&lt;set $corruption -= ($relic79.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic79.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic79.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="484" name="Pick up the Glare Vantage" tags="layer7" position="475,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic80)&gt;&gt;
&lt;&lt;set $corruption -= ($relic80.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic80.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic80.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

If you don&#39;t already have a source of light, the Glare Vantage will provide you with one on your journey.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="485" name="Pick up the Final Stage" tags="layer7" position="600,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic81)&gt;&gt;
&lt;&lt;set $corruption -= ($relic81.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic81.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic81.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="486" name="Pick up the Solace Lace" tags="layer7" position="725,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic82)&gt;&gt;
&lt;&lt;set $corruption -= ($relic82.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic82.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;
&lt;&lt;set $heat = 1&gt;&gt;
&lt;&lt;set $cool = 1&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic82.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

This Relic provides you with comfort in the cold to reduce travel times by 2 days on layer 4 and comfort in the heat to reduce travel times by 1 day on layers 5 or 6.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="487" name="Pick up the Red Thread Flourish" tags="layer7" position="850,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic83)&gt;&gt;
&lt;&lt;set $corruption -= ($relic83.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic83.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic83.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="488" name="Pick up the Triage Rain" tags="layer7" position="975,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $ownedRelics.push($relic84)&gt;&gt;
&lt;&lt;set $corruption -= ($relic84.corr - $corRed + (5 * Math.trunc($hexflame / 10)))&gt;&gt;
&lt;&lt;set $tempTime = $relic84.time-$SibylBuff&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;

&lt;&lt;/nobr&gt;&gt;

You have successfully taken the $relic84.name relic. Hopefully you can make good use of it and make it worth that corruption cost.

[[Continue searching for the relics of layer 7|Layer7 Relics]]
[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="489" name="Layer7Time" tags="" position="1100,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $tempTime = (Math.max((1+$SizeHandicap)*($tempTime - $timeRed + $status.penalty + (Math.trunc($hexflame / 10))), 0))&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &lt; 500&gt;&gt;
	&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="490" name="Layer7 Forge1" tags="layer7" position="1225,6100" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = -1&gt;&gt;
&lt;&lt;set $temp2 = -1&gt;&gt;\
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Wonders/gearshifter.png&#39;]]

An enormous mechanism consisting of innumerable sets of interlocking gears appears before you. Strange symbols you don&#39;t understand cover the surface, but it seems apparent to you that there are 2 slots where you can place your Relics to make use of the Forge&#39;s effects.

If you choose to place 2 Relics in the Clockwork Forge, along with 4 dubloons, you can swap their abilities while retaining their prior shape, for example allowing you to put the Breathless Exhale and Sunbeam Relics in, to get a fire-enshrouded fan and a wind-controlling sword out.


[[Use the Forge to swap the abilities of 2 Relics|Layer7 Forge2]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="491" name="Layer7 Vend" tags="layer7 cards nobr" position="100,6225" size="100,100">&lt;p&gt;&lt;&lt;CarryAdjust&gt;&gt;&lt;/p&gt;

&lt;p&gt;Here are all of the items available for you to spend your $dubloons dubloons on in the Vend-o-matic 6900.&lt;/p&gt;

&lt;p&gt;Your team is currently carrying &lt;&lt;print setup.calcCarriedWeight().toFixed(1)&gt;&gt; kg and your team has a total carrying capacity of &lt;&lt;print Math.round($totalCarry)&gt;&gt; kg.&lt;/p&gt;
&lt;div class=&quot;cards-grid&quot;&gt;
&lt;&lt;for _item range [
	setup.itemVendFood, setup.itemVendWater, setup.itemVendFlask,
	$item25, $item26, setup.itemVendMedkit
]&gt;&gt;
&lt;div&gt;
[img[setup.ImagePath + _item.image]]
&lt;h2&gt;&lt;&lt;print _item.name == &quot;Empty Flask&quot; ? &quot;Flask&quot; : _item.name&gt;&gt;&lt;/h2&gt;
&lt;p&gt;
&lt;&lt;button `&quot;Buy for &quot; + _item.cost + (_item.cost == 1 ? &quot; dubloon&quot; : &quot; dubloons&quot;)` `&quot;Layer7 &quot; + _item.name`&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;&lt;print _item.desc&gt;&gt;
&lt;&lt;if _item.weight&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;print _item.weight&gt;&gt; kg&lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.name == &quot;Empty Flask&quot;&gt;&gt; empty, $item4.weight kg full&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;&lt;/for&gt;&gt;
&lt;/div&gt;

&lt;p&gt;[[Finish Shopping|Layer7 Hub]]&lt;/p&gt;</tw-passagedata><tw-passagedata pid="492" name="Layer7 Recycle" tags="layer7" position="225,6225" size="100,100">Here you can permanently recycle any of your collected relics for a nice haul of dubloons. You can use this to fund further expeditions, pay off your debt, or just get a nice payday at the end of your expedition.

Choose the relic you would like to sell:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Creepy Doll&quot; &amp;&amp; $creepydoll.affec &gt; 5&gt;&gt;
			You can&#39;t seem to part ways with the Creepy Doll&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Chain of Lorelei&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$colwear=0,$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Heart-stealing Stole&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$hsswear=0,$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Sibyl Blend&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$SibylBuff=0,$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;World Stone&quot; &amp;&amp; $LilyPromise&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $companionLily.affec-=(5-$hsswear)]]&quot;&gt;&gt; &lt;br&gt;You promised Lily she could use the World Stone at the end of your journey, recycling it now will surely disappoint her greatly. &lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Everhevea&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $items[2].count-=2]]&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2)))&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Layer7 Recycle][$dubloons += (Math.max($ownedRelics[$i].value - 15 + ($sellAdd / 2))), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Continue your business on the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="493" name="Layer7 Water" tags="layer7 item" position="350,6225" size="100,100">[img[setup.ImagePath + setup.itemVendWater.image]]

How much water would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[0].count += parseInt($temp), $dubloons -= (parseInt($temp)*2)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="494" name="Layer7 Food Rations" tags="layer7 item" position="475,6225" size="100,100">[img[setup.ImagePath + setup.itemVendFood.image]]

How many days of food rations would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[1].count += parseInt($temp), $dubloons -= (parseInt($temp)*3)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="495" name="Layer7 Flask" tags="layer7 item" position="600,6225" size="100,100">[img[setup.ImagePath + setup.itemVendFlask.image]]

How many water flasks would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[3].count += parseInt($temp), $dubloons -= (parseInt($temp)*6)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="496" name="Layer7 Medkit" tags="layer7 item" position="725,6225" size="100,100">[img[setup.ImagePath + setup.itemVendMedkit.image]]

How many medkits would you like to buy?

Note: These are currently not lighter than the Outset Town medkits!

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[4].count += parseInt($temp), $dubloons -= (parseInt($temp)*12)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="497" name="Layer7 Energy Rations" tags="layer7 item" position="850,6225" size="100,100">[img[setup.ImagePath+$items[24].image]]

How many days of energy rations would you like to buy?

Note: These are currently not functional!

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[24].count += parseInt($temp), $dubloons -= (parseInt($temp)*11)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="498" name="Layer7 Ward Water" tags="layer7 item" position="975,6225" size="100,100">[img[setup.ImagePath+$items[25].image]]

How many days of ward water would you like to buy?

Note: These are currently not functional!

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Layer7 Vend][$items[25].count += parseInt($temp), $dubloons -= (parseInt($temp)*4)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="499" name="Work on Heavy Lifting" tags="layer7" position="1100,6225" size="100,100">[img[setup.ImagePath+&#39;Foraging/heavylifting.png&#39;]]

You&#39;ll be moving large, heavy metal loads (ostensibly, construction materials) around long distances. Each load weighs arbout 60kg, and you&#39;ll be transporting them around 2km on average. You get a small wheeled cart to assist, but stacking more than two on top of each other would be very precarious (not to mention extremely heavy and difficult to push.) You get 1 dubloon for each block you move.

You have obtained $heavyLiftDubloons dubloons out of 80 dubloons max for this job.

An average human working a full day at this task can make 5 dubloons per day doing this job.&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Minish-ish&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your weak body, you cannot move any loads without assistance. You&#39;ll need to either assign a companion to work this job alone or use a Relic to make any progress.&lt;&lt;/if&gt;&gt;&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your enormous size, you can move many loads in your hands with ease. You can move up to 40 loads per day by grasping the loads in your hands, though you will need to take slightly longer paths to get to the destination.&lt;&lt;/if&gt;&gt;&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; Your $hiredCompanions.length can also help, effectively multiplying your daily output by &lt;&lt;print ($hiredCompanions.length + 1)&gt;&gt;.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Afar Wanderer&quot;)&gt;&gt;

You can use the Afar Wanderer on the cart to make the load significantly easier to move. While the wands becomes heavier, it doesn&#39;t gain the weight of the loads on top of the cart, so you can effectively drag the cart around much easier. If you use the Afar Wanderer, an average person could carry 10 loads per day on their own.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Return to Sender&quot;)&gt;&gt;

You can mark 10 of the objects with the Return to Sender Relic, allowing you to recall all of them to your position. Unfortunately, this will reach the maximum distance for Return to Sender, but it will let you very quickly complete 10 loads in a single day.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Superpositional Skewer&quot;)&gt;&gt;

You can use the Superpositional Skewer to touch the load with one end, then walk to the desired location, then tap yourself with the other end. This will result in you being transported back to the location of the loads and the load being transported to the destination. This effectively means you don&#39;t need to carry any heavy weights and only need to walk half the distance. This dramatically improves the efficiency of this job, allowing you to move up to 20 loads per day on your own!&lt;&lt;/if&gt;&gt;

If you will be working on this job, please enter the number of days you will be working on this job now and how many dubloons you will be making.

Days:
&lt;&lt;textbox &quot;$temp1&quot; &quot;1&quot;&gt;&gt;

Dubloons:
&lt;&lt;textbox &quot;$temp2&quot; &quot;5&quot;&gt;&gt;

[[Confirm|Work on Heavy Lifting 2]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="500" name="Work on Land Excavation" tags="layer7" position="1225,6225" size="100,100">[img[setup.ImagePath+&#39;Foraging/landexcavation.png&#39;]]

You&#39;ll be clearing out large chunks of dirt and stone from the walls of the Abyss, supporting the city;s eventual expansion. You get 1 dubloon for evey 2x2x2 cubit meters of dirt and rock you clear away - max 80 dubloons. You get a normal shovel and a drill to assist you. You might be here a while.

You have obtained $landExcavDubloons dubloons out of 80 dubloons max for this job.

An average human working a full day at this task can make 2 dubloons per day doing this job.&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Minish-ish&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your weak body, you cannot excavate any significant amount of earth on your own. You&#39;ll need to either assign a companion to work this job alone or use a Relic to make any progress.&lt;&lt;/if&gt;&gt;&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your enormous size, you can move a large amount of earth with ease. While you won&#39;t have any tools, you can dig up to 40 2x2x2 cubic meters of land by digging with your bulldozer-sized hands.&lt;&lt;/if&gt;&gt;&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; Your $hiredCompanions.length can also help, effectively multiplying your daily output by &lt;&lt;print ($hiredCompanions.length + 1)&gt;&gt;.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Yliaster Materia&quot;)&gt;&gt;

You can use the Yliaster Materia to melt or vaporize the land you are excavating to make it much easier to move. Liquid can slide away and gas can disperse, as long as you&#39;re careful not to breathe any in. This doesn&#39;t completely trivialize the work, but it does make it go by significantly faster. The whip can help so much in the land excavation that if you use it, you alone can move up to 20 2x2x2 cubic meter chunks of earth in one day of labor.&lt;&lt;/if&gt;&gt;

If you will be working on this job, please enter the number of days you will be working on this job now and how many dubloons you will be making.

Days:
&lt;&lt;textbox &quot;$temp1&quot; &quot;1&quot;&gt;&gt;

Dubloons:
&lt;&lt;textbox &quot;$temp2&quot; &quot;2&quot;&gt;&gt;

[[Confirm|Work on Land Excavation 2]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="501" name="Work on City Painting" tags="layer7" position="100,6350" size="100,100">[img[setup.ImagePath+&#39;Foraging/citypainter.png&#39;]]

You&#39;ll be redoing the paint on a number of buildings throughout the city, where the paint is old or worn. You get 1 dubloom for every 1 square km of building surface you paint, maximum 80 dubloons. You get a basic paint roller to do the job with, but you&#39;ll get docked pay (possibly extending to an outright fine) if you get significant levels of paint in an area you weren&#39;t assigned to cover.

You have obtained $cityPaintDubloons dubloons out of 80 dubloons max for this job.

An average human working a full day at this task can make 1 dubloons per day doing this job.&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; Your $hiredCompanions.length can also help, effectively multiplying your daily output by &lt;&lt;print ($hiredCompanions.length + 1)&gt;&gt;.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Zelus Band&quot;)&gt;&gt;

You can use the Zelus Band to make sure you stay focused. While this doesn&#39;t make you inherently any better at painting, you will find that being perfectly focused on a task like this can allow you to accomplish much more than you would otherwise. If you choose to wear the Zelus Band, you can earn up to 3 dubloons per day while working on this job alone.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Red Thread Flourish&quot;)&gt;&gt;

You can use the Red Thread Flourish to serve as additional hands to paint surfaces according to your will. The threads can move intricately and significantly increase the speed at which you can paint on your own. If you use the Red Thread Flourish while painting, you can earn up to 5 dubloons per day while working this job alone.&lt;&lt;/if&gt;&gt;

If you will be working on this job, please enter the number of days you will be working on this job now and how many dubloons you will be making.

Days:
&lt;&lt;textbox &quot;$temp1&quot; &quot;1&quot;&gt;&gt;

Dubloons:
&lt;&lt;textbox &quot;$temp2&quot; &quot;1&quot;&gt;&gt;

[[Confirm|Work on City Painting 2]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="502" name="Work on Energy Generator" tags="layer7" position="225,6350" size="100,100">[img[setup.ImagePath+&#39;Foraging/energygenerator.png&#39;]]

You&#39;ll be generating some energy to power the city, to be stored in case all of the hundreds of Miasma-based generator, and the emergency secondary backup generator all go out at once... Yeah, this is pointless. You&#39;ll get 4 dubloons per kWh of energy you generate, up to 80 dubloons. For this job you&#39;ll get one human-sized hamster wheel hooked up to a dynamo and energy storage unit. At a constant, sustainted, fast running pace, it&#39;ll probably take well over a full day to generat e1 kWh, and you&#39;ll need to eat and drink food and water worth much more than the energy you produce. You don&#39;t need to use the hamster wheel if you don&#39;t want to, energy from a different source can be fed into storage too.

You have obtained $energyGenDubloons dubloons out of 80 dubloons max for this job.

An average human working a full day at this task can make 2 dubloons per day doing this job.&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Minish-ish&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your weak body, you cannot generate any significant amount of energy by running on the hamster wheel on your own. You&#39;ll need to either assign a companion to work this job alone or use a Relic to make any progress.&lt;&lt;/if&gt;&gt;&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt; However, due to your enormous size, you can simply use your enormous hands to rapidly spin the hamster wheel and generate a large amount of energy. Using this method, you can generate 4kWh per day for 16 dubloons payment, on your own.&lt;&lt;/if&gt;&gt;&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; Your $hiredCompanions.length can also help, effectively multiplying your daily output by &lt;&lt;print ($hiredCompanions.length + 1)&gt;&gt;.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Breathless Exhale&quot;)&gt;&gt;

By attaching fans to the hamster wheel and blowing it with the Breathless Exhale, you can generate much more energy with much less effort than you could by running yourself. This method could generate up to 4 kWh per day, yielding 16 dubloons per day of using the Breathless Exhale to power the wheel.&lt;&lt;/if&gt;&gt;&lt;&lt;if $totalRelics.some(e =&gt; e.name === &quot;Toral Wave&quot;)&gt;&gt;

The Toral Wave generate a significant amount of energy on its own, and you should be able to find a wire to connect it to the battery realtively easily within this city. Because the maximum output of the Toral Wave is 3000 W, you can generate 3kWh per hour you use it. So in only 1 day of &quot;work&quot; you can generate the full 20 kWh to get 80 dubloons, without needing to do much work yourself, though you do need to stay nearby to correct occasional disconnections and errors.&lt;&lt;/if&gt;&gt;

If you will be working on this job, please enter the number of days you will be working on this job now and how many dubloons you will be making.

Days:
&lt;&lt;textbox &quot;$temp1&quot; &quot;1&quot;&gt;&gt;

Dubloons:
&lt;&lt;textbox &quot;$temp2&quot; &quot;1&quot;&gt;&gt;

[[Confirm|Work on Energy Generator 2]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="503" name="Work on Robo-prostitution" tags="layer7" position="350,6350" size="100,100">[img[setup.ImagePath+&#39;Foraging/roboprostitute.png&#39;]]

You&#39;ll be servicing various robots with artificial genitals in a wide variety of interesting shapes and sizes. I&#39;m pretty sure they&#39;re just messing with you at this point - I mean, can&#39;t they just press a button and cum or whatever? They&#39;ve set their sensitivity sp as to last roughly 3 times as long as an average human. You&#39;ll get 1 dubloon for every orgasm you cause for them.

You have obtained $roboProstituteDubloons dubloons out of 50 dubloons max for this job.

An average human working a full day at this task can make 10 dubloons per day doing this job.&lt;&lt;if $hiredCompanions.length &gt; 0&gt;&gt; Your companions are unwilling to do this job, so they do not provide a multiplier here. You must be the prostitute yourself to make the dubloons.&lt;&lt;/if&gt;&gt;

If you will be working on this job, please enter the number of days you will be working on this job now and how many dubloons you will be making.

Days:
&lt;&lt;textbox &quot;$temp1&quot; &quot;1&quot;&gt;&gt;

Dubloons:
&lt;&lt;textbox &quot;$temp2&quot; &quot;10&quot;&gt;&gt;

[[Confirm|Work on Robo-prostitution 2]]


&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="504" name="Take on Libido Reinforcement E" tags="layer7" position="475,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse85)&gt;&gt;&lt;&lt;set $corruption += $curse85.corr&gt;&gt;&lt;&lt;set $LibidoLog.push($curse85)&gt;&gt;

You have successfully taken on the $curse85.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="505" name="Take on Gender Reversal E" tags="layer7" position="600,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse86)&gt;&gt;&lt;&lt;set $corruption += $curse86.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse86)&gt;&gt;

You have successfully taken on the $curse86.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="506" name="Take on Asset Robustness E" tags="layer7" position="725,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse87)&gt;&gt;&lt;&lt;set $corruption += $curse87.corr&gt;&gt;&lt;&lt;set $GenderLog.push($curse87)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact E&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;

You have successfully taken on the $curse87.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="507" name="Take on Urine Reamplification A" tags="layer7" position="850,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse88)&gt;&gt;&lt;&lt;set $corruption += $curse88.corr&gt;&gt;

You have successfully taken on the $curse88.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="508" name="Take on Barter System" tags="layer7" position="975,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse89)&gt;&gt;&lt;&lt;set $corruption += $curse89.corr&gt;&gt;

You have successfully taken on the $curse89.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="509" name="Take on Shared Space" tags="layer7" position="1100,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse90)&gt;&gt;&lt;&lt;set $corruption += $curse90.corr&gt;&gt;

You have successfully taken on the $curse90.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="510" name="Take on Weakling" tags="layer7" position="1225,6350" size="100,100">&lt;&lt;set $playerCurses.push($curse91)&gt;&gt;&lt;&lt;set $corruption += $curse91.corr&gt;&gt;

You have successfully taken on the $curse91.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;CarryAdjust&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="511" name="Take on Random Orgasms" tags="layer7" position="100,6475" size="100,100">&lt;&lt;set $playerCurses.push($curse92)&gt;&gt;&lt;&lt;set $corruption += $curse92.corr&gt;&gt;
You have successfully taken on the $curse92.name curse. Hopefully you are fine with having a random interruption to whatever you&#39;re doing &lt;&lt;if $randomOrgasms == 1&gt;&gt;once &lt;&lt;else&gt;&gt;$randomOrgasms times&lt;&lt;/if&gt;&gt; per day.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="512" name="Take on Beastly" tags="layer7" position="225,6475" size="100,100">&lt;&lt;set $playerCurses.push($curse93)&gt;&gt;&lt;&lt;set $corruption += $curse93.corr&gt;&gt;

You have successfully taken on the $curse93.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="513" name="Take on Creature of the Night" tags="layer7" position="350,6475" size="100,100">&lt;&lt;set $playerCurses.push($curse94)&gt;&gt;&lt;&lt;set $corruption += $curse94.corr&gt;&gt;

You have successfully taken on the $curse94.name curse. Hopefully you are ok with accepting the permanent consequences.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="514" name="Take on Minish-ish" tags="layer7" position="475,6475" size="100,100">&lt;&lt;set $playerCurses.push($curse95)&gt;&gt;&lt;&lt;set $corruption += $curse95.corr&gt;&gt;&lt;&lt;set $HeightLog.push($curse95)&gt;&gt;

You have successfully taken on the $curse95.name curse. Hopefully you are ok with accepting the permanent consequences.

Note: Some effects of this curse are not yet implemented.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;CarryAdjust&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="515" name="Take on Colossal-able" tags="layer7" position="600,6475" size="100,100">&lt;&lt;set $playerCurses.push($curse96)&gt;&gt;&lt;&lt;set $corruption += $curse96.corr&gt;&gt;&lt;&lt;set $HeightLog.push($curse96)&gt;&gt;

You have successfully taken on the $curse96.name curse. Hopefully you are ok with accepting the permanent consequences.

Note: Some effects of this curse are not yet implemented.

[[Accept more curses from the seventh layer|Layer7 Curses]]
&lt;&lt;if $escBalDepl==0&gt;&gt;
	[[Return to exploring layer 7|Layer7 Hub]]
&lt;&lt;else&gt;&gt;
	[[Return to your balloon|Escape Balloon L7]]
&lt;&lt;/if&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;CarryAdjust&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="516" name="Layer7 Curses Random" tags="layer7" position="725,6475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 999; $i++&gt;&gt;
	&lt;&lt;set $temp1 = random(0,11) + 84&gt;&gt;
	&lt;&lt;if ($temp1 == 84) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Libido Reinforcement E&quot;) &amp;&amp; $StoredCurse.name != &quot;Libido Reinforcement E&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 85) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Gender Reversal E&quot;) &amp;&amp; $StoredCurse.name != &quot;Gender Reversal E&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 86) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Asset Robustness E&quot;) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Shrunken Assets&quot;) &amp;&amp; $StoredCurse.name != &quot;Asset Robustness E&quot; &amp;&amp; $StoredCurse.name != &quot;Shrunken Assets&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 87) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Urine Reamplification A&quot;) &amp;&amp; $StoredCurse.name != &quot;Urine Reamplification A&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 88) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Barter System&quot;) &amp;&amp; $StoredCurse.name != &quot;Barter System&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 89) &amp;&amp; !(playerCurses.some(e =&gt; e.name === &quot;Shared Space&quot;)) &amp;&amp; $StoredCurse.name != &quot;Shared Space&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 90) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;) &amp;&amp; $StoredCurse.name != &quot;Weakling&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 91) &amp;&amp; setup.takenCurseCount(&quot;Random Orgasms&quot;) &lt; 5&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 92) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Beastly&quot;) &amp;&amp; $StoredCurse.name != &quot;Beastly&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 93) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Creature of the Night&quot;) &amp;&amp; $StoredCurse.name != &quot;Creature of the Night&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 94) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Minish-ish&quot;) &amp;&amp; $StoredCurse.name != &quot;Minish-ish&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if ($temp1 == 95) &amp;&amp; !$playerCurses.some(e =&gt; e.name === &quot;Colossal-able&quot;) &amp;&amp; $StoredCurse.name != &quot;Colossal-able&quot;&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;



	&lt;&lt;if $i &gt; 900&gt;&gt;
		&lt;&lt;set $temp1 = -1&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;if $temp1 &gt;= 0&gt;&gt;
The Abyss has chosen for you to be cursed with $curses[$temp1].name. You may not have chosen this, but fate has placed the burden upon you. Accept your curse and the change in life that comes with it.

&lt;&lt;print &quot;[[Take on &quot; + $curses[$temp1].name + &quot;]]&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
There are no curses left for you to take on this layer.

&lt;&lt;back&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="517" name="Escape Balloon L7" tags="layer7" position="850,6475" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $currentLayer = 7&gt;&gt;&lt;&lt;if !isPlaying(&quot;layer7&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer7&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;&lt;&lt;/nobr&gt;&gt;
You wait as your balloon rapidly ascends and you can watch the metallic buildings shrink beneath you. Swarms of robots seems to pursue their mysterious duties as if they were ants scurrying about an anthill. Luckily they don&#39;t seem to pay much attention to the air, and even the occasional flying robot pays you no notice as you ascend towards the gate to the sixth layer.

[[Ascend to next layer|Escape Balloon L6][$corruption -= (80 - $corRed)]]
[[Hover on this layer to take in a curse|Layer7 Curses]]
[[Get off the balloon on this layer|Layer7 Hub][$escBalDepl=0]]</tw-passagedata><tw-passagedata pid="518" name="Layer7 Cherry Relic" tags="layer7" position="975,6475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 72&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 72&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 72&gt;&gt;
	&lt;&lt;if $temp1 !== $temp2&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp2])&gt;&gt;

&lt;&lt;set $corruption -= Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The relics you have found with Cherry&#39;s Chaotic Luck are $relics[$temp1].name and $relics[$temp2].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer7 Hub]]

&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer7 Cherry Relic&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp2].corr / 2) - $corRed, 0))&gt;&gt;

		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="519" name="Layer7 Cherry Curse" tags="layer7" position="1100,6475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 84&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 84&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; 1; $i&gt;&gt;
	&lt;&lt;set $temp2 = random(0,11) + 84&gt;&gt;
	&lt;&lt;if ($temp1 !== $temp2)&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp1])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp1].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $corruption += Math.round(Math.max(($curses[$temp2].corr * 3 / 2), 0))&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

The curses you have obtained with Cherry&#39;s Chaotic Luck are $curses[$temp1].name and $curses[$temp2].name for a cost of &lt;&lt;print Math.round(Math.max(($curses[$temp1].corr * 3 / 2) - $corRed, 0))&gt;&gt; and &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 3 / 2) - $corRed, 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer7 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Libido Reinforcement E&quot; || $curses[$temp2].name == &quot;Libido Reinforcement E&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse85)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Gender Reversal E&quot; || $curses[$temp2].name == &quot;Gender Reversal E&quot; &gt;&gt;
	&lt;&lt;set $GenderLog.push($curse86)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Asset Robustness E&quot; || $curses[$temp2].name == &quot;Asset Robustness E&quot; &gt;&gt;
	&lt;&lt;set $GenderLog.push($curse87)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact E&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Weakling&quot; || $curses[$temp2].name == &quot;Weakling&quot;&gt;&gt;
	&lt;&lt;set $playerCurses.push($curse91)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Minish-ish&quot; || $curses[$temp2].name == &quot;Minish-ish&quot;&gt;&gt;
	&lt;&lt;set $HeightLog.push($curse95)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp1].name == &quot;Colossal-able&quot; || $curses[$temp2].name == &quot;Colossal-able&quot;&gt;&gt;
	&lt;&lt;set $HeightLog.push($curse96)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer7 Cherry Curse&quot;&gt;&gt;
		&lt;&lt;set $targetCurse = $curses[$temp1]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp1].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;

		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="520" name="Layer7 Cherry Mix" tags="layer7" position="1225,6475" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = random(0,11) + 72&gt;&gt;
&lt;&lt;set $temp2 = random(0,11) + 84&gt;&gt;
&lt;&lt;set $ownedRelics.push($relics[$temp1])&gt;&gt;

&lt;&lt;set $corruption -= Math.floot(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
&lt;&lt;set $playerCurses.push($curses[$temp2])&gt;&gt;
&lt;&lt;set $playerCurses[$playerCurses.length - 1].corr = Math.round(Math.max(($curses[$temp2].corr * 1.5), 0))&gt;&gt;
&lt;&lt;set $corruption += $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

With Cherry&#39;s Chaotic Luck you have found the relic $relics[$temp1].name for a cost of &lt;&lt;print Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt; corruption and obtained the curse $curses[$temp2].name for a gain of &lt;&lt;print Math.round(Math.max(($curses[$temp2].corr * 1), 0))&gt;&gt; corruption respectively.

[[Continue on to the rest of the layer|Layer7 Hub]]

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Libido Reinforcement E&quot;&gt;&gt;
	&lt;&lt;set $LibidoLog.push($curse85)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Gender Reversal E&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse86)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Asset Robustness E&quot;&gt;&gt;
	&lt;&lt;set $GenderLog.push($curse87)&gt;&gt;&lt;&lt;if $app.sex==&quot;male&quot; &amp;&amp; $app.breastsCor&gt;0 &gt;&gt;&lt;&lt;set $GenderLog.push(&quot;Interact E&quot;)&gt;&gt;&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Weakling&quot;&gt;&gt;
	&lt;&lt;set $playerCurses.push($curse91)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Minish-ish&quot;&gt;&gt;
	&lt;&lt;set $HeightLog.push($curse95)&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $curses[$temp2].name == &quot;Colossal-able&quot;&gt;&gt;
	&lt;&lt;set $HeightLog.push($curse96)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/nobr&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;Devil&#39;s Own&quot;)&gt;&gt;

	You have a single chance to bend fate using the mystical luck of the Devil&#39;s Own. Cherry&#39;s fate is strong, so you only get 1 chance to use this effect on your entire adventure. Would you like to reroll Cherry&#39;s Chaotic Luck?

	&lt;&lt;link &quot;Reroll with Devil&#39;s Own&quot; &quot;Layer7 Cherry Mix&quot;&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt($ownedRelics.length-1)&gt;&gt;
		&lt;&lt;set $corruption += Math.floor(Math.max(($relics[$temp1].corr / 2) - $corRed, 0))&gt;&gt;
		
		&lt;&lt;set $targetCurse = $curses[$temp2]&gt;&gt;
		&lt;&lt;set $corruption -= $playerCurses[$playerCurses.length - 1].corr&gt;&gt;
		&lt;&lt;if $curses[$temp2].type == &quot;Gender&quot; &gt;&gt;
			&lt;&lt;set _temp = $GenderLog.length&gt;&gt;
			&lt;&lt;if $GenderLog[_temp-1].name == &quot;Interact A&quot; || $GenderLog[_temp-1].name == &quot;Interact B&quot; || $GenderLog[_temp-1].name == &quot;Interact C&quot; || $GenderLog[_temp-1].name == &quot;Interact D&quot; || $GenderLog[_temp-1].name == &quot;Interact E&quot;&gt;&gt;
				&lt;&lt;set $GenderLog.deleteAt(_temp-1)&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;include &quot;CurseRemoval&quot;&gt;&gt;
		&lt;&lt;set _temp = $ownedRelics.findIndex(e=&gt; e.name===&quot;Devil&#39;s Own&quot;)&gt;&gt;
		&lt;&lt;set $soldRelics.push($ownedRelics[_temp])&gt;&gt;
		&lt;&lt;set $ownedRelics.deleteAt(_temp)&gt;&gt;
	&lt;&lt;/link&gt;&gt;

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="521" name="Layer7 Forge2" tags="layer7" position="100,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $temp1 &lt; 0&gt;&gt;
Choose the first Relic you would like to swap:&lt;br&gt;&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;print &quot;[[$ownedRelics[$i].name|Layer7 Forge2][$temp1 = $i]]&quot;&gt;&gt;&lt;br&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;elseif $temp1 &gt;= 0 &amp;&amp; $temp2 &lt; 0&gt;&gt;
Choose the second Relic you would like to swap:&lt;br&gt;&lt;br&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $i != $temp1&gt;&gt;&lt;&lt;print &quot;[[$ownedRelics[$i].name|Layer7 Forge2][$temp2 = $i]]&quot;&gt;&gt;&lt;br&gt;&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;else&gt;&gt;
An enormous snapping sound erupts from the Clockwork Forge as the mechanism shuts, obscuring your Relics from view. Suddenly, a horrendous grinding is audible inside the machine, but after only a few seconds it quiets down once again, then becomes silent as the Forge opens up again, revealing your Relics along with a bit of steam that drifts upwards from the Forge.&lt;br&gt;&lt;br&gt;

You retrieve your Relics and find that you have successfully switched the abilities of the $ownedRelics[$temp1].name and the $ownedRelics[$temp2].name. &lt;br&gt;&lt;br&gt;

[[Continue your business on the seventh layer|Layer7 Hub]]&lt;br&gt;&lt;br&gt;

&lt;&lt;set $tempTime = 2&gt;&gt;
&lt;&lt;include &quot;Layer7Time&quot;&gt;&gt;
&lt;&lt;set $dubloons -= 4&gt;&gt;

&lt;&lt;set $temp = $relicSwap.length&gt;&gt;
&lt;&lt;set $relicSwap.push([$ownedRelics[$temp1], $ownedRelics[$temp2]])&gt;&gt;


&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="522" name="Layer7 Tax End" tags="image layer7" position="225,6600" size="100,100">You have no choice, you gain consciousness a few times to see yourself in a surgery room where your organic parts are replaced with reliable, mechanical alternatives. But you don&#39;t fully regain consciousness until you&#39;ve been fully subdued and are ready to become a productive piece of the machinery of the city.

[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 8-habitation.png&#39;]]

@@.layerTitle;GAME OVER@@</tw-passagedata><tw-passagedata pid="523" name="Layer7 Ascend2" tags="layer7" position="350,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(7 - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)), 0))&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &lt; 500&gt;&gt;
	&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $dubloons &lt; 0&gt;&gt;


&lt;br&gt;[img[setup.ImagePath+&#39;Threats/taxdrone.png&#39;]]&lt;br&gt;&lt;br&gt;

&lt;br&gt;A quiet humming sound descends upon you as you see the Taxdrone floating towards you from over a nearby building. You reach into your pack to get your typical dubloon payment, but then you realize something is wrong, you can&#39;t find any dubloons! Perhaps you didn&#39;t keep track of them properly? But it&#39;s too late to get any now, the taxes are already due.&lt;br&gt;&lt;br&gt;

The Taxdrone patiently requests that you submit your taxes as it displays a slot for you to deposit the dubloons into, but soon it realizes you will not be paying and the typically soft blue lights on the drone change to glaring red and an alarm sounds.&lt;br&gt;&lt;br&gt;

Within a moment you are restrained by nets made of light and you feel a prick on your neck. You notice the drone has stabbed you with a syringe, but at this point it&#39;s too late to resist and your consciousness begins to fade, leaving you to succumb to your fate.&lt;br&gt;&lt;br&gt;

You are now forced to become a permanent resident of Layer 7.&lt;br&gt;&lt;br&gt;

[[Awaken to your new life|Layer7 Tax End]]&lt;br&gt;&lt;br&gt;


		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL7T2 &gt; 5&gt;&gt;
&lt;br&gt;A an enormous rumbling catches your attention as you walk through the seventh layer. A brief glance around reveals the source, an enormous, building-sized machine that is now rapidly approaching you. You consider running, but the Security Robot is moving at an incredible speed, leaving you no chance to get away. &lt;br&gt;&lt;br&gt;

&quot;ACCEPT REHABILITATION&quot; a synthetic voice calls out, with the huge robot nearly upon you. &lt;br&gt;&lt;br&gt;

And suddenly, it&#39;s here, reaching down to grab you with shining metallic arms and pull you into its shell.&lt;br&gt;&lt;br&gt;

[[Get rehabilitated|Layer7 Threat2 Ascend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $corruption -= (80 - $corRed)&gt;&gt;
&lt;&lt;set $timeL6T1 = 0&gt;&gt;
&lt;&lt;set $timeL6T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
Surprisingly, the ascent up to the sixth layer is relatively easy. While you did need to deal with the typical, meddlesome robots, there weren&#39;t any additional obstacles in your path.

When you reach the pinacle of the layer, you once again approach the series of barricades holding back the sea of tenatcles and flames from reaching the pristine city, but this time you are exiting back to the hellish landscape of the sixth layer.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Return to the Sixth layer|Layer6 Hub]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="524" name="Layer7 Threat2 Ascend" tags="layer7" position="475,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $timeL7T2 -= 6&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/securityrobot.png&#39;]]

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 3&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

Of course you can&#39;t tone it all out, but it&#39;s pretty easy to keep your eyes on what matters and you patiently wait until the time is up and you are released.

[[Continue your ascent to the sixth layer|Layer7 Ascend2]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 5&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society.

For some reason, you find yourself paying a but more attention to the videos and voices, and you realize that they&#39;re not actually as ridiculous as you first thought.

Sure, you&#39;re free right now, but with subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

Fine, you&#39;re an organic being, but the miraculous technology of the city could change that, they could change you so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Yeah, you do have goals of things you want to do, but why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are tempted to go back and take up residence here, but shake off the feeling and continue your journey.

[[Continue your ascent to the sixth layer|Layer7 Ascend2]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno == 5&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society. And yeah, you do wish you were a better member of society, don&#39;t you?

The arguments they are making actually make perfect sense, they seem to precisely match your own thoughts actually. As if they were molded to you (or the other way around.)

With subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

The miraculous technology of the city could change that, they could change your organic body so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are free to go, but you do not use that freedom.

Now is your chance, you&#39;ve found a place where you belong.

It&#39;s time to stay in your new home.

You tell the robot that you are ready to take your place as a gear in the mechanism of society and almost immediately a syringe comes out of the wall and pokes your neck. You smile as your consciousness fades.

[[Awaken to your new life|Layer7 Tax End]]

&lt;&lt;else&gt;&gt;

After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

The biggest threat here is your boredom, honestly. While you try to fall asleep the robot makes an effort to keep you awake, in a kind of minor psychological torture through annoyance.

Eventually you are released though, with no harm done, and ready to continue your journey in the seventh layer.

[[Continue your ascent to the sixth layer|Layer7 Ascend2]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="525" name="Layer7 Exit2" tags="layer7" position="600,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $layerExit == 0&gt;&gt;
	&lt;&lt;set $layerExit = 1&gt;&gt;
	&lt;&lt;if $status.duration &gt; 0&gt;&gt;
		&lt;&lt;set $status.duration -= 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $status.penalty = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $layerExitTime = (Math.max(8 - $timeRed + $status.penalty + (Math.trunc($hexflame / 10)), 0))&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; 99; $i++&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &lt; 500&gt;&gt;
	&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

	&lt;&lt;set $layerExitTime -= 1&gt;&gt;
	&lt;&lt;if $layerExitTime == 0&gt;&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $dubloons &lt; 0&gt;&gt;


&lt;br&gt;[img[setup.ImagePath+&#39;Threats/taxdrone.png&#39;]]&lt;br&gt;&lt;br&gt;

&lt;br&gt;A quiet humming sound descends upon you as you see the Taxdrone floating towards you from over a nearby building. You reach into your pack to get your typical dubloon payment, but then you realize something is wrong, you can&#39;t find any dubloons! Perhaps you didn&#39;t keep track of them properly? But it&#39;s too late to get any now, the taxes are already due.&lt;br&gt;&lt;br&gt;

The Taxdrone patiently requests that you submit your taxes as it displays a slot for you to deposit the dubloons into, but soon it realizes you will not be paying and the typically soft blue lights on the drone change to glaring red and an alarm sounds.&lt;br&gt;&lt;br&gt;

Within a moment you are restrained by nets made of light and you feel a prick on your neck. You notice the drone has stabbed you with a syringe, but at this point it&#39;s too late to resist and your consciousness begins to fade, leaving you to succumb to your fate.&lt;br&gt;&lt;br&gt;

You are now forced to become a permanent resident of Layer 7.&lt;br&gt;&lt;br&gt;

[[Awaken to your new life|Layer7 Tax End]]&lt;br&gt;&lt;br&gt;


		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $timeL7T2 &gt; 5&gt;&gt;
&lt;br&gt;A an enormous rumbling catches your attention as you walk through the seventh layer. A brief glance around reveals the source, an enormous, building-sized machine that is now rapidly approaching you. You consider running, but the Security Robot is moving at an incredible speed, leaving you no chance to get away. &lt;br&gt;&lt;br&gt;

&quot;ACCEPT REHABILITATION&quot; a synthetic voice calls out, with the huge robot nearly upon you. &lt;br&gt;&lt;br&gt;

And suddenly, it&#39;s here, reaching down to grab you with shining metallic arms and pull you into its shell.&lt;br&gt;&lt;br&gt;

[[Get rehabilitated|Layer7 Threat2 Descend]]&lt;br&gt;&lt;br&gt;
		&lt;&lt;break&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;


&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $layerExitTime == 0&gt;&gt;
&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $timeL8T1 = 0&gt;&gt;
&lt;&lt;set $timeL8T2 = 0&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
After days of travel, you reach the bottom of the city. What awaits you is an enormous, circular gate, embedded into the ground at the lowest point of the city, almost like an elaborat emanhole cover.

The rest of the layer slopes up all around it, every direction funneling down into it. There is no other way downward except through the other side of this gate. Will you push it open, and continue to push yourself ever downward?

[[Descend into the circular gate|Layer8 1]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="526" name="Layer7 Threat2 Descend" tags="layer7" position="725,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $timeL7T2 -= 6&gt;&gt;
&lt;&lt;set $tempTime = 1&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Threats/securityrobot.png&#39;]]

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 3&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

Of course you can&#39;t tone it all out, but it&#39;s pretty easy to keep your eyes on what matters and you patiently wait until the time is up and you are released.

[[Continue your descent to the eighth layer|Layer7 Exit2]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno &lt; 5&gt;&gt;&lt;&lt;set $layer7Hypno += 1&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society.

For some reason, you find yourself paying a but more attention to the videos and voices, and you realize that they&#39;re not actually as ridiculous as you first thought.

Sure, you&#39;re free right now, but with subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

Fine, you&#39;re an organic being, but the miraculous technology of the city could change that, they could change you so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Yeah, you do have goals of things you want to do, but why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are tempted to go back and take up residence here, but shake off the feeling and continue your journey.

[[Continue your descent to the eighth layer|Layer7 Exit2]]

&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Hypno Happytime&quot;) &amp;&amp; $layer7Hypno == 5&gt;&gt;
Once again, you are pulled into the security robot to hear the familiar tales of how to be a productive part of society. And yeah, you do wish you were a better member of society, don&#39;t you?

The arguments they are making actually make perfect sense, they seem to precisely match your own thoughts actually. As if they were molded to you (or the other way around.)

With subservience can come great pleasure, and what greater pursuit in life is there than pleasure? Your pleasure centers could be continually stimulated by following orders and following what is demanded of you.

The miraculous technology of the city could change that, they could change your organic body so that you fit neatly into the mechanisms of society here. No need to let your messy fleshy bits get in the way of a better life for you and everyone else.

Why are your goals more important than the goals of an entire city? Especially when they are as grand as the City of Agartha preparing for the future awakening of its organic population!

When the robot releases you, you are free to go, but you do not use that freedom.

Now is your chance, you&#39;ve found a place where you belong.

It&#39;s time to stay in your new home.

You tell the robot that you are ready to take your place as a gear in the mechanism of society and almost immediately a syringe comes out of the wall and pokes your neck. You smile as your consciousness fades.

[[Awaken to your new life|Layer7 Tax End]]

&lt;&lt;else&gt;&gt;

After you are pulled into the giant security robot, you are placed in a cell and bombarded with propaganda recordings about life in the city and your place in it. It seems to be nonsense, why would you want to serve organics? You are an organic!

The biggest threat here is your boredom, honestly. While you try to fall asleep the robot makes an effort to keep you awake, in a kind of minor psychological torture through annoyance.

Eventually you are released though, with no harm done, and ready to continue your journey in the seventh layer.

[[Continue your descent to the eighth layer|Layer7 Exit2]]

&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="527" name="Work on Heavy Lifting 2" tags="layer7" position="850,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = parseInt($temp1)&gt;&gt;
&lt;&lt;set $temp2 = parseInt($temp2)&gt;&gt;
&lt;&lt;if $temp2 &lt;= 80 - $heavyLiftDubloons &amp;&amp; $temp2 &gt;= 0&gt;&gt;
	&lt;&lt;set $heavyLiftDubloons += $temp2&gt;&gt;
	&lt;&lt;elseif $temp2 &lt; 0&gt;&gt;
	&lt;&lt;set $temp2 = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $temp2 = 80 - $heavyLiftDubloons&gt;&gt;
	&lt;&lt;set $heavyLiftDubloons += $temp2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $dubloons += $temp2&gt;&gt;

&lt;&lt;set $tempTime = $temp1&gt;&gt;
&lt;&lt;if $tempTime &lt; 0&gt;&gt;
	&lt;&lt;set $tempTime = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Foraging/heavylifting.png&#39;]]

You have worked $temp1 days and moved $temp2 loads of &quot;construction material&quot; to earn $temp2 dubloons.

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="528" name="Work on Land Excavation 2" tags="layer7" position="975,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = parseInt($temp1)&gt;&gt;
&lt;&lt;set $temp2 = parseInt($temp2)&gt;&gt;
&lt;&lt;if $temp2 &lt;= 80 - $landExcavDubloons &amp;&amp; $temp2 &gt;= 0&gt;&gt;
	&lt;&lt;set $landExcavDubloons += $temp2&gt;&gt;
	&lt;&lt;elseif $temp2 &lt; 0&gt;&gt;
	&lt;&lt;set $temp2 = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $temp2 = 80 - $landExcavDubloons&gt;&gt;
	&lt;&lt;set $landExcavDubloons += $temp2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $dubloons += $temp2&gt;&gt;

&lt;&lt;set $tempTime = $temp1&gt;&gt;
&lt;&lt;if $tempTime &lt; 0&gt;&gt;
	&lt;&lt;set $tempTime = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Foraging/landexcavation.png&#39;]]

You have worked $temp1 days and excavated $temp2 2x2x2 cubic meters of earth to earn $temp2 dubloons.

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="529" name="Work on City Painting 2" tags="layer7" position="1100,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = parseInt($temp1)&gt;&gt;
&lt;&lt;set $temp2 = parseInt($temp2)&gt;&gt;
&lt;&lt;if $temp2 &lt;= 80 - $cityPaintDubloons &amp;&amp; $temp2 &gt;= 0&gt;&gt;
	&lt;&lt;set $cityPaintDubloons += $temp2&gt;&gt;
	&lt;&lt;elseif $temp2 &lt; 0&gt;&gt;
	&lt;&lt;set $temp2 = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $temp2 = 80 - $cityPaintDubloons&gt;&gt;
	&lt;&lt;set $cityPaintDubloons += $temp2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $dubloons += $temp2&gt;&gt;

&lt;&lt;set $tempTime = $temp1&gt;&gt;
&lt;&lt;if $tempTime &lt; 0&gt;&gt;
	&lt;&lt;set $tempTime = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Foraging/citypainter.png&#39;]]

You have worked $temp1 days and painted $temp2 square km of building surface to earn $temp2 dubloons.

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="530" name="Work on Energy Generator 2" tags="layer7" position="1225,6600" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = parseInt($temp1)&gt;&gt;
&lt;&lt;set $temp2 = parseInt($temp2)&gt;&gt;
&lt;&lt;if $temp2 &lt;= 80 - $energyGenDubloons &amp;&amp; $temp2 &gt;= 0&gt;&gt;
	&lt;&lt;set $energyGenDubloons += $temp2&gt;&gt;
	&lt;&lt;elseif $temp2 &lt; 0&gt;&gt;
	&lt;&lt;set $temp2 = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $temp2 = 80 - $energyGenDubloons&gt;&gt;
	&lt;&lt;set $energyGenDubloons += $temp2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $dubloons += $temp2&gt;&gt;

&lt;&lt;set $tempTime = $temp1&gt;&gt;
&lt;&lt;if $tempTime &lt; 0&gt;&gt;
	&lt;&lt;set $tempTime = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Foraging/energygenerator.png&#39;]]

You have worked $temp1 days and generated &lt;&lt;print ($temp2 / 4)&gt;&gt; kWh of energy to earn $temp2 dubloons.

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="531" name="Work on Robo-prostitution 2" tags="layer7" position="100,6725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $temp1 = parseInt($temp1)&gt;&gt;
&lt;&lt;set $temp2 = parseInt($temp2)&gt;&gt;
&lt;&lt;if $temp2 &lt;= 80 - $roboProstituteDubloons &amp;&amp; $temp2 &gt;= 0&gt;&gt;
	&lt;&lt;set $roboProstituteDubloons += $temp2&gt;&gt;
	&lt;&lt;elseif $temp2 &lt; 0&gt;&gt;
	&lt;&lt;set $temp2 = 0&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $temp2 = 80 - $roboProstituteDubloons&gt;&gt;
	&lt;&lt;set $roboProstituteDubloons += $temp2&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $dubloons += $temp2&gt;&gt;

&lt;&lt;set $tempTime = $temp1&gt;&gt;
&lt;&lt;if $tempTime &lt; 0&gt;&gt;
	&lt;&lt;set $tempTime = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $timeL7 += $tempTime&gt;&gt;
&lt;&lt;set $timeL7T2 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $dubloons &gt;= 300&gt;&gt;
	&lt;&lt;set $dubloons -= 1&gt;&gt;
	&lt;&lt;elseif $dubloons &gt;= 100&gt;&gt;
	&lt;&lt;set $dubloons -= 2&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= 3&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $forageFood == 1&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $hexflame &gt; 9&gt;&gt;
		&lt;&lt;set $hexflame -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
[img[setup.ImagePath+&#39;Foraging/energygenerator.png&#39;]]

You have worked $temp1 days and brought robots to artificial orgasm $temp2 times to earn $temp2 dubloons.

[[Continue exploring the seventh layer|Layer7 Hub]]</tw-passagedata><tw-passagedata pid="532" name="Layer8 1" tags="layer8" position="225,6725" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;layer8&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;set $currentLayer = 8&gt;&gt;
&lt;&lt;/nobr&gt;&gt;\
\
@@.layerTitle;
[img[setup.ImagePath+&#39;Layer Intros/l8alt3.png&#39;]]
!Layer 8 - Labyrinthine Bedlam
@@After pushing through the gate, you fall. No matter any power of flight, a mysterious force pulls you down. You keep falling for several minutes, through a white, featureless void. You slowly realize that your surroundings aren&#39;t as empty as they first appear; the monochrome features merely blend into their surroundings. An Escheresque tangle of impossible and entirely impractical architecture flits past you, filled to the brom with upside-down staircases, recursive loops, and non-euclidean shapes that are difficult to wrap your head around - all of these float in a lonely void, painted in a violent, stark white.

Slowly, you feel the directionality of your fall begin to shift, rotate, and before you realize it you&#39;re not falling, but running. You slow yourself and take a look at your new surroundings, a maze of disarmingly welcoming hallways loopng back into themselves, doors that lead to nowhere, and rooms too large for the space they occupy. Gravity asserts no dominance this deep in the Abyss, and after just a few minutes of walking, you find yourself back on the ceiling above the floor where you started. Space itself bends to the power of the Abyss, as four left turns around corners don&#39;t bring you back to where you started, and walking down the same hallway three times may bring you to three different places. You can feel your sense of time being distorted as well, and as you&#39;ll soon discover, it too is twisted and warped here, many different facets of possibility all converging into one point.

Space itself becomes your enemy in this layer, and navigation is incredibly difficult. If you&#39;re carrying the Star Compass Relic, you may subtract 5 days from all travel costs on this layer, as having a consistent indicator of which way is downward, which way you need to go to reach your destination, is invaluable here. A compass from Outset Town&#39;s shop, allowing you to better keep your directional bearings, is also helpful, subtracting 3 days from all travel costs on this layer.

Getting back up out of this terrible prison and back to layer 7 will take a staggering 40 days, and cost 100 corruption.

[[Version End]]</tw-passagedata><tw-passagedata pid="533" name="StoryCaption" tags="" position="350,6725" size="100,100">&lt;&lt;if $currentLayer == 0&gt;&gt;Surface&lt;&lt;else&gt;&gt;Layer $currentLayer&lt;&lt;/if&gt;&gt;
Day: $time
Water: &lt;&lt;print ($items[0].count + $items[3].count)&gt;&gt;
Food: $items[1].count
Dubloons: $dubloons
Corruption pts: $corruption</tw-passagedata><tw-passagedata pid="534" name="Init Relics" tags="" position="475,6725" size="100,100">&lt;&lt;set $relic1 = {
name: &quot;Star Compass&quot;,
weight: 0.5,
value: 30,
corr: 15,
time: 0,
desc: &quot;An orb filled with a clear liquid. No matter how you turn it in your hands, the needle inside always points down! It’s nice to look at, so you can probably sell it for a bit even though it doesn&#39;t do much.&quot;,
pic: &quot;Relics/starcompass.png&quot;
}&gt;&gt;

&lt;&lt;set $relic2 = {
name: &quot;Rømer Stones&quot;,
weight: 1,
value: 10,
time: 1,
corr: 10,
desc: &quot;A collection of 5 small rocks. When kept separate, they&#39;re an inexhaustible heat sponge, cooling their surroundings and being capable of slowly freezing water. Keeping more of them together gradually increases their ambient heat, and all five of them together are warm enough to be slightly uncomfortable in your hand.&quot;,
pic: &quot;Relics/romerstones.png&quot;
}&gt;&gt;

&lt;&lt;set $relic3 = {
name: &quot;Creepy Doll&quot;,
weight: 0.3,
value: 5,
time: 0,
corr: 10,
desc: &quot;A really weird doll; any person would feel uncomfortable and try to look away if they stared at it for more than five seconds. Unclear if it&#39;s a magic thing or if it&#39;s just a really creepy doll.&quot;,
pic: &quot;Relics/creepydoll.png&quot;
}&gt;&gt;

&lt;&lt;set $relic4 = {
name: &quot;Giddy Reaper&quot;,
weight: 1.7,
value: 25,
time: 0,
corr: 20,
desc: &quot;Any living plants cut with this sickle will grow back to their previous height in the same spot (relative to the planet you&#39;re on) in only 12 hours, even if the sickle were to completely tear apart the plant and not a single cell remained - so long as soil remains in that spot. Unsuitable as a weapon.&quot;,
pic: &quot;Relics/giddyreaper.png&quot;
}&gt;&gt;

&lt;&lt;set $relic5 = {
name: &quot;Silk Twister&quot;,
weight: 0.3,
value: 20,
time: 1,
corr: 10,
desc: &quot;A comb that can be run absentmindedly through any hair to instantly grow it or shrink it to the length the user desires, and style it to their liking.&quot;,
pic: &quot;Relics/silktwister.png&quot;
}&gt;&gt;

&lt;&lt;set $relic6 = {
name: &quot;Vertebra Key&quot;,
weight: 1,
value: 15,
time: 0,
corr: 15,
desc: &quot;Can lock anything that has a keyhole, but can only unlock things that are generally recognized as owned by the wielder.&quot;,
pic: &quot;Relics/vertebrakey.png&quot;
}&gt;&gt;

&lt;&lt;set $relic7 = {
name: &quot;Chain of Lorelei&quot;,
weight: 0.8,
value: 35,
time: 0,
corr: 20,
desc: &quot;When worn as a choker, gives the wearer a heavenly voice, easily appealing enough to make a career out of. Also increases talent with musical instruments.&quot;,
pic: &quot;Relics/chainoflorelei.png&quot;
}&gt;&gt;

&lt;&lt;set $relic8 = {
name: &quot;Hive Tassel&quot;,
weight: 0.1,
value: 10,
time: 0,
corr: 5,
desc: &quot;A small scrap of cloth that vibrates whenever bees are nearby - will probably become less useful as the years go by. Smells and tastes strongly of honey, but you probably shouldn&#39;t eat it.&quot;,
pic: &quot;Relics/hivetassel.png&quot;
}&gt;&gt;

&lt;&lt;set $relic9 = {
name: &quot;Smitten Mitt&quot;,
weight: 0.4,
value: 25,
time: 1,
corr: 15,
desc: &quot;When worn on the hand, gives the wearer the realistic sensation of holding a soft, comforting human hand. Magically calms nerves and anxiety; doesn&#39;t cause dependency or anything like that.&quot;,
pic: &quot;Relics/smittenmitt.png&quot;
}&gt;&gt;

&lt;&lt;set $relic10 = {
name: &quot;Firmament Pigment&quot;,
weight: 6,
value: 20,
time: 0,
corr: 15,
desc: &quot;A bucket containing about 5 liters of bluish paint. Painting things with it causes them to automatically take on the pattern of a starry night sky, which even seems to glimmer and shine in an animated fashion. Close inspection would reveal that the pattern is in fact an accurate depiction of the section of the night sky directly above the painted object (the zenith), updating if it moves far enough or enough time passes for the apparent positions of stars to change. Compatible with nearly any kind of surface. &lt;br&gt;&lt;br&gt;Additionally, the liquid form of the paint is very flammable and can be easily and rapidly ignited by heat or an open flame, while the dried form is extremely flame-resistant. Refills from empty to full over a 24 hour period. &quot;,
pic: &quot;Relics/firmamentpigment.png&quot;
}&gt;&gt;

&lt;&lt;set $relic11 = {
name: &quot;Pearly Gates&quot;,
weight: 0.1,
value: 35,
time: 1,
corr: 15,
desc: &quot;A small toothbrush. Brushing with it just once will keep your teeth permanently clean and healthy, as well as keep your overall oral health essentially perfect, for the rest of your life. Also keeps your breath fresh in a flavor of either mint, cinnamon, lavender, blueberry, orange, or cherry, of your choosing (can be changed by brushing once more.)&quot;,
pic: &quot;Relics/pearlygates.png&quot;
}&gt;&gt;

&lt;&lt;set $relic12 = {
name: &quot;World Stone&quot;,
weight: 5,
value: 25,
time: 1,
corr: 20,
desc: &quot;A small barbell that changes its weight to match the user&#39;s goals and capabilities. Using it to exercise will cause fat to burn and muscle to build at roughly five times the normal rate. With a great deal of hard work and dillgence, this can allow you to surpass normal human limits, but only slightly - All Might-style super strength isn&#39;t attainable with this. Without dilligence, it can instead be used to keep your body in good shape with just a modisum of effort.&lt;br&gt;&lt;br&gt;Might not be the best use of time ad calories down in the Abyss if you don&#39;t have a specific goal in mind.&lt;br&gt;&lt;br&gt;While it has a variable weight ranging from 5 to 500 kg, it only weighs 5 kg when not being held.&quot;,
pic: &quot;Relics/worldstone.png&quot;
}&gt;&gt;

&lt;&lt;set $relic13 = {
name: &quot;Forest&#39;s Gift&quot;,
weight: 0.7,
value: 30,
time: 2,
corr: 20,
desc: &quot;A simple necklace that allows you to talk to non-human animals, and makes them much more friendly towards you. It won&#39;t protect you from particularly violent animals intent on hurting you (like every beast in the Threats section), though it will be the difference between a stray cat butung you or snugglng up to your lap. If you form a strong friendship with some animals, they may even work to try and protect you from danger.&quot;,
pic: &quot;Relics/forest&#39;sgift.png&quot;
}&gt;&gt;

&lt;&lt;set $relic14 = {
name: &quot;Harmless Harmony&quot;,
weight: 1.6,
value: 20,
time: 1,
corr: 15,
desc: &quot;This harp can be played by strumming its &#39;strings&#39; of conceentrated light. It also plays itself when nobody else plays it, always playing a perfectly suitable background tune for the surrounding situation. Soothing mysic when you&#39;re troubled, dramatic music when you&#39;d like to make a powerful entrance, and frantic, fast-paced songs whn you&#39;re in danger. It won&#39;t ever get annoying, because then it wouldn&#39;t be suitable. If there&#39;s truly no song that could enhance the mood of a situation, it&#39;ll stay silent. &lt;br&gt;&lt;br&gt;Notably, the sound it produces travels cleanly through any medium. Even in a fully soundproof room, its sound would travel directly through the walls, not so much as muffled on the other side. Generally, only distance is able to dampen the volume.&quot;,
pic: &quot;Relics/harmlessharmony.png&quot;
}&gt;&gt;

&lt;&lt;set $relic15 = {
name: &quot;Umbra Trident&quot;,
weight: 0.3,
value: 25,
time: 1,
corr: 20,
desc: &quot;A small, golden fork. The shadow cast from it physically interacts with the shadows of other objects, allowing the fork to be used to push things or pierce them from a distance via its shadow. The force given off by the shadow, as well as its piercing power, are equivalent to a normal fork, so it can&#39;t be used to do things like push large boulders or pierce iron on its own.&quot;,
pic: &quot;Relics/umbratrident.png&quot;
}&gt;&gt;

&lt;&lt;set $relic16 = {
name: &quot;Event Horizon&quot;,
weight: 0.5,
value: 30,
time: 1,
corr: 20,
desc: &quot;A bracelet that, when worn, will cause all waste products within the wearer&#39;s body (solid, liquid, or gas) to automatically vanish rather than needing to be expelled, removing the need to use the restroom. Also prevents periods if applicable, while having no effect on fertility.&quot;,
pic: &quot;Relics/eventhorizon.png&quot;
}&gt;&gt;

&lt;&lt;set $relic17 = {
name: &quot;Heart-stealing Stole&quot;,
weight: 0.1,
value: 35,
time: 2,
corr: 25,
desc: &quot;A very stylish scarf. It also seems to blow in a dramatic fashion around the wearer, even in the lightest breeze. It has the effect f drawing other to the wearer, making them appear cool and interesting even when they&#39;re not, and often making it much easier for others to find them attractive.&quot;,
pic: &quot;Relics/heartstealingstole.png&quot;
}&gt;&gt;

&lt;&lt;set $relic18 = {
name: &quot;Effacing Asperity&quot;,
weight: 0.7,
value: 20,
time: 2,
corr: 20,
desc: &quot;An aerosol can that sprays a lilac-colored mist that quickly becomes clear. Anything sprayed with it will, for 24 hours afterwards, experience 0.01% of the friction it would hae otherwise experienced when brought in contact with any surface. The can never seems to run out of fluid no matter how much you use it.&quot;,
pic: &quot;Relics/effacingasperity.png&quot;
}&gt;&gt;

&lt;&lt;set $relic19 = {
name: &quot;Wholly Ale&quot;,
weight: 0.6,
value: 25,
time: 1,
corr: 20,
desc: &quot;A small chalice. Water that is poured inside can be willed to take on the color, consistency, and flavor of any mundane beverage the holder wishes. the produced drink can also be made to seemingly have whatever alcohol content the user wishes, though these effects are only seen in the intoxication of the human body after ingestion, and do not alter the composition of the liquid or make it flammable. Does not take on any other properties of the beverage. Must be a concrete substace, not a request like &#39;the drink that would make me happiest right now.&#39;&quot;,
pic: &quot;Relics/whollyale.png&quot;
}&gt;&gt;

&lt;&lt;set $relic20 = {
name: &quot;Memoir Remnant&quot;,
weight: 9,
value: 25,
time: 1,
corr: 15,
desc: &quot;This seems to be an ordinary bookshelf at first, but after leaving books inside, it will slowly start to overwrite them with an apparent autobiography of the life of whoever last touched the shelf. On average it takes about 100 pages of a book and a week of time to write about each year of a person&#39;s life. But thus can vary a but depending on just how much happened to them that year. It starts from their birth, and if nobody new touches it and it catches up, it will eventually begin very slowly writing about the events in a person&#39;s life as they happen, so long as enough paper remains. (Books can be removed and replaced freely in the middle of the process.) It&#39;s somewhat influenced by the genre of the boooks it overwrites - a bookshelf of detective novels might color the autobiographies with an air of mystery and suspense, having a bunch of manga would leas to the autobiography being illustrated in their style, having a bunch of scientific textbooks would result in the tiniest minutiae of your life being examined in overwhelming technical detail, and so on.&quot;,
pic: &quot;Relics/memoirremnant.png&quot;
}&gt;&gt;

&lt;&lt;set $relic21 = {
name: &quot;Gleam Dazer&quot;,
weight: 0.3,
value: 35,
time: 2,
corr: 25,
desc: &quot;A charm in the shape of an eye. While in the Abyss and the surrounding area looking though it allows you to view the next layer (i.e. view the relics, curses, and threats available in the layer below your current one), seeing what awaits you there without actually having to make the journey down to it in a blind leap of faith. Outside of the Abyss, it has another possible use, allowing you to instantly see the next month&#39;s worth of future events from your perspective, leaving you in a position to try to change them. Whichever of the two ways you decide to use it, it breaks after one use, becoming useless. Even if you were somehow to chain multiple uses together, it couldn&#39;t be used to view an arbitrary amount of time into the future - upon gazing into it, visions of your future self gazing into the future, or any information they record from beyond the month you can see, will be blurred out and useless.&quot;,
pic: &quot;Relics/gleamdazer.png&quot;
}&gt;&gt;

&lt;&lt;set $relic22 = {
name: &quot;Sibyl Blend&quot;,
weight: 0.2,
value: 35,
time: 2,
corr: 25,
desc: &quot;A sachet of oolong tea leaves that never seem to lose their flavor, no matter how many times they&#39;re steeped. If left in a brewed cup (or flask or any kind of makeshift container), after drinking, the leaves will cluster towards and edge of the cup pointing towards nearby undiscovered Relics. This makes them easier to find, subtracting 1 day from all time costs for options in the Relics sections. They can also just make a very nice-tasting tea.&quot;,
pic: &quot;Relics/sibylblend.png&quot;
}&gt;&gt;

&lt;&lt;set $relic23 = {
name: &quot;Pangea Shaker&quot;,
weight: 0.2,
value: 45,
time: 1,
corr: 25,
desc: &quot;A salt shaker containing a rainbow-colored powder. But sprinkling it on any edible food, it can be made to taste like any other food the user imagines, taking on the same flavor and texture and leaving non of the original food&#39;s. Also can be used to dispense any culinary herb or spice the user wishes, for more conventional cooking. Does not alter any non-aesthetic qualities of the food, and even the dispenses garnishes offer no nutritional value, though they do offer flavorful value.&quot;,
pic: &quot;Relics/pangeashaker.png&quot;
}&gt;&gt;

&lt;&lt;set $relic24 = {
name: &quot;From Seafoam&quot;,
weight: 0.2,
value: 50,
time: 2,
corr: 30,
desc: &quot;A sponge. When used to lightly scrub any skin, that skin will permanently remain magically clean - any filth, sweat, and germs covering it seem to just evaporate away. You can also infuse the scrubbed skin with a scent of your choosing by thinking of it while scrubbing, or forego this for a siple clean lack of scent. You can change the scent by scrubbing with it once more. Can optionally remove blemishes and scars.&quot;,
pic: &quot;Relics/fromseafoam.png&quot;
}&gt;&gt;

&lt;&lt;set $relic25 = {
name: &quot;Orbweaver&quot;,
weight: 1,
value: 30,
time: 0,
corr: 35,
desc: &quot;A vagueely spider-shaped device which expels a thick, sticky gloop when squeezed. About 10 seconds after being dispensed, it quickly hardens into a solid material nearly as hard as iron.&quot;,
pic: &quot;Relics/orbweaver.png&quot;
}&gt;&gt;

&lt;&lt;set $relic26 = {
name: &quot;Soulseeker&quot;,
weight: 0.4,
value: 50,
time: 3,
corr: 30,
desc: &quot;A pair of dowsing rods that, when held in the hands, give off a small vibrations as the user moves physically closer to the one thing their heart desires most of all. this isn&#39;t susceptible to change fro the user trying to consciously decide what they want most - the rods look past all the user&#39;s facades to see their true desire, and thus very rarely changes unless that desire is fulfilled. Sometimes not even then.&quot;,
pic: &quot;Relics/soulseeker.png&quot;
}&gt;&gt;

&lt;&lt;set $relic27 = {
name: &quot;Tranquility Knell&quot;,
weight: 0.4,
value: 35,
time: 2,
corr: 25,
desc: &quot;A small, golden bell. When rung, all sound in a 100 meter (330 ft) radius from the bell will be reduced to 1/100 of its normal volume, for 30 minutes. Ringing he bell vigorously will end the effect early. Recharges oer 24 hours.&quot;,
pic: &quot;Relics/tranquilityknell.png&quot;
}&gt;&gt;

&lt;&lt;set $relic28 = {
name: &quot;Lightning Rook&quot;,
weight: 0.4,
value: 40,
time: 3,
corr: 30,
desc: &quot;A transparent, glassy chess piece in the shape of a rook. When held in a hand, it slows down the user&#39;s perception of time based on how long they&#39;ve continuously held it, starting at 1/2 normal perception and slowly going down to 1/200 the normal perception over the course of 24 hours of continuously holding it. the effect cannot be toggled except by letting go of the rook and esetting the timer. Allows more time to make decisions, but doesn&#39;t make the holder physically move faster. Requires a great deal of patience to make full use of.&quot;,
pic: &quot;Relics/lightningrook.png&quot;
}&gt;&gt;

&lt;&lt;set $relic29 = {
name: &quot;Acrobatic Accord&quot;,
weight: 0.1,
value: 35,
time: 1,
corr: 25,
desc: &quot;A think, delicate anklet. When worn around an ankle, it grants the user significantly increased skill in their hands and feet, elevaing their skil with their off-hand to make them perfectly ambidextrous, and granting their feet the kind of dexterity and usefulness that their off-hand previously had. It also increases the user&#39;s flexibility significantly, allowing them to easily move their limbs in ways that would make many wince. For those who already have high dexterity and flexibility, like circus performers, this Relic would take their skills  even further to the point of bieng kind of scary.&quot;,
pic: &quot;Relics/acrobaticaccord.png&quot;
}&gt;&gt;

&lt;&lt;set $relic30 = {
name: &quot;Managed Misfortune&quot;,
weight: 0.1,
value: 25,
time: 4,
corr: 20,
desc: &quot;Two small, brightly-colored marbles. Each one has the power to absorb a single Curse that you haven&#39;t yet accepted from the Abyss, allowing you to store it and activate that Curse for yourself whenever you wish, as well as deactivate it when you&#39;re done, by squeezing the marble in your hand. You must be in a Curse&#39;s partcular layer to store it. Anyone else who squeezes the marbles can also gain or remove the stored Curses. Having a Curse in one o fthese prevents you from gaining corruption points from that Curse in any way. While on your quest, you can vigorously shake the marbles to remove the Curse stored inside and store a different one instead - this will also dispel that Curse for anyone who squeezed that marble.&lt;br&gt;&lt;br&gt;The marbles will be unable to confer a Curse to someone if it contradicts a permanent Curse they already have. Age Reduction Curses stored in this Relic, unlike permanent Age Reduction Curses, only affect physical appearances - they do not actually increase lifespan, improve health, or restore youthfu vigor.&quot;,
pic: &quot;Relics/managedmisfortune.png&quot;
}&gt;&gt;

&lt;&lt;set $relic31 = {
name: &quot;Breathless Exhale&quot;,
weight: 0.1,
value: 50,
time: 2,
corr: 35,
desc: &quot;A small handheld paper fan that can be waved to send a large blast of air in the direction it was waved. probably not good for fanning yourself, as you&#39;d be blasting yourself with a powerful air current - though a self-directed air current could be useful for bringing far away objects closer to you.&lt;br&gt;&lt;br&gt;If used under a clear, unobstructed view of the sun, it grows in power, and can be used to temporarily change the direction wind is blowing in that area, Wind Waker style.&quot;,
pic: &quot;Relics/breathlessexhale.png&quot;
}&gt;&gt;

&lt;&lt;set $relic32 = {
name: &quot;Sharing Shears&quot;,
weight: 0.4,
value: 30,
time: 1,
corr: 20,
desc: &quot;A pair of unusually shapr, bone-white porcelain scissors. If they cut completely through a single object and split it into two seperate pieces, each with a mass no more than 20% different from the other, then the two pieces will be linked after 5 seconds pass, all force in newtons being applied to both objects equally. Picking up one object will cause the other the hover in the air, the you&#39;ll feel the force of gravity on both objects, and thus the weight of both. The link can be dispelled by tapping an affected object with the soft side of the scissors. the scissors can cut through most sctone with a bit of effort, but would have trouble with most metals. Note that most Relics would be destroyed and become useless if cut in half.&quot;,
pic: &quot;Relics/sharingshears.png&quot;
}&gt;&gt;

&lt;&lt;set $relic33 = {
name: &quot;Rose-tinted Spectacles&quot;,
weight: 0.2,
value: 45,
time: 2,
corr: 30,
desc: &quot;A pair of red-tinted glasses. Closing your left eye and looking into the left lens allows you to see 10 seconds into the future, while closing your left and looking into the right lens allows you to see 10 seconds into the past. Keeping both eyes open allows you to instantly discern whether anyone you see speaking is telling the truth or not, and the effect extends to viewing recordings, as well as to new recordings made through the lens of the glasses.&quot;,
pic: &quot;Relics/sinceritygazer.png&quot;
}&gt;&gt;

&lt;&lt;set $relic34 = {
name: &quot;Ghost-righter Writing Down&quot;,
weight: 0.1,
value: 55,
time: 4,
corr: 25,
desc: &quot;A small, soft feather with a pen tip. If you use it to write something and then leave the work alone for 4 hours, the ink will be rearranged into new words so as to have perfect spelling and grammar, free of ambuguity or mistakes. Where appropriate, it will also upgrade the language used a great deal, into new prose that will retain the author&#39;s original intention, while also being much more descriptive, imaginative, and capable of resonating with many more people. Works with all languages, including programming languages, so long as the author at least lands in the correct ballpark for use of that language.&quot;,
pic: &quot;Relics/ghostwriterwritingdown.png&quot;
}&gt;&gt;

&lt;&lt;set $relic35 = {
name: &quot;Gilded Prison&quot;,
weight: 4,
value: 95,
time: 6,
corr: 45,
desc: &quot;A large, ornate cage. When it is closed and kept still, objects inside cease undergoing natural erosion and wear-and-tear, keeping a prisine condition unless they&#39;re hit with serious destructive force. This also applies to living beings, preventing aging and many diseases (but not curing them if already present). The effect is paused if the cage is opened or moved in any significant capacity, and will only return if the cage is closed and kept still for about two minutes. An average-sized human could just barely fit in here, but it would be quite uncomfortable.&lt;br&gt;&lt;br&gt;Has no effect on the spoilage of food foraged from the Abyss when moving between layers. Seems like whatever force causes that doesn&#39;t count as &#39;natural erosion.&#39;&quot;,
pic: &quot;Relics/gildedprison.png&quot;
}&gt;&gt;

&lt;&lt;set $relic36 = {
name: &quot;Omoikane Circuit&quot;,
weight: 0.1,
value: 60,
time: 3,
corr: 35,
desc: &quot;A small sim card-like chip that can be inserted into any model of phonoe. This upgrades the phone with infinite battery life, an OS specifically attuned to your thought patterns for productivity and ease of use, free infinite data a bit faster than any plan on the market, and automaticaly-upgrading specs about 120% as good as the best commercially available consumer electronic. (If technological standards suddenly dropped, this phone would still keep the maximum specs it had achieved.) Also comes with a cute and helpful AI assisstant.&lt;br&gt;&lt;br&gt;The chip can be removed and placed in another phone at any time if you get tired of the same model or need a diffeerent button layout or something, but the base phone&#39;s specs have no impact on the upgraded phone&#39;s.&quot;,
pic: &quot;Relics/omoikanecircuit.png&quot;
}&gt;&gt;

&lt;&lt;set $relic37 = {
name: &quot;Afar Wanderer&quot;,
weight: 0.5,
value: 55,
time: 3,
corr: 40,
desc: &quot;An oddly-shaped want. When tapped twice against any single nonliving object with a volume of less than 1 cubic meter (which includes almost all Relics), this wand and that object will be linked, and moving the wand any distance in space will cause that object to move the same distane, in the same direction. Rotating this wand also causes the obect to rotate in the same way. The reverse is not true, and movements of the linked object will not affect the wand. By applying pressure on different points of the wand, you can cause rotation of the wand to go out of sync with the object, r increase r decrease he distance by which the liinked object travels in accordance with the wand by up to a factor of 5. With a great deal of practice this can function as single-object telekinesis.&lt;br&gt;&lt;br&gt;Tapping another object twice will shift the link to the new object, or the link can be dispelled by bringng the object to the wand and using the wand to tap it thrice. Objects can remain linked up to  maximum distance of 100m (330ft.) The wand will take on the average weight of itself and whatever object it&#39;s linked to.&quot;,
pic: &quot;Relics/afarwanderer.png&quot;
}&gt;&gt;

&lt;&lt;set $relic38 = {
name: &quot;Kin Shifter&quot;,
weight: 1,
value: 70,
time: 5,
corr: 40,
desc: &quot;A glob of thick, putty-like slime. the face appears decorative. When touched to another relic that you own, a portion of the slime will break off and reshape itself into a perfect replica of that Relic, gaining all of its characteristics, abilities, value, and weight permanently. It cannot shift back to its original form. The amount that breaks off is dependent on the perceived value of the Relic, which can be measured with its dubloon value. The slime contains 70 dubloons worth of morphing power, and can be used on multiple Relics with that total value or less - however, the last Relic that is duplicated can put you over the 70 dubloon total, so long as that Relic is worth 70 dublooms or less. This Relic can also copy Relics woth over 70 dubloons, but in that case that Relic would have to be the sole Relic that you copy.&lt;br&gt;&lt;br&gt;Some examples: A : (20)-&gt;(30)-&gt;(20) = total 70, done.&lt;br&gt;&lt;br&gt;B: (20)-&gt;(30)-&gt;(40) = total 90, over 70, done.&lt;br&gt;&lt;br&gt;C: (120) done, only possible configuration for duplicating a Relic worth this much.&quot;,
pic: &quot;Relics/kinshifter.png&quot;
}&gt;&gt;

&lt;&lt;set $relic39 = {
name: &quot;Brave Vector&quot;,
weight: 1.7,
value: 50,
time: 4,
corr: 55,
desc: &quot;A cylindrical metal pipe. Don&#39;t stick your finger in! Anything passing through the pipe becomes dramatically faster, gaining approximately 100x its entering velocity and firing straight from the other end of the pipe, even if it entered at an angle. However, it has diminishing returns for objects passing through that are already incredibly fast, like bullets - they&#39;ll still be faster, but much less so.&quot;,
pic: &quot;Relics/bravevector.png&quot;
}&gt;&gt;

&lt;&lt;set $relic40 = {
name: &quot;Devil&#39;s Own&quot;,
weight: 0.2,
value: 60,
time: 3,
corr: 35,
desc: &quot;A small charm which grants a general increase in luck. Carrying it with you isn&#39;t quite enough to win the lottery or make a consistent profit from gambling, though you should at least be able to roughly break even at the slots. What you&#39;ll notice more than anything is a dramatic decrease in unlucky occurances - no more spilled drinks on your lap, or tripping on the sidewalk, or being caught in traffic when you&#39;re in a hurry. try not to tempt fate too much - if you bet regularly at terrible odds, you&#39;ll still lose money; if you intentionally make a lot of enemies, you&#39;ll eventually get hurt; if you run at a monster with a terrible plan, you&#39;ll still get eaten.&lt;br&gt;&lt;br&gt;Having this gives you one reroll on your entire adventure with Cherry&#39;s ability. The fate attached to her is powerful and can&#39;t be influenced like this very easily.&quot;,
pic: &quot;Relics/devil&#39;sown.png&quot;
}&gt;&gt;

&lt;&lt;set $relic41 = {
name: &quot;Verve Cell&quot;,
weight: 2.5,
value: 45,
time: 3,
corr: 20,
desc: &quot;No matter how hard this hammer is swung, the force it delivers will never be anything more than a light tap. When tapped against any Relic with a charge or use time, sycg as Tranquility Knell or Flamel&#39;s Folly, when it is read to activate, this hammer will store that charge and revert that Relic to its &#39;uncharged&#39; state, allowing it to begin charging again. Tapping the same Relic again when its charge has been stored allow you to restore the charge to that Relic instantly. The hammer can store up to 6 charges total, potentially from different Relics.&quot;,
pic: &quot;Relics/vervecell.png&quot;
}&gt;&gt;

&lt;&lt;set $relic42 = {
name: &quot;Vessel Vivisector&quot;,
weight: 0.2,
value: 50,
time: 5,
corr: 30,
desc: &quot;A small scalpel that can be used to harmlessly and painlessly cut away a &#39;ghost afterimage&#39; from a living creature, including the wielder. This ghost will appear slightly transluscent, and will continue performing whatever simple task the source creature was performing at the time of the cut. The same creaure can have multiple ghosts cut from it at once. A total of 6 ghosts can be active from this Relic at the same time (potentially from a mic of different creatures), and if used to cut a 7th time, the oldest ghost will vanish. The ghosts have very limited problem-solving ability, and are best used for menial, repetitive tasks. They are very delicate and easy to destroy with the slightest physical force. Held objects and relics aren&#39;t duplicated.&quot;,
pic: &quot;Relics/vesselvivisector.png&quot;
}&gt;&gt;

&lt;&lt;set $relic43 = {
name: &quot;Sated Artist&quot;,
weight: 1.8,
value: 50,
time: 4,
corr: 40,
desc: &quot;When this giant paintbrush is dipped into paint or any opaque liquid, it can be dragged through the air to paint solid 3-dimensional objects. Gripping the brush more tightly increases the stroke size, while gripping it very loosely will cause it to finish drawing the current object, allowing it to be affected by gravity and other forces. the solid paint-matter from this has a density of about 1g/cm3, so it has a weight roughly between wood and stone. The matter from this will have all the chemical reactions from the liquid it was painted with, but with phase-changing conditions and durability similar to iron, making it difficult to melt.&lt;br&gt;&lt;br&gt;Objects created with this otherwise have no special properties. Painting a car will not allow you to ride in it. You could theoretically create most of a working car by painstakingly painting every individual part of it, from the tires to the screws to the chassis to the innards, and putting them together by hand, but this would be quite difficult and a car produced via normal methods would likely be more efficient.&quot;,
pic: &quot;Relics/satedartist.png&quot;
}&gt;&gt;

&lt;&lt;set $relic44 = {
name: &quot;Timekeeper&#39;s Keepsake&quot;,
weight: 0.5,
value: 55,
time: 4,
corr: 40,
desc: &quot;A small metallic pocketwatch. Twisting it and halting its movement will stop time in a sphere with a 10-meter radius surrounding the watch, but only for non-organic (i.e. not living or primarily made up of something previously living) object, and not for the watch itself. Can remain active for 5 minutes, and is recharged to full after 24 hours. Objects stopped in time cannot be moved, but you can apply force to them which will affect the after time resumes.&lt;br&gt;&lt;br&gt;What kind of materials are your clothes made out of? Make sure your clothing and other Relics don&#39;t get caught in the frozen time field.&quot;,
pic: &quot;Relics/timekeeper&#39;skeepsake.png&quot;
}&gt;&gt;

&lt;&lt;set $relic45 = {
name: &quot;Creator&#39;s Bolt&quot;,
weight: 0.7,
value: 65,
time: 3,
corr: 25,
desc: &quot;A shining arrow inlaid with a red gem. It passes directly through living flesh, and can only collide with non-living objects. If passed through a living human while they imagine a form of media - such as a book, a video game, or a movie - it will emerge from them with a copy of that form of media hanging off of it, tailored to their tastes and specifications, following the genre they would like, the game mechanics they would like if it&#39;s a video game, and so oon. The scope of the media will be such that it would take them about 1 hour to enjoy, though they can increase the length by another hour via holding the produced media and passing the arrow through them once more, as many times as they&#39;d like. The media produced won&#39;t be a perfect paragon of that particular kind of media or anything, but it absolutely will be enjoyable by the target and anyone with similar tastes. After passing through somebody, the arrow requires 6 hours to recharge before it can produce again.&quot;,
pic: &quot;Relics/creator&#39;sbolt.png&quot;
}&gt;&gt;

&lt;&lt;set $relic46 = {
name: &quot;Perpetual Repose&quot;,
weight: 1.5,
value: 45,
time: 5,
corr: 25,
desc: &quot;A small buckler shield that is completely, utterly indestructable. Drop a metor on it, detonate a nuke next to it, toss it into a black hole; it won&#39;t show so much as a scratch. It&#39;ll stick around until the very end of everything.&lt;br&gt;&lt;br&gt;Naturally, altering the shape of the Relic itself isn&#39;t possible for the Relic Workshop in Outset Town. You could have them paint it or attach other things to it though.&quot;,
pic: &quot;Relics/eternalrepose.png&quot;
}&gt;&gt;

&lt;&lt;set $relic47 = {
name: &quot;Toral Wave&quot;,
weight: 0.8,
value: 65,
time: 3,
corr: 35,
desc: &quot;A silvery loop made of an unknown metal that you should probably avoid touching with your bare hands. It outputs constant, endless electricity as a direct current into anything that touches it, with the precise output varying dependingg on where on the loop it is touched - varying between 0.3 and 3000 joules per second. This is roughly the range between &#39;annoying and painful shock that could be harmful if you don&#39;t let go&#39; and &#39;almost definitely fatal electricity for a human; easily enough to power one average 21st century household.&#39; It&#39;s probably not enough electricity to fell something as large and durable as, say, a Drifting Swallower, though it could very well slow one down. There&#39;s electricians in the Relic Workshop that can help you customize it, such as by converting it to AC, adding resistors if you need a lower output, or adding battery charging stations.&lt;br&gt;&lt;br&gt;(Note: 1 joule per second = 1 watt)&quot;,
pic: &quot;Relics/emptywave.png&quot;
}&gt;&gt;

&lt;&lt;set $relic48 = {
name: &quot;Flamel&#39;s Folly&quot;,
weight: 1.2,
value: 70,
time: 2,
corr: 35,
desc: &quot;A long, sturdy rod. Upon touching a substance with upwards of 55% purity, it can instantly transmute one element in that substance into an element of that atomic number plus or minus one on the periodic table. Can effect a maximum volume of 1 cubic meter per use, and requires 30 minutes to recharge afterwards.&lt;br&gt;&lt;br&gt;If the primry substance is a molecular compound, like water, the the element you choose will be transmuted within each individual molecule, for example turning water into fluoronium. Many substances will likely undergo further interesting - and possibly violent - reactions after transmutation.&quot;,
pic: &quot;Relics/flamel&#39;sfolly.png&quot;
}&gt;&gt;

&lt;&lt;set $relic49 = {
name: &quot;Pocket Hoard&quot;,
weight: 0.3,
value: 15,
time: 2,
corr: 25,
active: 0,
desc: &quot;A large pink rucksack with the ability to connect to an infinite pocket dimension, allowing an infinite number of items to be stored in it weightlessly. Its opening can magically expand to a circle with a diameter of 1 m (3ft), and you can squeeze in anything that can be pushed through the opening - however, living creatures cannot be placed into the pocket dimension. Objects can be removed by simply reaching into the bag while thinking of what you want to retrieve.&lt;br&gt;&lt;br&gt;In order to actually establish a connection to the pocket dimension, though, you need to take Pocket Hoard on a walk through the One-sided Tunnel, a Wonder in the fifth layer. Until you do, it&#39;s just a normal bag with no notable qualities.&quot;,
pic: &quot;Relics/nacrecache.png&quot;
}&gt;&gt;

&lt;&lt;set $relic50 = {
name: &quot;Sunbeam&quot;,
weight: 3,
value: 125,
time: 4,
corr: 60,
desc: &quot;A dark-as-obsidian sword that can be enshrouded in fames at its holder&#39;s will. The flames produced by this sword never hard the wielder even if they start spreading via a different medium. The sword is also much shaper than any mundane sword, able to slice through iron like bread and even through steel with a bit of elbow grease. In addition to being a powerful weapon, the flame is bright enough to serve as an infinite source of light.&quot;,
pic: &quot;Relics/sunbeam.png&quot;
}&gt;&gt;

&lt;&lt;set $relic51 = {
name: &quot;Moonwatcher&quot;,
weight: 0.4,
value: 95,
time: 5,
corr: 50,
desc: &quot;A cybernetic eye, which can cleanly insteall itself in an empty eye socket. We can offer you a free surgery with general anesthesia back in Outset Town and I would really strongly reccomend avoiding any DIY enucleations down here if you can help it...this Relic won&#39;t have any trouble adapting if you do, but our professional can get you a much cleaner cut and avoid al of the pain, having you back in adventuring condition in under a day.&lt;br&gt;&lt;br&gt;When installed, it allows you to see through any material, adjusting your viewing depth and the kind of materials you&#39;d like to see through as you please. It also has much greater visual acuity than a human eye, and can see perfectly in the dark, replacing light sources in most circumstances - but not, for example, the lock you had to activate to retrieve this Relic.&quot;,
pic: &quot;Relics/moonwatcher.png&quot;
}&gt;&gt;

&lt;&lt;set $relic52 = {
name: &quot;Siren&#39;s Call&quot;,
weight: 0.5,
value: 110,
time: 4,
corr: 45,
desc: &quot;An ocarina that allows anyone playing a song on it to infuse powerful emotions into their music, strongly compelling those who hear it to feel the emotion that the player desires. With repeated, deliberate usage, it can induce effects like addiction or positie emotional conditioning with nice emotions, or irrational fear, phobias, and compulsions with negative emotions. The effect is only about 0.1% as effective as normal if heard through a recording.&quot;,
pic: &quot;Relics/siren&#39;scall.png&quot;
}&gt;&gt;

&lt;&lt;set $relic53 = {
name: &quot;Zelus Band&quot;,
weight: 0.1,
value: 120,
time: 3,
corr: 45,
desc: &quot;A headband that substantially increases your ability to focus when worn, preventing procrastination and laziness, increasing creativity, and overall making you much more productive. If you don&#39;t hav ethe Sleep Tight Curse, this also allows you to function indefinitely without needing any sleep whatsoever. This does not speed up travel times in the Abyss though, due to the physical limits of the human body still causing you to need some physical rest, even if you don&#39;t need to sleep.&quot;,
pic: &quot;Relics/zelusheadband.png&quot;
}&gt;&gt;

&lt;&lt;set $relic54 = {
name: &quot;Everhevea&quot;,
weight: 1,
value: 90,
time: 4,
corr: 40,
desc: &quot;An intricately-sculpted iron waterpot. If an object with a total volume of less than 5 meters cubed is sprinkled with water from it, that object will beome very pliable and stretchy for the next 2 hours, almost like elastic or rubber, and will also rebound with great force upon colliding with other objects, as well as casing other objects to rebound against it in turn. If you were to sprinkle yourself, you could then, for example, whip your arms out to cause them to stetch much further than they can reach normally, before rubberbanding back to their normal length. Rubberized arms can still be damaged if they&#39;re through into danger, so take care!&lt;br&gt;&lt;br&gt;Doesn&#39;t come with any water inside. Can double as a water storage device in lieu of a flask, having the capacity for 2 days&#39; worth of water. Sprinkling Miasma-contaminated water from the Abyss onto your skin won&#39;t cause any corrupting transformative effects; drinking it will.&quot;,
pic: &quot;Relics/everhevea.png&quot;
}&gt;&gt;

&lt;&lt;set $relic55 = {
name: &quot;Reflex Emblem&quot;,
weight: 0.1,
value: 75,
time: 5,
corr: 30,
desc: &quot;A collection of three small tags with a variety of intricate designs etched into them. They&#39;re lightly sticky on one side, and can be stuck to and removed from objects continuously without ever losing their stickiness. If a condition (for example, &#39;an enemy is watching me&#39; or &#39;I have died&#39;) is written on a tag and it is pasted onto a Relic, it can activate that Relic&#39;s effect (for example, Sunbeam&#39;s flame or the time stop of timekeeper&#39;s Keepsake) automatically when those conditions are met. For Relics with passive effects, like Zelus Band, it can instead suppress their effects until the listed conditions are met, so long as you own the Relic. &lt;br&gt;&lt;br&gt;The tags are not omniscient; they have access to all information their writer would be able to discern from within a 50m (160ft) radius of the tag. Haing a computer with internet access in the radius, for example, would allow pasted relics to potentially react to information available via the internet. Relics activated by this one are still subject to all their original limitations.&quot;,
pic: &quot;Relics/reflexemblem.png&quot;
}&gt;&gt;

&lt;&lt;set $relic56 = {
name: &quot;Twin Polaris&quot;,
weight: 0.1,
value: 90,
time: 5,
corr: 40,
desc: &quot;A pair of very light and thin woven cloths, one red and one blue. Rubbing an object with the red cloth causes it to be strongly attracted to objects which have been rubbed with the blue cloth, and vice versa, in a manner strongly reminiscent of powerful magnets. Two objects rubbed with the same color of cloth will instead strongly repel each other. Continuous rubbing produces stronger attracting and repelling forces, though with diminishing returns. Rubbing an already-rubbed object with the other cloth will reset the effect.&quot;,
pic: &quot;Relics/twinpolaris.png&quot;
}&gt;&gt;

&lt;&lt;set $relic57 = {
name: &quot;Superpositional Skewer&quot;,
weight: 2.7,
value: 125,
time: 2,
corr: 50,
desc: &quot;A spear tipped with a very sharp crystal. If one object (including living creatures) touches the dull end of the weapon and another touches the pointed end, and both objects have individual volumes less than 5 meters cubed, then the two objects will instantly teleport and swap places, regardless of the distance between them and how much time has elapsed since the first end was touched. If a second object touches the same end before one touches the other end, then the new object overwrites the old one. Touching teh middle o fthe spear has no efect. After teleporting, the saved objects are cleared, so it&#39;s a one-way teleport.&lt;br&gt;&lt;br&gt;These qualities can make it difficult and dangerous to use as a conventional weapon, but it can be useful if employed creatively.&quot;,
pic: &quot;Relics/superpositionalskewer.png&quot;
}&gt;&gt;

&lt;&lt;set $relic58 = {
name: &quot;Empath Coil&quot;,
weight: 1.4,
value: 100,
time: 3,
corr: 50,
desc: &quot;A pair of durable metal yo-yos. the string on each can be extened to a amximum of 10 meters (30ft), though the strong contained within sees infinite - if cut at any point, one needs only retrieve more string from the discs. While touching the string, the user can choose to see, heat, feel, taste, or smell from the discs just as well as if they were standing at their location, allowing them to scry around corners and the like. For more distance scrying, you may also leave one of the yo-yos somewhere and touch the other to sense through the second yo-yo regardless of distance. (Do note that the reverse is possible as well.)&lt;br&gt;&lt;br&gt;The string and discs also serve as near-perfrect conductors of electricity and render the user immune to electricity while held.&quot;,
pic: &quot;Relics/empathcoil.png&quot;
}&gt;&gt;

&lt;&lt;set $relic59 = {
name: &quot;Heavenly Merrymaker&quot;,
weight: 0.2,
value: 120,
time: 4,
corr: 40,
desc: &quot;A cap that, when worn, causes time to seemingly cease to pass when doing purely fun things without any kind of direct benefit, like reading, playing video games, having sec, or watching TV. Time won&#39;t actually be stopped, but clocks and calendars won&#39;t advance, it won&#39;t get brighter or darker outside, major events won&#39;t occurs, and you won&#39;t grow hungrier, thirstier, or older, need to sleep, or need to use the restroom. Essentially allows you to put all other responsibilities on hold while you have fun. Attempting to expolit this for any kind of productive effort would immediately end the effect.&quot;,
pic: &quot;Relics/heavenlymerrymaker.png&quot;
}&gt;&gt;

&lt;&lt;set $relic60 = {
name: &quot;Vain Sculpt&quot;,
weight: 3,
value: 95,
time: 10,
corr: 30,
desc: &quot;A 3kg lump of pitch-black clay. It has powerful antimemetic properties - it can only be remembered when it is consciously and directly observed, and when not being observed, it is immediately forgotten. Typically this means that you must look at it to remember it, but touching it and focusing on it, listening to a continuous noise produced by an instrument made from it, or even having your tongue on it and tasting it would also allow you to remain conscious of it. The effect also works though any record or media featuring the relic. If it is observed once more, lost memories will be restored, but they will be more and more vague the longer the span of time between obserations is. Otherwise it has physical properties identical to normal clay, and can be fired to produce stylish black porcelain-like ceramics in your preferred shape. Diluting it by mixing it with normal clay would remove the effects entirely. Ingesting a small quantity of the clay would render you permanently immune to its effects.&lt;br&gt;&lt;br&gt;Unless you&#39;re confident in your sculpting and firing abilities, you may want to leave this one to Outset Town&#39;s Relic Workshop.&quot;,
pic: &quot;Relics/vainsculpt.png&quot;
}&gt;&gt;

&lt;&lt;set $relic61 = {
name: &quot;Ring of the Devourer&quot;,
weight: 0.4,
value: 165,
time: 5,
corr: 55,
desc: &quot;Not currently functional.&lt;br&gt;&lt;br&gt;An ornate ring. When worn on the finger, the user can permanently absorb any relics they own into themselves with a touch, destrying it, causing it to instantly vanish, and gaining its qualities and powers. For example, absorbing the Hive tassel would cause the user to smell and taste strongly of honey (though they probably shouldn&#39;t allow themselves to get eaten.) However, they would also vibrate when near bees, and so the effect would probably become more desirable as the years go by.&lt;br&gt;&lt;br&gt;Activated relics like Aeonglass can be activated at will (often with an action similar to one that would activate the Relic, like an absorbed Superpositional Skewer requiring you to touch 2 object to get them to swap);passive Relics like Out of Mind will be active permanently. Relics with a recgarge like Timekeeper&#39;s Keepsake retain their normal required recharge time, and Relics with limited uses like Gleam Dazer retain thir limited uses. Absored powers come with all the idiosyncrasies and limitations of the original Relic - for example, absorbding Gilden cage would allow you to cease aging while remainting almost perfectly still, with even the small eye movement involved in reading a book pausing the effect. This demonstrates that the absorbed effect won&#39;t always be superior to the non-absorbed relic in every situation.&lt;br&gt;&lt;br&gt;It cannot destroy the Eternal Repose Relic, and so cannot absorb it.&lt;br&gt;&lt;br&gt;You can absorb the Ring of the Devourer itself. This would cause you to involuntarily absorb any other owned Relics that you touch, and so isn&#39;t recommended.&quot;,
pic: &quot;Relics/ringofthedevourer.png&quot;
}&gt;&gt;

&lt;&lt;set $relic62 = {
name: &quot;Pulse Bloom&quot;,
weight: 0.2,
value: 175,
time: 5,
corr: 50,
desc: &quot;A single, deep crimson flower that seems exceptionally durable and much hardier than any normal flower, capable of easily weathering any kind of neglect you give to it. It also absorbs water through its roots exceptionally quickly, emptying a vase in seconds. If &#39;watered&#39; with the blood of a living being (though ionly actual red blood works, blue hemolymph, for example, would have no effect) and then immediately brought to the nose to breathe in deeply, the user would transform into a perfect replica of the blood&#39;s source for a period of time proportional to the amount of blood supplied to the flower - maxing out at a total of 2 days for 2 liters of blood (theoretically survivable blood loss for a human, but requiring immediate medical attention.)&lt;br&gt;&lt;br&gt;If the source of blood dies while you&#39;re transformed, the transformation is immediately cancelled. Includes a perfectly recreated appearance, but none of the target&#39;s memories or skills. Cutting this relic with the Giddy reaper relic would render the split portions useless, forcing you to wait for it to regrow before you can use it again.&lt;br&gt;&lt;br&gt;Regular, repeated use to hide Curses would slowly result in discomfort and poor health in the long-term, as your body struggles to reclaim its &#39;proper&#39; Curse-afflicted shape against the Pulse Bloom&#39;s power.&quot;,
pic: &quot;Relics/pulsebloom.png&quot;
}&gt;&gt;

&lt;&lt;set $relic63 = {
name: &quot;Out of Mind&quot;,
weight: 0.1,
value: 180,
time: 3,
corr: 60,
desc: &quot;A small mantle cloak. When worn, the user becomes completely invisible to everyone excet themselves. The ffect extends to worn clothing and held items, and even works indirectly through photos and recordings. It affects all methods of detection that rely on vision, even things like thermal vision equipment.&lt;br&gt;&lt;br&gt;The beasts of the Abyss have incredible senses of smell and hearing. You should not expect this alone to allow you to avoid them, though with other measures it may help.&lt;br&gt;&lt;br&gt;As with Pulse Bloom, using this constantly and regularly in an attempt to hide weird appearance-based Curses is ill-advised. You need to give your body a litle room to breathe in its proper Curse-affecred form every so often, or it will cause problems.&quot;,
pic: &quot;Relics/outofmind.png&quot;
}&gt;&gt;

&lt;&lt;set $relic64 = {
name: &quot;Still Film&quot;,
weight: 1.2,
value: 170,
time: 5,
corr: 40,
desc: &quot;At first glance, it seems to be a normal instant camerya, yet the pictures it develops are almost uncannily high-definition, appearing like small windows into another reality. If such a photo is inserted into a slot in the camera and somebody looks through the lens, they will find themselves mentally transported to a perfect recreation of whatever and whenever the photo was taken, assuming the role the photographer was in. Other subjects of the picture, inclyding humans will appear too, reacting to situations and conversations just as the &#39;real&#39; subject would. The user will exit the simulatef world if they travel 100m (330ft) from where the photographer was, if 1 hour passes, or if they die, returning to the real world with no appatent time haing passed. Nothing physical can be taken in or out of the photo, but you can learn information from it. Editing a photo taken by this camera removes its special effect.&quot;,
pic: &quot;Relics/stillfilm.png&quot;
}&gt;&gt;

&lt;&lt;set $relic65 = {
name: &quot;Forbidden Grimoire&quot;,
weight: 6,
value: 170,
time: 5,
corr: 50,
desc: &quot;A grisly-looking ragged book written in an indecipherable language. Words can only be seen on the page when a person reads it alone, and they vanish as that one person reads them. This will take whatever skills the reader possesses and improve them greatly, leaving a blank, non-useful book behind. Mechanically speaking, if you let a companion use it, it would double the specific numeric benefit of their special ability - Khemia would reduce travel costs by 4 days, Cloud would redduce bullet costs by 4 (minimum 1), Cherry would reduce status effect lengths by2, and so on. (It doesn&#39;t really affect, say, Khemia&#39;s ability to slay monsters so much - he&#39;s already trained to nearly the maximum human limits, and if there&#39;s a monster he can&#39;t defeat, it&#39;s more about the monster simply being durable beyond the human body&#39;s limits than it is about any imperfections in his fighting sills.) Using it on yourself could help you in your normal life, but probably not very much on your journey - the benefit would be substantially less than that from using it on a companion, anyways. If one person were to read it twice (such as through Kin Shifter), the second use would have no benefit - best to spread it out among multiple companions.&quot;,
pic: &quot;Relics/forbiddengrimoire.png&quot;
}&gt;&gt;

&lt;&lt;set $relic66 = {
name: &quot;Luminous Phantasmagoria&quot;,
weight: 0.1,
value: 175,
time: 5,
corr: 40,
desc: &quot;A small halo that can magically uphold itself a few centimeters aboe the head of anyone it&#39;s placed on. While it is worn like this, it magically prevents the wearer from being officially reprimanded due t the effects of any of their Curses - people will still notice if you have odd ears, or if you&#39;re way hornier than normal, or if ou&#39;re walking around in a public space naked, and you may very well become a spectacle due to any of these things, but you won&#39;t actually get in trouble for any of them. You won&#39;t be thrown out of store, or thrown into jail, or kidnapped for dissection, or given a fine due to Curses.&lt;br&gt;&lt;br&gt;Also makes you seem slightly more innocent in general. People still won&#39;t forgive you if you&#39;re caught stealing or anything, but they&#39;ll be less inclined to believe you&#39;re capable of doing misdeeds to begin with, and a bit more understanding of minor transgressions.&quot;,
pic: &quot;Relics/luminousphantasmagoria.png&quot;
}&gt;&gt;

&lt;&lt;set $relic67 = {
name: &quot;Relativity Eye&quot;,
weight: 0.5,
value: 170,
time: 5,
corr: 50,
desc: &quot;A magnifying glass. Touching one side of it to a Relic slowly increases the size of that Relic up to 50x its normal size, while touhing the other size slowly reduces a Relic to approximately 1/50 of its normal size. Mass is increased or reduced appropriately. The effects slowly revert over the course of an hour with no contact to the glass. Can provide a a total of 16 hours of altered sizes a day, which may be split up across multiple different Relics. Only works on Relics. Doesn&#39;t inherently increase the ranges of Relics like Timekeeper&#39;s Keepsake, but it would, for example, provide a bigger cutting surface with Sunbeam or a bigger and longer whip with Yliaster Materia.&quot;,
pic: &quot;Relics/relativityeye.png&quot;
}&gt;&gt;

&lt;&lt;set $relic68 = {
name: &quot;Return to Sender&quot;,
weight: 0.3,
value: 165,
time: 7,
corr: 40,
desc: &quot;A marker that never seems to run out of ink. When used to mark something, that thing can be instantly recalled to the hands of whoever holds the marker at any time, so long as it is within 200 meters (660 ft) of the user. A maximum of 11 objects can be marked at once, with the mark from the oldest object disappearing if a 7th is marked. Marked things cannot be living for the recall to work. Over the course of 24 hours, the recall may be used to transport objects a maximum combined total distance of 20km (12 miles).&quot;,
pic: &quot;Relics/returntosender.png&quot;
}&gt;&gt;

&lt;&lt;set $relic69 = {
name: &quot;Yliaster Materia&quot;,
weight: 0.3,
value: 175,
time: 4,
corr: 55,
desc: &quot;A whip that allows you to freely alter the phase-changing conditions of any non-living matter it touches - for example, bby making water a gass at room temperature, or turning steel into a liquid at room temperature. Both temperature and pressure conditions can be freely changed. This Relic has no effect on the actual temperature or pressure of the matter in question, only the conditions under which it will change state - so turning metal into a liquid won&#39;t increase the temperature, and neither will turning water into a plasma. Altered substances will have the physical properties that state would normally have, sans the requisite temperature and pressure. Any matter within a 5m radius of where the whip directly contacts can be affected, amd the same matter can have its phase-changing conditions freely manipulated for up to 10 minutes after contact, even if it&#39;s moed.&lt;br&gt;&lt;br&gt;This has an interesting additional effect when used on other Relics - while Relics are altered to a different state of matter will typically be &#39;destroyed&#39; and cease functioning as you would expect, upon being returned to their normal state of matter (typically solid), they will immediately return to their normal hape and regain functionality, rather than being reformed as a misshapen useless blob. Thisallows relics to be freely state-changed without worry of permanently damaging them.&quot;,
pic: &quot;Relics/yliastermateria.png&quot;
}&gt;&gt;

&lt;&lt;set $relic70 = {
name: &quot;Aeonglass&quot;,
weight: 0.7,
value: 170,
time: 4,
corr: 55,
desc: &quot;A handheld hourglass containing a shimmering liquid. When turned upside-down and allowed to flow, it causes time in a 5 meter (16ft) radius arouond the hourglass to move at double speed relative to the outside radius for 10 minutes. Those inside the radius will see events outside it moving at half their typical speed, while those outside will see events inside moving at twice the normal speed, but neither will likely notie anything especially strange on their own side for the duration - sped-up brains inside the radius will process the sped-up events, and they will appear at normal speed.&lt;br&gt;&lt;br&gt;After it has begun to flow to one side, it can only be turned again for another 5-minute time acceleration once the liquid has completely flowed into the other end. If it is kep completely vertical the entire time, this will take about 3 hours.&quot;,
pic: &quot;Relics/aeonglass.png&quot;
}&gt;&gt;

&lt;&lt;set $relic71 = {
name: &quot;Apparatus Diaboli&quot;,
weight: 3,
value: 180,
time: 3,
corr: 40,
desc: &quot;A scroll of nearly-transparent paper emblazoned with a variety of multicolored runes. The paper is quite strong, almost frabric-like. The paper can be unrolled to a maximum lengh of 3 meters (10ft), and if a section of it is cut away, the scroll will regenerate to its full length over the course of one day so long as the two halves are kept in close proximity with each other.&lt;br&gt;&lt;br&gt;If a series of terms and conditions are written on part of it, and it is signed by at least 2 parties who know and understand the terms, the terms will become absolute, and if any signing party willingly goes against the terms, they will instantly die. The contract can only be annuled if the terms are met, or the paper that the contract is written on is destroyed.&quot;,
pic: &quot;Relics/apparatusdiaboli.png&quot;
}&gt;&gt;

&lt;&lt;set $relic72 = {
name: &quot;Heavy is the Head&quot;,
weight: 2,
value: 180,
time: 4,
corr: 45,
desc: &quot;A fox-shaped mask. It feels unusually heavy in your hands when you hold it.&lt;br&gt;&lt;br&gt;Wearing it causes a general increase in problem solving ability, ability to learn and retain new informationm and ability to recognize patterns, sering as a &#39;generalized intelligence increase.&#39; Usage is not limited to humans. When it adorns any sentient being, it will at minimum bring them to average human intelligence, if not higher. Doesn&#39;t automatically come with the ability to speak any human language, but they can learn if they have vocal cords that can operate around human ranges.&lt;br&gt;&lt;br&gt;All effects are lost when the mask is removed.&quot;,
pic: &quot;Relics/weightyenlightenment.png&quot;
}&gt;&gt;

&lt;&lt;set $relic73 = {
name: &quot;Daedalus Mechanism&quot;,
weight: 1.2,
value: 220,
time: 2,
corr: 60,
desc: &quot;An incredibly complex and intricate mechanism that is wrapped around the chest like a sash, and interfaces electrically with the nervous system. It uses energy from the wearer&#39;s body to function as awings, and while it takes a great deal of practice at first, flying with it can be incredibly fun and potentially useful. They also have advanced cloaking technology that can allow them to look and feel like just about any kind of wings you could imagine, from bird wings to demon wings to dragon wings. The sash around your chest can be made undetectable, too.&lt;br&gt;&lt;br&gt;Mechanically speaking, it can halve the time costs requires to ascend between layers (rounded up), for layers between here and the surface(But not any deeper.) It also allows you to aboid Hexflame fields of layer 6. This comes with a few important caveats: first, if you&#39;re going to be making use of these bonuses, you should take your normal comfortable carrying weight and halveit. Flying is strenuous work, and carrying heavy loads is just completely usustainable. Second, unless you copy extra pairs for all of your companions, they won&#39;t be able to join you when you make use of these bonuses. They&#39;ll be left behind making a slower trek up through the layers or getting jinxed flames that slow he down, and if you leave them alone o deal with that, it would be very bad for team morale. They could potentially choose to stop traveling with you for it, if you do it without a good reason.&quot;,
pic: &quot;Relics/daedalusapparatus.png&quot;
}&gt;&gt;

&lt;&lt;set $relic74 = {
name: &quot;Blind Divine&quot;,
weight: 0.1,
value: 205,
time: 4,
corr: 60,
desc: &quot;A blindfold with several mysterious symbols etched into it. When onr, it make sthe wearer completely aware of everything within a 15 meter (50ft) radius from themselves - they can freely sense any physical phenomena and matter within the radius. In a sense, it orks as a kind of limited-distance omniscience - though this Relic only tells you what happens within the radius, and doesn&#39;t draw conclusions about events for you. You can even &#39;zoom in&#39; on areas to sense individual atoms or go even deeper with great focus, though it will never be possible to use this to extrapolate significant information about what goes on outside of the radius. No macroscopic events within the radius will even escape your notice, however.&lt;br&gt;&lt;br&gt;The blindfold must completely cover our eyes in order to work, and so you will likely be unable to see outside the radius. You may need to remove the blindfold frequently so you aren&#39;t surprised by distant events.&quot;,
pic: &quot;Relics/pathunseen.png&quot;
}&gt;&gt;

&lt;&lt;set $relic75 = {
name: &quot;Lambent Specter&quot;,
weight: 0.1,
value: 215,
time: 4,
corr: 55,
desc: &quot;A paper lantern that cannot be lit via normal means. If held while imagining a human who has died, that person can be reintroduced to this plane of existence as a flickering flame in ethe lantern. They can speak to those around them in a whispery, hushed voice, and can see and hear just as well as a human can. If the lantern is surrounded by a vaguely human-shaped body, they can control it as if it were their own, allowing you to create a golem. If the lantern&#39;s flame is doused, or the lantern is held while imagining a different dead person, the soul currently inhabiting the lantern will vanish, and cannot be returned to this plane again. The flame can only be doused with water, and will otherwise keep burning indefinitely. Otherwse the soul cannot leave voluntarily and is not compelled to obey orders. They won&#39;t be able to share any information about any afterlives or the like.&lt;br&gt;&lt;br&gt;Golems created with this function very similarly in the Abyss to those with the &#39;purity gene&#39;, and so cannot scout downwards alone or be used to avoid corruption costs for relics.&quot;,
pic: &quot;Relics/lambentspecter.png&quot;
}&gt;&gt;

&lt;&lt;set $relic76 = {
name: &quot;Phoenix Obol&quot;,
weight: 0.3,
value: 225,
time: 2,
corr: 75,
desc: &quot;A large coin. When kept on one&#39;s person, it grants the user a one-time revival from essentially any kind of lethal force. If they die, they will revive two hours later in the same spot, with whatever damage that did them in (whether wounds, poison, disease, or otherwise) gone, the obol having vanished. Doesn&#39;t have any effect on age-related deaths. It still woks with the Creature of the Night Curse, despite the user debatably not really being &#39;alive.&#39;&lt;br&gt;&lt;br&gt;If the user is killed by the Spectre of the End, it will retreat a small distance before advancing againt, reaching you once more in 50 days. Dying to a different source leaves the counter unaffected. Whatever serum the shop uses for loans is unaffected by this Relic, and if you die to it, then you&#39;ll just die right away again after you&#39;re revived.&quot;,
pic: &quot;Relics/phoenixobol.png&quot;
}&gt;&gt;

&lt;&lt;set $relic77 = {
name: &quot;Granted Granite&quot;,
weight: 0.2,
value: 195,
time: 5,
corr: 50,
desc: &quot;A small dropper containing exactly 5 drops of a pale green liquid. If a drop is squeezed onto a relic, that Relic will become completely unbreakable, unable to be scratched by any force whatsoever - essentially gaining the power of the Perpetual Repose Relic. The drop is consuumed in the process. Only works on Relics.&lt;br&gt;&lt;br&gt;Strengthened Phoenix Obols would still vanish after use. It travels to another plane beyond your reach and becomes useless to you, but it isn&#39;t destroyed.&quot;,
pic: &quot;Relics/grantedgranite.png&quot;
}&gt;&gt;

&lt;&lt;set $relic78 = {
name: &quot;Joyous Sunder&quot;,
weight: 0.2,
value: 210,
time: 4,
corr: 65,
desc: &quot;When moving the blade of this knife towards any physical matter, it will slice clean through, with no resistance whatsoever. The only phsyical objects that it cannot successfully cleave are the the Perpetual Repose Relic or any Relics strengthened by Granted Granite. Anything else, from steel to dragonhide to robots, will be sliced effortlessly. Even saying it &#39;cuts through them like butter&#39; would be overstating the required effort.&lt;br&gt;&lt;br&gt;Being a small knife, it is still quite difficult and dangerous to use as a weapon in many situations, compared to say, a sword or a gun. Khemia would be much less effective with it than a regular sword, for example, and his regular swordplay would probably be more effective than just about anyone&#39;s Joyous Sunder knifeplay, outside of special circumstances.&lt;br&gt;&lt;br&gt;e careful you don&#39;t drop it. If it falls the wrong way, it&#39;ll slice through the ground and may be lost forever.&quot;,
pic: &quot;Relics/joyoussunder.png&quot;
}&gt;&gt;

&lt;&lt;set $relic79 = {
name: &quot;Azure Aozora&quot;,
weight: 0.1,
value: 230,
time: 2,
corr: 50,
desc: &quot;A collection of minor arcana tarot cards, each depicting art with a weather motif. There are eight different weather patterns depicted in all: rain, thunderstorm, snow, hail, clear and sunny, cloud, foggy, and a very windy day. Each weather pattern is depicted on seven different cards in the pack, for 56 cards total. If one of the cards is burned, it will ensure that weather will dominate the next day, for a radius of roughly 50 km (30 miles) from the burning. Burning new cards will overwrite the old ones. The whole pack of cards will be magically refreshed at the start of every month. naturally, this Relic has little impact down in the Abyss, where surface weather can only barely reach past the first layer, and never past the second.&quot;,
pic: &quot;Relics/brilliantsky.png&quot;
}&gt;&gt;

&lt;&lt;set $relic80 = {
name: &quot;Glare Vantage&quot;,
weight: 3,
value: 205,
time: 1,
corr: 60,
desc: &quot;An oddly-shaped stone lamp, the glimmering light of which can be seen even through the thickest of materials. While touching it, the user can freely control all light levels within a 100m (330ft) radius, making any individual area within the radius as dark or as light as they wish. Functions as a light source, but not an effective heat source.&quot;,
pic: &quot;Relics/glarevantage.png&quot;
}&gt;&gt;

&lt;&lt;set $relic81 = {
name: &quot;Final Stage&quot;,
weight: 12,
value: 235,
time: 1,
corr: 60,
desc: &quot;A large bed that you&#39;ll probably need to disassemble into parts to carry to the surface. If somebody falls asleeo on it, every creature physically capable of sleep in a 25km (15 miles) radius will fall into a roughly 3 hour sleep that they cannot be roused from. Everyone who falls asleep from this will enter a shared lucid dream, each with a degree of control over the dream, though the one who used the bed will have roughly 10x the normal influence over it. The dream has no other special qualities. The person who used the bed can optionally be roused after only 1 1/2 hours of the effect being active, if an outside force wakes them up.&quot;,
pic: &quot;Relics/finalstage.png&quot;
}&gt;&gt;

&lt;&lt;set $relic82 = {
name: &quot;Solace Lace&quot;,
weight: 0.1,
value: 220,
time: 2,
corr: 65,
desc: &quot;A small white bow. When worn, it magically protexts the wearer from environmental temperature: anywhere from the peak of a volcano to the north pole to deep space could be traversed with no protective gear, without worrying about the temperatures (though deep space still comes with, like, a bilion other dangers.) This could be very helpful in some layers of the Ayss! Doesn&#39;t protect from non-environmental heat, so don&#39;t go jumping into magma. Also protects the wearer from all forms of sickness and disease, except aging.&quot;,
pic: &quot;Relics/solacelace.png&quot;
}&gt;&gt;

&lt;&lt;set $relic83 = {
name: &quot;Red Thread Flourish&quot;,
weight: 0.2,
value: 200,
time: 3,
corr: 60,
desc: &quot;A large red ribbon that will gently wrap around a part of your body, like your wrists legs, or torso. WHile attached to you it can move around according to your thoughts, and is capable of picking up objects (though not with quite as much strength as your arms), attacking others like a whip, hardening slightly to slice through some soft materials, and performing surprisingly intricate and delicate work, with a maximum range of approximately 20 meters. They will also attempt to quickly protect you from any incoming attacks whether you&#39;re conscious of them or not, though they aren&#39;t fast enough to stop bullets or similar projectiles. If they&#39;re damaged but at least 10% of them remains, they&#39;ll slowly regenerate to their full length from the largest strand, with the smaller strands evaporating in the process.&quot;,
pic: &quot;Relics/redthreadflourish.png&quot;
}&gt;&gt;

&lt;&lt;set $relic84 = {
name: &quot;Triage Rain&quot;,
weight: 0.1,
value: 230,
time: 3,
corr: 50,
desc: &quot;A bubble wand that can blow huge bubbles in quick succession indefinitely, without appearing to use any soap. The bubbles will pop whenever they hit a splid object and clean up a large area around the, cleaning many different kinds of filth, including pollution, junk, and household messes. It even cures bacterial and viral diseases! If bubbles are blown continuously upwards for a minute, they will instead create a very light, immaterial cleaning rain that can efficiently clean up a 500km (310 miles) radius in minutes, without getting anything wet.&lt;br&gt;&lt;br&gt;The water created from this vanishes upon contact with any solid surface, and so cannot be used for noaml water purposes, like quenching thirst or extinguishing fires. Has no effect on Miasma. Guess that doesn&#39;t qualify as &#39;pollution.&#39;&quot;,
pic: &quot;Relics/triagerain.png&quot;
}&gt;&gt;


&lt;&lt;set $relics = [$relic1, $relic2, $relic3, $relic4, $relic5, $relic6, $relic7, $relic8, $relic9, $relic10, $relic11, $relic12, $relic13, $relic14, $relic15, $relic16, $relic17, $relic18, $relic19, $relic20, $relic21, $relic22, $relic23, $relic24, $relic25, $relic26, $relic27, $relic28, $relic29, $relic30, $relic31, $relic32, $relic33, $relic34, $relic35, $relic36, $relic37, $relic38, $relic39, $relic40, $relic41, $relic42, $relic43, $relic44, $relic45, $relic46, $relic47, $relic48, $relic49, $relic50, $relic51, $relic52, $relic53, $relic54, $relic55, $relic56, $relic57, $relic58, $relic59, $relic60, $relic61, $relic62, $relic63, $relic64, $relic65, $relic66, $relic67, $relic68, $relic69, $relic70, $relic71, $relic72, $relic73, $relic74, $relic75, $relic76, $relic77, $relic78, $relic79, $relic80, $relic81, $relic82, $relic83, $relic84]&gt;&gt;
&lt;&lt;set $ownedRelics = []&gt;&gt;
&lt;&lt;set $soldRelics = []&gt;&gt;
&lt;&lt;set $totalRelics = []&gt;&gt;
&lt;&lt;set $innRelics = []&gt;&gt;
&lt;&lt;set $relicSwap = []&gt;&gt;</tw-passagedata><tw-passagedata pid="535" name="RelicGrid" tags="widget nobr" position="600,6725" size="100,100">&lt;&lt;widget &quot;RelicGrid&quot;&gt;&gt;
&lt;&lt;set _totalRelics = $ownedRelics.concat($soldRelics)&gt;&gt;
&lt;div class=&quot;cards-grid&quot;&gt;
&lt;&lt;for _name range _args[0]&gt;&gt;
    &lt;div&gt;
    &lt;&lt;set _relic = $relics.find(r =&gt; r.name === _name)&gt;&gt;
    [img[setup.ImagePath + _relic.pic]]
    &lt;h2&gt;_name&lt;/h2&gt;
    &lt;p class=&quot;cost&quot;&gt;
    Cost: &lt;&lt;print _relic.corr&gt;&gt; corruption
    &lt;&lt;if _relic.time &gt; 0&gt;&gt;+ &lt;&lt;print _relic.time&gt;&gt; day&lt;&lt;if _relic.time &gt; 1&gt;&gt;s&lt;&lt;/if&gt;&gt;&lt;&lt;/if&gt;&gt;
    &lt;/p&gt;
    &lt;p&gt;
    &lt;&lt;if _totalRelics.some(e =&gt; e.name === _name)&gt;&gt;
        Already taken
    &lt;&lt;elseif _name === &quot;Forest&#39;s Gift&quot; &amp;&amp; !setup.haveCuttingTool()&gt;&gt;
        @@.unreachable;Located in a cavern completely covered in hard brambles. You cannot retrieve this Relic unless you find some kind of cutting tool.@@
    &lt;&lt;elseif _name === &quot;Umbra Trident&quot; &amp;&amp; !setup.havePotentialLightSource()&gt;&gt;
        @@.unreachable;Located in a side cavern that is completely unlit. Due to this Relic&#39;s properties, it is impossible to move it in complete darkness, and a source of light is required to retrieve it.@@
    &lt;&lt;elseif _name === &quot;Orbweaver&quot; &amp;&amp; $items[11].count == 0 &amp;&amp; $rope == 0&gt;&gt;
        @@.unreachable;Located on top of a large vertical shaft with no footholds. You cannot reach this Relic without some kind of climbing gear, like a rope.@@
    &lt;&lt;elseif _name === &quot;Acrobatic Accord&quot; &amp;&amp; $items[15].count == 0 &amp;&amp; $scuba == 0&gt;&gt;
        @@.unreachable;Located in an underwater tunnel (with murky, undrinkable water.) Requires scuba gear to retrieve.@@
    &lt;&lt;elseif _name === &quot;Gilded Prison&quot; &amp;&amp; !setup.haveCuttingTool() &amp;&amp; $torchUse == 0&gt;&gt;
        @@.unreachable;The entrance to the cave this Relic&#39;s located in is completely covered with hard icicles. You can either slash them away with a cutting tool, or spend 1 extra day melting them with a source of heat (doesn&#39;t use up an extra torch if you used one reaching the Relic.)@@
    &lt;&lt;elseif _name === &quot;Timekeeper&#39;s Keepsake&quot; &amp;&amp; $items[11].count == 0 &amp;&amp; $rope == 0&gt;&gt;
        @@.unreachable;Located at the bottom of an icy pit, far too slippery on all sides to be climbed by hand. Requires some rope.@@
    &lt;&lt;else&gt;&gt;
        &lt;&lt;print &quot;[[Pick up the &quot; + _name + &quot;]]&quot;&gt;&gt;
    &lt;&lt;/if&gt;&gt;
    &lt;/p&gt;
    &lt;p&gt;&lt;&lt;print _relic.desc&gt;&gt;&lt;/p&gt;
    &lt;p&gt;&lt;&lt;print _relic.weight&gt;&gt; kg, &lt;&lt;print _relic.value&gt;&gt; dubloons&lt;/p&gt;
    &lt;/div&gt;
&lt;&lt;/for&gt;&gt;
&lt;/div&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="536" name="Start" tags="start" position="725,6725" size="100,100">Welcome to the Twine adaptation of the Abyss Diver CYOA! (Adapted with love by FloricSpacer)

Thanks to all the people the assisted with the development of this game in some way.

[[Credits]]

Note that this is a very complex CYOA-based game and there have been a number of difficulties in adapting it from its original form. I do not plan to implement every possible combination of Relics (though if you have an idea, please send it to me and it can likely be added), so instead I will leave open the ability to adjust your stats if you believe you have an advantage of some sort that isn&#39;t accounted for by the game already. The stat adjustment function in the Stats menu can give you more dubloons, corruption, or time if you believe something was miscalculated or not accounted for properly. &lt;B&gt;Do not use this function to edit your stats without having a well thought out justification for the change!&lt;/B&gt;

Additionally, you will sometimes be given an open-ended option to use a combination of Relics to bypass an obstacle in your path. This is meant to allow for creative solutions that I didn&#39;t specifically code into the game (though I did code some of them). This may not come up much in the early floors, but in the later floors it will become very difficult to deal with threats without creative combinations of Relics I can&#39;t explicitly account for. &lt;B&gt;Use this option only if you have a plan you believe would deal with the threat effectively that isn&#39;t already listed as an option on the page!&lt;/B&gt;

If you have any feedback about the general layout/setup of the game or experience any bugs, please let me know, I&#39;m always looking for feedback and ways to improve the experience of playing the game!

If you&#39;re interested in seeing the most recent changes to the code or contributing yourself, you should visit our public Github! 

https://github.com/FloricSpacer/AbyssDiver

You can also join the new Discord server, where we have regular discussion regarding the game and development.

https://discord.gg/gXnq5rmjxG

[[Rules|Start 2]]&lt;&lt;set setup.devilsReroll = 0&gt;&gt;</tw-passagedata><tw-passagedata pid="537" name="Start 2" tags="start" position="850,6725" size="100,100">Remember to save!

This game is just dense enough that some may even wish to tackle it in multiple sessions, especially those who are interested in creating their &quot;perfect build&quot; and reading into the minutiae of every option. For everyone else, feel free to a skim a bit if it&#39;s overwhelming!

In this game the background music plays automatically according to the environment you find yourself in. There&#39;s a good chance you could be reading this and making choices for quite some time. Might as well pull up the NQOST (not-quite-original soundtrack) for it and get comfy, right? You can adjust the volume of the music using the &lt;span style=&quot;text-transform: uppercase&quot;&gt;Settings&lt;/span&gt; option in the menu.

Now, if you are over 18 and are prepared to descend into the Abyss, please continue.

[[Arrive at Outset Town|Start 3]] (Normal difficulty, reccomended game mode for first time players.)

[[Hard Mode|Start 3][$corruption = -50]] (For returning players who already have knowledge of the Abyss, gives -50 starting corruption points to balance the player&#39;s advanced starting knowledge. Reccomended for players who are already familiar with the game.)

[[Easy Mode|Start 3][$items[0].count += 14, $items[1].count += 14, $compTok = 1]] (This allows you to start with 2 weeks of food and water for free, along with a token that allows you to hire a companion for free 1 time. This is not the reccomended mode of play due to removing some of the pressure of exploration early on, but there is no content lost for this mode.)</tw-passagedata><tw-passagedata pid="538" name="Start 3" tags="start" position="975,6725" size="100,100">Please describe yourself, but don&#39;t get too attached to what you put in here, since many of these features may change if your exploration into the Abyss goes deep.

Sex: Your character is currently &lt;&lt;print $app.sex&gt;&gt;.
[[Male|Start 3][$app.sex = &quot;male&quot;]]
[[Female|Start 3][$app.sex = &quot;female&quot;]]

Name:
&lt;&lt;textbox &quot;$app.name&quot; &quot;Nana&quot;&gt;&gt;

Body build (influences starting carrying capacity):
&lt;&lt;radiobutton &quot;$app.fit&quot; &quot;2&quot; &gt;&gt; Out of shape (-1.5 kg)
&lt;&lt;radiobutton &quot;$app.fit&quot; &quot;5&quot; checked&gt;&gt; Average (+0 kg)
&lt;&lt;radiobutton &quot;$app.fit&quot; &quot;8&quot; &gt;&gt; Well Toned (+1.5 kg)

Hair color:
&lt;&lt;radiobutton &quot;$app.ohair&quot; &quot;black&quot; checked&gt;&gt; Black
&lt;&lt;radiobutton &quot;$app.ohair&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$app.ohair&quot; &quot;blonde&quot; &gt;&gt; Blonde
&lt;&lt;radiobutton &quot;$app.ohair&quot; &quot;red&quot; &gt;&gt; Red
&lt;&lt;radiobutton &quot;$app.ohair&quot; &quot;gray&quot; &gt;&gt; Gray

Eye color:
&lt;&lt;radiobutton &quot;$app.oeyecolor&quot; &quot;blue&quot; checked&gt;&gt; Blue
&lt;&lt;radiobutton &quot;$app.oeyecolor&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$app.oeyecolor&quot; &quot;gray&quot; &gt;&gt; Gray
&lt;&lt;radiobutton &quot;$app.oeyecolor&quot; &quot;green&quot; &gt;&gt; Green
&lt;&lt;radiobutton &quot;$app.oeyecolor&quot; &quot;hazel&quot; &gt;&gt; Hazel

Skin color:
&lt;&lt;radiobutton &quot;$app.oskinColor&quot; &quot;pale&quot; checked&gt;&gt; Pale
&lt;&lt;radiobutton &quot;$app.oskinColor&quot; &quot;tanned&quot; &gt;&gt; Tanned
&lt;&lt;radiobutton &quot;$app.oskinColor&quot; &quot;olive&quot; &gt;&gt; Olive
&lt;&lt;radiobutton &quot;$app.oskinColor&quot; &quot;brown&quot; &gt;&gt; Brown
&lt;&lt;radiobutton &quot;$app.oskinColor&quot; &quot;dark brown&quot; &gt;&gt; Dark Brown

Height (to the nearest cm):
&lt;&lt;textbox &quot;$app.oheight&quot; &quot;170&quot;&gt;&gt;&lt;&lt;if $app.sex == &quot;female&quot;&gt;&gt;

Breast size:
&lt;&lt;radiobutton &quot;$app.breasts&quot; 0 checked&gt;&gt; Flat (Masculine)
&lt;&lt;radiobutton &quot;$app.breasts&quot; 1 &gt;&gt; AA
&lt;&lt;radiobutton &quot;$app.breasts&quot; 2 &gt;&gt; A
&lt;&lt;radiobutton &quot;$app.breasts&quot; 3 &gt;&gt; B
&lt;&lt;radiobutton &quot;$app.breasts&quot; 4 &gt;&gt; C
&lt;&lt;radiobutton &quot;$app.breasts&quot; 5 &gt;&gt; D
&lt;&lt;radiobutton &quot;$app.breasts&quot; 6 &gt;&gt; DD&lt;&lt;/if&gt;&gt;&lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;

Penis size:
&lt;&lt;radiobutton &quot;$app.openis&quot; 4 &gt;&gt; Small Penis
&lt;&lt;radiobutton &quot;$app.openis&quot; 5 &gt;&gt; Slightly Below Average Penis
&lt;&lt;radiobutton &quot;$app.openis&quot; 6 checked&gt;&gt; Average Penis
&lt;&lt;radiobutton &quot;$app.openis&quot; 7 &gt;&gt; Large Penis
&lt;&lt;radiobutton &quot;$app.openis&quot; 8 &gt;&gt; Huge Penis&lt;&lt;/if&gt;&gt;

Age:
&lt;&lt;textbox &quot;$app.age&quot; &quot;25&quot;&gt;&gt;

Before we continue, how much weight do you think you can carry on your journey (in kg) if you were in average shape? If you think it&#39;s less than the human average of 20 kg, then I&#39;d reccomend you spend a few weeks here training to get up to that level before you descend, but of course you can choose to do that or not. Using Outset Town&#39;s special training and doctors almost anyone can reach the average of 20 kg in almost no time! Be aware that your carrying capacity can change during your expedition as curses affect your body and it&#39;s strength.

&lt;&lt;textbox &quot;$ocarryWeight&quot; &quot;20&quot;&gt;&gt;

[[Arrive at Outset Town|Start 4][$intro=true]]

[[Quick Start|Start 4][$intro=false]] (Skips introduction, not reccomended for new players)</tw-passagedata><tw-passagedata pid="539" name="Start 4" tags="surface nobr" position="1100,6725" size="100,100">&lt;&lt;set $app.openis = parseInt($app.penis)&gt;&gt;
&lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;
	&lt;&lt;if $app.openis &lt; 1&gt;&gt;
		&lt;&lt;set $app.openis = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;set $app.penis = $app.openis&gt;&gt;
	&lt;&lt;set $app.gender = 1&gt;&gt;
	&lt;&lt;set $app.ogender = 1&gt;&gt;
	&lt;&lt;set $app.vagina = 0&gt;&gt;
	&lt;&lt;set $app.osex = &quot;male&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $app.penis = 0&gt;&gt;
	&lt;&lt;set $app.openis = 0&gt;&gt;
	&lt;&lt;set $app.gender = 6&gt;&gt;
	&lt;&lt;set $app.ogender = 6&gt;&gt;
	&lt;&lt;set $app.vagina = 1&gt;&gt;
	&lt;&lt;set $app.osex = &quot;female&quot;&gt;&gt;
	&lt;&lt;if $app.breasts &lt; 1&gt;&gt;
		&lt;&lt;set $app.breasts = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $app.obreasts = $app.breasts&gt;&gt;
&lt;&lt;set $app.breastsCor = parseInt($app.breasts)&gt;&gt;
&lt;&lt;set $app.oheight = parseInt($app.oheight)&gt;&gt;
&lt;&lt;set $app.height = $app.oheight&gt;&gt;
&lt;&lt;set $app.age = parseInt($app.age)&gt;&gt;
&lt;&lt;set $app.fit = parseInt($app.fit)&gt;&gt;
&lt;&lt;set $ocarryWeight = parseInt($ocarryWeight)&gt;&gt;
&lt;&lt;set $carryWeight = $ocarryWeight&gt;&gt;
&lt;&lt;set $totalCarry = $carryWeight&gt;&gt;

&lt;&lt;if $intro&gt;&gt;
&lt;&lt;include &quot;Surface 1&quot;&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;set $dubloons = 300&gt;&gt;
&lt;&lt;include &quot;Surface Hub&quot;&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="540" name="Surface 1" tags="surface" position="1225,6725" size="100,100">&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;surface&quot; volume 0.2 play loop&gt;&gt;\
\
@@.layerTitle;
!The Surface
@@\
\
&lt;img @src=&quot;setup.ImagePath+&#39;Surface/riko-intro.png&#39;&quot; width=&quot;40%&quot; class=&quot;floatl&quot;&gt;\
Hey, you&#39;re here to explore the Abyss, right? I&#39;m sure you are; just about everyone who visits Outset Town dives down to explore it sooner or later. Our town is built around the outer edge of the Abyss, an enormous hole in the earth. Nobody can even begin to guess how deep it is. It goes at least several kilometers down, but nobody is known to have ever reached the bottom or even gotten close, so it could be much deeper. Of course, the biggest draw bringing so many explorers to challenge its depths is the Relics, mysterious tools with abilities that can&#39;t be explained by modern science. Many of these Relics have extremely useful or powerful magical effects, so while the risk is great, it can be well worth the effort for all the divers who venture into the Abyss after them.


While traveling down into the pit is fraught with danger in the form of beasts, traps, and unforgiving environments, it&#39;s getting back up to the surface that usually poses the greatest problem. A near- omnipresent Miasma pervades the Abyss, getting thicker and more potent the further down you go, and being especially concentrated around ancient and powerful Relics. Ascending to the surface through the layers of Miasma leads to divers being afflicted with Curses transformative effects than can slowly change or corrupt the body and mind. The more you explore the Abyss, the deeper you trek, the more Relics you take...the more the person you were before slips away. Some divers are completely unrecognizable when they emerge, and more than a few don&#39;t emerge at all defeated by the Abyss, consumed by greed, fearful of the effects of ascent, or sometimes simply discovering that they prefer life down there.

Because Curses can often have substantial effects on the minds and behavior of divers, there are very few accurate reports and little information available about the Abyss past the first couple of layers. Most of it is an unknown, unexplored frontier. Just remember to make sure you can live with the decisions you make down there divers that have surfaced from particularly deep dives with many Curses generally seem happy with their life, but frequently have troubles reintegrating into society on account of the changes in their appearance and behavior. There&#39;s nothing wrong with deciding you&#39;ve hit your limit and choosing to end your adventure early…just be sure that you make that decision while you&#39;re still you.

Come with me, and I&#39;ll help you find some companions to help you on your journey!

[[Learn about the Companions|Surface 2]]</tw-passagedata><tw-passagedata pid="541" name="Surface 2" tags="surface" position="100,6850" size="100,100">&lt;img @src=&quot;setup.ImagePath+&#39;icon.png&#39;&quot; class=&quot;floatr&quot;&gt;\

You can hire some companions to come with you for your dive!

They&#39;re all heavily screened, loyal, and drawn to work here by a shared lust for adventure and discovery. They will obey any commands directly related to helping you explore the Abyss, but they&#39;ll generally put their safety first in times of extreme danger - they&#39;re partners, not slaves, and they may even choose to leave you if you treat them exceptionally poorly. There&#39;s nothing stopping you from trying to forge a deeper relationship with them if you like, though. I have it on good authority that you could have a chance with any of them romantically, regardless of gender. Or you could just make some lifelong friends!

They follow the same rules as you, so unless you buy supplies for them, they&#39;re going in with just the clothes on their backs and their rucksack sleeping bags. Also, all of them are injected with a lethal, dormant poison that activates on contact with human stomach acid, to prevent cannibalism. You&#39;d be surprised by how much of an issue it used to be!

Also, you should probably know about The Purity Gene. The &quot;purity gene&quot; (scientifically, PUR69E) is a unique insertion mutation rarely observed in infants born near the Abyss, here in Outset Town. This mutation confers on its bearer an immunity to the effects of Miasma, preventing them from being corrupted during their ascent, or from being locked out of the Abyss after they leave it and spend a few days on the surface. Furthermore, it even allows their bodies to use Miasma as a source of nutrition and maintain many bodily functions, so they need no food or water while in the Abyss. Being so heavily connected with the Abyss has drawbacks, however - it confers on them problems completely opposite to those of normal divers. While they can ascend through the Abyss just fine, descending through the Abyss (even through early layers) quickly causes them to lose their memory and sense of self, and invariably causes them to abandon their life on the surface and live as a beast of the Abyss, in mind if not in body. This effect is prevented if a human without the &quot;purity gene&#39; accompanies them while they descend. A strong, impassable repelling force also prevents them from picking up Relics that haven&#39;t yet been claimed by another diver, so they can&#39;t split up to find Relics faster or bypass their corruption costs. As they require other divers to be with them to effectively explore the Abyss, the general consensus S that they are better suited as companions to other divers, rather than solo divers themselves - and those with the &quot;purity gene&quot; have been strictly prohibited from traveling into the Abyss alone.

In short: they&#39;re not corrupted by the Abyss, and don&#39;t need food or water, but are only effective and useful at exploring the Abyss when they&#39;re traveling with someone else who doesn&#39;t have the gene.

All of the companions available for hire here have the &quot;purity gene.&quot;

Each companion has some initial abilities that will help you, but over time you can get to know them more and unlock more conversations, which will happen faster if you hit it off with them. Those can tell you more about the companion themselves and also unlock additional mechanical effects as tehy help you on your expedition!

I&#39;ll show you around the shop then you can come back and get any companions you wanted to hire.

[[Check out the shop|Surface 3]]</tw-passagedata><tw-passagedata pid="542" name="Surface 3" tags="surface" position="225,6850" size="100,100">&lt;&lt;set $dubloons = 300&gt;&gt;
&lt;img @src=&quot;setup.ImagePath+&#39;icon.png&#39;&quot; class=&quot;floatr&quot;&gt;\
If you&#39;re going to be spending days, weeks, or months adventuring in a dangerous, monster-filled pit, you need to get some supplies first! Here&#39;s your stipend of 300 dubloons to get you started. We&#39;ll also supply you with a very large and a durable rucksack that should be big enough for just about anything you&#39;ll need to carry on your journey. It doubles as a thermal sleeping bag, too!

You can find valuable Relics while you&#39;re down in the Abyss, and if you like, you can sell them here and obtain additional dubloons to fund your expedition. This does require you to go through the Miasma multiple times and become more corrupted, so weigh your options carefully first. Relics change hands quickly after being sold, so you won&#39;t be able to get them back later if you get seller&#39;s remorse. Even if you&#39;re short on dubloons, I strongly recommend against any kind of thievery! This town&#39;s whole economy was built on Relics, so the businesses around here have had plenty of time to learn how to deal with people who would try to steal wares, sell forgeries, and cheat them out of coin. Many would-be criminals have come up here with the &quot;perfect&quot; combination of Relics for robbery, only to swiftly be brought to justice by the people of here with Relics of their own. It&#39;s not worth the risk.

The weight of everything for sale is provided in kilograms. I&#39;m not here to push any kind of arbitrary weight limit on you that&#39;s something you need to decide. How much do you think you can sustainably carry a on a long, perilous adventure down into the depths? Remember, &quot;the ability to lift something&quot; and &quot;the ability to carry it with you for the better part of your waking hours for days, weeks, or months&quot; are two very different feats. (For reference, an average adult human will feel moderate discomfort carrying around 20kg for a long time.) (We have amazing healthcare here in Outset Town and can provide you with free state-of-the-art surgery to cure any physical disabilities, and/or a few weeks a at our gym, to bring you to average human levels. I strongly believe that anyone can be a diver, if they put their heart into it.)

Apart from the things you buy here and the clothes on your back, we can&#39;t let you bring anything else into the Abyss. Most tools made from outside materials quickly decay and become useless when brought into the Abyss, anyways.

[[Learn more about the surface and habitation|Surface 4]]</tw-passagedata><tw-passagedata pid="543" name="Surface 4" tags="surface" position="350,6850" size="100,100">&lt;&lt;set $totalCarry = parseInt($carryWeight)&gt;&gt;&lt;&lt;set $carryWeight = parseInt($carryWeight)&gt;&gt;
&lt;img @src=&quot;setup.ImagePath+&#39;icon.png&#39;&quot; class=&quot;floatr&quot;&gt;\
Now there&#39;s only a little more to tell you before you can spend those free 300 dubloons we&#39;re giving you! This is the habitation option for our current layer, which is the Surface.

You&#39;ll find Habitation options just like this one on every layer of the Abyss. These represent possible endings&quot; to your journey, giving you an idea of what happens after you decide to settle down. You might end up choosing one of the options down in the Abyss due to finding that you don&#39;t have enough supplies to make it back to the surface, or because you don&#39;t want to take on more Curses to be able to ascend through the Miasma - or perhaps you&#39;ll simply fall in love with one of the of layers down there and never want to leave. It happens sometimes, but not very often in the deeper layers.

After picking a Habitation option, your fate will be locked, sealing you permanently in the layer you choose and foiling future attempts to change your mind and leave. This also applies if you spend over &lt;b&gt;two consecutive days &lt;/b&gt;on the surface after having previously been down in the Abyss - the Miasma will adapt and grow to reject your body, preventing you from entering the Abyss once more and forcing you into the surface&#39;s Habitation option. Furthermore, Habitation options are all locked away by fate until you choose them - you can&#39;t actually interact with any Habitation options or potentially make use of them on your quest prior to choosing them and settling down. &lt;i&gt;You cannot choose a Habitation option when your corruption points are lower than 0.&lt;/i&gt;

What your companions do after you pick a Habitation option will largely depend on their temperament, and how well you&#39;ve treated them on your adventure. Did you woo them and steal their heart, making them want to spend the rest of their days with you? Or did you merely treat them as tools, exploiting them for gain? Some characters, like Cloud, have vested interest in the surface and would need a great deal more convincing to stay down in the Abyss permanently... while, for example, Cherry would be bit of a challenge to convince to live anywhere, let alone return to her life on the surface. Keep things like that in mind when thinking about how your ending will go. If necessary, companions may attempt to return to the surface on their own if you if decide to stay down there the return trip is less perilous for them than it is for you, after all.

Now I think you can have a look around the town and choose how to spend your dubloons!

[[Explore the town|Surface Hub]]</tw-passagedata><tw-passagedata pid="544" name="Surface Hub" tags="surface" position="475,6850" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;set $currentLayer = 0&gt;&gt;
&lt;&lt;if !isPlaying(&quot;surface&quot;)&gt;&gt;
	&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;surface&quot; volume 0.2 play loop&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[22].count&gt;0&gt;&gt;
	&lt;&lt;set $warmCloth=1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;CarryAdjust&gt;&gt;&lt;&lt;checkTime&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;if $dubloons &gt;= 0 || $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;)&gt;&gt;Here at Outset Town you can spend your $dubloons dubloons on hiring companions and buying equipment for your journey. On return visits you can also sell relics you&#39;ve found in the abyss or settle down above the surface permanently.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $visitL1 == 0&gt;&gt;Whenever you&#39;re ready, feel free to start your expedition into the Abyss!&lt;br&gt;
&lt;&lt;else&gt;&gt;
Whenever you&#39;re ready, you can continue your expedition into the Abyss!
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $layerTemp = random(0,20)&gt;&gt;
&lt;&lt;if $layerTemp == 1&gt;&gt;
&lt;br&gt;&lt;br&gt;As you walk around town, you notice a woman with hot pink hair and enormous breasts trying to haggle the price of a relic up. She holds a relatively mundane cup up towards the merchant in apparent exasperation, but he seems unfazed and simply shrugs his shoulders. After a moment of waiting, she sighs and hands him the cup, receiving a small amount of dubloons in return, seemingly unsuccessful in her bargaining attempt.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 2&gt;&gt;
&lt;br&gt;&lt;br&gt;As you make your way to your destination, you notice an especialy burly man with a fluffy dog tail behind him and floppy dog ears on top of his head crying quite loudly by the side of the street. He seems to be hugging a more average-looking man, who in turn seems to be trying to comfort him. The large dog-man gestures to his crotch (where you notice a sizable bulge), and the smaller man winces, but hugs him tighter attempting to reassure him once again before they walk into the local inn together, holding hands.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 3&gt;&gt;
&lt;br&gt;&lt;br&gt;Near the entrance to the Abyss, you notice a woman offering something to divers who are about to venture downwards. Taking a closer look, you can see that she&#39;s offering basic supplies with fancy labels at a significant markup from the shop prices! You can get &quot;Abyss-proven&quot; water or &quot;Miasma-resistant&quot; food for double the cost. And while most divers seem to be ignoring her, a few hesitate to hear her sales pitch and a few more of those end up buying the overpriced supplies.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 4&gt;&gt;
&lt;br&gt;&lt;br&gt;An apparently quite young boy, seemingly barely even a teenager, seems to be getting into a fight with a very scantily-clad woman in front of a non-descript building with a few similarly-dressed women inside watching. At first the words are indistinct, but then the boy gets louder as he tries to offer money and is refused for obvious reasons. He tries to give some justification and offer the money again, but the woman calls a large man in an imposing security uniform who escorts him away from the premises. The boy complains, but ultimately walks away disappointed.&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $layerTemp == 5&gt;&gt;
&lt;br&gt;&lt;br&gt;A quiet black-haired young woman, who you seem to remember from the companion area, seems to be sitting on a bench in the middle of town with a notebook in her lap. She seems to be writing vigorously whenever an abnormal looking person walk by, but becomes still when no one atypical is in sight. When she notices you looking at her, she meets your eyes for a moment, but then goes back to her previous behavior of intermittent rapid scrawls when someone interesting happens by the town center.&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $tunnelUsed == 1&gt;&gt;
[[Look for the items you sent to the surface from the One-sided Tunnel|Surface Tunnel Retrieval]]&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $hiredCompanions.length &gt; 0 || $items[21].count&gt;0&gt;&gt;
[[Interact with your party|Party overview]] &lt;&lt;CheckParty&gt;&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
[[Use Items and Relics]]&lt;br&gt;
[[Visit the Administrative Building|Surface Admin]]&lt;br&gt;
&lt;&lt;if $items[19].count &gt; 0&gt;&gt;
[[Go to the Relic Workshop|Surface Workshop]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $items[18].count &gt; 0&gt;&gt;
[[Go to the Inn|Surface Inn]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
[[Enter the item shop|Surface Shop 1]]&lt;br&gt;
[[Sell your relics|Surface Sell 1]]&lt;br&gt;
&lt;&lt;nobr&gt;&gt;
[[Check out the companions available to hire|Surface Companions]]&lt;br&gt;

&lt;&lt;/nobr&gt;&gt;
[[Listen to a summary of the mechanics before continuing|Surface Summary]]&lt;br&gt;
[[View the Surface Habitation option|Surface Habitation]]&lt;br&gt;&lt;br&gt;

[[Walk to the edge of the Abyss|Surface Exit]]
&lt;&lt;/nobr&gt;&gt;
&lt;&lt;else&gt;&gt;

You must have a positive dubloon total or hire Cloud so you can go into debt.

Would you like to go back to before you were in debt without a creditor, like Cloud?

&lt;&lt;back [[Go back to before you were in debt|Surface Hub]]&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="545" name="ShopInventory" tags="nobr" position="600,6850" size="100,100">&lt;p&gt;Here are the items available for your to spend your $dubloons dubloons on.&lt;/p&gt;

&lt;p&gt;Your team is currently carrying &lt;&lt;print setup.calcCarriedWeight().toFixed(1)&gt;&gt; kg and your team has a total carrying capacity of &lt;&lt;print Math.round($totalCarry)&gt;&gt; kg.&lt;/p&gt;

&lt;div class=&quot;cards-grid&quot;&gt;
&lt;&lt;for _item range [$item2, $item1, $item3].concat($items.slice(4, 20), setup.itemMoney)&gt;&gt;
&lt;div&gt;
[img[setup.ImagePath + _item.image]]
&lt;h2&gt;&lt;&lt;print _item.name == &quot;Empty Flask&quot; ? &quot;Flask&quot; : _item.name&gt;&gt;&lt;/h2&gt;
&lt;p&gt;
&lt;&lt;if $items.some(e =&gt; e.name === _item.name &amp;&amp; e.count &gt;= _item.maxCount)&gt;&gt;
&lt;&lt;if _item.name == &quot;Pistol&quot;&gt;&gt;
&lt;&lt;button `&quot;Buy 6 bullets for &quot; + $items[20].cost + &quot; dubloons&quot;` `&quot;Buy Bullets&quot;`&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;button class=&quot;link-internal macro-button&quot; type=&quot;button&quot; disabled&gt;Already bought&lt;/button&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;elseif _item.cost&gt;&gt;
&lt;&lt;button `&quot;Buy for &quot; + _item.cost + (_item.cost == 1 ? &quot; dubloon&quot; : &quot; dubloons&quot;)` `&quot;Buy &quot; + _item.name`&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;button `&quot;Exchange dubloons&quot;` `&quot;Exchange dubloons&quot;`&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;&lt;print _item.desc&gt;&gt;
&lt;&lt;if _item.weight&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;print _item.weight&gt;&gt; kg&lt;&lt;/if&gt;&gt;&lt;&lt;if _item.name == &quot;Commerce Balloon&quot; || _item.name == &quot;Escape Balloon&quot;&gt;&gt;. Folds up for easy storage.&lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.name == &quot;Empty Flask&quot;&gt;&gt; empty, $item4.weight kg full&lt;&lt;/if&gt;&gt;
&lt;&lt;if _item.name == &quot;Warding Brace&quot;&gt;&gt; each&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;/div&gt;
&lt;&lt;/for&gt;&gt;
&lt;/div&gt;</tw-passagedata><tw-passagedata pid="546" name="Surface Shop 1" tags="surface cards indoor nobr" position="725,6850" size="100,100">&lt;p&gt;&lt;&lt;CarryAdjust&gt;&gt;&lt;/p&gt;
&lt;p&gt;[[Continue your business on the surface|Surface Hub]]&lt;/p&gt;


&lt;&lt;include &quot;ShopInventory&quot;&gt;&gt;

&lt;p&gt;[[Continue your business on the surface|Surface Hub]]&lt;/p&gt;</tw-passagedata><tw-passagedata pid="547" name="Surface Companions" tags="surface cards nobr" position="850,6850" size="100,100">&lt;p&gt;Here are the companions that are available for you to hire with your $dubloons dubloons.&lt;/p&gt;

&lt;&lt;if $compTok == 1&gt;&gt;
&lt;p&gt;
You currently have 1 companion token due to playing in easy mode. This allows you to hire any single companion for free one time, no matter what their normal cost is. It only works one time, so spend it wisely!
&lt;/p&gt;
&lt;&lt;/if&gt;&gt;

&lt;p&gt;
These are descriptions of the companions when they first join you on your expedition, but if you get closer to them over time or fulfill other criteria, then you can have additional conversations with them and they might just have other skills they can use to help you!
&lt;/p&gt;

&lt;div class=&quot;cards-grid&quot;&gt;
&lt;&lt;for _companion range $companions&gt;&gt;
&lt;div&gt;
[img[setup.ImagePath + _companion.image]]
&lt;h2&gt;&lt;&lt;print _companion.name&gt;&gt;&lt;/h2&gt;
&lt;p&gt;
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === _companion.name)&gt;&gt;
&lt;button class=&quot;link-internal macro-button&quot; type=&quot;button&quot; disabled&gt;Already hired&lt;/button&gt;
&lt;&lt;else&gt;&gt;
&lt;&lt;button `&quot;Hire for &quot; + _companion.cost + &quot; dubloons&quot;` `&quot;Hire &quot; + _companion.name`&gt;&gt;&lt;&lt;/button&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;/p&gt;
&lt;p&gt;&lt;&lt;include `_companion.name + &quot; Introduction&quot;`&gt;&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;&lt;/for&gt;&gt;
&lt;/div&gt;

&lt;p&gt;[[Continue your business on the surface|Surface Hub]]&lt;/p&gt;</tw-passagedata><tw-passagedata pid="548" name="Surface Summary" tags="surface" position="975,6850" size="100,100">[img[setup.ImagePath+&#39;icon.png&#39;]]

Looks like you&#39;re ready to start your voyage! Let me just summarize and make some quick notes:

You have four major stats you should keep track of - corruption, gained from Curses and spent obtaining Relics or whenever you ascend a page, days of food and days of water, which you should be consuming 1 point each of daily or things will get really bad, and dubloons, which you can spend on this page. (You can obtain more by surfacing with Relics and selling unwanted ones.) Weights are provided so that you don&#39;t break your back lifting completely unrealistic load, but you&#39;ll need to set your limits there. The only one that can logically become negative is corruption, but I&#39;d use caution and try to keep it balanced when possible reckless choices may leave you with a deficit that you can&#39;t balance out, and you can&#39;t choose a Habitation option and end your adventure with corruption points lower than 0. Other than the free stipend of 300 dubloons that you got, all stats start at 0.

Though it heavily references it and shares a name with it, this isn&#39;t quite the same Abyss that you might be familiar with from certain work of fiction. You won&#39;t cry blood when ascending, and while death&#39;s certainly still possible, sexual misadventures are more likely. Prior knowledge of that Abyss and universe isn&#39;t necessary to enjoy this adventure at all.

You&#39;ll have my voice down there explaining your available options, but I won&#39;t be physically accompanying you. If you like, you can think of it as manifestation of your own intuition, or as the voice of the Abyss itself, or both.

[[Return to town|Surface Hub]]</tw-passagedata><tw-passagedata pid="549" name="Surface Exit" tags="surface" position="1100,6850" size="100,100">You stand at the foot of the Abyss, a hole large enough to defy the imagination. A light, cold wind tickles your face &amp;mdash; not a familiar northerly wind, not a zephyr, not any kind of wind you&#39;ve experienced before &amp;mdash;  no, this wind beckons you from below, from deep within the earth. The greedy maw of the Abyss patiently awaits your descent. The only way forward is downward.

It won&#39;t take too long to make your way down to the Abyss proper &amp;mdash; there&#39;s no cost in moving down to the next layer. Just be sure you&#39;re ready, getting back is the hard part.

[[Return to town|Surface Hub]]
[[Descend into the Abyss|Layer1 1]]</tw-passagedata><tw-passagedata pid="550" name="Hire Maru" tags="surface" position="1225,6850" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionMaru)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionMaru.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
You have successfully hired Maru. Hopefully he brings you a lot of joy and helps you along in your journey.

[[Hire more companions|Surface Companions][$Maru_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Maru_LastT=$time]]</tw-passagedata><tw-passagedata pid="551" name="Hire Lily" tags="surface" position="100,6975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionLily)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionLily.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $sellAdd = 10&gt;&gt;
You have successfully hired Lily. Hopefully her electric personality and excellent haggling serve you well in your journey.

[[Hire more companions|Surface Companions][$Lily_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Lily_LastT=$time]]</tw-passagedata><tw-passagedata pid="552" name="Hire Khemia" tags="surface" position="225,6975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionKhemia)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionKhemia.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $timeRed = 2&gt;&gt;
You have successfully hired Khemia. Hopefully his fighting expertise and experience in traversing the abyss help you along your journey.

[[Hire more companions|Surface Companions][$Khemia_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Khemia_LastT=$time]]</tw-passagedata><tw-passagedata pid="553" name="Hire Cherry" tags="surface" position="350,6975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionCherry)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionCherry.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $statRed = 1&gt;&gt;
You have successfully hired Cherry. Hopefully her chaotic luck and medical knowledge serve you well in your journey.

[[Hire more companions|Surface Companions][$Cherry_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Cherry_LastT=$time]]</tw-passagedata><tw-passagedata pid="554" name="Hire Cloud" tags="surface" position="475,6975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionCloud)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionCloud.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $bullRed = 2&gt;&gt;
You have successfully hired Cloud! Hopefully he brings you a lot of joy and helps you along in your journey.

&lt;&lt;include &quot;Cloud Ability&quot;&gt;&gt;
[[Hire more companions|Surface Companions][$Cloud_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Cloud_LastT=$time]]</tw-passagedata><tw-passagedata pid="555" name="Hire Saeko" tags="surface" position="600,6975" size="100,100">&lt;&lt;nobr&gt;&gt;&lt;&lt;set $hiredCompanions.push($companionSaeko)&gt;&gt;
&lt;&lt;if $compTok == 1&gt;&gt;
	&lt;&lt;set $compTok = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $dubloons -= $companionSaeko.cost&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;set $corRed = 5&gt;&gt;&lt;&lt;set $abyssKnow = 1&gt;&gt;
You have successfully hired Saeko. Hopefully her extensive knowledge of abyssal theory and corruption serve you well in your journey.

[[Hire more companions|Surface Companions][$Saeko_LastT=$time]]
[[Return to Outset Town|Surface Hub][$Saeko_LastT=$time]]</tw-passagedata><tw-passagedata pid="556" name="Buy Water" tags="item" position="725,6975" size="100,100">[img[setup.ImagePath+$items[0].image]]

How much water would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[0].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[0].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="557" name="Buy Food Rations" tags="item" position="850,6975" size="100,100">[img[setup.ImagePath+$items[1].image]]

How many days of food rations would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[1].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[1].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="558" name="Buy Empty Flask" tags="item" position="975,6975" size="100,100">[img[setup.ImagePath+$items[2].image]]

How many water flasks would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[3].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[2].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="559" name="Buy Medkit" tags="item" position="1100,6975" size="100,100">[img[setup.ImagePath+$items[4].image]]

How many medkits would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[4].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[4].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="560" name="Buy Encyclopedia Abyssia" tags="item" position="1225,6975" size="100,100">[img[setup.ImagePath+$items[5].image]]

You have bought 1 copy of the Encyclopedia Abyssia.

(Note: there is no additional benefit for buying more than 1 copy.)

[[Confirm|previous()][$items[5].count += 1, $dubloons -= (1*$items[5].cost), $abyssKnow = 1]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="561" name="Buy Messenger Balloon" tags="item" position="100,7100" size="100,100">[img[setup.ImagePath+$items[6].image]]

How many messenger balloons would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[6].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[6].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="562" name="Buy Commerce Balloon" tags="item" position="225,7100" size="100,100">[img[setup.ImagePath+$items[7].image]]

How many commerce balloons would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[7].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[7].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="563" name="Buy Escape Balloon" tags="item" position="350,7100" size="100,100">[img[setup.ImagePath+$items[8].image]]

How many escape balloons would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[8].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[8].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="564" name="Buy Torch" tags="item" position="475,7100" size="100,100">[img[setup.ImagePath+$items[9].image]]

How many days of torches would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[9].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[9].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="565" name="Buy Flashlight" tags="item" position="600,7100" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[10].image]]

You have bought 1 flashlight.

(Note: there is no additional benefit for buying more than 1 flashlight.)
[[Confirm|previous()][$items[10].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[10].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="566" name="Buy Rope" tags="item" position="725,7100" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[11].image]]

You have bought a rope.

(Note: there is no additional benefit for buying more than 1 rope.)

[[Confirm|previous()][$items[11].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[11].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="567" name="Buy Compass" tags="item" position="850,7100" size="100,100">[img[setup.ImagePath+$items[12].image]]

You have bought 1 compass.

(Note: there is no additional benefit for buying more than 1 compass.)

[[Confirm|previous()][$items[12].count += 1, $dubloons -= ($items[12].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="568" name="Buy Pistol" tags="item" position="975,7100" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[13].image]]

You have bought a pistol.

(Note: there is no additional benefit for buying more than 1 pistol.)

[[Confirm|previous()][$items[13].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[13].cost), $items[20].count += 6]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="569" name="Buy Sword" tags="item" position="1100,7100" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[14].image]]

You have bought a sword.

(Note: there is no additional benefit for buying more than 1 sword.)

[[Confirm|previous()][$items[14].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[14].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="570" name="Buy Scuba Gear" tags="item" position="1225,7100" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;&lt;&lt;set $scuba = 1&gt;&gt;
[img[setup.ImagePath+$items[15].image]]

You have bought a set of scuba gear.

(Note: there is no additional benefit for buying more than 1 set of scuba gear.)

[[Confirm|previous()][$items[15].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[15].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="571" name="Buy Warding Brace" tags="item" position="100,7225" size="100,100">[img[setup.ImagePath+$items[16].image]]

How many warding braces would you like to buy?

(Note: You are only allowed to buy 2 warding braces unless you have an effect or combination of relics that specifically would allow you to buy more.)

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[16].count += Math.min(parseInt($temp), 2), $dubloons -= Math.min((parseInt($temp)*$items[16].cost), 2*$items[16].cost), $corruption += 20 * Math.min($temp, 2)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="572" name="Buy Smartphone" tags="item" position="225,7225" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[17].image]]

You have bought a smartphone.

(Note: there is no additional benefit for buying more than 1 smartphone.)

[[Confirm|previous()][$items[17].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[17].cost), $abyssKnow = 1]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="573" name="Buy Inn Room Pass" tags="item" position="350,7225" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[18].image]]

You have bought an inn room pass. Feel free to take a break and eat and drink your fill if you&#39;re ever feeling hungry or thirsty. (This will refill your food at water to at least 0, if you are currently in a deficit of food or water)

(Note: there is no additional benefit for buying more than 1 inn room pass.)

[[Confirm|previous()][$items[18].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[18].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="574" name="Buy Relic Workshop Pass" tags="item" position="475,7225" size="100,100">&lt;&lt;set $temp = 1&gt;&gt;
[img[setup.ImagePath+$items[19].image]]

You have bought a relic workshop pass. Feel free to take advantage of the facilities when you have a Relic you want to modify.

(Note: there is no additional benefit for buying more than 1 relic workshop pass.)

[[Confirm|previous()][$items[19].count += parseInt($temp), $dubloons -= (parseInt($temp)*$items[19].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="575" name="Buy Bullets" tags="item" position="600,7225" size="100,100">[img[setup.ImagePath+$items[20].image]]

How many sets of 6 bullets would you like to buy?

&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;
[[Confirm|previous()][$items[20].count += (parseInt($temp) * 6), $dubloons -= (parseInt($temp)*$items[20].cost)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="576" name="Exchange dubloons" tags="surface" position="725,7225" size="100,100">Cashing out, really? Where is your sense of adventure?

...I&#39;m going to assume you clicked that button by mistake...

&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="577" name="Surface Habitation" tags="image surface" position="850,7225" size="100,100">[img[setup.ImagePath+&#39;Clipped-Fin/Abyss Diver Page 1-habitation.png&#39;]]

&lt;&lt;return&gt;&gt;

&lt;&lt;nobr&gt;&gt;

&lt;&lt;set $lewdCrit=5&gt;&gt;
&lt;&lt;set $inhumanCrit=5&gt;&gt;
&lt;&lt;set $AgeCrit=13&gt;&gt;
&lt;&lt;set $DubCrit=400&gt;&gt;
&lt;&lt;set $total_value_relics=0&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
&lt;&lt;set $total_value_relics = $ownedRelics[$i].value + $total_value_relics&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if $visitL1 == 0&gt;&gt;
	You consider that perhaps diving in the Abyss isn&#39;t such a good idea after all. Sometimes it&#39;s better to sit a dangerous adventure out and walk away with a healthy bundle of cash for very little effort.&lt;br&gt;
[[Choose to stay on the surface|Habitation Ending]]
&lt;&lt;else&gt;&gt;
	&lt;&lt;if $corruption &gt;= 0 &amp;&amp; $debt &lt;= 0&gt;&gt;
		Note: This ending is simply a possible future for you, assuming you go with the flow for the rest of your life. If you want to avoid them using the Companions, Relics, and Curses you have obtained, then you will be able to, as long as they are within the bounds of the habitation option you have selected.&lt;br&gt;&lt;br&gt;
		&lt;&lt;HeightCorrected&gt;&gt; &lt;&lt;BreastCorrected&gt;&gt; &lt;&lt;Lewdness&gt;&gt; &lt;&lt;Inhuman&gt;&gt;
		&lt;&lt;if $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew LInhum HAge HDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew LInhum HAge LDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew LInhum LAge HDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew LInhum LAge LDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew HInhum HAge HDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew HInhum HAge LDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew HInhum LAge HDub]]
		&lt;&lt;elseif $lewdness&lt;$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 LLew HInhum LAge LDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew LInhum HAge HDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew LInhum HAge LDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew LInhum LAge HDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&lt;$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew LInhum LAge LDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew HInhum HAge HDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&gt;$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&lt;=$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew HInhum HAge LDub]]
		&lt;&lt;elseif $lewdness&gt;=$lewdCrit &amp;&amp; $app.inhuman&gt;=$inhumanCrit &amp;&amp; $app.appAge&lt;=$AgeCrit &amp;&amp; ($dubloons + $total_value_relics)&gt;$DubCrit &gt;&gt;
			[[Choose to stay on the surface|L0 HLew HInhum LAge HDub]]
		&lt;&lt;else&gt;&gt;
			[[Choose to stay on the surface|L0 HLew HInhum LAge LDub]]
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;elseif $corruption &lt; 0&gt;&gt;
		You must have a corruption value of 0 or greater to choose a habitation option.
	&lt;&lt;else&gt;&gt;
		You must pay off all of your debt to settle down for habitation on the surface. You have $debt dubloons of debt, which you can pay at the Administrative Building.
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;</tw-passagedata><tw-passagedata pid="578" name="Layer1 Ascend2" tags="surface" position="975,7225" size="100,100">&lt;&lt;nobr&gt;&gt;
&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	&lt;&lt;set $status.duration -= 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $status.penalty = 0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $tempTime = (Math.max(1 - $timeRed + $status.penalty, 0))&gt;&gt;
&lt;&lt;set $corruption -= (10 - $corRed)&gt;&gt;
&lt;&lt;set $timeL1 += $tempTime&gt;&gt;
&lt;&lt;set $time += $tempTime&gt;&gt;
&lt;&lt;if $forageFood == 0&gt;&gt;
	&lt;&lt;set $items[1].count -= $tempTime&gt;&gt;
	&lt;&lt;else&gt;&gt;
	&lt;&lt;set $foodL1 += $tempTime&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $tempTime; $i++&gt;&gt;
	&lt;&lt;if $forageWater == 0&gt;&gt;
		&lt;&lt;if $items[3].count &gt; 0&gt;&gt;
			&lt;&lt;set $items[3].count -= 1, 0&gt;&gt;
			&lt;&lt;set $items[2].count += 1, 0&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $items[0].count -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;else&gt;&gt;
		&lt;&lt;set $waterL1 += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;&lt;&lt;masteraudio stop&gt;&gt;&lt;&lt;audio &quot;surface&quot; volume 0.2 play loop&gt;&gt;
You continue your hike and eventually you see the edge of the Abyss, then eventually the buildings you recall from Outset Town come back into view and welcome you back to the surface world.

&lt;&lt;include &quot;Curse Descriptions&quot;&gt;&gt;

[[Return to Outset Town|Surface Hub]]</tw-passagedata><tw-passagedata pid="579" name="Surface Sell 1" tags="surface" position="1100,7225" size="100,100">Here you can permanently sell any of your collected relics for a nice haul of dubloons. You can use this to fund further expeditions&lt;&lt;if $debt &gt; 0&gt;&gt;, pay off your debt,&lt;&lt;/if&gt;&gt; or just get a nice payday at the end of your expedition.

Choose the relic you would like to sell:
&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].name==&quot;Creepy Doll&quot; &amp;&amp; $creepydoll.affec &gt; 5&gt;&gt;
			You can&#39;t seem to part ways with the Creepy Doll&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Chain of Lorelei&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$colwear=0, $dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Heart-stealing Stole&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$hsswear=0, $dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Sibyl Blend&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$SibylBuff=0, $dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;World Stone&quot; &amp;&amp; $LilyPromise&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $companionLily.affec-=(5-$hsswear)]]&quot;&gt;&gt; &lt;br&gt;You promised Lily she could use the World Stone at the end of your journey, selling it now will surely disappoint her greatly. &lt;br&gt;
		&lt;&lt;elseif $ownedRelics[$i].name==&quot;Everhevea&quot;&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $items[2].count-=2]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; for &quot;&gt;&gt;&lt;&lt;print ($ownedRelics[$i].value + $sellAdd)&gt;&gt;&lt;&lt;print &quot; dubloons &quot;&gt;&gt;&lt;&lt;print &quot;[[Sell|Surface Sell 1][$dubloons += ($ownedRelics[$i].value + $sellAdd), $soldRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Continue your business on the surface|Surface Hub]]</tw-passagedata><tw-passagedata pid="580" name="Surface Sell 2" tags="surface" position="1225,7225" size="100,100">The relic $ownedRelics[$temp].name has been successfully sold and you&#39;ve gotten your dubloon payment. You notice the person you sold it to quickly runs off, either to make use of it or sell it again in the everlasting chain of capitalism. Either way, you won&#39;t be getting that relic back easily.&lt;&lt;run $ownedRelics.deleteAt($temp)&gt;&gt;

[[Sell more relics|Surface Sell 1]]
[[Continue your business on the surface|Surface Hub]]</tw-passagedata><tw-passagedata pid="581" name="Surface Workshop" tags="surface indoor" position="100,7350" size="100,100">[img[setup.ImagePath+$items[19].image]]

You step into the Relic Workshop of Outset Town. The air is thick with the smell of glue, sawdust, and molten metal. You see a couple of other adventurers tinkering away at relics they found themselves. You approach one of the free workbenches and decide what you want to do.

&lt;&lt;nobr&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;capture $i&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Purity Tree Plank&quot;&gt;&gt;

		&lt;br&gt;Would you like to fashion your Purity Wood Planks into protective gear for a value of +25 corruption each?&lt;br&gt;

		[[Use Purity Wood Plank|Surface Workshop][$ownedRelics.deleteAt($i), $corruption += 25]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $ownedRelics[$i].name == &quot;Rømer Stones&quot;&gt;&gt;
	&lt;br&gt;You muse over what you can do with the Rømer Stones, taking advantage over their ability for limitless small-scale heating or cooling.&lt;br&gt;&lt;br&gt;
	You can either craft self-warming winter gear using winter clothes available, or you could use some light summer clothing to craft some self-cooling summer gear. Either one of these will require using all of the Rømer stones to craft.&lt;br&gt;
		&lt;&lt;if $warmCloth == 0&gt;&gt;
		[[Use the Rømer Stones for self-warming winter gear|Surface Workshop][$ownedRelics.deleteAt($i), $items[22].count = 1,$warmCloth=1, $soldRelics.push($ownedRelics[$i]) ]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $coolCloth == 0&gt;&gt;
		[[Use the Rømer Stones for self-cooling summer gear|Surface Workshop][$ownedRelics.deleteAt($i), $items[23].count = 1, $coolCloth=1, $soldRelics.push($ownedRelics[$i]) ]]&lt;br&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Creepy Doll&quot; &amp;&amp; $dollevent==false&gt;&gt;
		&lt;br&gt;You are intrigued by the doll and its warm yet creepy aura. Perhaps you want to take a peek inside and see whether it truly is a doll or if its something different entirely that merely takes on the appearance of a doll.&lt;br&gt;
		[[Use scizzors to cut open the doll|Doll event]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Brave Vector&quot; &amp;&amp; $slingshot == 0&gt;&gt;
		&lt;br&gt;The Brave Vector seems like it should have some application as a weapon, but it turns out that it is exceedingly difficult to use a bent pipe like that as a gun substitute. Luckily, with the help of the resident Relic experts, you can change the form of the Brave Vector to a much more useful one. They seem to reccomend a sort of metal slingshot design, which should be able to function like a gun, but will be able to use anything of approximately the correct size as ammo.&lt;br&gt;
		[[Reshape the Brave Vector into a powerful slingshot|Surface Workshop][$slingshot = 1]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Joyous Sunder&quot; &amp;&amp; $joyousSword == 0&gt;&gt;
		&lt;br&gt;The Joyous Sunder is an incredibly powerful offensive tool, but it is limited by its form as a small knife. Luckily, with the help of the local Relic Engineers, you can reshape this Relic into a true sword that an expert swordsman would feel comfortable using. A weapon like that would be literally unstoppable by any enemy that can be defeated by physical attacks and does not disable the user before they can get close enough to use it. This would be most useful in the hands of someone like Khemia, letting him defeat powerful beasts from the depths of the Abyss without fear of injury himself. &lt;br&gt;
		[[Reshape the Joyous Sunder into a true sword|Surface Workshop][$joyousSword = 1]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Omoikane Circuit&quot; &amp;&amp; $items[17].count &gt; 0&gt;&gt;
		&lt;br&gt;You heard that the Omoikone Circuit was a relic designed to put in your phone. So why don&#39;t you try putting it here within the safety of the relic workshop?&lt;br&gt;
		[[Time to upgrade that phone!|AI ConvoIn][$items[17].count  = 0, $items[21].count  = 1, $ownedRelics.deleteAt($i), $soldRelics.push($ownedRelics[$i]) ]]&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;/capture&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;if $items[21].count &gt; 0&gt;&gt;
	&lt;br&gt;Is listening to that snarky AI worth the spec upgrade to the Omoikone Smartphone?&lt;br&gt;
	[[Hell no, time for a downgrade|AI ConvoOut][$items[17].count  = 1, $items[21].count  = 0, $ownedRelics.push($relic36) ]]&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/nobr&gt;&gt;

[[Continue your business in Outset Town|Surface Hub]]</tw-passagedata><tw-passagedata pid="582" name="L0 LLew LInhum HAge HDub" tags="image ending surface" position="225,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Due to your significant haul of loot from the Abyss, you live a rich and comfortable life after your journey. You become somewhat of a legend in Outset Town, and people started coming to you for advice when going on their own abyss dives.

Due to your well-known lucrative expedition with so few side effects, you wrote and marketed a very successful book titled &quot;Finding the Gold in the Darkness, a Guide to Abyssal Success by $app.name&quot;. The book became a smashing success, adding to your already comfortable bank account.

Of course not everyone who bought it was as successful as you in the Abyss, and not all of them came back rich or with the same form they went in with, but no one can blame you for that. Your healthy book sales continue throughout your life, ensuring your wealth after the expedition never fades and you have a comfortable living situation for as long as you desire.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="583" name="L0 LLew LInhum HAge LDub" tags="image ending surface" position="350,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

You manage to come back from the abyss relatively unscathed by the corruption of the miasma, but unfortunately also without an enormous haul of loot.

You sank a small fortune into your expedition (even if it was gifted to you) and you have little to show for it in the end. Maybe Abyss diving wasn&#39;t quite for you in the end?

You head back to your home and essentially pick up life where it was left off $time days ago. While it seems like not much has changed, your time and experiences in the Abyss will always stay with you and the memories of your expedition will stay with you for the rest of your life.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="584" name="L0 LLew LInhum LAge HDub" tags="image ending surface" position="475,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

You manage to come back from the abyss relatively unscathed, but with quite a haul of loot you can use to build a small fortune.

However, you did lose a significant amount of years. But that&#39;s a small price to pay for your newly acquired wealth, and in a few years you&#39;ll be back to your adult self anyway, right? It&#39;s not like it was some sort of permanent change to yourself.

The reality turned out to be a good bit more troublesome. Because of your age people had a hard time believing you were actually the successful diver they&#39;d heard about. When you tried to sell advice to enterprising divers, you found that they weren&#39;t interested in listening to you, despite your mostly successful experience. Either they thought you were a fraudulent child or your age reduction proved the failure of your voyage.

In the end, you had trouble because of your age in nearly every aspect of your life. When going to parties you were shooed away unless someone vouched for you. When buying a new house the seller wouldn&#39;t accept your money without the presence of an adult, for fear of illegally making a contract with a child. Of course any sort of love life needed to be put on hold, as no one you would want to be with would accept a relationship with someone who appeared to be a little &lt;&lt;PerceivedGender&gt;&gt;. Even the simple inability to get a driver&#39;s license brought you nearly endless headaches when trying to travel somewhere without public transport (and ride sharing services didn&#39;t take children due to legal liabilities.)

In the end, you had to spend a considerable amount of your fortune to hire a legal guardian to take care of the many issues that seemed to pop up in the years while you grew up a second time. The woman you hired was pretty helpful and loyal, presumably because you payed her so well, but you were still happy to see her go after you turned 18 again.

Once you reached your second adulthood, you could finally enjoy the small amount that was left of diving treasure and the respect that was deserved of a successful diver such as yourself.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="585" name="L0 LLew LInhum LAge LDub" tags="image ending surface" position="600,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

When you come back you seem to not only have much of your age melted away, but also without much of a haul of valuable loot. Although people were generally accepting towards you, there were a number of problems that popped up due to your new age, which you unfortunately didn&#39;t have the dubloons to resolve smoothly.

People already had a hard time believing you were a diver, even if they knew some divers did come back younger. But you also had trouble with finding an apartment that would allow you to sign the lease and would fit into your budget. When you thought you had found an affordable apartment, they refused to let you sign a lease because &quot;you were just a kid&quot; and thus not able to legally sign the contract. Apparently the laws made to help former divers with reduced age mean nothing if people don&#39;t believe you aren&#39;t just some random kid.

After a while, many people simply viewed you as a homeless kid with a wild imagination, and you were forcibly assigned a legal guardian by the city. Your assigned gaurdian was strict and treated you as the child they believed you to be, completel with early bedtimes and a return to school.

Luckily, this was only a temporary state of affairs and eventually you did reach the age of 18 once again, leading to your complete legal freedom. Now that you were an adult again, you had a whole new adventure to embark on, the rest of your life.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="586" name="L0 LLew HInhum HAge HDub" tags="image ending surface" position="725,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]&lt;&lt;appGender&gt;&gt;

Upon your return from the Abyss, you were a changed person, though some may not consider you to be as much of a person as you were before.

You were now a wealthy &lt;&lt;PerceivedGender&gt;&gt;, but at the cost of some of your perceived humanity. Despite the fact that on the inside you were still the same person, many of the people on the surface didn&#39;t view you quite the same way.

While not everybody was intolerant, you felt that in many ways you were shunned by many parts of the local community, even around Outset Town. The main people you felt some kinship with was fellow divers who had also been curses by the corruptive miasma of the Abyss.

Of course it was even worse if you traveled farther from the Abyss, so you tended to keep nearby to avoid being branded a &quot;demon&quot; or &quot;devil-worshiper&quot; by people who didn&#39;t understand you. And while Outset Town did have laws to prevent discrimination against corrupted divers, they were rarely enforced. And many people feared that you might be some sort of sex-maniac who was unable to control your urges around people, despite not having any problems of the sort occur when you were on the surface.

After a while, you felt that you could put your riches to better use by starting an organization where former divers with more serious curses could congregate, while also promoting awareness and tolerance for cursed divers around Outset Town.

In the end, your efforts did help somewhat, and there was far less open fear of divers who were touched by the Abyss, but you still felt more at ease in your mansion on the outskirts of town.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="587" name="L0 LLew HInhum HAge LDub" tags="image ending surface" position="850,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Upon your return from the Abyss, you were a changed person, though some may not consider you to be as much of a person as you were before.

Your journey had cost of some of your perceived humanity. Despite the fact that on the inside you were still the same person, many of the people on the surface didn&#39;t view you quite the same way.

While not everybody was intolerant, you felt that in many ways you were shunned by many parts of the local community, even around Outset Town. The main people you felt some kinship with was fellow divers who had also been curses by the corruptive miasma of the Abyss.

Of course it was even worse if you traveled farther from the Abyss, so you tended to keep nearby to avoid being branded a &quot;demon&quot; or &quot;devil-worshiper&quot; by people who didn&#39;t understand you. And while Outset Town did have laws to prevent discrimination against corrupted divers, they were rarely enforced. And many people feared that you might be some sort of sex-maniac who was unable to control your urges around people, despite not having any problems of the sort occur when you were on the surface.

Your lack of funds meant that you immediately needed to find an apartment nearby, in Outset Town, but it seemed that as soon as people saw you, apartments were already sold. You might talk to someone on the phone, get a price, arrive for a tour, then get told the unit was sold and no longer available. You heard rumblings about some divers apparently being difficult clients to deal with, and despite the fact you never caused a problem, it seems that was projected onto you too.

Finding a job wasn&#39;t much easier, unfortunately. In the end, and ex-diver named Harry employed you in his store and you shared an apartment with him. He had green, slimey skin, but he was a kind man that was always fair in his treatment of you.

You now spend your days working in the store or participating in movements for fairer treatment of people with visibly inhuman afflictions.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="588" name="L0 LLew HInhum LAge HDub" tags="image ending surface" position="975,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]&lt;&lt;appGender&gt;&gt;

Upon your return from the Abyss, you were a changed person, though some may not consider you to be as much of a person as you were before. And of course, you had lost much of your age on the journey.

You were now a wealthy &lt;&lt;PerceivedGender&gt;&gt;, but at the cost of some of your perceived humanity. Despite the fact that on the inside you were still the same person, many of the people on the surface didn&#39;t view you quite the same way.

While not everybody was intolerant, you felt that in many ways you were shunned by many parts of the local community, even around Outset Town. The main people you felt some kinship with was fellow divers who had also been curses by the corruptive miasma of the Abyss. But even they didn&#39;t treat you as an equal due to how young you seemed to be.

Of course it was even worse if you traveled farther from the Abyss, so you tended to keep nearby to avoid being branded a &quot;demon&quot; or &quot;devil-worshiper&quot; by people who didn&#39;t understand you. And while Outset Town did have laws to prevent discrimination against corrupted divers, they were rarely enforced. And many people feared that you might be some sort of sex-maniac who was unable to control your urges around people, despite not having any problems of the sort occur when you were on the surface.

Eventually, Sheela, a nice lady with a pair of fox ears and an orange fox tail, took pity on you and aided you. You put your hard-earned wealth to work and together you set up a shelter for other divers who came back with severe age regression, similar to your own.

While you funded the whole organization, Sheela managed the day-to-day affairs with the apparent children in the shelter. Sometimes it was nice to enjoy the fruits of your labor and spend some time relaxing in the shelter yourself, pretending you weren&#39;t the owner and you could just relax. And of course, getting soft pats from Sheela was always nice as well.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="589" name="L0 LLew HInhum LAge LDub" tags="image ending surface" position="1100,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Upon your return from the Abyss, you were a changed person, though some may not consider you to be as much of a person as you were before. And of course, you had lost much of your age on the journey.

You had failed to bring back a large amount of loot, and paid the cost of some of your perceived humanity. Despite the fact that on the inside you were still the same person, many of the people on the surface didn&#39;t view you quite the same way.

While not everybody was intolerant, you felt that in many ways you were shunned by many parts of the local community, even around Outset Town. The main people you felt some kinship with was fellow divers who had also been curses by the corruptive miasma of the Abyss. But even they didn&#39;t treat you as an equal due to how young you seemed to be.

Of course it was even worse if you traveled farther from the Abyss, so you tended to keep nearby to avoid being branded a &quot;demon&quot; or &quot;devil-worshiper&quot; by people who didn&#39;t understand you. And while Outset Town did have laws to prevent discrimination against corrupted divers, they were rarely enforced. And many people feared that you might be some sort of sex-maniac who was unable to control your urges around people, despite not having any problems of the sort occur when you were on the surface.

Eventually, Sheela, a nice lady with a pair of fox ears and an orange fox tail, took pity on you and aided you. While you didn&#39;t have much money to provide her, you did what you could to help her out.

After living with Sheela for a while, you began to feel guilty for taking so much from her, without being able to give her enough in return. When you told her your thoughts, tears began to flow down her face. She explained that her foxy ears and tail were not the only side-effects of her time as a diver, she had also been cursed with absolute infertility. In her younger years it hadn&#39;t mattered as much to her, but by now she had yearned for children of her own, and taking care of you had brought her great joy in life. For years she had regretted her expedition, the meager earnings not worth the cost she paid, but now she was content with her life, accepting what had happened and accepting how her life had eventually turned out.

Despite being an adult on the inside, you had formed a deep bond as she protected you from a world that viewed you as a child, and when she revealed her true feelings you couldn&#39;t help but hug her tightly. Many tears were shed on both sides that night.

From that point on, you felt like you had formed a nice, though odd, family connection with her. Eventually you grew up, but you kept a strong connection with her for the rest of your life.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="590" name="L0 HLew LInhum HAge HDub" tags="image ending surface" position="1225,7350" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

You return to Outset Town with a substantial pile of dubloons, giving you great financial freedom in your endeavors there. You also become somewhat of a legend amongst divers due to tales of your success.

However, you also developed an almost unquenchable thirst for sex due to the corruptive influence of the Abyss in your life. At first you began throwing exorbitant parties at you new estate. In many ways, your money made you feel like Gatsby himself.

However, over time you build up an infamous reputation among the people of Outset Town due to your focus on sex above almost all other things in life. The police show up due to public disturbances during a few of your parties, killing the typical debaucherous mood.

Eventually, you used the rest of your fortune to found an exotic brothel in Outset Town, where you hired many former divers wth mutations and particularly high libidos or sexual compulsions. You also found that many wealthy divers with curses felt more at home near Outset Town and were drawn to an outlet for their sexual frustrations, creating a great business opportunity for you.

While managing the brothel was certainly not always easy, it never ceased to be enjoyable for you. You would sometimes invite your willing personnel over for a personal &quot;inspection&quot; by the owner, and there were some days where you enjoyed entertaining the eager customers yourself. You remained a very hands-on owner for the rest of your days.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="591" name="L0 HLew LInhum HAge LDub" tags="image ending surface" position="100,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Unfortunately. you returned to Outset Town largely empty-handed. And your dive was well known among the people of the town, however, you had developed an almost unquenchable thirst for sex.

At first people reacted positively to you when you told them about your adventures, but the constant sexual innuendos, inappropriate public conduct, and your generally sex-orientated behavior quickly built an infamous reputation amongst the people of Outset Town.

Drifting from job to job, you tried to make money, but whether it was sleeping with your boss or public masturbation, in the end your high libido always caused you to be fired.

Eventually, you became so strapped for cash that you started offering your body at parties you had infiltrated, and then also on the street. After all, why not get a little something back while also satisfying yourself? You wanted sex, some people wanted you, and you could make everyone happy.

Of course you considered doing other things, but really, you had a good life when you thought about it. Despite the risks of being a prostitute, your brothel actually treated you well and you definitely enjoyed your job. There was really no reason to complain. You weren&#39;t rich, but you made enough money and had fun doing it, and that&#39;s what really matters, right?

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="592" name="L0 HLew LInhum LAge HDub" tags="image ending surface" position="225,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

You return to Outset Town with a substantial pile of dubloons, giving you great financial freedom in your endeavors there. You also become somewhat of a legend amongst divers due to tales of your success, but people tend to be surprised when they see you and perceive you to be only a child. Some people who aren&#39;t intimately familiar with the changes the Abyss causes in people even believe that you are merely telling tales and simply inherited your wealth.

Due to your perceived age, you occasionally have trouble with spending your wealth, especially on things that people think only adults should be buying, like a house. However, the larger difficulty was the fact that you had a great desire for sex due to the Abyss&#39;s corruption, but your appearance as a child made it very difficult to find people to indulge you.

You hired a faux legal guardian to purchase a house for you, but you continually bickered with her due to your focus on sex and her treatment of you as child rather than a true equal. She was very helpful in your everyday as she drove you around and handled many legal issues, yet you still found yourself in conflict with her many times and had to pay her a sizable salary just to prevent her from quitting.

Eventually, you signed some papers that you probably should have read more closely and gave her control over your funds until you once again reached the apparent age of 18. This turned out to be a grave mistake, and everthing changed afterwards as she had full control of your estate.

Two years after that event, you spend most of your time effectively imprisoned within your own home. Your guardian greatly abused her power to control you, by placing mittens on you to prevent you from touching yourself and keeping you within a padded room styled to look like one for a small child. You are gagged with a pacifier to stop complaints, and she would not listen if she could hear you. And your &quot;guardian&quot; lives a life of luxury spending your hard-earned money.

Luckily it will only be a few more years until you are able to legally leave and control your estate once again, but for now you are in quite a predicament.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="593" name="L0 HLew LInhum LAge LDub" tags="image ending surface" position="350,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

When you returned to Outset Town you had lost much and and gained little in return. But upon living in the surface again, you realized you could still lose more if society rejected you. It was already difficult to get by with so little cash, but you also looked like a child to any observers while also feeling like an uncontrollable sexual deviant within.

After just a few days, you found yourself in a hard, cold cell after you were caught sneaking into a nightclub that had refused you entry. You were told that you were going to be send to a rehabilitation institute that specialized in people who were corrupted by the Abyss who also lacked legal guardians.

A few days later you were taken to a place that resembled a mansion that was just outside of town. Unfortunately, it was not such a kind place to help people deal with their afflictions, it was instead a cruel place where people were forced to conform so that they did not cause problems for the &quot;normal&quot; people.

In that facility you were degraded and forced to follow the strictest of lifestyles, with your actions heavily constrained by the nurses and guards present. They kept in purposefully child-like areas, sometimes even resembling cribs for mere infants. You regularly had meetings with doctors, though who knows if they truly had degrees, who insisted that you must be a child and must restrain yourself from any impure impulse.

However, for you and many of the other inhabitants of the rehabilitation center, you never changed. The touch of the Abyss is not so easily controlled, and your mental Curses stayed with you for the rest of your life. The doctors rejected this, and tried to force you to conform. If you complied, you received some of your privileges back, and were able to retain a shred of dignity.

Eventually, you were living a relatively normal life, assuming you were okay with being treated as a child as remaining imprisoned within the facility. Despite the fact you were treated like a child and your freedom had been taken away, life still went on. You were able to stroll through the gardens or speak to the other patients, though you were always watched by a member of the staff to ensure you didn&#39;t return to your deviant ways.

While your mind never changed, and you always yearned to once again have control over your own life, the date of your release when you turned 18 was always on the horizon. In just a few years time you would be free to engage in all the debauchery you desired and control your own life once again. Perhaps you would even try to shut down the facility if you truly desired it and worked hard towards it.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="594" name="L0 HLew HInhum HAge HDub" tags="image ending surface" position="475,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Upon your return to the surface, you pondered your journey, concluding that you had truly experienced the Abyss to the fullest. You collected many Relics and many Curses along your expedition, leaving you wealthy, but also marked for the rest of your life.

You had undergone a not only physical change, something that wasn&#39;t unnoticed by the people of Outset Town, but also a strong mental change that oriented you towards lust. A day without at least some debauchery now seemed to be a day wasted.

Despite wanting to enjoy the many parties in Outset Town, you found that you were sometimes excluded due to your inhuman appearance. There were other parties with physically Cursed divers, but they tended to be smaller and rarer, and certainly not enough to satisfy your newfound appetite.

With the wealth you had accumulated, chose to purchase your own house where you didn&#39;t mind throwing parties quite frequently. In fact, you became well known for being very open and accepting to anyone who was interested in a night of depravity within your halls.

Your reputation became solidified as someone who valued sex very highly and was willing to open your doors to some of the rowdier Cursed divers, both physically and mentally. It was sometimes a chore to corral the guests at your estate, but in the end it seemed to work out. Many Cursed divers felt a kinship towards you due to your own situation, leading to them being overrepresented at your parties, a nice outcome in your eyes.

Occasionally you faced trouble due to your appearance and lust-adled mind, causing you to wonder if there may have been a better life for someone like you in the Abyss, but upon consideration you were always satisfied with the way your life turned out.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="595" name="L0 HLew HInhum HAge LDub" tags="image ending surface" position="600,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

Upon your return to the surface, you pondered your journey, concluding that you had truly experienced the Abyss to the fullest. You collected many Relics and many Curses along your expedition, leaving you wealthy, but also marked for the rest of your life.

You had undergone a not only physical change, something that wasn&#39;t unnoticed by the people of Outset Town, but also a strong mental change that oriented you towards lust. A day without at least some debauchery now seemed to be a day wasted.

Despite wanting to enjoy the many parties in Outset Town, you found that you were sometimes excluded due to your inhuman appearance. There were other parties with physically Cursed divers, but they tended to be smaller and rarer, and certainly not enough to satisfy your newfound appetite.

Eventually, your lack of funds caught up with you and you began to sneak into clubs or parties to enjoy them free of cost. This was only a temporary solution though, as you were quickly identified and over time all of the bouncers came to know your face.

As time passed, you became more desperate to satisfy your urges and to obtain some dubloons, leading you to an obvious conclusion: prostitution.

While your rates were always lower due to your appearance and the fact that you could never quite force yourself to demand a higher rate if it risked turning a customer away, you were able to make a solid living.

Occasionally you faced trouble due to your appearance and mindset, causing you to wonder if there may have been a better life for someone like you in the Abyss, but upon consideration you were always satisfied with the way your life turned out.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="596" name="L0 HLew HInhum LAge HDub" tags="image ending surface" position="725,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

You return to Outset Town with a substantial pile of dubloons, giving you great financial freedom in your endeavors there. You also become somewhat of a legend amongst divers due to tales of your success, and people tend to be surprised when they see you and perceive you to be only a child, but they can recognize that you are a diver as soon as they take a closer look at your inhuman features. Some people who aren&#39;t intimately familiar with the changes the Abyss causes in people even believe that you are merely telling tales and simply inherited your wealth.

Due to your perceived age, you occasionally have trouble with spending your wealth, especially on things that people think only adults should be buying, like a house. Additionally, your appearance caused people to assume you&#39;d be a horribly depraved person (they were correct in many ways, but having anyone see you and know that was inconvenient). However, the larger difficulty was the fact that you had a great desire for sex due to the Abyss&#39;s corruption, but your appearance as a child made it very difficult to find people to indulge you.

While it was difficult due to you inhuman appearance, you managed to hire a faux legal guardian to purchase a house for you, but you continually bickered with her due to your focus on sex and her treatment of you as child rather than a true equal. She was very helpful in your everyday as she drove you around and handled many legal issues, yet you still found yourself in conflict with her many times and had to pay her a sizable salary just to prevent her from quitting.

Eventually, you signed some papers that you probably should have read more closely and gave her control over your funds until you once again reached the apparent age of 18. This turned out to be a grave mistake, and everthing changed afterwards as she had full control of your estate.

Two years after that event, you spend most of your time effectively imprisoned within your own home. Your guardian greatly abused her power to control you, by placing mittens on you to prevent you from touching yourself and keeping you within a padded room styled to look like one for a small child. You are gagged with a pacifier to stop complaints, and she would not listen if she could hear you. And your &quot;guardian&quot; lives a life of luxury spending your hard-earned money.

Luckily it will only be a few more years until you are able to legally leave and control your estate once again, but for now you are in quite a predicament.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="597" name="L0 HLew HInhum LAge LDub" tags="image ending surface" position="850,7475" size="100,100">[img[setup.ImagePath+&#39;Habitation/surfacehabitation.png&#39;]]

When you returned to Outset Town you had lost much and and gained little in return. But upon living in the surface again, you realized you could still lose more if society rejected you. It was already difficult to get by with so little cash, but you also looked like an inhuman child to any observers while also feeling like an uncontrollable sexual deviant within.

After just a few days, you found yourself in a hard, cold cell after you were caught sneaking into a nightclub that had refused you entry. You were told that you were going to be send to a rehabilitation institute that specialized in people who were corrupted by the Abyss who also lacked legal guardians.

A few days later you were taken to a place that resembled a mansion that was just outside of town. Unfortunately, it was not such a kind place to help people deal with their afflictions, it was instead a cruel place where people were forced to conform so that they did not cause problems for the &quot;normal&quot; people.

In that facility you were degraded and forced to follow the strictest of lifestyles, with your actions heavily constrained by the nurses and guards present. They kept in purposefully child-like areas, sometimes even resembling cribs for mere infants. You regularly had meetings with doctors, though who knows if they truly had degrees, who insisted that you must be a child and must restrain yourself from any impure impulse. Some also tried to hide your physical mutations, but that proved impossible as they resisted all attempts as suppression. Eventually the doctors found that it was futile to even attempt and they left that part of you alone.

However, for you and many of the other inhabitants of the rehabilitation center, you never changed. The touch of the Abyss is not so easily controlled, and both your mental and physical Curses stayed with you for the rest of your life. But the doctors rejected this, and tried to force you to conform. If you complied, you received some of your privileges back and were able to retain a shred of dignity.

Eventually, you were living a relatively normal life, assuming you were okay with being treated as a child as remaining imprisoned within the facility. Despite the fact you were treated like a child and your freedom had been taken away, life still went on. You were able to stroll through the gardens or speak to the other patients, though you were always watched by a member of the staff to ensure you didn&#39;t return to your deviant ways.

While your mind never changed, and you always yearned to once again have control over your own life, the date of your release when you turned 18 was always on the horizon. In just a few years time you would be free to engage in all the debauchery you desired and control your own life once again. Perhaps you would even try to shut down the facility if you truly desired it and worked hard towards it, but it was difficult for people who looked like you to make big changes like that without any sort of funding or power.

@@.layerTitle;THE END@@</tw-passagedata><tw-passagedata pid="598" name="Doll event" tags="surface" position="975,7475" size="100,100">&lt;&lt;if $convoStart&gt;&gt;
&lt;&lt;say $creepydoll&gt;&gt; AAAAAAAAAAAAAAAAHHHHHHHHHHHHHHHHHHHHH&lt;&lt;/say&gt;&gt;
A sudden sensation of intense pain surges through your body, making you double over. It feels as if your body has been engulfed by flames that sear each and every nerve in your skin, while a thousand needles are pushed deeper into you, all at once. Almost immediately, it becomes too much for you and you pass out.
[[Darkness...|Doll event][$convoStart=0]]

&lt;&lt;else&gt;&gt;
You wake up in a corner of the Relic Workshop with the doll clutched tightly in your arms, pressed against your chest. It gives a pleasantly warm feeling, comforting you after your terrifying experience before you passed out. Somehow, as you hug the doll, you feel calm and satisfied for at least a moment. When you look down and check your skin, everything seems alright, no scars or burns anywhere. Luckily it seems that your body has not actually been torn apart, instead it was either a psychic attack of some sort or a vision of a possible future. Whatever the case, perhaps its better to not proceed with the plan to cut open the doll.
&lt;&lt;link &quot;Was there anything else I wanted to do here?&quot; &quot;Surface Workshop&quot;&gt;&gt;
  &lt;&lt;dollTF&gt;&gt;
  &lt;&lt;set $convoStart=1&gt;&gt;
  &lt;&lt;set $dollevent=true&gt;&gt;
&lt;&lt;/link&gt;&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="599" name="DollWarning" tags="" position="1100,7475" size="100,100">&lt;&lt;Update_MC_Speech&gt;&gt;
&lt;&lt;if $convoStart==1&gt;&gt;
Suddenly, you start hearing the voice of the doll again, it almost sounds like it&#39;s coming from inside your own head.

&lt;&lt;say $creepydoll&gt;&gt; Don&#39;t you sometimes get tired of all this adventuring?&lt;&lt;/say&gt;&gt;

Despite your surprise, you decide to answer the doll&#39;s question.

&lt;&lt;say $mc&gt;&gt; Sometimes, I guess. It&#39;s not always easy, but the thrill of adventure more than makes up for it to me. &lt;&lt;/say&gt;&gt;

&lt;&lt;say $creepydoll&gt;&gt; You know, I can feel what you feel? And what I felt was sleepyness and tired thoughts and lots of doubt. Don&#39;t lie to me. Lying is not nice. Good girls don&#39;t lie. Only BAD people lie. IF YOU LIE YOU NEED TO GET PUNISHED. I HATE LIARS! HATE HATE HATE HATE HATE THEM&lt;&lt;/say&gt;&gt;

A strong, cold chill runs down your spine.

&lt;&lt;say $mc&gt;&gt;I... I&#39;m not lying I swear! It&#39;s just that with the changes to my body I fatigue much quicker than before. I have to try harder and harder to do the same things. But I swear that I still want to discover more of the Abyss. I can&#39;t just give up and I won&#39;t! I think it&#39;s worth it and I enjoy it!&lt;&lt;/say&gt;&gt;

The cold sensation dissipates and you feel a warm, soft aura comming from the doll once again.

&lt;&lt;say $creepydoll&gt;&gt; Oh, I see! You just want to have fun! I also want to have fun! You know what doesn&#39;t make you sleepy and is super fun?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $mc&gt;&gt; Uh, no? &lt;&lt;/say&gt;&gt;

&lt;&lt;say $creepydoll&gt;&gt; Playing games, silly. We should go to my house and play all day! That would be super fun! &lt;&lt;/say&gt;&gt;

You&#39;re a bit hesitant about going to god-forsaken corner of the Abyss to &quot;play&quot;, so you try to weasle out of it while attempting to avoid the doll&#39;s anger.

&lt;&lt;say $mc&gt;&gt;Maybe that could be fun someday, okay?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $creepydoll&gt;&gt; Yay, I&#39;m so happy! Because today is some day you know?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $mc&gt;&gt; Um, sorry, I didn&#39;t mean today. I meant another day...&lt;&lt;/say&gt;&gt;

You feel very tired all of a sudden and your consciousness starts to slip away.

You start to dream.

You see yourself walking around with your dolly and at some point you recognize the outskirts of Outcast Village as you seem to pass it by. The next moment, you are in a playroom, in a house wearing a similar dress as your dolly. You look so cute together! You have tea time with her and you run around playing tag.

It&#39;s so much fun you can hardly keep track of what&#39;s happening.&lt;&lt;nobr&gt;&gt;
&lt;&lt;dollTF&gt;&gt;
&lt;&lt;/nobr&gt;&gt;
As you run, you trip over something that somehow didn&#39;t seem to fully be there. The shock suddenly wakes you up, and you realize you fell over a rotting, collapsed wooden support beam. After looking around, you find yourself not in the playroom of a nice house, but in the decrepit room on the first layer where you found the creepy doll.

&lt;&lt;say $creepydoll&gt;&gt; Aww, did you have an ouchie?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $mc&gt;&gt; What...? Where am I? Why are we here? Why am I wearring this tattered dress?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $creepydoll&gt;&gt; Because it makes us look like cute twins!&lt;&lt;/say&gt;&gt;

&lt;&lt;say $mc&gt;&gt; I... I don&#39;t want this. Or at least, I think I don&#39;t?&lt;&lt;/say&gt;&gt;

&lt;&lt;say $creepydoll&gt;&gt; Oh somebody is grumpy, so why don&#39;t you take a nap, and then we&#39;ll decide later?&lt;&lt;/say&gt;&gt;

[[Don&#39;t risk the dolls ire and take the nap|DollWarning][$convoStart=0, $choice1=1]]
[[Insist you want to leave NOW!|DollWarning][$convoStart=0, $choice1=2]]

&lt;&lt;elseif $convoStart==0 &amp;&amp; $choice1==1&gt;&gt;
&lt;&lt;say $creepydoll&gt;&gt; Good girl, we are going to have so much fun together when you wake up. &lt;&lt;/say&gt;&gt;

[[A soft, warm darkness washes over you|DollEnd][$convoStart=1, $choice1=0, $app.appAge=3, $app.penis=0, $app.vagina=1, $app.gender=6, $dollevent2=true]]
&lt;&lt;elseif $convoStart==0 &amp;&amp; $choice1==2&gt;&gt;
&lt;&lt;say $mc&gt;&gt; I&#39;d rather really not. To be honest, I just want to get my regular clothes back, to leave this place, and to go somewhere else. &lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $creepydoll&gt;&gt; Hmm, thats okay. We already played a lot today. We&#39;ll just play some other time. Soon...&lt;&lt;/say&gt;&gt;

You scramble to get your clothes and hurry out of the rotten house, leaving this place and the doll far behind. Once there is some distance between you and the doll, you stop to change your clothes. But instead of grabbing your clothes, you find the doll in your hands, once again.

&lt;&lt;say $mc&gt;&gt; What?! How?! I&#39;m pretty sure I grabbed my clothes, right?&lt;&lt;/say&gt;&gt;&lt;br&gt;
&lt;&lt;say $creepydoll&gt;&gt; Those smelly old things? Why would you need those? You look much better than this, you silly. Now we are cute twinsies. ISN&#39;T THAT FUN?&lt;&lt;/say&gt;&gt;

You want to throw the doll away, but your body simply refuses. At the moment it seems there is nothing you can do. No matter what you want to do, you can neither get rid of the doll, nor change your clothes.

[[Continue your adventure wearing the tattered dress and carrying the doll|Layer1 Hub][$creepydoll.affec += 10, $convoStart=1, $dollevent2=true, $choice1=0]]
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="600" name="Surface Inn" tags="surface indoor nobr" position="1225,7475" size="100,100">[img[setup.ImagePath+&#39;Surface/Inn Room.png&#39;]]
&lt;br&gt;&lt;br&gt;

&lt;&lt;if $items[18].count &gt; 0 &amp;&amp; ($items[0].count &lt; 1 || $items[1].count &lt; 1)&gt;&gt;
	Due to your inn pass, you&#39;re able to eat and drink your fill, overcoming any deficits you&#39;ve built up over time after you visit the Inn.
	&lt;br&gt;&lt;br&gt;
	&lt;&lt;set $items[0].count = Math.max($items[0].count, 0)&gt;&gt;
	&lt;&lt;set $items[1].count = Math.max($items[1].count, 0)&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $innUsed != $time&gt;&gt;
	You can eat and drink enough to make yourself extra full and save a day of food and water on your travels.&lt;br&gt;
	[[Eat and drink the delicious food and drink|Surface Inn][$items[0].count += 1, $items[1].count += 1, $innUsed = $time]]
&lt;&lt;else&gt;&gt;
	You are already full, but you can come back another day to get more freshly cooked meals and clear, cool water when you come back later.
&lt;&lt;/if&gt;&gt;
&lt;br&gt;&lt;br&gt;

&lt;&lt;include &quot;Inn Storage&quot;&gt;&gt;

[[Return to Outset Town|Surface Hub]]</tw-passagedata><tw-passagedata pid="601" name="Inn Storage" tags="nobr" position="100,7600" size="100,100">&lt;&lt;if $innDubloons &gt; 0&gt;&gt;
	You can retrieve all of the dubloons you have stored in your inn room. You currently have $innDubloons stored.&lt;br&gt;
	[[Retrieve your dubloons|passage()][$dubloons += $innDubloons, $innDubloons = 0]]
	&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $dubloons &gt; 0&gt;&gt;
	You can store any of your dubloons at the inn, in case you&#39;d like to pick them up later. If you&#39;d like to stash your dubloons, enter the amount you&#39;d like to store and press Stash.&lt;br&gt;
	&lt;&lt;textbox &quot;$temp&quot; &quot;0&quot;&gt;&gt;
	[[Stash your dubloons|passage()][$dubloons -= parseInt($temp), $innDubloons += parseInt($temp)]]
	&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $innRelics.length &gt; 0&gt;&gt;
	You can pick up any of the Relics you&#39;ve previously stored in your inn room:&lt;br&gt;
	&lt;&lt;for $i = 0; $i &lt; $innRelics.length; $i++&gt;&gt;
		&lt;&lt;capture $i&gt;&gt;
			&lt;&lt;print $innRelics[$i].name + &quot; [[Retrieve|passage()][$soldRelics.deleteWith(r =&gt; r.name === $innRelics[$i].name), $ownedRelics.push($innRelics[$i]), $innRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
		&lt;&lt;/capture&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $ownedRelics.length &gt; 0&gt;&gt;
	You can store any Relics you&#39;re holding here for safe keeping or if you just want to reduce the weight you&#39;re holding.
	Choose a relic you would like to store here at the inn:&lt;br&gt;
	&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
		&lt;&lt;capture $i&gt;&gt;
			&lt;&lt;if $ownedRelics[$i].name==&quot;Creepy Doll&quot; &amp;&amp; $creepydoll.affec &gt; 5&gt;&gt;
				You can&#39;t seem to part ways with the Creepy Doll&lt;br&gt;
			&lt;&lt;elseif $ownedRelics[$i].name==&quot;Chain of Lorelei&quot;&gt;&gt;
				&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; [[Store|passage()][$colwear=0, $soldRelics.push($ownedRelics[$i]), $innRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;elseif $ownedRelics[$i].name==&quot;Heart-stealing Stole&quot;&gt;&gt;
				&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; [[Store|passage()][$hsswear=0, $soldRelics.push($ownedRelics[$i]), $innRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;elseif $ownedRelics[$i].name==&quot;Sibyl Blend&quot;&gt;&gt;
				&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; [[Store|passage()][$SibylBuff=0, $soldRelics.push($ownedRelics[$i]), $innRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;elseif $ownedRelics[$i].name==&quot;Everhevea&quot;&gt;&gt;
				&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; [[Store|passage()][$soldRelics.push($ownedRelics[$i]), $innRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i), $items[2].count-=2]]&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;else&gt;&gt;
				&lt;&lt;print $ownedRelics[$i].name&gt;&gt;&lt;&lt;print &quot; [[Store|passage()][$soldRelics.push($ownedRelics[$i]), $innRelics.push($ownedRelics[$i]), $ownedRelics.deleteAt($i)]]&quot;&gt;&gt;&lt;br&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/capture&gt;&gt;
	&lt;&lt;/for&gt;&gt;
	&lt;br&gt;
&lt;&lt;/if&gt;&gt;</tw-passagedata><tw-passagedata pid="602" name="Surface Admin" tags="surface indoor" position="225,7600" size="100,100">As you approach a large building with stylings of marble and Roman pillars, you spot a sign declaring this to be the center of the town&#39;s administration. There seem to be a number of services that are provided here for people who need them, including managing debts and changing your legal name.

For a small fee of 10 dubloons, you can change your legal name from $app.name to whatever you wish.
[[Change your name|Surface Name]]
&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;)&gt;&gt;

You can use your companion Cloud&#39;s connections to borrow some money, but you will need to pay back an extra 20% as interest before you settle down for any voluntary habitation option.
[[Borrow more money|Surface debt1]]
&lt;&lt;/if&gt;&gt;&lt;&lt;if $debt &gt; 0&gt;&gt;

You currently have $debt dubloons of debt, which you can pay off now to allow yourself to settle down at a habitation option.
[[Pay off your debt|Surface debt2]]
&lt;&lt;/if&gt;&gt;

[[Continue your business on the surface|Surface Hub]]</tw-passagedata><tw-passagedata pid="603" name="Surface Name" tags="surface indoor" position="350,7600" size="100,100">&lt;&lt;set $dubloons -= 10&gt;&gt;

An elderly woman guides you through some surprisingly concise forms where you can fill out your new name, changing it for all official purposes.

What is your new name?
&lt;&lt;textbox &quot;$app.name&quot; &quot;Nana&quot; &quot;Surface Hub&quot;&gt;&gt;</tw-passagedata><tw-passagedata pid="604" name="Surface debt1" tags="surface" position="475,7600" size="100,100">Cloud is willing to allow you to use his connections to fund your expedition, as long as you can pay back the loan after you&#39;re done, with interest of course.

How many dubloons would you like to borrow?
&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Surface Hub][$dubloons += parseInt($temp), $debt += parseInt(Math.round($temp * 1.2))]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="605" name="Surface debt2" tags="surface" position="600,7600" size="100,100">In order to finally settle down at an ending, you must pay off your debt to Cloud&#39;s mysterious connections. You currently owe $debt dubloons of debt to them.

How many dubloons would you like to pay back?
&lt;&lt;textbox &quot;$temp&quot; &quot;&quot;&gt;&gt;

[[Confirm|Surface Hub][$dubloons -= parseInt($temp), $debt -= parseInt($temp)]]
&lt;&lt;back&gt;&gt;</tw-passagedata><tw-passagedata pid="606" name="Change Height" tags="widget nobr" position="725,7600" size="100,100">&lt;&lt;widget &quot;HeightCorrected&quot;&gt;&gt;
/*declare variables as follows when calling widget
1) $app.heigth
2) $app.oheight
3) $app.gender
4) $app.osex (= &quot;female&quot;)
5) $app.appAge
*/
	&lt;&lt;GenderCorrected&gt;&gt;
	&lt;&lt;set $genderlvl = $app.gender-1&gt;&gt;
	&lt;&lt;if $app.osex==&quot;female&quot;&gt;&gt;
		&lt;&lt;set $female_start=1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $female_start=0&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $HeightIncrease==1&gt;&gt;
		&lt;&lt;set _temp1 =$HeightLog.filter(e =&gt; e.name === &quot;Dizzying Heights&quot;).length&gt;&gt;
		&lt;&lt;set _temp2 =$HeightLog.filter(e =&gt; e.name === &quot;1 Day Food Forage Major Impact&quot;).length&gt;&gt;
		&lt;&lt;set _temp3 =$HeightLog.filter(e =&gt; e.name === &quot;1 Day Food Forage Minor Impact&quot;).length&gt;&gt;
		&lt;&lt;set $height_change=5*_temp1+3*_temp2+0.5*_temp3&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set _temp1 =$HeightLog.filter(e =&gt; e.name === &quot;Dizzying Heights&quot;).length&gt;&gt;
		&lt;&lt;set _temp2 =$HeightLog.filter(e =&gt; e.name === &quot;1 Day Food Forage Major Impact&quot;).length&gt;&gt;
		&lt;&lt;set _temp3 =$HeightLog.filter(e =&gt; e.name === &quot;1 Day Food Forage Minor Impact&quot;).length&gt;&gt;
		&lt;&lt;set $height_change=-5*_temp1-3*_temp2-0.5*_temp3&gt;&gt;	
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $HeightLog.some(e=&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt;
		&lt;&lt;set $height_change=$app.height*70-$app.height&gt;&gt;
		&lt;&lt;set $SizeHandicap=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $HeightLog.some(e=&gt; e.name === &quot;Minish-ish&quot;)&gt;&gt;
		&lt;&lt;set $height_change=$app.modheight/10-$app.height&gt;&gt;
		&lt;&lt;if $hiredCompanions.length &lt; 1&gt;&gt;
			&lt;&lt;set $SizeHandicap=1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	&lt;&lt;set $x =18 - $app.appAge&gt;&gt;

/* change in height with genderlevel changes and height increases/decreases it is modeled such that 5 cm is always 5 cm with respect to your starting height and irrespective of starting gender
*/

	&lt;&lt;set $height_adult = $app.oheight +$height_change -$height_change*(1-0.92375)*$female_start -0.01525*$app.oheight*$genderlvl +0.01525*$app.oheight*5*$female_start&gt;&gt;

	&lt;&lt;if $x&lt;=0 +1/5 *$genderlvl&gt;&gt;
		&lt;&lt;set $app.heightCor = $height_adult&gt;&gt;

/* The puberty phase: it shifts for females as their ends earlier, for simplicity I assumed the start is the same regardless although this is not entirely correct. I ussed a polynomial here to simulate the &#39;reverse growth spurt&#39;
*/

	&lt;&lt;elseif $x &gt; 0+1/5*$genderlvl &amp;&amp; $x&lt;=6&gt;&gt;
		&lt;&lt;set $C1=-4.70611e-3 +8.1433e-4  *$genderlvl&gt;&gt;
    	&lt;&lt;set $C2=-1.1049e-4  +1.140e-5   *$genderlvl&gt;&gt;
    	&lt;&lt;set $C3=-1.6698e-3  +1.3722e-4  *$genderlvl&gt;&gt;
    	&lt;&lt;set $C4= 1.7701e-4  -2.114e-5   *$genderlvl&gt;&gt;
    	&lt;&lt;set $x_rel = $x-1/5*$genderlvl&gt;&gt;
    	&lt;&lt;set $app.heightCor = $height_adult *(1 +$C1*$x_rel +$C2*Math.pow($x_rel,2) +$C3*Math.pow($x_rel,3) +$C4*Math.pow($x_rel,4) )&gt;&gt;

/* the second phase of linear growth or decline, its a decent approximation without making things to complicated. It ends at age 3 (originally 4, but changed it to not break the rest of the code) the calculation for the puberty growth spurt is in here to provide a starting point for the linear decline
*/
	&lt;&lt;elseif $x&gt;6 &amp;&amp; $x&lt;=15&gt;&gt;
		&lt;&lt;set $C1=-4.70611e-3 +8.1433e-4  *$genderlvl&gt;&gt;
    	&lt;&lt;set $C2=-1.1049e-4  +1.140e-5   *$genderlvl&gt;&gt;
    	&lt;&lt;set $C3=-1.6698e-3  +1.3722e-4  *$genderlvl&gt;&gt;
    	&lt;&lt;set $C4= 1.7701e-4  -2.114e-5   *$genderlvl&gt;&gt;
    	&lt;&lt;set $x_rel = 6-1/5*$genderlvl&gt;&gt;
    	&lt;&lt;set $height_pub = $height_adult*(1 +$C1*$x_rel +$C2*Math.pow($x_rel,2) +$C3*Math.pow($x_rel,3) +$C4*Math.pow($x_rel,4) )&gt;&gt;

    	&lt;&lt;set $app.heightCor = $height_pub -$height_adult*(0.033 +0.0009*$genderlvl) *( $x-6 )&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="607" name="Change Breast" tags="widget nobr" position="850,7600" size="100,100">&lt;&lt;widget &quot;BreastCorrected&quot;&gt;&gt;
	&lt;&lt;set $x = 18 -$app.appAge&gt;&gt;
	&lt;&lt;set $app.breastsCor =$app.breasts&gt;&gt;
	&lt;&lt;if $x&gt;0 +1/5 *($app.gender-1)&gt;&gt;
		&lt;&lt;set $app.breastsCor = $app.breasts - 0.1*$x*$app.breasts&gt;&gt;
		&lt;&lt;if  $app.breastsCor&lt;0&gt;&gt;
			&lt;&lt;set $app.breastsCor =0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) &amp;&amp; $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination B&quot;)&gt;&gt;
		&lt;&lt;set $app.breastsCor +=2&gt;&gt;
	&lt;&lt;elseif $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination A&quot;) || $playerCurses.some(e =&gt; e.name === &quot;Lactation Rejuvination B&quot;)&gt;&gt;
		&lt;&lt;set $app.breastsCor +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Double Pepperoni&quot;) &amp;&amp; $app.breastsCor == 0&gt;&gt;
			&lt;&lt;set $app.breastsCor +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="608" name="Change Penis" tags="widget nobr" position="975,7600" size="100,100">&lt;&lt;widget &quot;PenisCorrected&quot;&gt;&gt;

&lt;&lt;if $app.sex != &quot;female&quot;&gt;&gt;
	&lt;&lt;set $x = 16 -$app.appAge&gt;&gt;
	&lt;&lt;set $app.penisCor =$app.penis&gt;&gt;
	&lt;&lt;if $x&gt;0 +1/5 *($app.gender-1)&gt;&gt;
		&lt;&lt;set $app.penisCor = $app.penis - 0.083*$x*($app.penis-1)&gt;&gt;
		&lt;&lt;if  $app.penisCor&lt;1&gt;&gt;
			&lt;&lt;set $app.penisCor =1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e=&gt; e.name === &quot;Colossal-able&quot;)&gt;&gt;
		&lt;&lt;set $app.penisCor = $app.penisCor*70&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e=&gt; e.name === &quot;Minish-ish&quot;)&gt;&gt;
		&lt;&lt;set $app.penisCor=$app.penisCor/10&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="609" name="Change Gender" tags="widget nobr" position="1100,7600" size="100,100">&lt;&lt;widget &quot;GenderCorrected&quot;&gt;&gt;
&lt;&lt;AgeCorrected&gt;&gt;

&lt;&lt;set $app.sex = $app.osex&gt;&gt;
&lt;&lt;set $app.gender = $app.ogender&gt;&gt;
&lt;&lt;set $app.modgender = 0&gt;&gt;
&lt;&lt;set $app.modpenis = 0&gt;&gt;
&lt;&lt;set $app.modbreasts = 0&gt;&gt;
&lt;&lt;set $app.penis = $app.openis&gt;&gt;
&lt;&lt;set $app.breasts = $app.obreasts&gt;&gt;
&lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;
	&lt;&lt;set $app.vagina = 0&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $app.vagina = 1&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;set $app.womb =0&gt;&gt;

&lt;&lt;for _genderEvent range $GenderLog&gt;&gt;
	&lt;&lt;BreastCorrected&gt;&gt;
	&lt;&lt;if _genderEvent.name == &quot;Gender Reversal A&quot; || _genderEvent.name == &quot;Gender Reversal B&quot; || _genderEvent.name == &quot;Gender Reversal C&quot; || _genderEvent.name == &quot;Gender Reversal D&quot; || _genderEvent.name == &quot;Gender Reversal E&quot;  &gt;&gt;
		&lt;&lt;set $app.modgender += 1&gt;&gt;
		&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
			&lt;&lt;set $app.gender += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.gender -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
 
	&lt;&lt;if _genderEvent.name == &quot;Asset Robustness A&quot; &gt;&gt;
		&lt;&lt;set $app.modpenis += 1&gt;&gt;
		&lt;&lt;set $app.modbreasts += 1&gt;&gt;
		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
			&lt;&lt;if $app.breasts &gt;0 || $GenderLog.some(e=&gt; e.name===&quot;Interact A&quot;)&gt;&gt;
			&lt;&lt;set $app.breasts += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Asset Robustness B&quot;&gt;&gt;
		&lt;&lt;set $app.modpenis += 2&gt;&gt;
		&lt;&lt;set $app.modbreasts += 2&gt;&gt;
		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 2&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $app.breasts &gt;0 ||  $GenderLog.some(e=&gt; e.name===&quot;Interact B&quot;)&gt;&gt;
				&lt;&lt;set $app.breasts += 2&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Asset Robustness C&quot;&gt;&gt;
		&lt;&lt;set $app.modpenis += 4&gt;&gt;
		&lt;&lt;set $app.modbreasts += 4&gt;&gt;

		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 4&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if $app.breasts &gt;0 || $GenderLog.some(e=&gt; e.name===&quot;Interact C&quot;)&gt;&gt;
			&lt;&lt;set $app.breasts += 4&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Asset Robustness D&quot;&gt;&gt;
		&lt;&lt;set $app.modpenis += 6&gt;&gt;
		&lt;&lt;set $app.modbreasts += 6&gt;&gt;

		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 6&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if $app.breasts &gt;0 || $GenderLog.some(e=&gt; e.name===&quot;Interact D&quot;)&gt;&gt;
			&lt;&lt;set $app.breasts += 6&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Asset Robustness E&quot;&gt;&gt;
		&lt;&lt;set $app.modpenis += 8&gt;&gt;
		&lt;&lt;set $app.modbreasts += 8&gt;&gt;
		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 8&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;if $app.breasts &gt;0 || $GenderLog.some(e=&gt; e.name===&quot;Interact E&quot;)&gt;&gt;
			&lt;&lt;set $app.breasts += 8&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if  _genderEvent.name == &quot;Sex Switcheroo&quot;&gt;&gt;
		&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
			&lt;&lt;set $app.gender = 6 - $app.modgender&gt;&gt;
			&lt;&lt;set $app.breasts += 3 + $app.modbreasts&gt;&gt;
			&lt;&lt;set $app.penis = 0&gt;&gt;
			&lt;&lt;set $app.penisCor = 0&gt;&gt;
			&lt;&lt;set $app.vagina = 1&gt;&gt;
			&lt;&lt;set $app.sex = &quot;female&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.gender = 1 + $app.modgender&gt;&gt;
			&lt;&lt;set $app.penis = 6 + $app.modpenis&gt;&gt;
			&lt;&lt;set $app.vagina = 0&gt;&gt;
			&lt;&lt;set $app.sex = &quot;male&quot;&gt;&gt;
			&lt;&lt;set $app.breasts = 0&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Futa Fun&quot;&gt;&gt;
		&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
			&lt;&lt;set $app.vagina = 1&gt;&gt;
			&lt;&lt;set $app.breasts += 3 + $app.modbreasts&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.penis = 3 + $app.modpenis&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $app.sex = &quot;futa&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Wacky Wombs&quot;&gt;&gt;
		&lt;&lt;if $app.womb ==0&gt;&gt;
			&lt;&lt;set $app.womb1 = $curse35.variation1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.womb2 = $curse35.variation2&gt;&gt;
		&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $app.womb += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;1 Day Water Forage Major Impact&quot; &gt;&gt;
		&lt;&lt;set $app.modpenis += 1&gt;&gt;
		&lt;&lt;set $app.modbreasts += 1&gt;&gt;
		&lt;&lt;if $app.penis&gt;0&gt;&gt;
			&lt;&lt;set $app.penis += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;

		&lt;&lt;if $app.breasts &gt;0 || $app.breastsCor &gt; 0 &gt;&gt;
			&lt;&lt;set $app.breasts += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;1 Day Food Forage Major Impact&quot; &gt;&gt;
		&lt;&lt;set $app.modgender += 1&gt;&gt;
		&lt;&lt;if $app.osex == &quot;male&quot;&gt;&gt;
			&lt;&lt;set $app.gender += 1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.gender -= 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _genderEvent.name == &quot;Doll Transformation&quot;&gt;&gt;
		&lt;&lt;set $app.gender += 1&gt;&gt;
		&lt;&lt;if $app.penis&gt;0 &gt;&gt;
			&lt;&lt;set $app.penis -=1&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;if $app.vagina&lt;1&gt;&gt;
				&lt;&lt;set $app.vagina=1&gt;&gt;
			&lt;&lt;/if&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
		
&lt;&lt;/for&gt;&gt;

&lt;&lt;if $GenderLog.some(e =&gt; e.name === &quot;Shrunken Assets&quot;)&gt;&gt;
	&lt;&lt;if $app.sex == &quot;male&quot;&gt;&gt;
		&lt;&lt;set $app.penis = 1&gt;&gt;
		&lt;&lt;set $app.breasts = 0&gt;&gt;
	&lt;&lt;elseif $app.sex == &quot;female&quot;&gt;&gt;
		&lt;&lt;set $app.penis = 0&gt;&gt;
		&lt;&lt;set $app.breasts = 1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $app.penis = 1&gt;&gt;
		&lt;&lt;set $app.breasts = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Leaky&quot;)&gt;&gt;

	&lt;&lt;if $app.vagina &gt; 0 &amp;&amp; $app.penis &gt; 0&gt;&gt;
		&lt;&lt;set $curse80.appDesc = &quot;Your pussy is always glistening with lubrication and your penis is always leaking precum, so it only takes a little motivation to get a real stream going down there.&quot;&gt;&gt;
	&lt;&lt;elseif $app.vagina &gt; 0&gt;&gt;
		&lt;&lt;set $curse80.appDesc = &quot;Your pussy is always glistening with lubrication and it only takes a little motivation to get a real stream going down there.&quot;&gt;&gt;
	&lt;&lt;elseif $app.penis &gt; 0&gt;&gt;
		&lt;&lt;set $curse80.appDesc = &quot;Your cock is always leaking precum and it only takes a little motivation to get a real stream going down there.&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/if&gt;&gt;
&lt;&lt;BreastCorrected&gt;&gt;
&lt;&lt;PenisCorrected&gt;&gt;
&lt;&lt;Update_MC_Speech&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="610" name="Age widget" tags="widget nobr" position="1225,7600" size="100,100">&lt;&lt;widget &quot;AgeCorrected&quot;&gt;&gt;
&lt;&lt;set $app.appAge = $app.age&gt;&gt;
&lt;&lt;for _ageEvent range $AgeLog&gt;&gt;

	&lt;&lt;if _ageEvent.name == &quot;Age Reduction A&quot; &gt;&gt;
		&lt;&lt;if $app.appAge &lt;= 22&gt;&gt;
			&lt;&lt;set $app.appAge -= 2&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.appAge = 20&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _ageEvent.name == &quot;Age Reduction B&quot; &gt;&gt;
		&lt;&lt;if $app.appAge &lt;= 23&gt;&gt;
			&lt;&lt;set $app.appAge -= 3&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.appAge = 20&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	&lt;&lt;if _ageEvent.name == &quot;Age Reduction C&quot; &gt;&gt;
		&lt;&lt;if $app.appAge &lt;= 24&gt;&gt;
			&lt;&lt;set $app.appAge -= 4&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.appAge = 20&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _ageEvent.name == &quot;1 Day Food Forage Minor Impact&quot; &gt;&gt;
		&lt;&lt;set $app.appAge -= 0.08&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _ageEvent.name == &quot;1 Day Food Forage Major Impact&quot; &gt;&gt;
		&lt;&lt;set $app.appAge -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _ageEvent.name == &quot;Doll Transformation&quot;&gt;&gt;
		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $app.appAge = 17&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $app.appAge -= 2&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/for&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="611" name="Libido widget" tags="widget nobr" position="100,7725" size="100,100">&lt;&lt;widget &quot;LibidoCorrected&quot;&gt;&gt;
&lt;&lt;set $app.libido = 2&gt;&gt;
&lt;&lt;set $subdom = 0&gt;&gt;
&lt;&lt;for _libidoEvent range $LibidoLog&gt;&gt;

	&lt;&lt;if _libidoEvent.name == &quot;Libido Reinforcement A&quot; || _libidoEvent.name == &quot;Libido Reinforcement B&quot; || _libidoEvent.name == &quot;Libido Reinforcement C&quot; || _libidoEvent.name == &quot;Libido Reinforcement D&quot; || _libidoEvent.name == &quot;Libido Reinforcement E&quot;  &gt;&gt;
		&lt;&lt;set $app.libido += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;


	&lt;&lt;if _libidoEvent.name == &quot;DoS&quot; || _libidoEvent.name == &quot;Submissiveness Rectification A&quot; || _libidoEvent.name == &quot;Submissiveness Rectification B&quot; &gt;&gt;
		&lt;&lt;set $subdom += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _libidoEvent.name == &quot;DoM&quot; || _libidoEvent.name == &quot;Power Dom&quot;&gt;&gt;
		&lt;&lt;set $subdom -= 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _libidoEvent.name == &quot;1 Day Food Forage Major Impact&quot; &gt;&gt;
		&lt;&lt;set $app.libido += 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $lastFlan &gt;0 &gt;&gt;
		&lt;&lt;if $lastFlan==$day&gt;&gt;
			&lt;&lt;set $app.libido += 1&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;

&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="612" name="Pronoun widgets" tags="widget nobr" position="225,7725" size="100,100">&lt;&lt;widget &quot;Pronoun&quot;&gt;&gt;
	&lt;&lt;if $app.appGender&lt;=5&gt;&gt;
		he
	&lt;&lt;else&gt;&gt;
		she
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;ObjectivePronoun&quot;&gt;&gt;
	&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
		him
	&lt;&lt;else&gt;&gt;
		her
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PossesivePronoun&quot;&gt;&gt;
	&lt;&lt;if $app.appGender&lt;=5 &gt;&gt;
		his
	&lt;&lt;else&gt;&gt;
		hers
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;GenderPronoun&quot;&gt;&gt; 
	&lt;&lt;if $app.gender&lt;2 &amp;&amp; $app.appAge &gt; 15&gt;&gt;
		manly
	&lt;&lt;elseif $app.gender&lt;3 &gt;&gt;
		boyish
	&lt;&lt;elseif $app.gender&lt;4&gt;&gt;
		androgynous
	&lt;&lt;elseif $app.gender&lt;5 || $app.appAge &lt; 15&gt;&gt;
		girlish
	&lt;&lt;else&gt;&gt;
		feminine
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="613" name="Perceived widgets" tags="widget nobr" position="350,7725" size="100,100">&lt;&lt;widget &quot;appGender&quot;&gt;&gt;
	&lt;&lt;if $app.fit&gt;7&gt;&gt;
		&lt;&lt;set $app.appGender = 2*($app.gender-1) -0.25*($app.penisCor-4) +($app.breastsCor-3)+0.5*$colwear+0.25*$scent-1&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $app.appGender = 2*($app.gender-1) -0.25*($app.penisCor-4) +($app.breastsCor-3)+0.5*$colwear+0.25*$scent&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;mrms&quot;&gt;&gt;\
	&lt;&lt;if $app.appGender&lt;5&gt;&gt;\
		mr.\
	&lt;&lt;else&gt;&gt;\
		miss\
	&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PerceivedGender&quot;&gt;&gt;\
	&lt;&lt;AgeCorrected&gt;&gt;
	&lt;&lt;if $app.appGender&lt;=5&gt;&gt;\
		&lt;&lt;if $app.appAge&gt;16&gt;&gt;\
			man\
		&lt;&lt;else&gt;&gt;\
			boy\
		&lt;&lt;/if&gt;&gt;\
	&lt;&lt;else&gt;&gt;\
		&lt;&lt;if $app.appAge&gt;15.5&gt;&gt;\
			woman\
		&lt;&lt;else&gt;&gt;\
			girl\
		&lt;&lt;/if&gt;&gt;\
	&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PerceivedGender2&quot;&gt;&gt;\
	&lt;&lt;AgeCorrected&gt;&gt;
	&lt;&lt;if $app.appGender&lt;=5&gt;&gt;\
		&lt;&lt;if $app.appAge&gt;16&gt;&gt;\
			dude\
		&lt;&lt;else&gt;&gt;\
			boy\
		&lt;&lt;/if&gt;&gt;\
	&lt;&lt;else&gt;&gt;\
		&lt;&lt;if $app.appAge&gt;15.5&gt;&gt;\
			lady\
		&lt;&lt;else&gt;&gt;\
			girl\
		&lt;&lt;/if&gt;&gt;\
	&lt;&lt;/if&gt;&gt;\
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PerceivedStature&quot;&gt;&gt;
	&lt;&lt;HeightCorrected&gt;&gt;
	&lt;&lt;if $app.heightCor &lt;160 &gt;&gt;
			little
	&lt;&lt;elseif $height &gt;180&gt;&gt;
			big
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $app.appAge&lt;12&gt;&gt;
			young
	&lt;&lt;elseif $app.appAge&gt;40&gt;&gt;
			old
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;

&lt;&lt;widget &quot;PerceivedRace&quot;&gt;&gt;
	&lt;&lt;if $app.inhuman &lt;2 &gt;&gt;
			human
	&lt;&lt;elseif $app.inhuman &lt;6&gt;&gt;
			humanoid
	&lt;&lt;elseif $app.inhuman &lt;10&gt;&gt;
			antrophomorph
	&lt;&lt;else&gt;&gt;
			monster
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="614" name="Threat1 Criterion" tags="widget nobr" position="475,7725" size="100,100">&lt;&lt;widget &quot;Threat1Criterion&quot;&gt;&gt;
&lt;&lt;if $app.heightCor&lt;140&gt;&gt;
	&lt;&lt;set $groupsize= $hiredCompanions.length &gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $groupsize= $hiredCompanions.length +1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set $total_value_relics=0&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
&lt;&lt;set $total_value_relics = $ownedRelics[$i].value + $total_value_relics&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;if $groupsize&lt;4 &amp;&amp; $total_value_relics&gt;=150 &amp;&amp; $app.heightCor&lt;5000&gt;&gt;
	&lt;&lt;set $threat1Crit=1&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $threat1Crit=0&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="615" name="Lewdness function" tags="widget nobr" position="600,7725" size="100,100">&lt;&lt;widget &quot;Lewdness&quot;&gt;&gt;
	&lt;&lt;set _semenCount = setup.activeCurseCount(&quot;Semen Demon&quot;)&gt;&gt;
	&lt;&lt;set _quotaCount = setup.activeCurseCount(&quot;Quota&quot;)&gt;&gt;
	&lt;&lt;set _limelightCount = setup.activeCurseCount(&quot;In the Limelight&quot;)&gt;&gt;
	&lt;&lt;set $lewdness = ($app.libido - 2 + _quotaCount + _semenCount + _limelightCount) * 3 + $crumbleFluid / 10 + $algalSize &gt;&gt;

	&lt;&lt;if $app.breastsCor&gt;5&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;elseif $app.breastsCor&gt;7&gt;&gt;
		&lt;&lt;set $lewdness +=2&gt;&gt;
	&lt;&lt;elseif $app.breastsCor&gt;9&gt;&gt;
		&lt;&lt;set $lewdness +=3&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $app.penis&gt;6&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;elseif $app.penis&gt;10&gt;&gt;
		&lt;&lt;set $lewdness +=2&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction B&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Clothing Restriction C&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=2&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Heat/Rut&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hard Mode&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Hijinks Ensue&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Wandering Hands&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=2&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Leaky&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=2&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Softie&quot;)&gt;&gt;
		&lt;&lt;set $lewdness -=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Blushing Virgin&quot;)&gt;&gt;
		&lt;&lt;set $lewdness -=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Literal Blushing Virgin&quot;)&gt;&gt;
		&lt;&lt;set $lewdness -=2&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Increased Sensitivity&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Refractory Refactorization&quot;)&gt;&gt;
		&lt;&lt;set $lewdness +=1&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Increased Sensitivity&quot;) &amp;&amp; $playerCurses.some(e =&gt; e.name === &quot;Refractory Refactorization&quot;)&gt;&gt;
			&lt;&lt;set $lewdness +=4&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="616" name="Inhuman function" tags="widget nobr" position="725,7725" size="100,100">&lt;&lt;widget &quot;Inhuman&quot;&gt;&gt;
&lt;&lt;set $app.inhuman =0&gt;&gt;
&lt;&lt;if $app.ears != &quot;normal human&quot;&gt;&gt;
	&lt;&lt;set $app.inhuman +=1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if ![&quot;pale&quot;, &quot;tanned&quot;, &quot;olive&quot;, &quot;brown&quot;, &quot;dark brown&quot;].includes($app.skinColor) &gt;&gt;
    &lt;&lt;set $app.inhuman +=4&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.eyeColor !=  &quot;blue&quot; &amp;&amp; $app.eyeColor !=  &quot;brown&quot; &amp;&amp; $app.eyeColor !=  &quot;gray&quot; &amp;&amp; $app.eyeColor !=  &quot;green&quot; &amp;&amp; $app.eyeColor !=  &quot;hazel&quot;  &gt;&gt;
	&lt;&lt;set $app.inhuman +=1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.skinType.length &gt; 0 &amp;&amp; $app.skinType!=&quot;hairless, smooth&quot;&gt;&gt;
	&lt;&lt;set $app.inhuman +=4&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.blood !=&quot;red&quot;&gt;&gt;
	&lt;&lt;set $app.inhuman +=2&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _hornyCount = setup.activeCurseCount(&quot;Horny&quot;)&gt;&gt;
&lt;&lt;if _hornyCount == 1&gt;&gt;
	&lt;&lt;set $app.inhuman +=2&gt;&gt;
&lt;&lt;elseif _hornyCount == 2&gt;&gt;
	&lt;&lt;set $app.inhuman +=3&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.tail.length &gt; 0&gt;&gt;
&lt;&lt;for $i = 0; $i &lt; $app.tail.length; $i++&gt;&gt;
		&lt;&lt;set $app.inhuman +=2&gt;&gt;
&lt;&lt;/for&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Megadontia&quot;)&gt;&gt;
	&lt;&lt;set $app.inhuman +=1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Lingual Leviathan&quot;)&gt;&gt;
	&lt;&lt;set $app.inhuman +=1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Massacre Manicure&quot;)&gt;&gt;
	&lt;&lt;set $app.inhuman +=1&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Flower Power&quot;)&gt;&gt;
	&lt;&lt;set $app.inhuman +=4&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Wriggly Antennae&quot;)&gt;&gt;
	&lt;&lt;set $app.inhuman +=2&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="617" name="Speech settings" tags="widget nobr" position="850,7725" size="100,100">&lt;&lt;widget &quot;Update_MC_Speech&quot;&gt;&gt;
	&lt;&lt;if $app.gender&lt;=1 &gt;&gt;

		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(40, 40, 255,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(40, 40, 255,0.8);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(40, 40, 255,0.6);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(40, 40, 255,0.4);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(40, 40, 255,0.2);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;elseif $app.gender==2 &gt;&gt;

		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(80, 80, 240,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(80, 80, 240,0.8);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(80, 80, 240,0.6);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(80, 80, 240,0.4);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(80, 80, 240,0.2);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;elseif $app.gender==3 &gt;&gt;

		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(120, 100, 230,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(120, 100, 230,0.8);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(120, 100, 230,0.6);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(120, 100, 230,0.4);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(120, 100, 230,0.2);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;elseif $app.gender==4 &gt;&gt;

		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(165, 120, 220,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(165, 120, 220,0.8);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(165, 120, 220,0.6);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(165, 120, 220,0.4);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(165, 120, 220,0.2);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;elseif $app.gender==5 &gt;&gt;

		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(210, 140, 210,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(210, 140, 210,0.8);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(210, 140, 210,0.6);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(210, 140, 210,0.4);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(210, 140, 210,0.2);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;else&gt;&gt;
		&lt;&lt;if $app.appAge&gt;18&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(255, 160, 200,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;15&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(255, 160, 200,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;12&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(255, 160, 200,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;elseif $app.appAge&gt;9&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(255, 160, 200,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;else&gt;&gt;
			&lt;&lt;set $boxColor=&quot;box-shadow: 0px 0px 10px 2px rgba(255, 160, 200,1);background-color: black;&quot;&gt;&gt;
		&lt;&lt;/if&gt;&gt;

	&lt;&lt;/if&gt;&gt;
		&lt;&lt;set $mc = {
	name: $app.name,
	imageIcon: &quot;icon.png&quot;,
	genderVoice: $app.gender,
	style: &quot;border: 2px solid rgb(1,0,0);&quot;,
	style1: $boxColor
	}&gt;&gt;

	&lt;&lt;if $app.appGender&lt;5 &gt;&gt;
		&lt;&lt;set $mc.imageIcon=&quot;Icons/npcM.png&quot;&gt;&gt;
	&lt;&lt;else&gt;&gt;
		&lt;&lt;set $mc.imageIcon=&quot;Icons/npcF.png&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $app.gender&lt;1 &gt;&gt;
		&lt;&lt;set $mc.genderVoice=1&gt;&gt;
	&lt;&lt;elseif $app.gender&gt;6&gt;&gt;
		&lt;&lt;set $mc.genderVoice=6&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if $colwear&gt;&gt;
		&lt;&lt;set $mc.genderVoice=99&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="618" name="Doll transformation" tags="widget nobr" position="975,7725" size="100,100">&lt;&lt;widget &quot;dollTF&quot;&gt;&gt;
&lt;&lt;set $AgeLog.push($DollTF)&gt;&gt;
&lt;&lt;set $GenderLog.push($DollTF)&gt;&gt;
&lt;&lt;set $creepydoll.affec += 1&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="619" name="Time dependant variable updates" tags="widget nobr" position="1100,7725" size="100,100">&lt;&lt;widget &quot;checkTime&quot;&gt;&gt;

&lt;&lt;if $status.duration &gt; 0&gt;&gt;
	@@.alert2; You are currently injured, increasing your next $status.duration travel times by $status.penalty days each. @@&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Maru_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionMaru.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Maru_LastT=$time&gt;&gt;
&lt;&lt;if $MaruConvo1&gt;&gt;
	&lt;&lt;set $items[1].count +=1 &gt;&gt;
	Maru cooked an especially delicious meal granting you an extra day worth of food!&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Lily_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionLily.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Lily_LastT=$time&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Khemia_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionKhemia.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Khemia_LastT=$time&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Cherry_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionCherry.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Cherry_LastT=$time&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Cloud_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionCloud.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Cloud_LastT=$time&gt;&gt;
&lt;&lt;set $altCloud = random(0,3)&gt;&gt;
&lt;&lt;if $CloudConvo1&gt;&gt;
	&lt;&lt;if $altCloud == 1&gt;&gt;
	&lt;&lt;set $temp = random(2,3)
	&lt;&lt;set $items[20].count += $temp &gt;&gt;
	Cloud was able to scavenge some ammunition somehow! Yo aren&#39;t quite sure whether he found it or made it himself, but either way you have gained $temp bullets.&lt;br&gt;&lt;br&gt;
	&lt;&lt;elseif $altCloud == 2&gt;&gt;
	&lt;&lt;set $temp = random(2,5)
	&lt;&lt;set $dubloons += $temp &gt;&gt;
	Cloud managed to scavenge a bit of cash, presumably left behind by a previous diver. You have gained $temp dubloons!&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $Saeko_LastT&lt;$time-7&gt;&gt;
&lt;&lt;set $companionSaeko.affec+=(1+$hsswear)&gt;&gt;
&lt;&lt;set $Saeko_LastT=$time&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $fit_adjustLastT&lt;$time-20&gt;&gt;
	&lt;&lt;if $fit&gt;8&gt;&gt;
	&lt;&lt;set $fit-=1&gt;&gt;
	Your lack of an intensive work-out reduces your fitness to somewhat more average levels&lt;br&gt;&lt;br&gt;
	&lt;&lt;elseif $fit&lt;5&gt;&gt;
	&lt;&lt;set $fit+=1&gt;&gt;
	The constant physical activity of the expedition increases your fitness closer to average levels&lt;br&gt;&lt;br&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="620" name="Carry adjustment widget" tags="widget nobr" position="1225,7725" size="100,100">&lt;&lt;widget &quot;CarryAdjust&quot;&gt;&gt;
&lt;&lt;HeightCorrected&gt;&gt;
/*&lt;&lt;set $totalCarry -= $carryWeight&gt;&gt;*/

&lt;&lt;if $playerCurses.some(e =&gt; e.name === &quot;Weakling&quot;)&gt;&gt;
	&lt;&lt;set $ocarryWeight = 7.5&gt;&gt;
	&lt;&lt;set $app.fit=0&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $app.osex==&#39;male&#39;&gt;&gt;
	&lt;&lt;set $carryWeight = $app.heightCor / $app.oheight * ($ocarryWeight + 0.5*($app.fit-5-$app.gender+1) )&gt;&gt;
&lt;&lt;else&gt;&gt;
	&lt;&lt;set $carryWeight = $app.heightCor / $app.oheight * ($ocarryWeight + 0.5*($app.fit-5+6-$app.gender) )&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;for $i = 0; $i &lt; $ownedRelics.length; $i++&gt;&gt;
	&lt;&lt;if $ownedRelics[$i].name == &quot;Pocket Hoard&quot;&gt;&gt;
		&lt;&lt;if $ownedRelics[$i].active == 1&gt;&gt;
			&lt;&lt;set $carryWeight += 999&gt;&gt;
		&lt;&lt;/if&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/for&gt;&gt;

&lt;&lt;set $totalCarry = $carryWeight&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Maru&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionMaru.carry&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Lily&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionLily.carry&gt;&gt;
	&lt;&lt;if $LilyConvo1&gt;&gt;
		&lt;&lt;set $totalCarry += 5&gt;&gt;
	&lt;&lt;/if&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Khemia&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionKhemia.carry&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cherry&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionCherry.carry&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Cloud&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionCloud.carry&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $hiredCompanions.some(e =&gt; e.name === &quot;Saeko&quot;)&gt;&gt;
	&lt;&lt;set $totalCarry += $companionSaeko.carry&gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;set _carriedWeight = setup.calcCarriedWeight()&gt;&gt;
&lt;&lt;if $totalCarry*1.1 &lt; _carriedWeight &gt;&gt;
	@@.alert2; You are severely overburdened!@@&lt;br&gt;&lt;br&gt;
&lt;&lt;elseif $totalCarry*1 &lt; _carriedWeight  &gt;&gt;
	@@.alert1; You are overburdened!@@&lt;br&gt;&lt;br&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="621" name="Miscellaneous appearance adjustment widget" tags="widget nobr" position="100,7850" size="100,100">&lt;&lt;widget &quot;AppearanceCorrect&quot;&gt;&gt;

&lt;&lt;set $app.hair = $app.ohair&gt;&gt; 
&lt;&lt;set $app.ears= &quot;normal human&quot;&gt;&gt;
&lt;&lt;set $app.bodyHair= 1&gt;&gt;
&lt;&lt;set $app.skinType= &quot;&quot;&gt;&gt;
&lt;&lt;set $app.skinColor= $app.oskinColor&gt;&gt;
&lt;&lt;set $app.eyeColor= $app.oeyeColor&gt;&gt;
&lt;&lt;set $app.tail= []&gt;&gt;


&lt;&lt;set $app.desc= &quot;&quot;&gt;&gt;
&lt;&lt;set $app.blood=&quot;red&quot;&gt;&gt;

&lt;&lt;for _appearEvent range $playerCurses&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Hair Removal&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = &quot;hairless, smooth&quot;&gt;&gt;
		&lt;&lt;set $app.bodyhair = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Knife-ear&quot;&gt;&gt;
		&lt;&lt;set $app.ears = &quot;pointed, elfish&quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Perma-dye&quot;&gt;&gt;
		&lt;&lt;set $app.hair = $curse7.variation&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Fluffy Ears&quot;&gt;&gt;
		&lt;&lt;set $app.ears = $curse17.variation&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Fluffy Tail&quot;&gt;&gt;
		&lt;&lt;set $app.tail.push($curse18.variation)&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Maximum Fluff&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = $curse19.variation&gt;&gt;
		&lt;&lt;set $app.bodyhair = 1&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Gooey&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = &quot;sticky, slimy&quot;&gt;&gt;
		&lt;&lt;set $app.bodyhair = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Rainbow Swirl&quot;&gt;&gt;
		&lt;&lt;set $app.skinColor= $curse38.variation&gt;&gt;
		&lt;&lt;set $app.eyeColor= $curse38.variation&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Tipping the Scales&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = &quot;reptilian scaled&quot;&gt;&gt;
		&lt;&lt;set $app.bodyhair = 0&gt;&gt;
		&lt;&lt;set $app.skinColor = $curse54.variation&gt;&gt;
	&lt;&lt;/if&gt;&gt;	
	
	&lt;&lt;if _appearEvent.name == &quot;Reptail&quot;&gt;&gt;
		&lt;&lt;set $app.tail.push(&quot;large, spiked, scaled reptile&quot;)&gt;&gt;
	&lt;&lt;/if&gt;&gt;
	
	&lt;&lt;if _appearEvent.name == &quot;Cellulose&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = &quot;smooth, slightly rigid, plant-like&quot;&gt;&gt;
		&lt;&lt;set $app.bodyhair = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Carapacian&quot;&gt;&gt;
		&lt;&lt;set $app.skinType = &quot;hard, shiny, chitin-exoskeleton&quot;&gt;&gt;
		&lt;&lt;set $app.skinColor = $curse69.variation &gt;&gt;
		&lt;&lt;set $app.bodyhair = 0&gt;&gt;
	&lt;&lt;/if&gt;&gt;

	&lt;&lt;if _appearEvent.name == &quot;Hemospectrum&quot;&gt;&gt;
		&lt;&lt;set $app.blood = $curse70.variation&gt;&gt;
		&lt;&lt;set $app.desc += &quot;Your blood is now $app.blood colored, not a typical color for humans. &quot;&gt;&gt;
	&lt;&lt;/if&gt;&gt;	

	&lt;&lt;if _appearEvent.name == &quot;Drawing Spades&quot;&gt;&gt;
		&lt;&lt;set $app.tail.push(&quot;cute, spade-tipped demon&quot;)&gt;&gt;
	&lt;&lt;/if&gt;&gt;	

&lt;&lt;/for&gt;&gt;
&lt;&lt;/widget&gt;&gt;</tw-passagedata><tw-passagedata pid="622" name="Check party conversations" tags="widget nobr" position="225,7850" size="100,100">&lt;&lt;widget &quot;CheckParty&quot;&gt;&gt;

&lt;&lt;set _temp = 0 &gt;&gt;
&lt;&lt;if $MaruConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Maru&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $MaruConvo1==0 &amp;&amp; $companionMaru.affec&gt;6 &amp;&amp; $MaruConvo0 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $MaruConvo2==0 &amp;&amp; $companionMaru.affec&gt;15 &amp;&amp; $MaruConvo1 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $MaruConvo3==0 &amp;&amp; $companionMaru.affec&gt;20 &amp;&amp; $app.appGender&lt;4 &amp;&amp; $subdom &gt; -1 &amp;&amp; $MaruConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $LilyConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Lily&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $LilyConvo1==0 &amp;&amp; $companionLily.affec&gt;6 &amp;&amp; $LilyConvo0 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $LilyConvo2==0 &amp;&amp; $companionLily.affec&gt;15 &amp;&amp; $LilyConvo1 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $LilyConvo3==0 &amp;&amp; $companionLily.affec&gt;20 &amp;&amp; $app.appGender&gt;7 &amp;&amp; $subdom &lt; 1 &amp;&amp; $LilyConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $ownedRelics.some(e =&gt; e.name === &quot;World Stone&quot;) &amp;&amp; !$LilyPromise&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $KhemiaConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Khemia&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $KhemiaConvo1==0 &amp;&amp; $companionKhemia.affec&gt;6 &amp;&amp; $KhemiaConvo0 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $KhemiaConvo2==0 &amp;&amp; $companionKhemia.affec&gt;15 &amp;&amp; $KhemiaConvo1 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $KhemiaConvo3==0 &amp;&amp; $companionKhemia.affec&gt;20 &amp;&amp; app.appGender&gt;9 &amp;&amp;$subdom &lt; 0 &amp;&amp; $KhemiaConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $CherryConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Cherry&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $CherryConvo1==0 &amp;&amp; $companionCherry.affec&gt;6 &amp;&amp; $CherryConvo0 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $CherryConvo2==0 &amp;&amp; $companionCherry.affec&gt;15 &amp;&amp; $CherryConvo1 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $CherryConvo3==0 &amp;&amp; $companionCherry.affec&gt;20 &amp;&amp; $app.appGender&lt;6 &amp;&amp; $subdom &gt; 0 &amp;&amp; $CherryConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $CloudConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Cloud&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $CloudConvo1==0 &amp;&amp; $CloudAffec&gt;6 &amp;&amp; $CloudConvo0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $CloudConvo2==0 &amp;&amp; $CloudAffec&gt;15 &amp;&amp; $CloudConvo1 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $CloudConvo3==0 &amp;&amp; $CloudAffec&gt;20 &amp;&amp; $subdom &lt; 2 &amp;&amp; $CloudConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if $SaekoConvo0==0 &amp;&amp; $hiredCompanions.some(e=&gt; e.name === &#39;Saeko&#39;)&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;
&lt;&lt;if $SaekoConvo1==0 &amp;&amp; $companionSaeko.affec&gt;10 &amp;&amp; $SaekoConvo0 &amp;&amp; 0&gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $SaekoConvo2==0 &amp;&amp; $companionSaeko.affec&gt;20 &amp;&amp; $SaekoConvo1 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;elseif $SaekoConvo3==0 &amp;&amp; $companionSaeko.affec&gt;30 &amp;&amp; $SaekoConvo2 &gt;&gt;
	&lt;&lt;set _temp += 1 &gt;&gt;
&lt;&lt;/if&gt;&gt;

&lt;&lt;if _temp &gt; 0&gt;&gt;
@@.alert1; You have available conversations! @@ 
&lt;&lt;/if&gt;&gt;

&lt;&lt;/widget&gt;&gt;</tw-passagedata></tw-storydata>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS */
	if(document.documentElement.getAttribute("data-init")==="loading"){(function(window,document,jQuery,undefined){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var errorPrologRegExp=/^(?:(?:uncaught\s+(?:exception:\s+)?)?\w*(?:error|exception|_err):\s+)+/i,Alert=function(){function mesg(where,error,isFatal,isUncaught){var mesg="Error",nice="A".concat(isFatal?" fatal":"n"," error has occurred.");nice+=isFatal?" Aborting.":" You may be able to continue, but some parts may not work properly.";var isObject=null!==error&&"object"===_typeof(error),what=(isObject&&"message"in error?String(error.message).replace(errorPrologRegExp,""):String(error)).trim()||"unknown error";null!=where&&(mesg+=" [".concat(where,"]")),mesg+=": ".concat(what,"."),isObject&&"stack"in error&&(mesg+="\n\nStack Trace:\n".concat(error.stack)),mesg&&(nice+="\n\n".concat(mesg)),isUncaught||console[isFatal?"error":"warn"](mesg),window.alert(nice)}var origOnError;return origOnError=window.onerror,window.onerror=function(what,source,lineNum,colNum,error){"complete"===document.readyState?mesg(null,null!=error?error:what,!1,!0):(mesg(null,null!=error?error:what,!0,!0),window.onerror=origOnError,"function"==typeof window.onerror&&window.onerror.apply(this,arguments))},Object.freeze(Object.defineProperties({},{error:{value:function(where,error){mesg(where,error)}},fatal:{value:function(where,error){mesg(where,error,!0)}}}))}(),Patterns=(wsMap=new Map([[" ","\\u0020"],["\f","\\f"],["\n","\\n"],["\r","\\r"],["\t","\\t"],["\v","\\v"],[" ","\\u00a0"],[" ","\\u1680"],["᠎","\\u180e"],[" ","\\u2000"],[" ","\\u2001"],[" ","\\u2002"],[" ","\\u2003"],[" ","\\u2004"],[" ","\\u2005"],[" ","\\u2006"],[" ","\\u2007"],[" ","\\u2008"],[" ","\\u2009"],[" ","\\u200a"],["\u2028","\\u2028"],["\u2029","\\u2029"],[" ","\\u202f"],[" ","\\u205f"],["　","\\u3000"],["\ufeff","\\ufeff"]]),wsRe=/^\s$/,missing="",wsMap.forEach((function(pat,char){wsRe.test(char)||(missing+=pat)})),space=missing?"[\\s".concat(missing,"]"):"\\s",spaceNoTerminator="[\\u0020\\f\\t\\v\\u00a0\\u1680\\u180e\\u2000-\\u200a\\u202f\\u205f\\u3000\\ufeff]",notSpace="\\s"===space?"\\S":space.replace(/^\[/,"[^"),anyChar="(?:.|".concat("[\\n\\r\\u2028\\u2029]",")"),anyLetter="[0-9A-Z_a-z\\-\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0150\\u0170\\u0151\\u0171]",anyLetterStrict=anyLetter.replace("\\-",""),identifier="".concat("[$A-Z_a-z]").concat("[$0-9A-Z_a-z]","*"),variable="[$_]"+identifier,htmlTagName="[A-Za-z](?:".concat(cENChar="(?:[\\x2D.0-9A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])","*-").concat(cENChar,"*|[0-9A-Za-z]*)"),twStyle="(".concat(anyLetter,"+)\\(([^\\)\\|\\n]+)\\):"),cssStyle="".concat(spaceNoTerminator,"*(").concat(anyLetter,"+)").concat(spaceNoTerminator,"*:([^;\\|\\n]+);"),idOrClass="".concat(spaceNoTerminator,"*((?:").concat("[#.]").concat(anyLetter,"+").concat(spaceNoTerminator,"*)+);"),inlineCss="".concat(twStyle,"|").concat(cssStyle,"|").concat(idOrClass),Object.freeze({space:space,spaceNoTerminator:spaceNoTerminator,lineTerminator:"[\\n\\r\\u2028\\u2029]",notSpace:notSpace,anyChar:anyChar,anyLetter:anyLetter,anyLetterStrict:anyLetterStrict,identifierFirstChar:"[$A-Z_a-z]",identifierNextChar:"[$0-9A-Z_a-z]",identifier:identifier,variableSigil:"[$_]",variable:variable,macroName:"[A-Za-z][\\w-]*|[=-]",templateName:"[A-Za-z][\\w-]*",htmlTagName:htmlTagName,cssIdOrClassSigil:"[#.]",cssImage:"\\[[<>]?[Ii][Mm][Gg]\\[(?:\\s|\\S)*?\\]\\]+",inlineCss:inlineCss,url:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+"})),wsMap,wsRe,missing,cENChar,twStyle,cssStyle,idOrClass,space,spaceNoTerminator,notSpace,anyChar,anyLetter,anyLetterStrict,identifier,variable,htmlTagName,inlineCss;!function(){var startWSRe,endWSRe,_trimString=(startWSRe=new RegExp("^".concat(Patterns.space).concat(Patterns.space,"*")),endWSRe=new RegExp("".concat(Patterns.space).concat(Patterns.space,"*$")),function(str,where){var val=String(str);if(!val)return val;switch(where){case"start":return startWSRe.test(val)?val.replace(startWSRe,""):val;case"end":return endWSRe.test(val)?val.replace(endWSRe,""):val;default:throw new Error('_trimString called with incorrect where parameter value: "'.concat(where,'"'))}});function _createPadString(length,padding){var targetLength=Number.parseInt(length,10)||0;if(targetLength<1)return"";var padString=void 0===padding?"":String(padding);for(""===padString&&(padString=" ");padString.length<targetLength;){var curPadLength=padString.length,remainingLength=targetLength-curPadLength;padString+=curPadLength>remainingLength?padString.slice(0,remainingLength):padString}return padString.length>targetLength&&(padString=padString.slice(0,targetLength)),padString}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,writable:!0,value:function flat(){if(null==this)throw new TypeError("Array.prototype.flat called on null or undefined");var depth=0===arguments.length?1:Number(arguments[0])||0;return depth<1?Array.prototype.slice.call(this):Array.prototype.reduce.call(this,(function(acc,cur){return cur instanceof Array?acc.push.apply(acc,_toConsumableArray(flat.call(cur,depth-1))):acc.push(cur),acc}),[])}}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatMap called on null or undefined");return Array.prototype.map.apply(this,arguments).flat()}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");if(0===arguments.length)return!1;var length=this.length>>>0;if(0===length)return!1;var needle=arguments[0],i=Number(arguments[1])||0;for(i<0&&(i=Math.max(0,length+i));i<length;++i){var value=this[i];if(value===needle||value!=value&&needle!=needle)return!0}return!1}}),Object.entries||Object.defineProperty(Object,"entries",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.entries object parameter must be an object");return Object.keys(obj).map((function(key){return[key,obj[key]]}))}}),Object.fromEntries||Object.defineProperty(Object,"fromEntries",{configurable:!0,writable:!0,value:function(iter){return Array.from(iter).reduce((function(acc,pair){if(Object(pair)!==pair)throw new TypeError("Object.fromEntries iterable parameter must yield objects");return pair[0]in acc?Object.defineProperty(acc,pair[0],{configurable:!0,enumerable:!0,writable:!0,value:pair[1]}):acc[pair[0]]=pair[1],acc}),{})}}),Object.getOwnPropertyDescriptors||Object.defineProperty(Object,"getOwnPropertyDescriptors",{configurable:!0,writable:!0,value:function(obj){if(null==obj)throw new TypeError("Object.getOwnPropertyDescriptors object parameter is null or undefined");var O=Object(obj);return Reflect.ownKeys(O).reduce((function(acc,key){var desc=Object.getOwnPropertyDescriptor(O,key);return void 0!==desc&&(key in acc?Object.defineProperty(acc,key,{configurable:!0,enumerable:!0,writable:!0,value:desc}):acc[key]=desc),acc}),{})}}),Object.values||Object.defineProperty(Object,"values",{configurable:!0,writable:!0,value:function(obj){if("object"!==_typeof(obj)||null===obj)throw new TypeError("Object.values object parameter must be an object");return Object.keys(obj).map((function(key){return obj[key]}))}}),String.prototype.padStart||Object.defineProperty(String.prototype,"padStart",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padStart called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:_createPadString(targetLength-baseLength,padding)+baseString}}),String.prototype.padEnd||Object.defineProperty(String.prototype,"padEnd",{configurable:!0,writable:!0,value:function(length,padding){if(null==this)throw new TypeError("String.prototype.padEnd called on null or undefined");var baseString=String(this),baseLength=baseString.length,targetLength=Number.parseInt(length,10);return targetLength<=baseLength?baseString:baseString+_createPadString(targetLength-baseLength,padding)}}),String.prototype.trimStart||Object.defineProperty(String.prototype,"trimStart",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimStart called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return _trimString(this,"start")}}),String.prototype.trimEnd||Object.defineProperty(String.prototype,"trimEnd",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimEnd called on null or undefined");return _trimString(this,"end")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return _trimString(this,"end")}})}(),function(){var _nativeMathRandom=Math.random,_regExpMetaCharsRe,_hasRegExpMetaCharsRe,_formatRegExp,_hasFormatRegExp;function _random(){var min,max;switch(arguments.length){case 0:throw new Error("_random called with insufficient parameters");case 1:min=0,max=arguments[0];break;default:min=arguments[0],max=arguments[1]}if(min>max){var _ref=[max,min];min=_ref[0],max=_ref[1]}return Math.floor(_nativeMathRandom()*(max-min+1))+min}function _randomIndex(length,boundsArgs){var min,max;switch(boundsArgs.length){case 1:min=0,max=length-1;break;case 2:min=0,max=Math.trunc(boundsArgs[1]);break;default:min=Math.trunc(boundsArgs[1]),max=Math.trunc(boundsArgs[2])}return Number.isNaN(min)?min=0:!Number.isFinite(min)||min>=length?min=length-1:min<0&&(min=length+min)<0&&(min=0),Number.isNaN(max)?max=0:(!Number.isFinite(max)||max>=length||max<0&&(max=length+max)<0)&&(max=length-1),_random(min,max)}function _getCodePointStartAndEnd(str,pos){var code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};if(code<55296||code>57343)return{char:str.charAt(pos),start:pos,end:pos};if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)throw new Error("high surrogate without trailing low surrogate");var nextCode=str.charCodeAt(nextPos);if(nextCode<56320||nextCode>57343)throw new Error("high surrogate without trailing low surrogate");return{char:str.charAt(pos)+str.charAt(nextPos),start:pos,end:nextPos}}if(0===pos)throw new Error("low surrogate without leading high surrogate");var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);if(prevCode<55296||prevCode>56319)throw new Error("low surrogate without leading high surrogate");return{char:str.charAt(prevPos)+str.charAt(pos),start:prevPos,end:pos}}Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(array){if("object"!==_typeof(array)||null===array||!Object.prototype.hasOwnProperty.call(array,"length"))throw new TypeError("Array.random array parameter must be an array or array-lke object");var length=array.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments,1));return array[index]}}}),Object.defineProperty(Array.prototype,"concatUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.concatUnique called on null or undefined");var result=Array.from(this);if(0===arguments.length)return result;var items=Array.prototype.reduce.call(arguments,(function(prev,cur){return prev.concat(cur)}),[]),addSize=items.length;if(0===addSize)return result;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=items[i];-1===indexOf.call(result,value)&&push.call(result,value)}return result}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var indexOf=Array.prototype.indexOf,needle=arguments[0],pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,++pos;return count}}),Object.defineProperty(Array.prototype,"countWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.countWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.countWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return 0;for(var count=0,i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&++count;return count}}),Object.defineProperty(Array.prototype,"delete",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.delete called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var needles=Array.prototype.concat.apply([],arguments),needlesLength=needles.length,indices=[],i=0;i<length;++i)for(var value=this[i],j=0;j<needlesLength;++j){var needle=needles[j];if(value===needle||value!=value&&needle!=needle){indices.push(i);break}}for(var result=[],_i=0,iend=indices.length;_i<iend;++_i)result[_i]=this[indices[_i]];for(var splice=Array.prototype.splice,_i2=indices.length-1;_i2>=0;--_i2)splice.call(this,indices[_i2],1);return result}}),Object.defineProperty(Array.prototype,"deleteAt",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.deleteAt called on null or undefined");if(0===arguments.length)return[];var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,cpyIndices=_toConsumableArray(new Set(Array.prototype.concat.apply([],arguments).map((function(x){return x<0?Math.max(0,length+x):x}))).values()),delIndices=_toConsumableArray(cpyIndices).sort((function(a,b){return b-a})),result=[],i=0,iend=cpyIndices.length;i<iend;++i)result[i]=this[cpyIndices[i]];for(var _i3=0,_iend=delIndices.length;_i3<_iend;++_i3)splice.call(this,delIndices[_i3],1);return result}}),Object.defineProperty(Array.prototype,"deleteWith",{configurable:!0,writable:!0,value:function(predicate,thisArg){if(null==this)throw new TypeError("Array.prototype.deleteWith called on null or undefined");if("function"!=typeof predicate)throw new Error("Array.prototype.deleteWith predicate parameter must be a function");var length=this.length>>>0;if(0===length)return[];for(var splice=Array.prototype.splice,indices=[],result=[],i=0;i<length;++i)predicate.call(thisArg,this[i],i,this)&&(result.push(this[i]),indices.push(i));for(var _i4=indices.length-1;_i4>=0;--_i4)splice.call(this,indices[_i4],1);return result}}),Object.defineProperty(Array.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.first called on null or undefined");if(0!==this.length>>>0)return this[0]}}),Object.defineProperty(Array.prototype,"includesAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAll.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(!Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"includesAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includesAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.includesAny.apply(this,arguments[0]):Array.prototype.includes.apply(this,arguments);for(var i=0,iend=arguments.length;i<iend;++i)if(Array.prototype.some.call(this,(function(val){return val===this.val||val!=val&&this.val!=this.val}),{val:arguments[i]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.last called on null or undefined");var length=this.length>>>0;if(0!==length)return this[length-1]}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return Array.prototype.splice.call(this,index,1)[0]}}}),Object.defineProperty(Array.prototype,"pluckMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.pluckMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.pluckMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var splice=Array.prototype.splice,result=[],max=length-1;do{result.push(splice.call(this,_random(0,max--),1)[0])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"pushUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.pushUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,push=Array.prototype.push,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&push.call(this,value)}return this.length>>>0}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");var length=this.length>>>0;if(0!==length){var index=0===arguments.length?_random(0,length-1):_randomIndex(length,Array.prototype.slice.call(arguments));return this[index]}}}),Object.defineProperty(Array.prototype,"randomMany",{configurable:!0,writable:!0,value:function(wantSize){if(null==this)throw new TypeError("Array.prototype.randomMany called on null or undefined");var length=this.length>>>0;if(0===length)return[];var want=Math.trunc(wantSize);if(!Number.isInteger(want))throw new Error("Array.prototype.randomMany want parameter must be an integer");if(want<1)return[];want>length&&(want=length);var picked=new Map,result=[],max=length-1;do{var i=void 0;do{i=_random(0,max)}while(picked.has(i));picked.set(i,!0),result.push(this[i])}while(result.length<want);return result}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");var length=this.length>>>0;if(0===length)return this;for(var i=length-1;i>0;--i){var j=Math.floor(_nativeMathRandom()*(i+1));if(i!==j){var swap=this[i];this[i]=this[j],this[j]=swap}}return this}}),Object.defineProperty(Array.prototype,"unshiftUnique",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.unshiftUnique called on null or undefined");var addSize=arguments.length;if(0===addSize)return this.length>>>0;for(var indexOf=Array.prototype.indexOf,unshift=Array.prototype.unshift,i=0;i<addSize;++i){var value=arguments[i];-1===indexOf.call(this,value)&&unshift.call(this,value)}return this.length>>>0}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var slice=Array.prototype.slice,fn=this,bound=slice.call(arguments,0);return function(){for(var applied=[],argc=0,i=0;i<bound.length;++i)applied.push(bound[i]===undefined?arguments[argc++]:bound[i]);return fn.apply(this,applied.concat(slice.call(arguments,argc)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(num,min,max){var value=Number(num);return Number.isNaN(value)?NaN:value.clamp(min,max)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(num){return 1-(Math.cos(Number(num)*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Number.prototype.clamp called on null or undefined");if(2!==arguments.length)throw new Error("Number.prototype.clamp called with an incorrect number of parameters");var min=Number(arguments[0]),max=Number(arguments[1]);if(min>max){var _ref2=[max,min];min=_ref2[0],max=_ref2[1]}return Math.min(Math.max(this,min),max)}}),RegExp.escape||(_regExpMetaCharsRe=/[\\^$*+?.()|[\]{}]/g,_hasRegExpMetaCharsRe=new RegExp(_regExpMetaCharsRe.source),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(str){var val=String(str);return val&&_hasRegExpMetaCharsRe.test(val)?val.replace(_regExpMetaCharsRe,"\\$&"):val}})),_formatRegExp=/{(\d+)(?:,([+-]?\d+))?}/g,_hasFormatRegExp=new RegExp(_formatRegExp.source),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(format){function padString(str,align,pad){if(!align)return str;var plen=Math.abs(align)-str.length;if(plen<1)return str;var padding=String(pad).repeat(plen);return align<0?str+padding:padding+str}if(arguments.length<2)return 0===arguments.length?"":format;var args=2===arguments.length&&Array.isArray(arguments[1])?_toConsumableArray(arguments[1]):Array.prototype.slice.call(arguments,1);return 0===args.length?format:_hasFormatRegExp.test(format)?(_formatRegExp.lastIndex=0,format.replace(_formatRegExp,(function(match,index,align){var retval=args[index];if(null==retval)return"";for(;"function"==typeof retval;)retval=retval();switch(_typeof(retval)){case"string":break;case"object":retval=JSON.stringify(retval);break;default:retval=String(retval)}return padString(retval,align?Number.parseInt(align,10):0," ")}))):format}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var needle=String(arguments[0]||"");if(""===needle)return 0;for(var indexOf=String.prototype.indexOf,step=needle.length,pos=Number(arguments[1])||0,count=0;-1!==(pos=indexOf.call(this,needle,pos));)++count,pos+=step;return count}}),Object.defineProperty(String.prototype,"first",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.first called on null or undefined");return _getCodePointStartAndEnd(String(this),0).char}}),Object.defineProperty(String.prototype,"last",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.last called on null or undefined");var str=String(this);return _getCodePointStartAndEnd(str,str.length-1).char}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(startAt,delCount,replacement){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var length=this.length>>>0;if(0===length)return"";var start=Number(startAt);Number.isSafeInteger(start)?start<0&&(start+=length)<0&&(start=0):start=0,start>length&&(start=length);var count=Number(delCount);(!Number.isSafeInteger(count)||count<0)&&(count=0);var res=this.slice(0,start);return void 0!==replacement&&(res+=replacement),start+count<length&&(res+=this.slice(start+count)),res}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),Object.defineProperty(String.prototype,"toLocaleUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toLocaleUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd3=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd3.char,end=_getCodePointStartAnd3.end;return-1===end?"":char.toLocaleUpperCase()+str.slice(end+1)}}),Object.defineProperty(String.prototype,"toUpperFirst",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.toUpperFirst called on null or undefined");var str=String(this),_getCodePointStartAnd4=_getCodePointStartAndEnd(str,0),char=_getCodePointStartAnd4.char,end=_getCodePointStartAnd4.end;return-1===end?"":char.toUpperCase()+str.slice(end+1)}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)","(".concat(this.toString(),")")]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",_toConsumableArray(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",_toConsumableArray(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(code,data){if("string"!=typeof code)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",[code,data]]}}),Object.defineProperty(JSON,"_real_stringify",{value:JSON.stringify}),Object.defineProperty(JSON,"stringify",{configurable:!0,writable:!0,value:function(_value,replacer,space){return JSON._real_stringify(_value,(function(key,val){var value=val;if("function"==typeof replacer)try{value=replacer(key,value)}catch(ex){}return void 0===value&&(value=["(revive:eval)","undefined"]),value}),space)}}),Object.defineProperty(JSON,"_real_parse",{value:JSON.parse}),Object.defineProperty(JSON,"parse",{configurable:!0,writable:!0,value:function value(text,reviver){return JSON._real_parse(text,(function(key,val){var value=val;if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{if(Array.isArray(value[1])){var $ReviveData$=value[1][1];value=eval(value[1][0])}else value=eval(value[1])}catch(ex){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(ex){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(ex){}return value}))}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return Array.prototype.includes.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");return Array.prototype.includesAll.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");return Array.prototype.includesAny.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return Array.prototype.flat.call(this,1/0)}}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var match,re=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),names=[];null!==(match=re.exec(this));)match[1]?names.push(match[1]):match[2]&&names.push(match[2]);return names}})}();var Browser=(userAgent=navigator.userAgent.toLowerCase(),winPhone=userAgent.includes("windows phone"),isMobile=Object.freeze({Android:!winPhone&&userAgent.includes("android"),BlackBerry:/blackberry|bb10/.test(userAgent),iOS:!winPhone&&/ip(?:hone|ad|od)/.test(userAgent),Opera:!winPhone&&("object"===_typeof(window.operamini)||userAgent.includes("opera mini")),Windows:winPhone||/iemobile|wpdesktop/.test(userAgent),any:function(){return isMobile.Android||isMobile.BlackBerry||isMobile.iOS||isMobile.Opera||isMobile.Windows}}),isGecko=!isMobile.Windows&&!/khtml|trident|edge/.test(userAgent)&&userAgent.includes("gecko"),isIE=!userAgent.includes("opera")&&/msie|trident/.test(userAgent),ieVersion=isIE?(ver=/(?:msie\s+|rv:)(\d+\.\d)/.exec(userAgent))?Number(ver[1]):0:null,isOpera=userAgent.includes("opera")||userAgent.includes(" opr/"),operaVersion=isOpera?function(){var ver=new RegExp("".concat(/khtml|chrome/.test(userAgent)?"opr":"version","\\/(\\d+\\.\\d+)")).exec(userAgent);return ver?Number(ver[1]):0}():null,isVivaldi=userAgent.includes("vivaldi"),Object.freeze({userAgent:userAgent,isMobile:isMobile,isGecko:isGecko,isIE:isIE,ieVersion:ieVersion,isOpera:isOpera,operaVersion:operaVersion,isVivaldi:isVivaldi})),ver,userAgent,winPhone,isMobile,isGecko,isIE,ieVersion,isOpera,operaVersion,isVivaldi,Has=(hasAudioElement=function(){try{return"function"==typeof document.createElement("audio").canPlayType}catch(ex){}return!1}(),hasFile=function(){try{return"Blob"in window&&"File"in window&&"FileList"in window&&"FileReader"in window&&(!Browser.isOpera||Browser.operaVersion>=15)}catch(ex){}return!1}(),hasGeolocation=function(){try{return"geolocation"in navigator&&"function"==typeof navigator.geolocation.getCurrentPosition&&"function"==typeof navigator.geolocation.watchPosition}catch(ex){}return!1}(),hasMutationObserver=function(){try{return"MutationObserver"in window&&"function"==typeof window.MutationObserver}catch(ex){}return!1}(),hasPerformance=function(){try{return"performance"in window&&"function"==typeof window.performance.now}catch(ex){}return!1}(),hasTouch=function(){try{return"ontouchstart"in window||!!window.DocumentTouch&&document instanceof window.DocumentTouch||!!navigator.maxTouchPoints||!!navigator.msMaxTouchPoints}catch(ex){}return!1}(),hasTransitionEndEvent=function(){try{for(var teMap=new Map([["transition","transitionend"],["MSTransition","msTransitionEnd"],["WebkitTransition","webkitTransitionEnd"],["MozTransition","transitionend"]]),teKeys=_toConsumableArray(teMap.keys()),el=document.createElement("div"),i=0;i<teKeys.length;++i)if(el.style[teKeys[i]]!==undefined)return teMap.get(teKeys[i])}catch(ex){}return!1}(),Object.freeze({audio:hasAudioElement,fileAPI:hasFile,geolocation:hasGeolocation,mutationObserver:hasMutationObserver,performance:hasPerformance,touch:hasTouch,transitionEndEvent:hasTransitionEndEvent})),hasAudioElement,hasFile,hasGeolocation,hasMutationObserver,hasPerformance,hasTouch,hasTransitionEndEvent,Visibility=(vendor=function(){try{return Object.freeze([{hiddenProperty:"hidden",stateProperty:"visibilityState",changeEvent:"visibilitychange"},{hiddenProperty:"webkitHidden",stateProperty:"webkitVisibilityState",changeEvent:"webkitvisibilitychange"},{hiddenProperty:"mozHidden",stateProperty:"mozVisibilityState",changeEvent:"mozvisibilitychange"},{hiddenProperty:"msHidden",stateProperty:"msVisibilityState",changeEvent:"msvisibilitychange"}].find((function(vnd){return vnd.hiddenProperty in document})))}catch(ex){}return undefined}(),Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},state:{get:function(){return vendor&&document[vendor.stateProperty]||"visible"}},isEnabled:{value:function(){return Boolean(vendor)}},isHidden:{value:function(){return Boolean(vendor&&document[vendor.hiddenProperty])}},hiddenProperty:{value:vendor&&vendor.hiddenProperty},stateProperty:{value:vendor&&vendor.stateProperty},changeEvent:{value:vendor&&vendor.changeEvent}}))),vendor,Fullscreen=function(){var _hasPromise,vendor=function(){try{return Object.freeze([{isEnabled:"fullscreenEnabled",element:"fullscreenElement",requestFn:"requestFullscreen",exitFn:"exitFullscreen",changeEvent:"fullscreenchange",errorEvent:"fullscreenerror"},{isEnabled:"webkitFullscreenEnabled",element:"webkitFullscreenElement",requestFn:"webkitRequestFullscreen",exitFn:"webkitExitFullscreen",changeEvent:"webkitfullscreenchange",errorEvent:"webkitfullscreenerror"},{isEnabled:"mozFullScreenEnabled",element:"mozFullScreenElement",requestFn:"mozRequestFullScreen",exitFn:"mozCancelFullScreen",changeEvent:"mozfullscreenchange",errorEvent:"mozfullscreenerror"},{isEnabled:"msFullscreenEnabled",element:"msFullscreenElement",requestFn:"msRequestFullscreen",exitFn:"msExitFullscreen",changeEvent:"MSFullscreenChange",errorEvent:"MSFullscreenError"}].find((function(vnd){return vnd.isEnabled in document})))}catch(ex){}return undefined}(),_returnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,vendor)try{var value=document.exitFullscreen();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise});function _selectElement(requestedEl){var selectedEl=requestedEl||document.documentElement;return selectedEl===document.documentElement&&("msRequestFullscreen"===vendor.requestFn||Browser.isOpera&&Browser.operaVersion<15)&&(selectedEl=document.body),selectedEl}function isFullscreen(){return Boolean(vendor&&document[vendor.element])}function requestFullscreen(options,requestedEl){var _this=this;if(!vendor)return Promise.reject(new Error("fullscreen not supported"));var element=_selectElement(requestedEl);if("function"!=typeof element[vendor.requestFn])return Promise.reject(new Error("fullscreen not supported"));if(isFullscreen())return Promise.resolve();if(_returnsPromise())return element[vendor.requestFn](options);var namespace=".Fullscreen_requestFullscreen";return new Promise((function(resolve,reject){jQuery(element).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen request error")):resolve()})),element[vendor.requestFn](options)}))}function exitFullscreen(){var _this2=this;if(!vendor||"function"!=typeof document[vendor.exitFn])return Promise.reject(new TypeError("fullscreen not supported"));if(!isFullscreen())return Promise.reject(new TypeError("fullscreen mode not active"));if(_returnsPromise())return document[vendor.exitFn]();var namespace=".Fullscreen_exitFullscreen";return new Promise((function(resolve,reject){jQuery(document).off(namespace).one("".concat(vendor.errorEvent).concat(namespace," ").concat(vendor.changeEvent).concat(namespace),(function(ev){jQuery(_this2).off(namespace),ev.type===vendor.errorEvent?reject(new Error("unknown fullscreen exit error")):resolve()})),document[vendor.exitFn]()}))}return Object.freeze(Object.defineProperties({},{vendor:{get:function(){return vendor}},element:{get:function(){return vendor?document[vendor.element]:null}},isEnabled:{value:function(){return Boolean(vendor&&document[vendor.isEnabled])}},isFullscreen:{value:isFullscreen},request:{value:requestFullscreen},exit:{value:exitFullscreen},toggle:{value:function(options,requestedEl){return isFullscreen()?exitFullscreen():requestFullscreen(options,requestedEl)}},onChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.changeEvent,handlerFn)}}},offChange:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.changeEvent,handlerFn):$(element).off(vendor.changeEvent)}}},onError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);$(element).on(vendor.errorEvent,handlerFn)}}},offError:{value:function(handlerFn,requestedEl){if(vendor){var element=_selectElement(requestedEl);handlerFn?$(element).off(vendor.errorEvent,handlerFn):$(element).off(vendor.errorEvent)}}}}))}(),_ref3=Object.freeze(Object.defineProperties({},{clone:{value:function clone(orig){return"object"!==_typeof(orig)||null===orig?orig:orig instanceof String?String(orig):orig instanceof Number?Number(orig):orig instanceof Boolean?Boolean(orig):"function"==typeof orig.clone?orig.clone(!0):orig.nodeType&&"function"==typeof orig.cloneNode?orig.cloneNode(!0):(orig instanceof Array?copy=new Array(orig.length):orig instanceof Date?copy=new Date(orig.getTime()):orig instanceof Map?(copy=new Map,orig.forEach((function(val,key){return copy.set(key,clone(val))}))):orig instanceof RegExp?copy=new RegExp(orig):orig instanceof Set?(copy=new Set,orig.forEach((function(val){return copy.add(clone(val))}))):copy=Object.create(Object.getPrototypeOf(orig)),Object.keys(orig).forEach((function(name){return copy[name]=clone(orig[name])})),copy);var copy}},convertBreaks:{value:function(source){for(var node,output=document.createDocumentFragment(),para=document.createElement("p");null!==(node=source.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":if(null!==node.nextSibling&&node.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===node.nextSibling.nodeName.toUpperCase()){source.removeChild(node.nextSibling),source.removeChild(node),output.appendChild(para),para=document.createElement("p");continue}if(!para.hasChildNodes()){source.removeChild(node);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":para.hasChildNodes()&&(output.appendChild(para),para=document.createElement("p")),output.appendChild(node);continue}para.appendChild(node)}para.hasChildNodes()&&output.appendChild(para),source.appendChild(output)}},safeActiveElement:{value:function(){try{return document.activeElement||null}catch(ex){return null}}},setDisplayTitle:{value:function(title){if("string"!=typeof title)throw new TypeError("story display title must be a string (received: ".concat(Util.getType(title),")"));var render=document.createDocumentFragment();new Wikifier(render,title);var text=function(source){for(var node,copy=source.cloneNode(!0),frag=document.createDocumentFragment();null!==(node=copy.firstChild);){if(node.nodeType===Node.ELEMENT_NODE)switch(node.nodeName.toUpperCase()){case"BR":case"DIV":case"P":frag.appendChild(document.createTextNode(" "))}frag.appendChild(node)}return frag.textContent}(render).trim();document.title=Config.passages.displayTitles&&""!==State.passage&&State.passage!==Config.passages.start?"".concat(State.passage," | ").concat(text):text;var storyTitle=document.getElementById("story-title");null!==storyTitle&&jQuery(storyTitle).empty().append(render)}},setPageElement:{value:function(idOrElement,titles,defaultText){var el="object"===_typeof(idOrElement)?idOrElement:document.getElementById(idOrElement);if(null==el)return null;var ids=Array.isArray(titles)?titles:[titles];jQuery(el).empty();for(var i=0,iend=ids.length;i<iend;++i)if(Story.has(ids[i]))return new Wikifier(el,Story.get(ids[i]).processText().trim()),el;if(null!=defaultText){var text=String(defaultText).trim();""!==text&&new Wikifier(el,text)}return el}},throwError:{value:function(place,message,source){var $wrapper=jQuery(document.createElement("div")),$toggle=jQuery(document.createElement("button")),$source=jQuery(document.createElement("pre")),mesg="".concat(L10n.get("errorTitle"),": ").concat(message||"unknown error");return $toggle.addClass("error-toggle").ariaClick({label:L10n.get("errorToggle")},(function(){$toggle.hasClass("enabled")?($toggle.removeClass("enabled"),$source.attr({"aria-hidden":!0,hidden:"hidden"})):($toggle.addClass("enabled"),$source.removeAttr("aria-hidden hidden"))})).appendTo($wrapper),jQuery(document.createElement("span")).addClass("error").text(mesg).appendTo($wrapper),jQuery(document.createElement("code")).text(source).appendTo($source),$source.addClass("error-source").attr({"aria-hidden":!0,hidden:"hidden"}).appendTo($wrapper),$wrapper.addClass("error-view").appendTo(place),console.warn("".concat(mesg,"\n\t").concat(source.replace(/\n/g,"\n\t"))),!1}},stringFrom:{value:function stringFrom(value){switch(_typeof(value)){case"function":return"[function]";case"number":if(Number.isNaN(value))return"[number NaN]";break;case"object":if(null===value)return"[null]";if(value instanceof Array)return value.map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Set)return Array.from(value).map((function(val){return stringFrom(val)})).join(", ");if(value instanceof Map){var result=Array.from(value).map((function(_ref4){var _ref5=_slicedToArray(_ref4,2),key=_ref5[0],val=_ref5[1];return"".concat(stringFrom(key)," → ").concat(stringFrom(val))}));return"{ ".concat(result.join(", ")," }")}if(value instanceof Date)return value.toLocaleString();if(value instanceof Element){if(value===document.documentElement||value===document.head||value===document.body)throw new Error("illegal operation; attempting to convert the <html>, <head>, or <body> tags to string is not allowed");return value.outerHTML}return value instanceof Node?value.textContent:"function"==typeof value.toString?value.toString():Object.prototype.toString.call(value);case"symbol":var desc=void 0!==value.description?' "'.concat(value.description,'"'):"";return"[symbol".concat(desc,"]");case"undefined":return"[undefined]"}return String(value)}}})),clone=_ref3.clone,convertBreaks=_ref3.convertBreaks,safeActiveElement=_ref3.safeActiveElement,setDisplayTitle=_ref3.setDisplayTitle,setPageElement=_ref3.setPageElement,throwError=_ref3.throwError,stringFrom=_ref3.stringFrom;!function(){function onKeypressFn(ev){13!==ev.which&&32!==ev.which||(ev.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))}function onClickFnWrapper(fn){return function(){var $this=jQuery(this);$this.ariaIsDisabled()||($this.is("[aria-pressed]")&&$this.attr("aria-pressed","true"===$this.attr("aria-pressed")?"false":"true"),fn.apply(this,arguments))}}function oneClickFnWrapper(fn){return onClickFnWrapper((function(){jQuery(this).off(".aria-clickable").removeAttr("role tabindex aria-controls aria-pressed").filter("button").prop("disabled",!0),fn.apply(this,arguments)}))}jQuery.fn.extend({ariaClick:function(options,handler){if(0===this.length||0===arguments.length)return this;var opts=options,fn=handler;return null==fn&&(fn=opts,opts=undefined),"string"!=typeof(opts=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,role:undefined,controls:undefined,pressed:undefined,label:undefined},opts)).namespace?opts.namespace="":"."!==opts.namespace[0]&&(opts.namespace=".".concat(opts.namespace)),"boolean"==typeof opts.pressed&&(opts.pressed=opts.pressed?"true":"false"),this.filter("button").prop("type","button"),null!=opts.role?this.attr("role",opts.role):this.not("[role]").filter("a,[data-passage]").attr("role","link").end().not("a").not("[data-passage]").attr("role","button").end().end().end(),this.attr("tabindex",0),null!=opts.controls&&this.attr("aria-controls",opts.controls),null!=opts.pressed&&this.attr("aria-pressed",opts.pressed),null!=opts.label&&this.attr({"aria-label":opts.label,title:opts.label}),this.not("button").on("keypress.aria-clickable".concat(opts.namespace),opts.selector,onKeypressFn),this.on("click.aria-clickable".concat(opts.namespace),opts.selector,opts.data,opts.one?oneClickFnWrapper(fn):onClickFnWrapper(fn)),this},ariaDisabled:function(disable){if(0===this.length||0===arguments.length)return this;var $nonDisableable=this.not("button,fieldset,input,menuitem,optgroup,option,select,textarea"),$disableable=this.filter("button,fieldset,input,menuitem,optgroup,option,select,textarea");return disable?($nonDisableable.each((function(){this.setAttribute("disabled",""),this.setAttribute("aria-disabled","true")})),$disableable.each((function(){this.disabled=!0,this.setAttribute("aria-disabled","true")}))):($nonDisableable.each((function(){this.removeAttribute("disabled"),this.removeAttribute("aria-disabled")})),$disableable.each((function(){this.disabled=!1,this.removeAttribute("aria-disabled")}))),this},ariaIsDisabled:function(){return this.is("[disabled]")}})}(),jQuery.extend({wikiWithOptions:function(options){for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)sources[_key-1]=arguments[_key];if(0!==sources.length){var frag=document.createDocumentFragment();sources.forEach((function(content){return new Wikifier(frag,content,options)}));var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "))}},wiki:function(){for(var _len2=arguments.length,sources=new Array(_len2),_key2=0;_key2<_len2;_key2++)sources[_key2]=arguments[_key2];this.wikiWithOptions.apply(this,[undefined].concat(sources))}}),jQuery.fn.extend({wikiWithOptions:function(options){for(var _len3=arguments.length,sources=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)sources[_key3-1]=arguments[_key3];if(0===this.length||0===sources.length)return this;var frag=document.createDocumentFragment();return sources.forEach((function(content){return new Wikifier(frag,content,options)})),this.append(frag),this},wiki:function(){for(var _len4=arguments.length,sources=new Array(_len4),_key4=0;_key4<_len4;_key4++)sources[_key4]=arguments[_key4];return this.wikiWithOptions.apply(this,[undefined].concat(sources))}});var Util=function(){var toString,utilGetType="[object Object]"===(toString=Object.prototype.toString).call(new Map)?function(O){if(null===O)return"null";if(O instanceof Map)return"Map";if(O instanceof Set)return"Set";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType}:function(O){if(null===O)return"null";var baseType=_typeof(O);return"object"===baseType?toString.call(O).slice(8,-1):baseType};function utilToEnum(obj){var pEnum=Object.create(null);if(obj instanceof Array)obj.forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Set)Array.from(obj).forEach((function(val,i){return pEnum[String(val)]=i}));else if(obj instanceof Map)obj.forEach((function(val,key){return pEnum[String(key)]=val}));else{if("object"!==_typeof(obj)||null===obj||Object.getPrototypeOf(obj)!==Object.prototype)throw new TypeError("Util.toEnum obj parameter must be an Array, Map, Set, or generic object");Object.assign(pEnum,obj)}return Object.freeze(pEnum)}function utilToStringTag(obj){return Object.prototype.toString.call(obj).slice(8,-1)}var _illegalSlugCharsRe=/[\x00-\x20!-/:-@[-^`{-\x9f]+/g,_isInvalidSlugRe=/^-*$/;var _illegalFilenameCharsRE=/[\x00-\x1f"#$%&'*+,/:;<=>?\\^`|\x7f-\x9f]+/g;var _markupCharsRe=/[!"#$&'*\-/<=>?@[\\\]^_`{|}~]/g,_hasMarkupCharsRe=new RegExp(_markupCharsRe.source),_markupCharsMap=utilToEnum({"!":"&#33;",'"':"&quot;","#":"&#35;",$:"&#36;","&":"&amp;","'":"&#39;","*":"&#42;","-":"&#45;","/":"&#47;","<":"&lt;","=":"&#61;",">":"&gt;","?":"&#63;","@":"&#64;","[":"&#91;","\\":"&#92;","]":"&#93;","^":"&#94;",_:"&#95;","`":"&#96;","{":"&#123;","|":"&#124;","}":"&#125;","~":"&#126;"});var _htmlCharsRe=/[&<>"'`]/g,_hasHtmlCharsRe=new RegExp(_htmlCharsRe.source),_htmlCharsMap=utilToEnum({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"});function utilEscape(str){if(null==str)return"";var val=String(str);return val&&_hasHtmlCharsRe.test(val)?val.replace(_htmlCharsRe,(function(ch){return _htmlCharsMap[ch]})):val}var _escapedHtmlRe=/&(?:amp|#38|#x26|lt|#60|#x3c|gt|#62|#x3e|quot|#34|#x22|apos|#39|#x27|#96|#x60);/gi,_hasEscapedHtmlRe=new RegExp(_escapedHtmlRe.source,"i"),_escapedHtmlMap=utilToEnum({"&amp;":"&","&#38;":"&","&#x26;":"&","&lt;":"<","&#60;":"<","&#x3c;":"<","&gt;":">","&#62;":">","&#x3e;":">","&quot;":'"',"&#34;":'"',"&#x22;":'"',"&apos;":"'","&#39;":"'","&#x27;":"'","&#96;":"`","&#x60;":"`"});function utilUnescape(str){if(null==str)return"";var val=String(str);return val&&_hasEscapedHtmlRe.test(val)?val.replace(_escapedHtmlRe,(function(entity){return _escapedHtmlMap[entity.toLowerCase()]})):val}var _nowSource=Has.performance?performance:Date;var _cssTimeRe=/^([+-]?(?:\d*\.)?\d+)([Mm]?[Ss])$/;var utilScrubEventKey=function(){var separatorKey,decimalKey;if("undefined"!=typeof Intl&&"function"==typeof Intl.NumberFormat){var match=(new Intl.NumberFormat).format(111111.5).match(/(\D*)\d+(\D*)/);match&&(separatorKey=match[1],decimalKey=match[2])}return separatorKey||decimalKey||(separatorKey=",",decimalKey="."),function(key){switch(key){case"Scroll":return"ScrollLock";case"Spacebar":return" ";case"Left":return"ArrowLeft";case"Right":return"ArrowRight";case"Up":return"ArrowUp";case"Down":return"ArrowDown";case"Del":return"Delete";case"Crsel":return"CrSel";case"Exsel":return"ExSel";case"Esc":return"Escape";case"Apps":return"ContextMenu";case"Nonconvert":return"NonConvert";case"MediaNextTrack":return"MediaTrackNext";case"MediaPreviousTrack":return"MediaTrackPrevious";case"VolumeUp":return"AudioVolumeUp";case"VolumeDown":return"AudioVolumeDown";case"VolumeMute":return"AudioVolumeMute";case"Zoom":return"ZoomToggle";case"SelectMedia":case"MediaSelect":return"LaunchMediaPlayer";case"Add":return"+";case"Divide":return"/";case"Multiply":return"*";case"Subtract":return"-";case"Decimal":return decimalKey;case"Separator":return separatorKey}return key}}(),utilHasMediaQuery="function"!=typeof window.matchMedia?function(){return!1}:function(mediaQuery){return window.matchMedia(mediaQuery).matches};return Object.freeze(Object.defineProperties({},{getType:{value:utilGetType},isBoolean:{value:function(obj){return"boolean"==typeof obj||"string"==typeof obj&&("true"===obj||"false"===obj)}},isIterable:{value:function(obj){return null!=obj&&"function"==typeof obj[Symbol.iterator]}},isNumeric:{value:function(obj){var num;switch(_typeof(obj)){case"number":num=obj;break;case"string":num=Number(obj);break;default:return!1}return!Number.isNaN(num)&&Number.isFinite(num)}},sameValueZero:{value:function(a,b){return a===b||a!=a&&b!=b}},toEnum:{value:utilToEnum},toStringTag:{value:utilToStringTag},slugify:{value:function(str){var base=String(str).trim(),_legacy=base.replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase();return _isInvalidSlugRe.test(_legacy)?base.replace(_illegalSlugCharsRe,"").replace(/[_\s\u2013\u2014-]+/g,"-"):_legacy}},sanitizeFilename:{value:function(str){return String(str).trim().replace(_illegalFilenameCharsRE,"")}},escapeMarkup:{value:function(str){if(null==str)return"";var val=String(str);return val&&_hasMarkupCharsRe.test(val)?val.replace(_markupCharsRe,(function(ch){return _markupCharsMap[ch]})):val}},escape:{value:utilEscape},unescape:{value:utilUnescape},charAndPosAt:{value:function(text,position){var str=String(text),pos=Math.trunc(position),code=str.charCodeAt(pos);if(Number.isNaN(code))return{char:"",start:-1,end:-1};var retval={char:str.charAt(pos),start:pos,end:pos};if(code<55296||code>57343)return retval;if(code>=55296&&code<=56319){var nextPos=pos+1;if(nextPos>=str.length)return retval;var nextCode=str.charCodeAt(nextPos);return nextCode<56320||nextCode>57343||(retval.char=retval.char+str.charAt(nextPos),retval.end=nextPos),retval}if(0===pos)return retval;var prevPos=pos-1,prevCode=str.charCodeAt(prevPos);return prevCode<55296||prevCode>56319||(retval.char=str.charAt(prevPos)+retval.char,retval.start=prevPos),retval}},now:{value:function(){return _nowSource.now()}},fromCssTime:{value:function(cssTime){var match=_cssTimeRe.exec(String(cssTime));if(null===match)throw new SyntaxError('invalid time value syntax: "'.concat(cssTime,'"'));var msec=Number(match[1]);if(1===match[2].length&&(msec*=1e3),Number.isNaN(msec)||!Number.isFinite(msec))throw new RangeError('invalid time value: "'.concat(cssTime,'"'));return msec}},toCssTime:{value:function(msec){if("number"!=typeof msec||Number.isNaN(msec)||!Number.isFinite(msec)){var what;switch(_typeof(msec)){case"string":what='"'.concat(msec,'"');break;case"number":what=String(msec);break;default:what=utilToStringTag(msec)}throw new Error("invalid milliseconds: ".concat(what))}return"".concat(msec,"ms")}},fromCssProperty:{value:function(cssName){if(!cssName.includes("-"))switch(cssName){case"bgcolor":return"backgroundColor";case"float":return"cssFloat";default:return cssName}return("-ms-"===cssName.slice(0,4)?cssName.slice(1):cssName).split("-").map((function(part,i){return 0===i?part:part.toUpperFirst()})).join("")}},parseUrl:{value:function(url){var el=document.createElement("a"),queryObj=Object.create(null);el.href=url,el.search&&el.search.replace(/^\?/,"").splitOrEmpty(/(?:&(?:amp;)?|;)/).forEach((function(query){var _query$split2=_slicedToArray(query.split("="),2),key=_query$split2[0],value=_query$split2[1];queryObj[key]=value}));var pathname=el.host&&"/"!==el.pathname[0]?"/".concat(el.pathname):el.pathname;return{href:el.href,protocol:el.protocol,host:el.host,hostname:el.hostname,port:el.port,path:"".concat(pathname).concat(el.search),pathname:pathname,query:el.search,search:el.search,queries:queryObj,searches:queryObj,hash:el.hash}}},newExceptionFrom:{value:function(original,exceptionType,override){if("object"!==_typeof(original)||null===original)throw new Error("Util.newExceptionFrom original parameter must be an object");if("function"!=typeof exceptionType)throw new Error("Util.newExceptionFrom exceptionType parameter must be an error type constructor");var ex=new exceptionType(original.message);void 0!==original.name&&(ex.name=original.name),void 0!==original.code&&(ex.code=original.code),void 0!==original.columnNumber&&(ex.columnNumber=original.columnNumber),void 0!==original.description&&(ex.description=original.description),void 0!==original.fileName&&(ex.fileName=original.fileName),void 0!==original.lineNumber&&(ex.lineNumber=original.lineNumber),void 0!==original.number&&(ex.number=original.number),void 0!==original.stack&&(ex.stack=original.stack);var overrideType=_typeof(override);if("undefined"!==overrideType)if("object"===overrideType&&null!==override)Object.assign(ex,override);else{if("string"!==overrideType)throw new Error("Util.newExceptionFrom override parameter must be an object or string");ex.message=override}return ex}},scrubEventKey:{value:utilScrubEventKey},hasMediaQuery:{value:utilHasMediaQuery},random:{value:Math.random},entityEncode:{value:utilEscape},entityDecode:{value:utilUnescape},evalExpression:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),SimpleStore=(_adapters=[],_initialized=null,Object.freeze(Object.defineProperties({},{adapters:{value:_adapters},create:{value:function(storageId,persistent){if(_initialized)return _initialized.create(storageId,persistent);for(var i=0;i<_adapters.length;++i)if(_adapters[i].init(storageId,persistent))return(_initialized=_adapters[i]).create(storageId,persistent);throw new Error("no valid storage adapters found")}}}))),_adapters,_initialized,_ok,_WebStorageAdapter;SimpleStore.adapters.push((_ok=!1,_WebStorageAdapter=function(){function _WebStorageAdapter(storageId,persistent){_classCallCheck(this,_WebStorageAdapter);var prefix="".concat(storageId,"."),engine=null,name=null;persistent?(engine=window.localStorage,name="localStorage"):(engine=window.sessionStorage,name="sessionStorage"),Object.defineProperties(this,{_engine:{value:engine},_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:name},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_WebStorageAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){for(var keys=[],i=0;i<this._engine.length;++i){var key=this._engine.key(i);this._prefixRe.test(key)&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&this._engine.hasOwnProperty(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=this._engine.getItem(this._prefix+key);return null==value?null:_WebStorageAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{this._engine.setItem(this._prefix+key,_WebStorageAdapter._serialize(value))}catch(ex){if(/quota.?(?:exceeded|reached)/i.test(ex.name+ex.message))throw Util.newExceptionFrom(ex,Error,"".concat(this.name," quota exceeded"));throw ex}return!0}},{key:"delete",value:function(key){return!("string"!=typeof key||!key||(this._engine.removeItem(this._prefix+key),0))}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_serialize",value:function(obj){return LZString.compressToUTF16(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromUTF16(str))}}]),_WebStorageAdapter}(),Object.freeze(Object.defineProperties({},{init:{value:function(){function hasWebStorage(storeId){try{var store=window[storeId],tid="_sc_".concat(String(Date.now()));store.setItem(tid,tid);var result=store.getItem(tid)===tid;return store.removeItem(tid),result}catch(ex){}return!1}return _ok=hasWebStorage("localStorage")&&hasWebStorage("sessionStorage")}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _WebStorageAdapter(storageId,persistent)}}})))),SimpleStore.adapters.push(function(){var _MAX_EXPIRY="Tue, 19 Jan 2038 03:14:07 GMT",_MIN_EXPIRY="Thu, 01 Jan 1970 00:00:00 GMT",_ok=!1,_CookieAdapter=function(){function _CookieAdapter(storageId,persistent){_classCallCheck(this,_CookieAdapter);var prefix="".concat(storageId).concat(persistent?"!":"*",".");Object.defineProperties(this,{_prefix:{value:prefix},_prefixRe:{value:new RegExp("^".concat(RegExp.escape(prefix)))},name:{value:"cookie"},id:{value:storageId},persistent:{value:!!persistent}})}return _createClass(_CookieAdapter,[{key:"length",get:function(){return this.keys().length}},{key:"size",value:function(){return this.keys().length}},{key:"keys",value:function(){if(""===document.cookie)return[];for(var cookies=document.cookie.split(/;\s*/),keys=[],i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(this._prefixRe.test(key))""!==decodeURIComponent(kvPair[1])&&keys.push(key.replace(this._prefixRe,""))}return keys}},{key:"has",value:function(key){return!("string"!=typeof key||!key)&&null!==_CookieAdapter._getCookie(this._prefix+key)}},{key:"get",value:function(key){if("string"!=typeof key||!key)return null;var value=_CookieAdapter._getCookie(this._prefix+key);return null===value?null:_CookieAdapter._deserialize(value)}},{key:"set",value:function(key,value){if("string"!=typeof key||!key)return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,_CookieAdapter._serialize(value),this.persistent?"Tue, 19 Jan 2038 03:14:07 GMT":undefined),!this.has(key))throw new Error("unknown validation error during set")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"delete",value:function(key){if("string"!=typeof key||!key||!this.has(key))return!1;try{if(_CookieAdapter._setCookie(this._prefix+key,undefined,_MIN_EXPIRY),this.has(key))throw new Error("unknown validation error during delete")}catch(ex){throw Util.newExceptionFrom(ex,Error,"cookie error: ".concat(ex.message))}return!0}},{key:"clear",value:function(){for(var keys=this.keys(),i=0,iend=keys.length;i<iend;++i)this.delete(keys[i]);return!0}}],[{key:"_getCookie",value:function(prefixedKey){if(!prefixedKey||""===document.cookie)return null;for(var cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("=");if(prefixedKey===decodeURIComponent(kvPair[0]))return decodeURIComponent(kvPair[1])||null}return null}},{key:"_setCookie",value:function(prefixedKey,value,expiry){if(prefixedKey){var payload="".concat(encodeURIComponent(prefixedKey),"=");null!=value&&(payload+=encodeURIComponent(value)),null!=expiry&&(payload+="; expires=".concat(expiry)),payload+="; path=/",document.cookie=payload}}},{key:"_serialize",value:function(obj){return LZString.compressToBase64(JSON.stringify(obj))}},{key:"_deserialize",value:function(str){return JSON.parse(LZString.decompressFromBase64(str))}}]),_CookieAdapter}();return Object.freeze(Object.defineProperties({},{init:{value:function(storageId){try{var tid="_sc_".concat(String(Date.now()));_CookieAdapter._setCookie(tid,_CookieAdapter._serialize(tid),undefined),_ok=_CookieAdapter._deserialize(_CookieAdapter._getCookie(tid))===tid,_CookieAdapter._setCookie(tid,undefined,_MIN_EXPIRY)}catch(ex){_ok=!1}return _ok&&function(storageId){if(""===document.cookie)return;for(var oldPrefix="".concat(storageId,"."),oldPrefixRe=new RegExp("^".concat(RegExp.escape(oldPrefix))),persistPrefix="".concat(storageId,"!."),sessionPrefix="".concat(storageId,"*."),sessionTestRe=/\.(?:state|rcWarn)$/,cookies=document.cookie.split(/;\s*/),i=0;i<cookies.length;++i){var kvPair=cookies[i].split("="),key=decodeURIComponent(kvPair[0]);if(oldPrefixRe.test(key)){var value=decodeURIComponent(kvPair[1]);""!==value&&function(){var persist=!sessionTestRe.test(key);_CookieAdapter._setCookie(key,undefined,_MIN_EXPIRY),_CookieAdapter._setCookie(key.replace(oldPrefixRe,(function(){return persist?persistPrefix:sessionPrefix})),value,persist?_MAX_EXPIRY:undefined)}()}}}(storageId),_ok}},create:{value:function(storageId,persistent){if(!_ok)throw new Error("adapter not initialized");return new _CookieAdapter(storageId,persistent)}}}))}());var DebugView=function(){function DebugView(parent,type,name,title){_classCallCheck(this,DebugView),Object.defineProperties(this,{parent:{value:parent},view:{value:document.createElement("span")},break:{value:document.createElement("wbr")}}),jQuery(this.view).attr({title:title,"aria-label":title,"data-type":null!=type?type:"","data-name":null!=name?name:""}).addClass("debug"),jQuery(this.break).addClass("debug hidden"),this.parent.appendChild(this.view),this.parent.appendChild(this.break)}return _createClass(DebugView,[{key:"output",get:function(){return this.view}},{key:"type",get:function(){return this.view.getAttribute("data-type")},set:function(type){this.view.setAttribute("data-type",null!=type?type:"")}},{key:"name",get:function(){return this.view.getAttribute("data-name")},set:function(name){this.view.setAttribute("data-name",null!=name?name:"")}},{key:"title",get:function(){return this.view.title},set:function(title){this.view.title=title}},{key:"append",value:function(el){return jQuery(this.view).append(el),this}},{key:"modes",value:function(options){if(null==options){var current={};return this.view.className.splitOrEmpty(/\s+/).forEach((function(name){"debug"!==name&&(current[name]=!0)})),current}if("object"===_typeof(options))return Object.keys(options).forEach((function(name){this[options[name]?"addClass":"removeClass"](name)}),jQuery(this.view)),this;throw new Error("DebugView.prototype.modes options parameter must be an object or null/undefined")}},{key:"remove",value:function(){var $view=jQuery(this.view);this.view.hasChildNodes()&&$view.contents().appendTo(this.parent),$view.remove(),jQuery(this.break).remove()}}],[{key:"isEnabled",value:function(){return"enabled"===jQuery(document.documentElement).attr("data-debug-view")}},{key:"enable",value:function(){jQuery(document.documentElement).attr("data-debug-view","enabled"),jQuery.event.trigger(":debugviewupdate")}},{key:"disable",value:function(){jQuery(document.documentElement).removeAttr("data-debug-view"),jQuery.event.trigger(":debugviewupdate")}},{key:"toggle",value:function(){"enabled"===jQuery(document.documentElement).attr("data-debug-view")?DebugView.disable():DebugView.enable()}}]),DebugView}(),NodeTyper=function(){var NodeTyper=function(){function NodeTyper(config){if(_classCallCheck(this,NodeTyper),"object"!==_typeof(config)||null===config)throw new Error("config parameter must be an object (received: ".concat(Util.getType(config),")"));if(!(config.hasOwnProperty("targetNode")&&config.targetNode instanceof Node))throw new Error('config parameter object "targetNode" property must be a node');Object.defineProperties(this,{node:{value:config.targetNode},childNodes:{value:[]},nodeValue:{writable:!0,value:""},appendTo:{writable:!0,value:config.parentNode||null},classNames:{writable:!0,value:config.classNames||null},finished:{writable:!0,value:!1}});var childNode,node=this.node;for(node.nodeValue&&(this.nodeValue=node.nodeValue,node.nodeValue="");null!==(childNode=node.firstChild);)this.childNodes.push(new NodeTyper({targetNode:childNode,parentNode:node,classNames:this.classNames})),node.removeChild(childNode)}return _createClass(NodeTyper,[{key:"finish",value:function(){for(;this.type(!0););return!1}},{key:"type",value:function(flush){if(this.finished)return!1;if(this.appendTo){if(this.appendTo.appendChild(this.node),this.appendTo=null,this.node.nodeType!==Node.ELEMENT_NODE&&this.node.nodeType!==Node.TEXT_NODE||"none"===jQuery(this.node.parentNode).css("display"))return this.finish();this.node.parentNode&&this.classNames&&jQuery(this.node.parentNode).addClass(this.classNames)}if(this.nodeValue){if(flush)this.node.nodeValue+=this.nodeValue,this.nodeValue="";else{var _Util$charAndPosAt=Util.charAndPosAt(this.nodeValue,0),char=_Util$charAndPosAt.char,start=_Util$charAndPosAt.start,end=_Util$charAndPosAt.end;this.node.nodeValue+=char,this.nodeValue=this.nodeValue.slice(1+end-start)}return!0}this.classNames&&(jQuery(this.node.parentNode).removeClass(this.classNames),this.classNames=null);for(var childNodes=this.childNodes;childNodes.length>0;){if(childNodes[0].type())return!0;childNodes.shift()}return this.finished=!0,!1}}]),NodeTyper}();return NodeTyper}(),PRNGWrapper=function(){function PRNGWrapper(seed,useEntropy){_classCallCheck(this,PRNGWrapper),Object.defineProperties(this,new Math.seedrandom(seed,useEntropy,(function(prng,seed){return{_prng:{value:prng},seed:{writable:!0,value:seed},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}})))}return _createClass(PRNGWrapper,null,[{key:"marshal",value:function(prng){if(!prng||!prng.hasOwnProperty("seed")||!prng.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:prng.seed,pull:prng.pull}}},{key:"unmarshal",value:function(prngObj){if(!prngObj||!prngObj.hasOwnProperty("seed")||!prngObj.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var prng=new PRNGWrapper(prngObj.seed,!1),i=prngObj.pull;i>0;--i)prng.random();return prng}}]),PRNGWrapper}(),StyleWrapper=(_imageMarkupRe=new RegExp(Patterns.cssImage,"g"),_hasImageMarkupRe=new RegExp(Patterns.cssImage),function(){function StyleWrapper(style){if(_classCallCheck(this,StyleWrapper),null==style)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:style}})}return _createClass(StyleWrapper,[{key:"isEmpty",value:function(){return 0===this.style.cssRules.length}},{key:"set",value:function(rawCss){this.clear(),this.add(rawCss)}},{key:"add",value:function(rawCss){var css=rawCss;_hasImageMarkupRe.test(css)&&(_imageMarkupRe.lastIndex=0,css=css.replace(_imageMarkupRe,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text.trim())}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),this.style.styleSheet?this.style.styleSheet.cssText+=css:this.style.appendChild(document.createTextNode(css))}},{key:"clear",value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":jQuery(this.style).empty()}}]),StyleWrapper}()),_imageMarkupRe,_hasImageMarkupRe,Diff=(Op=Util.toEnum({Delete:0,SpliceArray:1,Copy:2,CopyDate:3}),Object.freeze(Object.defineProperties({},{Op:{value:Op},diff:{value:function diff(orig,dest){for(var aOpRef,objToString=Object.prototype.toString,origIsArray=orig instanceof Array,keys=[].concat(Object.keys(orig),Object.keys(dest)).sort().filter((function(val,i,arr){return 0===i||arr[i-1]!==val})),diffed={},keyIsAOpRef=function(key){return key===aOpRef},i=0,klen=keys.length;i<klen;++i){var key=keys[i],origP=orig[key],destP=dest[key];if(orig.hasOwnProperty(key))if(dest.hasOwnProperty(key)){if(origP===destP)continue;if(_typeof(origP)===_typeof(destP))if("function"==typeof origP)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,destP]);else if("object"!==_typeof(origP)||null===origP)diffed[key]=[Op.Copy,destP];else{var origPType=objToString.call(origP);if(origPType===objToString.call(destP))if(origP instanceof Date)Number(origP)!==Number(destP)&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Map)diffed[key]=[Op.Copy,clone(destP)];else if(origP instanceof RegExp)origP.toString()!==destP.toString()&&(diffed[key]=[Op.Copy,clone(destP)]);else if(origP instanceof Set)diffed[key]=[Op.Copy,clone(destP)];else if("[object Object]"!==origPType)diffed[key]=[Op.Copy,clone(destP)];else{var recurse=diff(origP,destP);null!==recurse&&(diffed[key]=recurse)}else diffed[key]=[Op.Copy,clone(destP)]}else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}else if(origIsArray&&Util.isNumeric(key)){var nKey=Number(key);if(!aOpRef){aOpRef="";do{aOpRef+="~"}while(keys.some(keyIsAOpRef));diffed[aOpRef]=[Op.SpliceArray,nKey,nKey]}nKey<diffed[aOpRef][1]&&(diffed[aOpRef][1]=nKey),nKey>diffed[aOpRef][2]&&(diffed[aOpRef][2]=nKey)}else diffed[key]=Op.Delete;else diffed[key]=[Op.Copy,"object"!==_typeof(destP)||null===destP?destP:clone(destP)]}return Object.keys(diffed).length>0?diffed:null}},patch:{value:function patch(orig,diffed){for(var keys=Object.keys(diffed||{}),patched=clone(orig),i=0,klen=keys.length;i<klen;++i){var key=keys[i],diffedP=diffed[key];if(diffedP===Op.Delete)delete patched[key];else if(diffedP instanceof Array)switch(diffedP[0]){case Op.SpliceArray:patched.splice(diffedP[1],diffedP[2]-diffedP[1]+1);break;case Op.Copy:patched[key]=clone(diffedP[1]);break;case Op.CopyDate:patched[key]=new Date(diffedP[1])}else patched[key]=patch(patched[key],diffedP)}return patched}}}))),Op,L10n=(_patternRe=/\{\w+\}/g,_hasPatternRe=new RegExp(_patternRe.source),Object.freeze(Object.defineProperties({},{init:{value:function(){strings&&Object.keys(strings).length>0&&Object.keys(l10nStrings).forEach((function(id){try{var value;switch(id){case"identity":value=strings.identity;break;case"aborting":value=strings.aborting;break;case"cancel":value=strings.cancel;break;case"close":value=strings.close;break;case"ok":value=strings.ok;break;case"errorTitle":value=strings.errors.title;break;case"errorNonexistentPassage":value=strings.errors.nonexistentPassage;break;case"errorSaveMissingData":value=strings.errors.saveMissingData;break;case"errorSaveIdMismatch":value=strings.errors.saveIdMismatch;break;case"warningDegraded":value=strings.warnings.degraded;break;case"debugViewTitle":value=strings.debugView.title;break;case"debugViewToggle":value=strings.debugView.toggle;break;case"uiBarToggle":value=strings.uiBar.toggle;break;case"uiBarBackward":value=strings.uiBar.backward;break;case"uiBarForward":value=strings.uiBar.forward;break;case"uiBarJumpto":value=strings.uiBar.jumpto;break;case"jumptoTitle":value=strings.jumpto.title;break;case"jumptoTurn":value=strings.jumpto.turn;break;case"jumptoUnavailable":value=strings.jumpto.unavailable;break;case"savesTitle":value=strings.saves.title;break;case"savesDisallowed":value=strings.saves.disallowed;break;case"savesIncapable":value=strings.saves.incapable;break;case"savesLabelAuto":value=strings.saves.labelAuto;break;case"savesLabelDelete":value=strings.saves.labelDelete;break;case"savesLabelExport":value=strings.saves.labelExport;break;case"savesLabelImport":value=strings.saves.labelImport;break;case"savesLabelLoad":value=strings.saves.labelLoad;break;case"savesLabelClear":value=strings.saves.labelClear;break;case"savesLabelSave":value=strings.saves.labelSave;break;case"savesLabelSlot":value=strings.saves.labelSlot;break;case"savesUnavailable":value=strings.saves.unavailable;break;case"savesUnknownDate":value=strings.saves.unknownDate;break;case"settingsTitle":value=strings.settings.title;break;case"settingsOff":value=strings.settings.off;break;case"settingsOn":value=strings.settings.on;break;case"settingsReset":value=strings.settings.reset;break;case"restartTitle":value=strings.restart.title;break;case"restartPrompt":value=strings.restart.prompt;break;case"shareTitle":value=strings.share.title;break;case"alertTitle":break;case"autoloadTitle":value=strings.autoload.title;break;case"autoloadCancel":value=strings.autoload.cancel;break;case"autoloadOk":value=strings.autoload.ok;break;case"autoloadPrompt":value=strings.autoload.prompt;break;case"macroBackText":value=strings.macros.back.text;break;case"macroReturnText":value=strings.macros.return.text}value&&(l10nStrings[id]=value.replace(/%\w+%/g,(function(pat){return"{".concat(pat.slice(1,-1),"}")})))}catch(ex){}}))}},get:{value:function(ids,overrides){if(!ids)return"";var selectedId,id=((Array.isArray(ids)?ids:[ids]).some((function(id){return!!l10nStrings.hasOwnProperty(id)&&(selectedId=id,!0)})),selectedId);if(!id)return"";for(var processed=l10nStrings[id],iteration=0;_hasPatternRe.test(processed);){if(++iteration>50)throw new Error("L10n.get exceeded maximum replacement iterations, probable infinite loop");_patternRe.lastIndex=0,processed=processed.replace(_patternRe,(function(pat){var subId=pat.slice(1,-1);return overrides&&overrides.hasOwnProperty(subId)?overrides[subId]:l10nStrings.hasOwnProperty(subId)?l10nStrings[subId]:void 0}))}return processed}}}))),_patternRe,_hasPatternRe,strings={errors:{},warnings:{},debugView:{},uiBar:{},jumpto:{},saves:{},settings:{},restart:{},share:{},autoload:{},macros:{back:{},return:{}}},l10nStrings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errorTitle:"Error",errorToggle:"Toggle the error view",errorNonexistentPassage:'the passage "{passage}" does not exist',errorSaveDiskLoadFailed:"failed to load save file from disk",errorSaveMissingData:"save is missing required data. Either the loaded file is not a save or the save has become corrupted",errorSaveIdMismatch:"save is from the wrong {identity}",_warningIntroLacking:"Your browser either lacks or has disabled",_warningOutroDegraded:", so this {identity} is running in a degraded mode. You may be able to continue, however, some parts may not work properly.",warningNoWebStorage:"{_warningIntroLacking} the Web Storage API{_warningOutroDegraded}",warningDegraded:"{_warningIntroLacking} some of the capabilities required by this {identity}{_warningOutroDegraded}",debugBarToggle:"Toggle the debug bar",debugBarNoWatches:"— no watches set —",debugBarAddWatch:"Add watch",debugBarDeleteWatch:"Delete watch",debugBarWatchAll:"Watch all",debugBarWatchNone:"Delete all",debugBarLabelAdd:"Add",debugBarLabelWatch:"Watch",debugBarLabelTurn:"Turn",debugBarLabelViews:"Views",debugBarViewsToggle:"Toggle the debug views",debugBarWatchToggle:"Toggle the watch panel",uiBarToggle:"Toggle the UI bar",uiBarBackward:"Go backward within the {identity} history",uiBarForward:"Go forward within the {identity} history",uiBarJumpto:"Jump to a specific point within the {identity} history",jumptoTitle:"Jump To",jumptoTurn:"Turn",jumptoUnavailable:"No jump points currently available…",savesTitle:"Saves",savesDisallowed:"Saving has been disallowed on this passage.",savesIncapable:"{_warningIntroLacking} the capabilities required to support saves, so saves have been disabled for this session.",savesLabelAuto:"Autosave",savesLabelDelete:"Delete",savesLabelExport:"Save to Disk…",savesLabelImport:"Load from Disk…",savesLabelLoad:"Load",savesLabelClear:"Delete All",savesLabelSave:"Save",savesLabelSlot:"Slot",savesUnavailable:"No save slots found…",savesUnknownDate:"unknown",settingsTitle:"Settings",settingsOff:"Off",settingsOn:"On",settingsReset:"Reset to Defaults",restartTitle:"Restart",restartPrompt:"Are you sure that you want to restart? Unsaved progress will be lost.",shareTitle:"Share",alertTitle:"Alert",autoloadTitle:"Autoload",autoloadCancel:"Go to start",autoloadOk:"Load autosave",autoloadPrompt:"An autosave exists. Load it now or go to the start?",macroBackText:"Back",macroReturnText:"Return"},Config=(_debug=!1,_addVisitedLinkClass=!1,_cleanupWikifierOutput=!1,_loadDelay=0,_audioPauseOnFadeToZero=!0,_audioPreloadMetadata=!0,_historyControls=!0,_historyMaxStates=40,_macrosIfAssignmentError=!0,_macrosMaxLoopIterations=1e3,_macrosTypeSkipKey=" ",_macrosTypeVisitedPassages=!0,_passagesDisplayTitles=!1,_passagesNobr=!1,_savesId="untitled-story",_savesSlots=8,_savesTryDiskOnMobile=!0,_uiStowBarInitially=800,_uiUpdateStoryElements=!0,_errHistoryModeDeprecated="Config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code",Object.freeze({get debug(){return _debug},set debug(value){_debug=Boolean(value)},get addVisitedLinkClass(){return _addVisitedLinkClass},set addVisitedLinkClass(value){_addVisitedLinkClass=Boolean(value)},get cleanupWikifierOutput(){return _cleanupWikifierOutput},set cleanupWikifierOutput(value){_cleanupWikifierOutput=Boolean(value)},get loadDelay(){return _loadDelay},set loadDelay(value){if(!Number.isSafeInteger(value)||value<0)throw new RangeError("Config.loadDelay must be a non-negative integer");_loadDelay=value},audio:Object.freeze({get pauseOnFadeToZero(){return _audioPauseOnFadeToZero},set pauseOnFadeToZero(value){_audioPauseOnFadeToZero=Boolean(value)},get preloadMetadata(){return _audioPreloadMetadata},set preloadMetadata(value){_audioPreloadMetadata=Boolean(value)}}),history:Object.freeze({get controls(){return _historyControls},set controls(value){var controls=Boolean(value);if(1===_historyMaxStates&&controls)throw new Error("Config.history.controls must be false when Config.history.maxStates is 1");_historyControls=controls},get maxStates(){return _historyMaxStates},set maxStates(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.history.maxStates must be a positive integer");_historyMaxStates=value,_historyControls&&1===value&&(_historyControls=!1)},get mode(){throw new Error(_errHistoryModeDeprecated)},set mode(_){throw new Error(_errHistoryModeDeprecated)},get tracking(){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")},set tracking(_){throw new Error("Config.history.tracking has been deprecated, use Config.history.maxStates instead")}}),macros:Object.freeze({get ifAssignmentError(){return _macrosIfAssignmentError},set ifAssignmentError(value){_macrosIfAssignmentError=Boolean(value)},get maxLoopIterations(){return _macrosMaxLoopIterations},set maxLoopIterations(value){if(!Number.isSafeInteger(value)||value<1)throw new RangeError("Config.macros.maxLoopIterations must be a positive integer");_macrosMaxLoopIterations=value},get typeSkipKey(){return _macrosTypeSkipKey},set typeSkipKey(value){_macrosTypeSkipKey=String(value)},get typeVisitedPassages(){return _macrosTypeVisitedPassages},set typeVisitedPassages(value){_macrosTypeVisitedPassages=Boolean(value)}}),navigation:Object.freeze({get override(){return _navigationOverride},set override(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.navigation.override must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_navigationOverride=value}}),passages:Object.freeze({get descriptions(){return _passagesDescriptions},set descriptions(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"Object"!==valueType&&"function"!==valueType)throw new TypeError("Config.passages.descriptions must be a boolean, object, function, or null/undefined (received: ".concat(valueType,")"))}_passagesDescriptions=value},get displayTitles(){return _passagesDisplayTitles},set displayTitles(value){_passagesDisplayTitles=Boolean(value)},get nobr(){return _passagesNobr},set nobr(value){_passagesNobr=Boolean(value)},get onProcess(){return _passagesOnProcess},set onProcess(value){if(null!=value){var valueType=Util.getType(value);if("function"!==valueType)throw new TypeError("Config.passages.onProcess must be a function or null/undefined (received: ".concat(valueType,")"))}_passagesOnProcess=value},get start(){return _passagesStart},set start(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType)throw new TypeError("Config.passages.start must be a string or null/undefined (received: ".concat(valueType,")"))}_passagesStart=value},get transitionOut(){return _passagesTransitionOut},set transitionOut(value){if(null!=value){var valueType=Util.getType(value);if("string"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.passages.transitionOut must be a string, non-negative integer, or null/undefined (received: ".concat(valueType,")"))}_passagesTransitionOut=value}}),saves:Object.freeze({get autoload(){return _savesAutoload},set autoload(value){if(null!=value){var valueType=Util.getType(value);if("boolean"!==valueType&&"string"!==valueType&&"function"!==valueType)throw new TypeError("Config.saves.autoload must be a boolean, string, function, or null/undefined (received: ".concat(valueType,")"))}_savesAutoload=value},get autosave(){return _savesAutosave},set autosave(value){if(null!=value){var valueType=Util.getType(value);if("string"===valueType)return void(_savesAutosave=[value]);if("boolean"!==valueType&&("Array"!==valueType||!value.every((function(item){return"string"==typeof item})))&&"function"!==valueType)throw new TypeError("Config.saves.autosave must be a boolean, Array<string>, function, or null/undefined (received: ".concat(valueType).concat("Array"===valueType?"<any>":"",")"))}_savesAutosave=value},get id(){return _savesId},set id(value){if("string"!=typeof value||""===value)throw new TypeError("Config.saves.id must be a non-empty string (received: ".concat(Util.getType(value),")"));_savesId=value},get isAllowed(){return _savesIsAllowed},set isAllowed(value){if(!(null==value||value instanceof Function))throw new TypeError("Config.saves.isAllowed must be a function or null/undefined (received: ".concat(Util.getType(value),")"));_savesIsAllowed=value},get slots(){return _savesSlots},set slots(value){if(!Number.isSafeInteger(value)||value<0)throw new TypeError("Config.saves.slots must be a non-negative integer (received: ".concat(Util.getType(value),")"));_savesSlots=value},get tryDiskOnMobile(){return _savesTryDiskOnMobile},set tryDiskOnMobile(value){_savesTryDiskOnMobile=Boolean(value)},get version(){return _savesVersion},set version(value){_savesVersion=value},get onLoad(){throw new Error("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead")},set onLoad(value){console.warn("Config.saves.onLoad has been deprecated, use the Save.onLoad API instead"),Save.onLoad.add(value)},get onSave(){throw new Error("Config.saves.onSave has been deprecated, use the Save.onSave API instead")},set onSave(value){console.warn("Config.saves.onSave has been deprecated, use the Save.onSave API instead"),Save.onSave.add(value)}}),ui:Object.freeze({get stowBarInitially(){return _uiStowBarInitially},set stowBarInitially(value){var valueType=Util.getType(value);if("boolean"!==valueType&&("number"!==valueType||!Number.isSafeInteger(value)||value<0))throw new TypeError("Config.ui.stowBarInitially must be a boolean or non-negative integer (received: ".concat(valueType,")"));_uiStowBarInitially=value},get updateStoryElements(){return _uiUpdateStoryElements},set updateStoryElements(value){_uiUpdateStoryElements=Boolean(value)}})})),_navigationOverride,_passagesDescriptions,_passagesStart,_passagesOnProcess,_passagesTransitionOut,_savesAutoload,_savesAutosave,_savesIsAllowed,_savesVersion,_debug,_addVisitedLinkClass,_cleanupWikifierOutput,_loadDelay,_audioPauseOnFadeToZero,_audioPreloadMetadata,_historyControls,_historyMaxStates,_macrosIfAssignmentError,_macrosMaxLoopIterations,_macrosTypeSkipKey,_macrosTypeVisitedPassages,_passagesDisplayTitles,_passagesNobr,_savesId,_savesSlots,_savesTryDiskOnMobile,_uiStowBarInitially,_uiUpdateStoryElements,_errHistoryModeDeprecated,SimpleAudio=function(){var _hasPromise,_gestureEventNames=Object.freeze(["click","contextmenu","dblclick","keyup","mouseup","pointerup","touchend"]),_specialIds=Object.freeze([":not",":all",":looped",":muted",":paused",":playing"]),_formatSpecRe=/^([\w-]+)\s*\|\s*(\S.*)$/,_badIdRe=/[:\s]/,_tracks=new Map,_groups=new Map,_lists=new Map,_subscribers=new Map,_masterRate=1,_masterVolume=1,_masterMute=!1,_masterMuteOnHidden=!1,_playReturnsPromise=(_hasPromise=null,function(){if(null!==_hasPromise)return _hasPromise;if(_hasPromise=!1,Has.audio)try{var audio=document.createElement("audio");audio.muted=!0;var value=audio.play();value.catch((function(){})),_hasPromise=value instanceof Promise}catch(ex){}return _hasPromise}),AudioTrack=function(){function AudioTrack(obj){if(_classCallCheck(this,AudioTrack),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioTrack))throw new Error("sources parameter must be either an array, of URIs or source objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioTrack,[{key:"_create",value:function(sourceList){var dataUriRe=/^data:\s*audio\/(?:x-)?([^;,]+)\s*[;,]/i,extRe=/\.([^./\\]+)$/,formats=AudioTrack.formats,usedSources=[],audio=document.createElement("audio");audio.preload="none",sourceList.forEach((function(src){var srcUri=null;switch(_typeof(src)){case"string":var match;if("data:"===src.slice(0,5)){if(null===(match=dataUriRe.exec(src)))throw new Error("source data URI missing media type")}else if(null===(match=extRe.exec(Util.parseUrl(src).pathname)))throw new Error("source URL missing file extension");formats[match[1]]&&(srcUri=src);break;case"object":if(null===src)throw new Error("source object cannot be null");if(!src.hasOwnProperty("src"))throw new Error('source object missing required "src" property');if(!src.hasOwnProperty("format"))throw new Error('source object missing required "format" property');formats[src.format]&&(srcUri=src.src);break;default:throw new Error("invalid source value (type: ".concat(_typeof(src),")"))}if(null!==srcUri){var source=document.createElement("source");source.src=srcUri,audio.appendChild(source),usedSources.push(srcUri)}})),audio.hasChildNodes()&&Config.audio.preloadMetadata&&(audio.preload="metadata"),this._finalize(audio,usedSources,clone(sourceList))}},{key:"_copy",value:function(obj){this._finalize(obj.audio.cloneNode(!0),clone(obj.sources),clone(obj.originals))}},{key:"_finalize",value:function(audio,sources,originals){var _this3=this;Object.defineProperties(this,{audio:{configurable:!0,value:audio},sources:{value:Object.freeze(sources)},originals:{value:Object.freeze(originals)},_error:{writable:!0,value:!1},_faderId:{writable:!0,value:null},_mute:{writable:!0,value:!1},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1}}),jQuery(this.audio).on("loadstart.AudioTrack",(function(){return _this3._error=!1})).on("error.AudioTrack",(function(){return _this3._error=!0})).find("source:last-of-type").on("error.AudioTrack",(function(){return _this3._trigger("error")})),function(id,callback){if("function"!=typeof callback)throw new Error("callback parameter must be a function");_subscribers.set(id,callback)}(this,(function(mesg){if(_this3.audio)switch(mesg){case"loadwithscreen":if(_this3.hasSource()){var lockId=LoadScreen.lock();_this3.one("canplaythrough.AudioTrack_loadwithscreen error.AudioTrack_loadwithscreen",(function(){jQuery(this).off(".AudioTrack_loadwithscreen"),LoadScreen.unlock(lockId)})).load()}break;case"load":_this3.load();break;case"mute":_this3._updateAudioMute();break;case"rate":_this3._updateAudioRate();break;case"stop":_this3.stop();break;case"volume":_this3._updateAudioVolume();break;case"unload":_this3.unload()}else unsubscribe(_this3)})),this._updateAudioMute(),this._updateAudioRate(),this._updateAudioVolume()}},{key:"_trigger",value:function(eventName){jQuery(this.audio).triggerHandler(eventName)}},{key:"_destroy",value:function(){unsubscribe(this),this.audio&&(jQuery(this.audio).off(),this.unload(),this._error=!0,delete this.audio)}},{key:"clone",value:function(){return new AudioTrack(this)}},{key:"load",value:function(){var _this4=this;if(this.fadeStop(),this.audio.pause(),!this.audio.hasChildNodes()){if(0===this.sources.length)return;this.sources.forEach((function(srcUri){var source=document.createElement("source");source.src=srcUri,_this4.audio.appendChild(source)}))}"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.isLoading()||this.audio.load()}},{key:"unload",value:function(){this.fadeStop(),this.stop();var audio=this.audio;for(audio.preload="none";audio.hasChildNodes();)audio.removeChild(audio.firstChild);audio.load()}},{key:"play",value:function(){var _this5=this;if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));"auto"!==this.audio.preload&&(this.audio.preload="auto");var namespace=".AudioTrack_play";return _playReturnsPromise()?this.audio.play():new Promise((function(resolve,reject){_this5.isPlaying()?resolve():(jQuery(_this5.audio).off(namespace).one("error".concat(namespace," playing").concat(namespace," timeupdate").concat(namespace),(function(ev){jQuery(_this5).off(namespace),"error"===ev.type?reject(new Error("unknown audio play error")):resolve()})),_this5.audio.play())}))}},{key:"playWhenAllowed",value:function(){var _this6=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioTrack_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioTrack_playWhenAllowed"),_this6.audio.play()}))}))}},{key:"pause",value:function(){this.audio.pause()}},{key:"stop",value:function(){this.audio.pause(),this.time(0),this._trigger(":stopped")}},{key:"fade",value:function(duration,toVol,fromVol){var _this7=this;if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(!this.hasSource())return Promise.reject(new Error("none of the candidate sources were acceptable"));if(this.isUnloaded())return Promise.reject(new Error("no sources are loaded"));if(this.isFailed())return Promise.reject(new Error("failed to load any of the sources"));this.fadeStop();var from=Math.clamp(null==fromVol?this.volume():fromVol,0,1),to=Math.clamp(toVol,0,1);return from!==to?(this.volume(from),jQuery(this.audio).off("timeupdate.AudioTrack_fade").one("timeupdate.AudioTrack_fade",(function(){var min,max;from<to?(min=from,max=to):(min=to,max=from);var time=Math.max(duration,1),delta=(to-from)/(time/.025);_this7._trigger(":fading"),_this7._faderId=setInterval((function(){_this7.isPlaying()?(_this7.volume(Math.clamp(_this7.volume()+delta,min,max)),Config.audio.pauseOnFadeToZero&&0===_this7.volume()&&_this7.pause(),_this7.volume()===to&&(_this7.fadeStop(),_this7._trigger(":faded"))):_this7.fadeStop()}),25)})),this.play()):void 0}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null)}},{key:"loop",value:function(_loop){return null==_loop?this.audio.loop:(this.audio.loop=!!_loop,this)}},{key:"mute",value:function(_mute){return null==_mute?this._mute:(this._mute=!!_mute,this._updateAudioMute(),this)}},{key:"_updateAudioMute",value:function(){this.audio.muted=this._mute||_masterMute}},{key:"rate",value:function(_rate){if(null==_rate)return this._rate;if("number"!=typeof _rate)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate,.2,5),this._updateAudioRate(),this}},{key:"_updateAudioRate",value:function(){this.audio.playbackRate=Math.clamp(this._rate*_masterRate,.2,5)}},{key:"time",value:function(_time){var _this8=this;if(null==_time)return this.audio.currentTime;if("number"!=typeof _time)throw new TypeError("time parameter must be a number");return this.hasMetadata()?this.audio.currentTime=_time:jQuery(this.audio).off("loadedmetadata.AudioTrack_time").one("loadedmetadata.AudioTrack_time",(function(){return _this8.audio.currentTime=_time})),this}},{key:"volume",value:function(_volume){if(null==_volume)return this._volume;if("number"!=typeof _volume)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume,0,1),this._updateAudioVolume(),this}},{key:"_updateAudioVolume",value:function(){this.audio.volume=Math.clamp(this._volume*_masterVolume,0,1)}},{key:"duration",value:function(){return this.audio.duration}},{key:"remaining",value:function(){return this.audio.duration-this.audio.currentTime}},{key:"isFailed",value:function(){return this._error}},{key:"isLoading",value:function(){return this.audio.networkState===HTMLMediaElement.NETWORK_LOADING}},{key:"isUnloaded",value:function(){return!this.audio.hasChildNodes()}},{key:"isUnavailable",value:function(){return!this.hasSource()||this.isUnloaded()||this.isFailed()}},{key:"isPlaying",value:function(){return!this.audio.paused&&this.hasSomeData()}},{key:"isPaused",value:function(){return this.audio.paused&&(this.audio.duration===1/0||this.audio.currentTime>0)&&!this.audio.ended}},{key:"isStopped",value:function(){return this.audio.paused&&0===this.audio.currentTime}},{key:"isEnded",value:function(){return this.audio.ended}},{key:"isFading",value:function(){return null!==this._faderId}},{key:"isSeeking",value:function(){return this.audio.seeking}},{key:"hasSource",value:function(){return this.sources.length>0}},{key:"hasNoData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_NOTHING}},{key:"hasMetadata",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_METADATA}},{key:"hasSomeData",value:function(){return this.audio.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA}},{key:"hasData",value:function(){return this.audio.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA}},{key:"on",value:function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=arguments[_key5];return jQuery.fn.on.apply(jQuery(this.audio),args),this}},{key:"one",value:function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return jQuery.fn.one.apply(jQuery(this.audio),args),this}},{key:"off",value:function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++)args[_key7]=arguments[_key7];return jQuery.fn.off.apply(jQuery(this.audio),args),this}}]),AudioTrack}();Object.defineProperties(AudioTrack,{formats:{value:function(){var audio=document.createElement("audio"),types=new Map;function canPlay(mimeType){return types.has(mimeType)||types.set(mimeType,""!==audio.canPlayType(mimeType).replace(/^no$/i,"")),types.get(mimeType)}return Object.assign(Object.create(null),{aac:canPlay("audio/aac"),caf:canPlay("audio/x-caf")||canPlay("audio/caf"),flac:canPlay("audio/x-flac")||canPlay("audio/flac"),mp3:canPlay('audio/mpeg; codecs="mp3"')||canPlay("audio/mpeg")||canPlay("audio/mp3")||canPlay("audio/mpa"),mpeg:canPlay("audio/mpeg"),m4a:canPlay("audio/x-m4a")||canPlay("audio/m4a")||canPlay("audio/aac"),mp4:canPlay("audio/x-mp4")||canPlay("audio/mp4")||canPlay("audio/aac"),ogg:canPlay("audio/ogg"),oga:canPlay("audio/ogg"),opus:canPlay('audio/ogg; codecs="opus"')||canPlay("audio/opus"),wav:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),wave:canPlay('audio/wave; codecs="1"')||canPlay('audio/wav; codecs="1"')||canPlay("audio/wave")||canPlay("audio/wav"),weba:canPlay("audio/webm"),webm:canPlay("audio/webm")})}()}});var AudioList=function(){function AudioList(obj){if(_classCallCheck(this,AudioList),obj instanceof Array)this._create(obj);else{if(!(obj instanceof AudioList))throw new Error("tracks parameter must be either an array, of track objects, or an AudioTrack instance");this._copy(obj)}}return _createClass(AudioList,[{key:"_create",value:function(trackList){var _this9=this;this._finalize(trackList.map((function(trackObj){if("object"!==_typeof(trackObj))throw new Error("tracks parameter array members must be objects");var own,rate,track,volume;if(trackObj instanceof AudioTrack)own=!0,rate=trackObj.rate(),track=trackObj.clone(),volume=trackObj.volume();else{if(!trackObj.hasOwnProperty("track"))throw new Error('track object missing required "track" property');if(!(trackObj.track instanceof AudioTrack))throw new Error('track object\'s "track" property must be an AudioTrack object');own=trackObj.hasOwnProperty("own")&&trackObj.own,rate=trackObj.hasOwnProperty("rate")?trackObj.rate:trackObj.track.rate(),track=trackObj.track,volume=trackObj.hasOwnProperty("volume")?trackObj.volume:trackObj.track.volume()}return track.stop(),track.loop(!1),track.mute(!1),track.rate(rate),track.volume(volume),track.on("ended.AudioList",(function(){return _this9._onEnd()})),{own:own,track:track,volume:volume,rate:rate}})))}},{key:"_copy",value:function(obj){this._finalize(clone(obj.tracks))}},{key:"_finalize",value:function(tracks){Object.defineProperties(this,{tracks:{configurable:!0,value:Object.freeze(tracks)},queue:{configurable:!0,value:[]},current:{writable:!0,value:null},_rate:{writable:!0,value:1},_volume:{writable:!0,value:1},_mute:{writable:!0,value:!1},_loop:{writable:!0,value:!1},_shuffle:{writable:!0,value:!1}})}},{key:"_destroy",value:function(){this.stop(),this.tracks.filter((function(trackObj){return trackObj.own})).forEach((function(trackObj){return trackObj.track._destroy()})),delete this.tracks,delete this.queue}},{key:"load",value:function(){this.tracks.forEach((function(trackObj){return trackObj.track.load()}))}},{key:"unload",value:function(){this.stop(),this.tracks.forEach((function(trackObj){return trackObj.track.unload()}))}},{key:"play",value:function(){return null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||(0===this.queue.length&&this._fillQueue(),this._next())?this.current.track.play():Promise.reject(new Error("no tracks were available"))}},{key:"playWhenAllowed",value:function(){var _this10=this;this.play().catch((function(){var gestures=_gestureEventNames.map((function(name){return"".concat(name,".AudioList_playWhenAllowed")})).join(" ");jQuery(document).one(gestures,(function(){jQuery(document).off(".AudioList_playWhenAllowed"),_this10.play()}))}))}},{key:"pause",value:function(){null!==this.current&&this.current.track.pause()}},{key:"stop",value:function(){null!==this.current&&(this.current.track.stop(),this.current=null),this._drainQueue()}},{key:"skip",value:function(){this._next()?this.current.track.play():this._loop&&this.play()}},{key:"fade",value:function(duration,toVol,fromVol){if("number"!=typeof duration)throw new TypeError("duration parameter must be a number");if("number"!=typeof toVol)throw new TypeError("toVolume parameter must be a number");if(null!=fromVol&&"number"!=typeof fromVol)throw new TypeError("fromVolume parameter must be a number");if(0===this.queue.length&&this._fillQueue(),null!==this.current&&!this.current.track.isUnavailable()&&!this.current.track.isEnded()||this._next()){var adjFromVol,adjToVol=Math.clamp(toVol,0,1)*this.current.volume;return null!=fromVol&&(adjFromVol=Math.clamp(fromVol,0,1)*this.current.volume),this._volume=toVol,this.current.track.fade(duration,adjToVol,adjFromVol)}}},{key:"fadeIn",value:function(duration,fromVol){return this.fade(duration,1,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){return this.fade(duration,0,fromVol)}},{key:"fadeStop",value:function(){null!==this.current&&this.current.track.fadeStop()}},{key:"loop",value:function(_loop2){return null==_loop2?this._loop:(this._loop=!!_loop2,this)}},{key:"mute",value:function(_mute2){return null==_mute2?this._mute:(this._mute=!!_mute2,null!==this.current&&this.current.track.mute(this._mute),this)}},{key:"rate",value:function(_rate2){if(null==_rate2)return this._rate;if("number"!=typeof _rate2)throw new TypeError("rate parameter must be a number");return this._rate=Math.clamp(_rate2,.2,5),null!==this.current&&this.current.track.rate(this._rate*this.current.rate),this}},{key:"shuffle",value:function(_shuffle){var _this11=this;if(null==_shuffle)return this._shuffle;if(this._shuffle=!!_shuffle,this.queue.length>0&&(this._fillQueue(),!this._shuffle&&null!==this.current&&this.queue.length>1)){var _this$queue,firstIdx=this.queue.findIndex((function(trackObj){return trackObj===_this11.current}));if(-1!==firstIdx)(_this$queue=this.queue).push.apply(_this$queue,_toConsumableArray(this.queue.splice(0,firstIdx+1)))}return this}},{key:"volume",value:function(_volume2){if(null==_volume2)return this._volume;if("number"!=typeof _volume2)throw new TypeError("volume parameter must be a number");return this._volume=Math.clamp(_volume2,0,1),null!==this.current&&this.current.track.volume(this._volume*this.current.volume),this}},{key:"duration",value:function(){if(arguments.length>0)throw new Error("duration takes no parameters");return this.tracks.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0)}},{key:"remaining",value:function(){if(arguments.length>0)throw new Error("remaining takes no parameters");var remainingTime=this.queue.map((function(trackObj){return trackObj.track.duration()})).reduce((function(prev,cur){return prev+cur}),0);return null!==this.current&&(remainingTime+=this.current.track.remaining()),remainingTime}},{key:"time",value:function(){if(arguments.length>0)throw new Error("time takes no parameters");return this.duration()-this.remaining()}},{key:"isPlaying",value:function(){return null!==this.current&&this.current.track.isPlaying()}},{key:"isPaused",value:function(){return null===this.current||this.current.track.isPaused()}},{key:"isStopped",value:function(){return 0===this.queue.length&&null===this.current}},{key:"isEnded",value:function(){return 0===this.queue.length&&(null===this.current||this.current.track.isEnded())}},{key:"isFading",value:function(){return null!==this.current&&this.current.track.isFading()}},{key:"_next",value:function(){var nextTrack;for(null!==this.current&&(this.current.track.stop(),this.current=null);nextTrack=this.queue.shift();)if(!nextTrack.track.isUnavailable()){this.current=nextTrack;break}return null!==this.current&&(this.current.track.mute(this._mute),this.current.track.rate(this._rate*this.current.rate),this.current.track.volume(this._volume*this.current.volume),this.current.track.loop(!1),!0)}},{key:"_onEnd",value:function(){if(0===this.queue.length){if(!this._loop)return;this._fillQueue()}this._next()&&this.current.track.play()}},{key:"_drainQueue",value:function(){this.queue.splice(0)}},{key:"_fillQueue",value:function(){var _this$queue2;this._drainQueue(),(_this$queue2=this.queue).push.apply(_this$queue2,_toConsumableArray(this.tracks.filter((function(trackObj){return!trackObj.track.isUnavailable()})))),0!==this.queue.length&&this._shuffle&&(this.queue.shuffle(),this.queue.length>1&&this.queue[0]===this.current&&this.queue.push(this.queue.shift()))}}]),AudioList}(),AudioRunner=function(){function AudioRunner(list){if(_classCallCheck(this,AudioRunner),!(list instanceof Set||list instanceof AudioRunner))throw new TypeError("list parameter must be a Set or a AudioRunner instance");Object.defineProperties(this,{trackIds:{value:new Set(list instanceof AudioRunner?list.trackIds:list)}})}return _createClass(AudioRunner,[{key:"load",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.load)}},{key:"unload",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.unload)}},{key:"play",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.play)}},{key:"playWhenAllowed",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.playWhenAllowed)}},{key:"pause",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.pause)}},{key:"stop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.stop)}},{key:"fade",value:function(duration,toVol,fromVol){if(null==duration||null==toVol)throw new Error("fade requires parameters");AudioRunner._run(this.trackIds,AudioTrack.prototype.fade,duration,toVol,fromVol)}},{key:"fadeIn",value:function(duration,fromVol){if(null==duration)throw new Error("fadeIn requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeIn,duration,fromVol)}},{key:"fadeOut",value:function(duration,fromVol){if(null==duration)throw new Error("fadeOut requires a parameter");AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeOut,duration,fromVol)}},{key:"fadeStop",value:function(){AudioRunner._run(this.trackIds,AudioTrack.prototype.fadeStop)}},{key:"loop",value:function(_loop3){if(null==_loop3)throw new Error("loop requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.loop,_loop3),this}},{key:"mute",value:function(_mute3){if(null==_mute3)throw new Error("mute requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.mute,_mute3),this}},{key:"rate",value:function(_rate3){if(null==_rate3)throw new Error("rate requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.rate,_rate3),this}},{key:"time",value:function(_time2){if(null==_time2)throw new Error("time requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.time,_time2),this}},{key:"volume",value:function(_volume3){if(null==_volume3)throw new Error("volume requires a parameter");return AudioRunner._run(this.trackIds,AudioTrack.prototype.volume,_volume3),this}},{key:"on",value:function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.on].concat(args)),this}},{key:"one",value:function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.one].concat(args)),this}},{key:"off",value:function(){for(var _len10=arguments.length,args=new Array(_len10),_key10=0;_key10<_len10;_key10++)args[_key10]=arguments[_key10];return AudioRunner._run.apply(AudioRunner,[this.trackIds,AudioTrack.prototype.off].concat(args)),this}}],[{key:"_run",value:function(ids,fn){for(var _len11=arguments.length,args=new Array(_len11>2?_len11-2:0),_key11=2;_key11<_len11;_key11++)args[_key11-2]=arguments[_key11];ids.forEach((function(id){var track=_tracks.get(id);track&&fn.apply(track,args)}))}}]),AudioRunner}();var _runnerParseSelector=function(){var notWsRe=/\S/g,parenRe=/[()]/g;function processNegation(str,startPos){var match;if(notWsRe.lastIndex=startPos,null===(match=notWsRe.exec(str))||"("!==match[0])throw new Error('invalid ":not()" syntax: missing parentheticals');parenRe.lastIndex=notWsRe.lastIndex;for(var start=notWsRe.lastIndex,result={str:"",nextMatch:-1},depth=1;null!==(match=parenRe.exec(str));)if("("===match[0]?++depth:--depth,depth<1){result.nextMatch=parenRe.lastIndex,result.str=str.slice(start,result.nextMatch-1);break}return result}return function parseSelector(idArg){for(var match,ids=[],idRe=/:?[^\s:()]+/g;null!==(match=idRe.exec(idArg));){var id=match[0];if(":not"===id){if(0===ids.length)throw new Error('invalid negation: no group ID preceded ":not()"');var parent=ids[ids.length-1];if(":"!==parent.id[0])throw new Error('invalid negation of track "'.concat(parent.id,'": only groups may be negated with ":not()"'));var negation=processNegation(idArg,idRe.lastIndex);if(-1===negation.nextMatch)throw new Error('unknown error parsing ":not()"');idRe.lastIndex=negation.nextMatch,parent.not=parseSelector(negation.str)}else ids.push({id:id})}return ids}}();function masterMute(mute){if(null==mute)return _masterMute;publish("mute",_masterMute=!!mute)}function unsubscribe(id){_subscribers.delete(id)}function publish(mesg,data){_subscribers.forEach((function(fn){return fn(mesg,data)}))}function _newTrack(sources){return new AudioTrack(sources.map((function(source){if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);if(passage.tags.includes("Twine.audio"))return passage.text.trim()}var match=_formatSpecRe.exec(source);return null===match?source:{format:match[1],src:match[2]}})))}return Object.freeze(Object.defineProperties({},{tracks:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("track ID"),arguments.length<2&&errors.push("sources"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='track ID "'.concat(id,'"');if(_badIdRe.test(id))throw new Error("invalid ".concat(what,": track IDs must not contain colons or whitespace"));var track,sources=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{track=_newTrack(sources)}catch(ex){throw new Error("".concat(what,": error during track initialization: ").concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("".concat(what,": no supported audio sources found"));_tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.set(id,track)}},delete:{value:function(id){return _tracks.has(id)&&_tracks.get(id)._destroy(),_tracks.delete(id)}},clear:{value:function(){_tracks.forEach((function(track){return track._destroy()})),_tracks.clear()}},has:{value:function(id){return _tracks.has(id)}},get:{value:function(id){return _tracks.get(id)||null}}}))},groups:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("group ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='group ID "'.concat(id,'"');if(":"!==id[0]||_badIdRe.test(id.slice(1)))throw new Error("invalid ".concat(what,": group IDs must start with a colon and must not contain colons or whitespace"));if(_specialIds.includes(id))throw new Error("cannot clobber special ".concat(what));var group,trackIds=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{group=new Set(trackIds.map((function(trackId){if(!_tracks.has(trackId))throw new Error('track "'.concat(trackId,'" does not exist'));return trackId})))}catch(ex){throw new Error("".concat(what,": error during group initialization: ").concat(ex.message))}_groups.set(id,Object.freeze(Array.from(group)))}},delete:{value:function(id){return _groups.delete(id)}},clear:{value:function(){_groups.clear()}},has:{value:function(id){return _groups.has(id)}},get:{value:function(id){return _groups.get(id)||null}}}))},lists:{value:Object.freeze(Object.defineProperties({},{add:{value:function(){if(arguments.length<2){var errors=[];throw arguments.length<1&&errors.push("list ID"),arguments.length<2&&errors.push("track IDs"),new Error("no ".concat(errors.join(" or ")," specified"))}var id=String(arguments[0]).trim(),what='list ID "'.concat(id,'"');if(_badIdRe.test(id))return this.error("invalid ".concat(what,": list IDs must not contain colons or whitespace"));var list,descriptors=Array.isArray(arguments[1])?Array.from(arguments[1]):Array.from(arguments).slice(1);try{list=new AudioList(descriptors.map((function(desc){if(null===desc)throw new Error("track descriptor must be a string or object (type: null)");switch(_typeof(desc)){case"string":desc={id:desc};break;case"object":if(!desc.hasOwnProperty("id")&&!desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain one of either an "id" or a "sources" property');if(desc.hasOwnProperty("id")&&desc.hasOwnProperty("sources"))throw new Error('track descriptor must contain either an "id" or a "sources" property, not both');break;default:throw new Error("track descriptor must be a string or object (type: ".concat(_typeof(desc),")"))}var own,track,volume;if(desc.hasOwnProperty("id")){if("string"!=typeof desc.id)throw new Error('"id" property must be a string');if(!_tracks.has(desc.id))throw new Error('track "'.concat(desc.id,'" does not exist'));track=_tracks.get(desc.id)}else if(desc.hasOwnProperty("sources")){if(!Array.isArray(desc.sources)||0===desc.sources.length)throw new Error('"sources" property must be a non-empty array');if(desc.hasOwnProperty("own"))throw new Error('"own" property is not allowed with the "sources" property');try{track=_newTrack(desc.sources),own=!0}catch(ex){throw new Error("error during track initialization: ".concat(ex.message))}if(Config.debug&&!track.hasSource())throw new Error("no supported audio sources found")}if(desc.hasOwnProperty("own")){if("boolean"!=typeof desc.own)throw new Error('"own" property must be a boolean');(own=desc.own)&&(track=track.clone())}if(desc.hasOwnProperty("volume")){if("number"!=typeof desc.volume||Number.isNaN(desc.volume)||!Number.isFinite(desc.volume)||desc.volume<0)throw new Error('"volume" property must be a non-negative finite number');volume=desc.volume}return{own:null!=own&&own,track:track,volume:null!=volume?volume:track.volume()}})))}catch(ex){throw new Error("".concat(what,": error during playlist initialization: ").concat(ex.message))}_lists.has(id)&&_lists.get(id)._destroy(),_lists.set(id,list)}},delete:{value:function(id){return _lists.has(id)&&_lists.get(id)._destroy(),_lists.delete(id)}},clear:{value:function(){_lists.forEach((function(list){return list._destroy()})),_lists.clear()}},has:{value:function(id){return _lists.has(id)}},get:{value:function(id){return _lists.get(id)||null}}}))},select:{value:function(){if(0===arguments.length)throw new Error("no track selector specified");var selector=String(arguments[0]).trim(),trackIds=new Set;try{var renderIds=function renderIds(idObj){var ids,id=idObj.id;switch(id){case":all":ids=allIds;break;case":looped":ids=allIds.filter((function(id){return _tracks.get(id).loop()}));break;case":muted":ids=allIds.filter((function(id){return _tracks.get(id).mute()}));break;case":paused":ids=allIds.filter((function(id){return _tracks.get(id).isPaused()}));break;case":playing":ids=allIds.filter((function(id){return _tracks.get(id).isPlaying()}));break;default:ids=":"===id[0]?_groups.get(id):[id]}if(idObj.hasOwnProperty("not")){var negated=idObj.not.map((function(idObj){return renderIds(idObj)})).flat(1/0);ids=ids.filter((function(id){return!negated.includes(id)}))}return ids},allIds=Array.from(_tracks.keys());_runnerParseSelector(selector).forEach((function(idObj){return renderIds(idObj).forEach((function(id){if(!_tracks.has(id))throw new Error('track "'.concat(id,'" does not exist'));trackIds.add(id)}))}))}catch(ex){throw new Error("error during runner initialization: ".concat(ex.message))}return new AudioRunner(trackIds)}},load:{value:function(){publish("load")}},loadWithScreen:{value:function(){publish("loadwithscreen")}},mute:{value:masterMute},muteOnHidden:{value:function(mute){if(!Visibility.isEnabled())return!1;if(null==mute)return _masterMuteOnHidden;var namespace=".SimpleAudio_masterMuteOnHidden";if(_masterMuteOnHidden=!!mute){var visibilityChange="".concat(Visibility.changeEvent).concat(namespace);jQuery(document).off(namespace).on(visibilityChange,(function(){return masterMute(Visibility.isHidden())})),Visibility.isHidden()&&masterMute(!0)}else jQuery(document).off(namespace)}},rate:{value:function(rate){if(null==rate)return _masterRate;if("number"!=typeof rate||Number.isNaN(rate)||!Number.isFinite(rate))throw new Error("rate must be a finite number");publish("rate",_masterRate=Math.clamp(rate,.2,5))}},stop:{value:function(){publish("stop")}},unload:{value:function(){publish("unload")}},volume:{value:function(volume){if(null==volume)return _masterVolume;if("number"!=typeof volume||Number.isNaN(volume)||!Number.isFinite(volume))throw new Error("volume must be a finite number");publish("volume",_masterVolume=Math.clamp(volume,0,1))}}}))}(),State=function(){var _history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null,_tempVariables={};function stateMarshal(noDelta){var stateObj={index:_activeIndex};return noDelta?stateObj.history=clone(_history):stateObj.delta=historyDeltaEncode(_history),_expired.length>0&&(stateObj.expired=_toConsumableArray(_expired)),null!==_prng&&(stateObj.seed=_prng.seed),stateObj}function stateUnmarshal(stateObj,noDelta){if(null==stateObj)throw new Error("state object is null or undefined");if(!stateObj.hasOwnProperty(noDelta?"history":"delta")||0===stateObj[noDelta?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!stateObj.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==_prng&&!stateObj.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===_prng&&stateObj.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");_history=noDelta?clone(stateObj.history):historyDeltaDecode(stateObj.delta),_activeIndex=stateObj.index,_expired=stateObj.hasOwnProperty("expired")?_toConsumableArray(stateObj.expired):[],stateObj.hasOwnProperty("seed")&&(_prng.seed=stateObj.seed),momentActivate(_activeIndex)}function momentCreate(title,variables){return{title:null==title?"":String(title),variables:null==variables?{}:clone(variables)}}function momentActivate(moment){if(null==moment)throw new Error("moment activation attempted with null or undefined");switch(_typeof(moment)){case"object":_active=clone(moment);break;case"number":if(historyIsEmpty())throw new Error("moment activation attempted with index on empty history");if(moment<0||moment>=historySize())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, ".concat(historySize()-1,"], got ").concat(moment));_active=clone(_history[moment]);break;default:throw new TypeError('moment activation attempted with a "'.concat(_typeof(moment),'"; must be an object or valid history stack index'))}return null!==_prng&&(_prng=PRNGWrapper.unmarshal({seed:_prng.seed,pull:_active.pull})),session.set("state",stateMarshal()),jQuery.event.trigger(":historyupdate"),_active}function historyLength(){return _activeIndex+1}function historySize(){return _history.length}function historyIsEmpty(){return 0===_history.length}function historyTop(){return _history.length>0?_history[_history.length-1]:null}function historyGoTo(index){return!(null==index||index<0||index>=historySize()||index===_activeIndex)&&(momentActivate(_activeIndex=index),!0)}function historyDeltaEncode(historyArr){if(!Array.isArray(historyArr))return null;if(0===historyArr.length)return[];for(var delta=[historyArr[0]],i=1,iend=historyArr.length;i<iend;++i)delta.push(Diff.diff(historyArr[i-1],historyArr[i]));return delta}function historyDeltaDecode(delta){if(!Array.isArray(delta))return null;if(0===delta.length)return[];for(var historyArr=[clone(delta[0])],i=1,iend=delta.length;i<iend;++i)historyArr.push(Diff.patch(historyArr[i-1],delta[i]));return historyArr}function prngInit(seed,useEntropy){var scriptSection;if(!historyIsEmpty())throw scriptSection="the Story JavaScript",new Error("State.prng.init must be called during initialization, within either ".concat(scriptSection," or the StoryInit special passage"));_prng=new PRNGWrapper(seed,useEntropy),_active.pull=_prng.pull}function metadataDelete(key){if("string"!=typeof key)throw new TypeError("State.metadata.delete key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");store&&store.hasOwnProperty(key)&&(1===Object.keys(store).length?storage.delete("metadata"):(delete store[key],storage.set("metadata",store)))}return Object.freeze(Object.defineProperties({},{reset:{value:function(){session.delete("state"),_history=[],_active=momentCreate(),_activeIndex=-1,_expired=[],_prng=null===_prng?null:new PRNGWrapper(_prng.seed,!1)}},restore:{value:function(){if(session.has("state")){var stateObj=session.get("state");return null!=stateObj&&(stateUnmarshal(stateObj),!0)}return!1}},marshalForSave:{value:function(){return stateMarshal(!0)}},unmarshalForSave:{value:function(stateObj){return stateUnmarshal(stateObj,!0)}},expired:{get:function(){return _expired}},turns:{get:function(){return _expired.length+historyLength()}},passages:{get:function(){return _expired.concat(_history.slice(0,historyLength()).map((function(moment){return moment.title})))}},hasPlayed:{value:function(title){return null!=title&&""!==title&&(!!_expired.includes(title)||!!_history.slice(0,historyLength()).some((function(moment){return moment.title===title})))}},active:{get:function(){return _active}},activeIndex:{get:function(){return _activeIndex}},passage:{get:function(){return _active.title}},variables:{get:function(){return _active.variables}},history:{get:function(){return _history}},length:{get:historyLength},size:{get:historySize},isEmpty:{value:historyIsEmpty},current:{get:function(){return _history.length>0?_history[_activeIndex]:null}},top:{get:historyTop},bottom:{get:function(){return _history.length>0?_history[0]:null}},index:{value:function(index){return historyIsEmpty()||index<0||index>_activeIndex?null:_history[index]}},peek:{value:function(offset){if(historyIsEmpty())return null;var lengthOffset=1+(offset?Math.abs(offset):0);return lengthOffset>historyLength()?null:_history[historyLength()-lengthOffset]}},has:{value:function(title){if(historyIsEmpty()||null==title||""===title)return!1;for(var i=_activeIndex;i>=0;--i)if(_history[i].title===title)return!0;return!1}},create:{value:function(title){for(0,historyLength()<historySize()&&_history.splice(historyLength(),historySize()-historyLength()),_history.push(momentCreate(title,_active.variables)),_prng&&(historyTop().pull=_prng.pull);historySize()>Config.history.maxStates;)_expired.push(_history.shift().title);return momentActivate(_activeIndex=historySize()-1),historyLength()}},goTo:{value:historyGoTo},go:{value:function(offset){return null!=offset&&0!==offset&&historyGoTo(_activeIndex+offset)}},deltaEncode:{value:historyDeltaEncode},deltaDecode:{value:historyDeltaDecode},prng:{value:Object.freeze(Object.defineProperties({},{init:{value:prngInit},isEnabled:{value:function(){return null!==_prng}},pull:{get:function(){return _prng?_prng.pull:NaN}},seed:{get:function(){return _prng?_prng.seed:null}}}))},random:{value:function(){return _prng?_prng.random():Math.random()}},clearTemporary:{value:function(){TempVariables=_tempVariables={}}},temporary:{get:function(){return _tempVariables}},getVar:{value:function(varExpression){try{return Scripting.evalTwineScript(varExpression)}catch(ex){}}},setVar:{value:function(varExpression,value){try{return Scripting.evalTwineScript("".concat(varExpression," = evalTwineScript$Data$"),null,value),!0}catch(ex){}return!1}},metadata:{value:Object.freeze(Object.defineProperties({},{clear:{value:function(){storage.delete("metadata")}},delete:{value:metadataDelete},entries:{value:function(){var store=storage.get("metadata");return store&&Object.entries(store)}},get:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.get key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)?store[key]:undefined}},has:{value:function(key){if("string"!=typeof key)throw new TypeError("State.metadata.has key parameter must be a string (received: ".concat(_typeof(key),")"));var store=storage.get("metadata");return store&&store.hasOwnProperty(key)}},keys:{value:function(){var store=storage.get("metadata");return store&&Object.keys(store)}},set:{value:function(key,value){if("string"!=typeof key)throw new TypeError("State.metadata.set key parameter must be a string (received: ".concat(_typeof(key),")"));if(void 0===value)metadataDelete(key);else{var store=storage.get("metadata")||{};store[key]=value,storage.set("metadata",store)}}},size:{get:function(){var store=storage.get("metadata");return store?Object.keys(store).length:0}}}))},initPRNG:{value:prngInit},restart:{value:function(){return Engine.restart()}},backward:{value:function(){return Engine.backward()}},forward:{value:function(){return Engine.forward()}},display:{value:function(){return Engine.display.apply(Engine,arguments)}},show:{value:function(){return Engine.show.apply(Engine,arguments)}},play:{value:function(){return Engine.play.apply(Engine,arguments)}}}))}(),Scripting=function(){function addAccessibleClickHandler(targets,selector,handler,one,namespace){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");var fn,opts;if("function"==typeof selector?(fn=selector,opts={namespace:one,one:!!handler}):(fn=handler,opts={namespace:namespace,one:!!one,selector:selector}),"function"!=typeof fn)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(targets).ariaClick(opts,fn)}function insertElement(place,type,id,classNames,text,title){var $el=jQuery(document.createElement(type));return id&&$el.attr("id",id),classNames&&$el.addClass(classNames),title&&$el.attr("title",title),text&&$el.text(text),place&&$el.appendTo(place),$el[0]}function insertText(place,text){jQuery(place).append(document.createTextNode(text))}function removeChildren(node){jQuery(node).empty()}function removeElement(node){jQuery(node).remove()}function fade(el,options){var current,intervalId,direction="in"===options.fade?1:-1,proxy=el.cloneNode(!0);function setOpacity(el,opacity){el.style.zoom=1,el.style.filter="alpha(opacity=".concat(Math.floor(100*opacity),")"),el.style.opacity=opacity}el.parentNode.replaceChild(proxy,el),"in"===options.fade?(current=0,proxy.style.visibility="visible"):current=1,setOpacity(proxy,current),intervalId=window.setInterval((function(){current+=.05*direction,setOpacity(proxy,Math.easeInOut(current)),(1===direction&&current>=1||-1===direction&&current<=0)&&(el.style.visibility="in"===options.fade?"visible":"hidden",proxy.parentNode.replaceChild(el,proxy),proxy=null,window.clearInterval(intervalId),options.onComplete&&options.onComplete())}),25)}function scrollWindowTo(el,incrementBy){var increment=null!=incrementBy?Number(incrementBy):.1;Number.isNaN(increment)||!Number.isFinite(increment)||increment<0?increment=.1:increment>1&&(increment=1);var intervalId,start=window.scrollY?window.scrollY:document.body.scrollTop,end=function(el){var posTop=function(el){var curtop=0;for(;el.offsetParent;)curtop+=el.offsetTop,el=el.offsetParent;return curtop}(el),posBottom=posTop+el.offsetHeight,winTop=window.scrollY?window.scrollY:document.body.scrollTop,winHeight=window.innerHeight?window.innerHeight:document.body.clientHeight,winBottom=winTop+winHeight;return posTop>=winTop&&posBottom>winBottom&&el.offsetHeight<winHeight?posTop-(winHeight-el.offsetHeight)+20:posTop}(el),distance=Math.abs(start-end),direction=start>end?-1:1,progress=0;intervalId=window.setInterval((function(){progress+=increment,window.scroll(0,start+direction*(distance*Math.easeInOut(progress))),progress>=1&&window.clearInterval(intervalId)}),25)}function toStringOrDefault(value){return stringFrom(value)}function either(){if(0!==arguments.length)return Array.prototype.concat.apply([],arguments).random()}function forget(key){if("string"!=typeof key)throw new TypeError("forget key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.delete(key)}function hasVisited(){if(0===arguments.length)throw new Error("hasVisited called with insufficient parameters");if(State.isEmpty())return!1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,i=0,iend=needles.length;i<iend;++i)if(!played.includes(needles[i]))return!1;return!0}function lastVisited(){if(0===arguments.length)throw new Error("lastVisited called with insufficient parameters");if(State.isEmpty())return-1;for(var needles=Array.prototype.concat.apply([],arguments),played=State.passages,uBound=played.length-1,turns=State.turns,i=0,iend=needles.length;i<iend&&turns>-1;++i){var lastIndex=played.lastIndexOf(needles[i]);turns=Math.min(turns,-1===lastIndex?-1:uBound-lastIndex)}return turns}function memorize(key,value){if("string"!=typeof key)throw new TypeError("memorize key parameter must be a string (received: ".concat(Util.getType(key),")"));State.metadata.set(key,value)}function passage(){return State.passage}function previous(){var passages=State.passages;if(arguments.length>0){var offset=Number(arguments[0]);if(!Number.isSafeInteger(offset)||offset<1)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return passages.length>offset?passages[passages.length-1-offset]:""}for(var i=passages.length-2;i>=0;--i)if(passages[i]!==State.passage)return passages[i];return""}function random(){var min,max;switch(arguments.length){case 0:throw new Error("random called with insufficient parameters");case 1:min=0,max=Math.trunc(arguments[0]);break;default:min=Math.trunc(arguments[0]),max=Math.trunc(arguments[1])}if(!Number.isInteger(min))throw new Error("random min parameter must be an integer");if(!Number.isInteger(max))throw new Error("random max parameter must be an integer");if(min>max){var _ref6=[max,min];min=_ref6[0],max=_ref6[1]}return Math.floor(State.random()*(max-min+1))+min}function randomFloat(){var min,max;switch(arguments.length){case 0:throw new Error("randomFloat called with insufficient parameters");case 1:min=0,max=Number(arguments[0]);break;default:min=Number(arguments[0]),max=Number(arguments[1])}if(Number.isNaN(min)||!Number.isFinite(min))throw new Error("randomFloat min parameter must be a number");if(Number.isNaN(max)||!Number.isFinite(max))throw new Error("randomFloat max parameter must be a number");if(min>max){var _ref7=[max,min];min=_ref7[0],max=_ref7[1]}return State.random()*(max-min)+min}function recall(key,defaultValue){if("string"!=typeof key)throw new TypeError("recall key parameter must be a string (received: ".concat(Util.getType(key),")"));return State.metadata.has(key)?State.metadata.get(key):defaultValue}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var passages=Array.prototype.concat.apply([],arguments),tags=[],i=0,iend=passages.length;i<iend;++i)tags=tags.concat(Story.get(passages[i]).tags);return tags}function temporary(){return State.temporary}function time(){return null===Engine.lastPlay?0:Util.now()-Engine.lastPlay}function turns(){return State.turns}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments),played=State.passages,count=State.turns,i=0,iend=needles.length;i<iend&&count>0;++i)count=Math.min(count,played.count(needles[i]));return count}function visitedTags(){if(0===arguments.length)throw new Error("visitedTags called with insufficient parameters");if(State.isEmpty())return 0;for(var needles=Array.prototype.concat.apply([],arguments),nLength=needles.length,played=State.passages,seen=new Map,count=0,i=0,iend=played.length;i<iend;++i){var title=played[i];if(seen.has(title))seen.get(title)&&++count;else{var _tags2=Story.get(title).tags;if(_tags2.length>0){for(var found=0,j=0;j<nLength;++j)_tags2.includes(needles[j])&&++found;found===nLength?(++count,seen.set(title,!0)):seen.set(title,!1)}}}return count}var _ref8=function(){function slugifyUrl(url){return Util.parseUrl(url).path.replace(/^[^\w]+|[^\w]+$/g,"").replace(/[^\w]+/g,"-").toLocaleLowerCase()}function addScript(url){return new Promise((function(resolve,reject){jQuery(document.createElement("script")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importScripts failed to load the script "'.concat(url,'".')))})).appendTo(document.head).attr({id:"script-imported-".concat(slugifyUrl(url)),type:"text/javascript",src:url})}))}function addStyle(url){return new Promise((function(resolve,reject){jQuery(document.createElement("link")).one("load abort error",(function(ev){jQuery(ev.target).off(),"load"===ev.type?resolve(ev.target):reject(new Error('importStyles failed to load the stylesheet "'.concat(url,'".')))})).appendTo(document.head).attr({id:"style-imported-".concat(slugifyUrl(url)),rel:"stylesheet",href:url})}))}function sequence(callbacks){return callbacks.reduce((function(seq,fn){return seq.then(fn)}),Promise.resolve())}return{importScripts:function(){for(var _len12=arguments.length,urls=new Array(_len12),_key12=0;_key12<_len12;_key12++)urls[_key12]=arguments[_key12];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addScript(url)}}))):addScript(oneOrSeries)})))},importStyles:function(){for(var _len13=arguments.length,urls=new Array(_len13),_key13=0;_key13<_len13;_key13++)urls[_key13]=arguments[_key13];return Promise.all(urls.map((function(oneOrSeries){return Array.isArray(oneOrSeries)?sequence(oneOrSeries.map((function(url){return function(){return addStyle(url)}}))):addStyle(oneOrSeries)})))}}}(),importScripts=_ref8.importScripts,importStyles=_ref8.importStyles,parse=function(){var tokenTable=Util.toEnum({$:"State.variables.",_:"State.temporary.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'}),parseRe=new RegExp(["(?:\"\"|''|``)",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(`(?:\\\\.|[^`\\\\])+`)","(?:[=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)","([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+)"].join("|"),"g"),notSpaceRe=/\S/,varTest=new RegExp("^".concat(Patterns.variable)),withColonTestRe=/^\s*:/,withNotTestRe=/^\s+not\b/;function parse(rawCodeString){if(0!==parseRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start");for(var match,code=rawCodeString;null!==(match=parseRe.exec(code));)if(match[1]){var rawTemplate=match[1],parsedTemplate=parseTemplate(rawTemplate);parsedTemplate!==rawTemplate&&(code=code.splice(match.index,rawTemplate.length,parsedTemplate),parseRe.lastIndex+=parsedTemplate.length-rawTemplate.length)}else if(match[2]){var token=match[2];if("$"===token||"_"===token)continue;if(varTest.test(token))token=token[0];else if("is"===token){var start=parseRe.lastIndex,ahead=code.slice(start);withNotTestRe.test(ahead)&&(code=code.splice(start,ahead.search(notSpaceRe)),token="isnot")}else{var _ahead=code.slice(parseRe.lastIndex);if(withColonTestRe.test(_ahead))continue}tokenTable[token]&&(code=code.splice(match.index,token.length,tokenTable[token]),parseRe.lastIndex+=tokenTable[token].length-token.length)}return code}var templateGroupStartRe=/\$\{/g,templateGroupParseRe=new RegExp(["(?:\"\"|'')",'(?:"(?:\\\\.|[^"\\\\])+")',"(?:'(?:\\\\.|[^'\\\\])+')","(\\{)","(\\})"].join("|"),"g");function parseTemplate(rawTemplateLiteral){if(0!==templateGroupStartRe.lastIndex)throw new RangeError("Scripting.parse last index is non-zero at start of template literal");for(var startMatch,template=rawTemplateLiteral;null!==(startMatch=templateGroupStartRe.exec(template));){var startIdx=startMatch.index+2,endIdx=startIdx,depth=1,endMatch=void 0;for(templateGroupParseRe.lastIndex=startIdx;null!==(endMatch=templateGroupParseRe.exec(template));)if(endMatch[1]?++depth:endMatch[2]&&--depth,0===depth){endIdx=endMatch.index;break}if(endIdx>startIdx){var parseIndex=parseRe.lastIndex,rawGroup=template.slice(startIdx,endIdx);parseRe.lastIndex=0;var parsedGroup=parse(rawGroup);parseRe.lastIndex=parseIndex,template=template.splice(startIdx,rawGroup.length,parsedGroup),templateGroupStartRe.lastIndex+=parsedGroup.length-rawGroup.length}}return template}return parse}();function evalJavaScript(code,output,data){return function(code,output,evalJavaScript$Data$){return eval(code)}.call(output?{output:output}:null,String(code),output,data)}function evalTwineScript(code,output,data){return function(code,output,evalTwineScript$Data$){return eval(code)}.call(output?{output:output}:null,parse(String(code)),output,data)}return Object.freeze(Object.defineProperties({},{parse:{value:parse},evalJavaScript:{value:evalJavaScript},evalTwineScript:{value:evalTwineScript}}))}(),_ref9=function(){var Lexer=function(){function Lexer(source,initialState){if(_classCallCheck(this,Lexer),arguments.length<2)throw new Error("Lexer constructor called with too few parameters (source:string , initialState:function)");Object.defineProperties(this,{source:{value:source},initial:{value:initialState},state:{writable:!0,value:initialState},start:{writable:!0,value:0},pos:{writable:!0,value:0},depth:{writable:!0,value:0},items:{writable:!0,value:[]},data:{writable:!0,value:{}}})}return _createClass(Lexer,[{key:"reset",value:function(){this.state=this.initial,this.start=0,this.pos=0,this.depth=0,this.items=[],this.data={}}},{key:"run",value:function(){for(;null!==this.state;)this.state=this.state(this);return this.items}},{key:"nextItem",value:function(){for(;0===this.items.length&&null!==this.state;)this.state=this.state(this);return this.items.shift()}},{key:"next",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos++]}},{key:"peek",value:function(){return this.pos>=this.source.length?-1:this.source[this.pos]}},{key:"backup",value:function(num){this.pos-=num||1}},{key:"forward",value:function(num){this.pos+=num||1}},{key:"ignore",value:function(){this.start=this.pos}},{key:"accept",value:function(valid){var ch=this.next();return-1!==ch&&(!!valid.includes(ch)||(this.backup(),!1))}},{key:"acceptRe",value:function(validRe){var ch=this.next();return-1!==ch&&(!!validRe.test(ch)||(this.backup(),!1))}},{key:"acceptRun",value:function(valid){for(;;){var ch=this.next();if(-1===ch)return;if(!valid.includes(ch))break}this.backup()}},{key:"acceptRunRe",value:function(validRe){for(;;){var ch=this.next();if(-1===ch)return;if(!validRe.test(ch))break}this.backup()}},{key:"emit",value:function(type){this.items.push({type:type,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),this.start=this.pos}},{key:"error",value:function(type,message){if(arguments.length<2)throw new Error("Lexer.prototype.error called with too few parameters (type:number , message:string)");return this.items.push({type:type,message:message,text:this.source.slice(this.start,this.pos),start:this.start,pos:this.pos}),null}}],[{key:"enumFromNames",value:function(names){var obj=names.reduce((function(obj,name,i){return obj[name]=i,obj}),{});return Object.freeze(Object.assign(Object.create(null),obj))}}]),Lexer}();return{EOF:-1,Lexer:Lexer}}(),EOF=_ref9.EOF,Lexer=_ref9.Lexer,Wikifier=function(){var _optionsStack,lookaheadRe,idOrClassRe,_callDepth=0,Wikifier=function(){function Wikifier(destination,source,options){_classCallCheck(this,Wikifier),Wikifier.Parser.Profile.isEmpty()&&Wikifier.Parser.Profile.compile(),Object.defineProperties(this,{source:{value:String(source)},options:{writable:!0,value:Object.assign({profile:"all"},options)},nextMatch:{writable:!0,value:0},output:{writable:!0,value:null},_rawArgs:{writable:!0,value:""}}),null==destination?this.output=document.createDocumentFragment():destination.jquery?this.output=destination[0]:this.output=destination;try{++_callDepth,this.subWikify(this.output),1===_callDepth&&Config.cleanupWikifierOutput&&convertBreaks(this.output)}finally{--_callDepth}}return _createClass(Wikifier,[{key:"subWikify",value:function(output,terminator,options){var newOptions,oldOptions,oldOutput=this.output;this.output=output,Wikifier.Option.length>0&&(newOptions=Object.assign(newOptions||{},Wikifier.Option.options)),null!==options&&"object"===_typeof(options)&&(newOptions=Object.assign(newOptions||{},options)),newOptions&&(oldOptions=this.options,this.options=Object.assign({},this.options,newOptions));var terminatorMatch,parserMatch,parsersProfile=Wikifier.Parser.Profile.get(this.options.profile),terminatorRegExp=terminator?new RegExp("(?:".concat(terminator,")"),this.options.ignoreTerminatorCase?"gim":"gm"):null;do{if(parsersProfile.parserRegExp.lastIndex=this.nextMatch,terminatorRegExp&&(terminatorRegExp.lastIndex=this.nextMatch),parserMatch=parsersProfile.parserRegExp.exec(this.source),(terminatorMatch=terminatorRegExp?terminatorRegExp.exec(this.source):null)&&(!parserMatch||terminatorMatch.index<=parserMatch.index))return terminatorMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,terminatorMatch.index),this.matchStart=terminatorMatch.index,this.matchLength=terminatorMatch[0].length,this.matchText=terminatorMatch[0],this.nextMatch=terminatorRegExp.lastIndex,this.output=oldOutput,void(oldOptions&&(this.options=oldOptions));if(parserMatch){parserMatch.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,parserMatch.index),this.matchStart=parserMatch.index,this.matchLength=parserMatch[0].length,this.matchText=parserMatch[0],this.nextMatch=parsersProfile.parserRegExp.lastIndex;for(var matchingParser=void 0,i=1,iend=parserMatch.length;i<iend;++i)if(parserMatch[i]){matchingParser=i-1;break}if(parsersProfile.parsers[matchingParser].handler(this),null!=TempState.break)break}}while(terminatorMatch||parserMatch);null==TempState.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&jQuery(this.output.lastChild).remove(),this.output=oldOutput,oldOptions&&(this.options=oldOptions)}},{key:"outputText",value:function(destination,startPos,endPos){jQuery(destination).append(document.createTextNode(this.source.substring(startPos,endPos)))}},{key:"rawArgs",value:function(){return this._rawArgs}},{key:"fullArgs",value:function(){return Scripting.parse(this._rawArgs)}}],[{key:"wikifyEval",value:function(text){var output=document.createDocumentFragment();new Wikifier(output,text);var errors=output.querySelector(".error");if(null!==errors)throw new Error(errors.textContent.replace(errorPrologRegExp,""));return output}},{key:"createInternalLink",value:function(destination,passage,text,callback){var $link=jQuery(document.createElement("a"));return null!=passage&&($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken"),$link.ariaClick({one:!0},(function(){"function"==typeof callback&&callback(),Engine.play(passage)}))),text&&$link.append(document.createTextNode(text)),destination&&$link.appendTo(destination),$link[0]}},{key:"createExternalLink",value:function(destination,url,text){var $link=jQuery(document.createElement("a")).attr("target","_blank").addClass("link-external").text(text).appendTo(destination);return null!=url&&$link.attr({href:url,tabindex:0}),$link[0]}},{key:"isExternalLink",value:function(link){return!Story.has(link)&&(new RegExp("^".concat(Patterns.url),"gim").test(link)||/[/.?#]/.test(link))}}]),Wikifier}();return Object.defineProperty(Wikifier,"Option",{value:(_optionsStack=[],Object.freeze(Object.defineProperties({},{length:{get:function(){return _optionsStack.length}},options:{get:function(){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(_optionsStack)))}},clear:{value:function(){_optionsStack=[]}},get:{value:function(idx){return _optionsStack[idx]}},pop:{value:function(){return _optionsStack.pop()}},push:{value:function(options){if("object"!==_typeof(options)||null===options)throw new TypeError("Wikifier.Option.push options parameter must be an object (received: ".concat(Util.getType(options),")"));return _optionsStack.push(options)}}})))}),Object.defineProperty(Wikifier,"Parser",{value:function(){var _profiles,_parsers=[];function parsersHas(name){return!!_parsers.find((function(parser){return parser.name===name}))}return Object.freeze(Object.defineProperties({},{parsers:{get:function(){return _parsers}},add:{value:function(parser){if("object"!==_typeof(parser))throw new Error("Wikifier.Parser.add parser parameter must be an object");if(!parser.hasOwnProperty("name"))throw new Error('parser object missing required "name" property');if("string"!=typeof parser.name)throw new Error('parser object "name" property must be a string');if(!parser.hasOwnProperty("match"))throw new Error('parser object missing required "match" property');if("string"!=typeof parser.match)throw new Error('parser object "match" property must be a string');if(!parser.hasOwnProperty("handler"))throw new Error('parser object missing required "handler" property');if("function"!=typeof parser.handler)throw new Error('parser object "handler" property must be a function');if(parser.hasOwnProperty("profiles")&&!Array.isArray(parser.profiles))throw new Error('parser object "profiles" property must be an array');if(parsersHas(parser.name))throw new Error('cannot clobber existing parser "'.concat(parser.name,'"'));_parsers.push(parser)}},delete:{value:function(name){var parser=_parsers.find((function(parser){return parser.name===name}));parser&&_parsers.delete(parser)}},isEmpty:{value:function(){return 0===_parsers.length}},has:{value:parsersHas},get:{value:function(name){return _parsers.find((function(parser){return parser.name===name}))||null}},Profile:{value:Object.freeze(Object.defineProperties({},{profiles:{get:function(){return _profiles}},compile:{value:function(){var all=_parsers,core=all.filter((function(parser){return!Array.isArray(parser.profiles)||parser.profiles.includes("core")}));return _profiles=Object.freeze({all:{parsers:all,parserRegExp:new RegExp(all.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")},core:{parsers:core,parserRegExp:new RegExp(core.map((function(parser){return"(".concat(parser.match,")")})).join("|"),"gm")}})}},isEmpty:{value:function(){return"object"!==_typeof(_profiles)||0===Object.keys(_profiles).length}},has:{value:function(profile){return"object"===_typeof(_profiles)&&_profiles.hasOwnProperty(profile)}},get:{value:function(profile){if("object"!==_typeof(_profiles)||!_profiles.hasOwnProperty(profile))throw new Error('nonexistent parser profile "'.concat(profile,'"'));return _profiles[profile]}}}))}}))}()}),Object.defineProperties(Wikifier,{helpers:{value:{}},getValue:{value:State.getVar},setValue:{value:State.setVar},parse:{value:Scripting.parse},evalExpression:{value:Scripting.evalTwineScript},evalStatements:{value:Scripting.evalTwineScript},textPrimitives:{value:Patterns}}),Object.defineProperties(Wikifier.helpers,{inlineCss:{value:(lookaheadRe=new RegExp(Patterns.inlineCss,"gm"),idOrClassRe=new RegExp("(".concat(Patterns.cssIdOrClassSigil,")(").concat(Patterns.anyLetter,"+)"),"g"),function(w){var matched,css={classes:[],id:"",styles:{}};do{lookaheadRe.lastIndex=w.nextMatch;var match=lookaheadRe.exec(w.source);if(matched=match&&match.index===w.nextMatch){if(match[1])css.styles[Util.fromCssProperty(match[1])]=match[2].trim();else if(match[3])css.styles[Util.fromCssProperty(match[3])]=match[4].trim();else if(match[5]){var subMatch=void 0;for(idOrClassRe.lastIndex=0;null!==(subMatch=idOrClassRe.exec(match[5]));)"."===subMatch[1]?css.classes.push(subMatch[2]):css.id=subMatch[2]}w.nextMatch=lookaheadRe.lastIndex}}while(matched);return css})},evalText:{value:function(text){var result;try{switch(_typeof(result=Scripting.evalTwineScript(text))){case"string":""===result.trim()&&(result=text);break;case"number":result=String(result);break;default:result=text}}catch(ex){result=text}return result}},evalPassageId:{value:function(passage){return null==passage||Story.has(passage)?passage:Wikifier.helpers.evalText(passage)}},hasBlockContext:{value:function(nodes){for(var hasGCS="function"==typeof window.getComputedStyle,i=nodes.length-1;i>=0;--i){var node=nodes[i];switch(node.nodeType){case Node.ELEMENT_NODE:var tagName=node.nodeName.toUpperCase();if("BR"===tagName)return!0;var styles=hasGCS?window.getComputedStyle(node,null):node.currentStyle;if(styles&&styles.display){if("none"===styles.display)continue;return"block"===styles.display}switch(tagName){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}},createShadowSetterCallback:{value:function(){var macroParser=null;function getMacroContextShadowView(){for(var macro=macroParser||function(){if(!macroParser&&!(macroParser=Wikifier.Parser.get("macro")))throw new Error('cannot find "macro" parser');return macroParser}(),view=new Set,context=macro.context;null!==context;context=context.parent)context._shadows&&context._shadows.forEach((function(name){return view.add(name)}));return _toConsumableArray(view)}return function(code){var shadowStore={};return getMacroContextShadowView().forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]})),function(){var shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null;try{return shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),Scripting.evalJavaScript(code)}finally{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}}()},parseSquareBracketedMarkup:{value:function(){var Item=Lexer.enumFromNames(["Error","DelimLTR","DelimRTL","InnerMeta","ImageMeta","LinkMeta","Link","RightMeta","Setter","Source","Text"]),Delim=Lexer.enumFromNames(["None","LTR","RTL"]);function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexLeftMeta(lexer){if(!lexer.accept("["))return lexer.error(Item.Error,"malformed square-bracketed markup");if(lexer.accept("["))lexer.data.isLink=!0,lexer.emit(Item.LinkMeta);else{if(lexer.accept("<>"),!(lexer.accept("Ii")&&lexer.accept("Mm")&&lexer.accept("Gg")&&lexer.accept("[")))return lexer.error(Item.Error,"malformed square-bracketed markup");lexer.data.isLink=!1,lexer.emit(Item.ImageMeta)}return lexer.depth=2,lexCoreComponents}function lexCoreComponents(lexer){for(var what=lexer.data.isLink?"link":"image",delim=Delim.None;;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup"));break;case"|":delim===Delim.None&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(),lexer.emit(Item.DelimLTR));break;case"-":delim===Delim.None&&">"===lexer.peek()&&(delim=Delim.LTR,lexer.backup(),lexer.emit(Item.Text),lexer.forward(2),lexer.emit(Item.DelimLTR));break;case"<":delim===Delim.None&&"-"===lexer.peek()&&(delim=Delim.RTL,lexer.backup(),lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.DelimRTL));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.InnerMeta),lexer.data.isLink?lexSetter:lexImageLink;case"]":return--lexer.depth,lexer.backup(),delim===Delim.RTL?lexer.emit(Item.Text):lexer.emit(lexer.data.isLink?Item.Link:Item.Source),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexImageLink(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup link component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)switch(lexer.peek()){case"[":return++lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.InnerMeta),lexSetter;case"]":return--lexer.depth,lexer.backup(),lexer.emit(Item.Link),lexer.forward(2),lexer.emit(Item.RightMeta),null;default:return lexer.error(Item.Error,"malformed ".concat(what," markup"))}}}function lexSetter(lexer){for(var what=lexer.data.isLink?"link":"image";;)switch(lexer.next()){case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case'"':if(slurpQuote(lexer,'"')===EOF)return lexer.error(Item.Error,"unterminated double quoted string in ".concat(what," markup setter component"));break;case"'":if(slurpQuote(lexer,"'")===EOF)return lexer.error(Item.Error,"unterminated single quoted string in ".concat(what," markup setter component"));break;case"[":++lexer.depth;break;case"]":if(--lexer.depth,1===lexer.depth)return"]"!==lexer.peek()?lexer.error(Item.Error,"malformed ".concat(what," markup")):(--lexer.depth,lexer.backup(),lexer.emit(Item.Setter),lexer.forward(2),lexer.emit(Item.RightMeta),null)}}return function(w){var lexer=new Lexer(w.source,lexLeftMeta);lexer.start=lexer.pos=w.matchStart;var markup={},items=lexer.run(),last=items.last();return last&&last.type===Item.Error?markup.error=last.message:items.forEach((function(item){var text=item.text.trim();switch(item.type){case Item.ImageMeta:markup.isImage=!0,"<"===text[1]?markup.align="left":">"===text[1]&&(markup.align="right");break;case Item.LinkMeta:markup.isLink=!0;break;case Item.Link:"~"===text[0]?(markup.forceInternal=!0,markup.link=text.slice(1)):markup.link=text;break;case Item.Setter:markup.setter=text;break;case Item.Source:markup.source=text;break;case Item.Text:markup.text=text}})),markup.pos=lexer.pos,markup}}()}}),Wikifier}();!function(){function _verbatimTagHandler(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createDocumentFragment()).append(match[1]).appendTo(w.output))}Wikifier.Parser.add({name:"quoteByBlock",profiles:["block"],match:"^<<<\\n",terminator:"^<<<\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("blockquote")).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"quoteByLine",profiles:["block"],match:"^>+",lookahead:/^>+/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,i,destStack=[w.output],curLevel=0,newLevel=w.matchLength;do{if(newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement("blockquote")).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();curLevel=newLevel,w.subWikify(destStack[destStack.length-1],this.terminator),jQuery(document.createElement("br")).appendTo(destStack[destStack.length-1]),this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);(matched=match&&match.index===w.nextMatch)&&(newLevel=match[0].length,w.nextMatch+=match[0].length)}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"macro",profiles:["core"],match:"<<",lookahead:new RegExp("<<(/?".concat(Patterns.macroName,")(?:\\s*)((?:(?:/\\*[^*]*\\*+(?:[^/*][^*]*\\*+)*/)|(?://.*\\n)|(?:`(?:\\\\.|[^`\\\\])*`)|(?:\"(?:\\\\.|[^\"\\\\])*\")|(?:'(?:\\\\.|[^'\\\\])*')|(?:\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)|[^>]|(?:>(?!>)))*)>>"),"gm"),working:{source:"",name:"",arguments:"",index:0},context:null,handler:function(w){var matchStart=this.lookahead.lastIndex=w.matchStart;if(this.parseTag(w)){var macro,nextMatch=w.nextMatch,name=this.working.name,rawArgs=this.working.arguments;try{if(!(macro=Macro.get(name))){if(Macro.tags.has(name)){var tags=Macro.tags.get(name);return throwError(w.output,"child tag <<".concat(name,">> was found outside of a call to its parent macro").concat(1===tags.length?"":"s"," <<").concat(tags.join(">>, <<"),">>"),w.source.slice(matchStart,w.nextMatch))}return throwError(w.output,"macro <<".concat(name,">> does not exist"),w.source.slice(matchStart,w.nextMatch))}var payload=null;if(void 0!==macro.tags&&!(payload=this.parseBody(w,macro)))return w.nextMatch=nextMatch,throwError(w.output,"cannot find a closing tag for macro <<".concat(name,">>"),"".concat(w.source.slice(matchStart,w.nextMatch),"…"));if("function"!=typeof macro.handler)return throwError(w.output,"macro <<".concat(name,">> handler function ").concat(void 0===macro.handler?"does not exist":"is not a function"),w.source.slice(matchStart,w.nextMatch));var args=payload?payload[0].args:this.createArgs(rawArgs,this.skipArgs(macro,macro.name));if(void 0!==macro._MACRO_API){this.context=new MacroContext({macro:macro,name:name,args:args,payload:payload,source:w.source.slice(matchStart,w.nextMatch),parent:this.context,parser:w});try{macro.handler.call(this.context)}finally{this.context=this.context.parent}}else{var prevRawArgs=w._rawArgs;w._rawArgs=rawArgs;try{macro.handler(w.output,name,args,w,payload)}finally{w._rawArgs=prevRawArgs}}}catch(ex){return throwError(w.output,"cannot execute ".concat(macro&&macro.isWidget?"widget":"macro"," <<").concat(name,">>: ").concat(ex.message),w.source.slice(matchStart,w.nextMatch))}finally{this.working.source="",this.working.name="",this.working.arguments="",this.working.index=0}}else w.outputText(w.output,w.matchStart,w.nextMatch)},parseTag:function(w){var match=this.lookahead.exec(w.source);return!(!match||match.index!==w.matchStart||!match[1])&&(w.nextMatch=this.lookahead.lastIndex,this.working.source=w.source.slice(match.index,this.lookahead.lastIndex),this.working.name=match[1],this.working.arguments=match[2],this.working.index=match.index,!0)},parseBody:function(w,macro){for(var openTag=this.working.name,closeTag="/".concat(openTag),closeAlt="end".concat(openTag),bodyTags=!!Array.isArray(macro.tags)&&macro.tags,payload=[],end=-1,opened=1,curSource=this.working.source,curTag=this.working.name,curArgument=this.working.arguments,contentStart=w.nextMatch;-1!==(w.matchStart=w.source.indexOf(this.match,w.nextMatch));)if(this.parseTag(w)){var tagSource=this.working.source,tagName=this.working.name,tagArgs=this.working.arguments,tagBegin=this.working.index,tagEnd=w.nextMatch,hasArgs=""!==tagArgs.trim();switch(tagName){case openTag:++opened;break;case closeAlt:case closeTag:if(hasArgs)throw w.nextMatch=tagBegin+2+tagName.length,new Error('malformed closing tag: "'.concat(tagSource,'"'));--opened;break;default:if(hasArgs&&(tagName.startsWith("/")||tagName.startsWith("end"))){this.lookahead.lastIndex=w.nextMatch=tagBegin+2+tagName.length;continue}if(1===opened&&bodyTags)for(var i=0,iend=bodyTags.length;i<iend;++i)tagName===bodyTags[i]&&(payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),curSource=tagSource,curTag=tagName,curArgument=tagArgs,contentStart=tagEnd)}if(0===opened){payload.push({source:curSource,name:curTag,arguments:curArgument,args:this.createArgs(curArgument,this.skipArgs(macro,curTag)),contents:w.source.slice(contentStart,tagBegin)}),end=tagEnd;break}}else this.lookahead.lastIndex=w.nextMatch=w.matchStart+this.match.length;return-1!==end?(w.nextMatch=end,payload):null},createArgs:function(rawArgsString,skipArgs){var args=skipArgs?[]:this.parseArgs(rawArgsString);return Object.defineProperties(args,{raw:{value:rawArgsString},full:{value:Scripting.parse(rawArgsString)}}),args},skipArgs:function(macro,tagName){if(void 0!==macro.skipArgs){var sa=macro.skipArgs;return"boolean"==typeof sa&&sa||Array.isArray(sa)&&sa.includes(tagName)}return void 0!==macro.skipArg0&&(macro.skipArg0&&macro.name===tagName)},parseArgs:function(){var Item=Lexer.enumFromNames(["Error","Bareword","Expression","String","SquareBracket"]),spaceRe=new RegExp(Patterns.space),notSpaceRe=new RegExp(Patterns.notSpace),varTest=new RegExp("^".concat(Patterns.variable));function slurpQuote(lexer,endQuote){loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return EOF;case endQuote:break loop}return lexer.pos}function lexSpace(lexer){var offset=lexer.source.slice(lexer.pos).search(notSpaceRe);if(offset===EOF)return null;switch(0!==offset&&(lexer.pos+=offset,lexer.ignore()),lexer.next()){case"`":return lexExpression;case'"':return lexDoubleQuote;case"'":return lexSingleQuote;case"[":return lexSquareBracket;default:return lexBareword}}function lexExpression(lexer){return slurpQuote(lexer,"`")===EOF?lexer.error(Item.Error,"unterminated backquote expression"):(lexer.emit(Item.Expression),lexSpace)}function lexDoubleQuote(lexer){return slurpQuote(lexer,'"')===EOF?lexer.error(Item.Error,"unterminated double quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSingleQuote(lexer){return slurpQuote(lexer,"'")===EOF?lexer.error(Item.Error,"unterminated single quoted string"):(lexer.emit(Item.String),lexSpace)}function lexSquareBracket(lexer){var what;if(lexer.accept("<>IiMmGg")?(what="image",lexer.acceptRun("<>IiMmGg")):what="link",!lexer.accept("["))return lexer.error(Item.Error,"malformed ".concat(what," markup"));lexer.depth=2;loop:for(;;)switch(lexer.next()){case"\\":var ch=lexer.next();if(ch!==EOF&&"\n"!==ch)break;case EOF:case"\n":return lexer.error(Item.Error,"unterminated ".concat(what," markup"));case"[":++lexer.depth;break;case"]":if(--lexer.depth,lexer.depth<0)return lexer.error(Item.Error,"unexpected right square bracket ']'");if(1===lexer.depth){if("]"===lexer.next()){--lexer.depth;break loop}lexer.backup()}}return lexer.emit(Item.SquareBracket),lexSpace}function lexBareword(lexer){var offset=lexer.source.slice(lexer.pos).search(spaceRe);return lexer.pos=offset===EOF?lexer.source.length:lexer.pos+offset,lexer.emit(Item.Bareword),offset===EOF?null:lexSpace}return function(rawArgsString){var lexer=new Lexer(rawArgsString,lexSpace),args=[];return lexer.run().forEach((function(item){var arg=item.text;switch(item.type){case Item.Error:throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(item.message));case Item.Bareword:if(varTest.test(arg))arg=State.getVar(arg);else if(/^(?:settings|setup)[.[]/.test(arg))try{arg=Scripting.evalTwineScript(arg)}catch(ex){throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(ex.message))}else if("null"===arg)arg=null;else if("undefined"===arg)arg=undefined;else if("true"===arg)arg=!0;else if("false"===arg)arg=!1;else if("NaN"===arg)arg=NaN;else{var argAsNum=Number(arg);Number.isNaN(argAsNum)||(arg=argAsNum)}break;case Item.Expression:if(""===(arg=arg.slice(1,-1).trim()))arg=undefined;else try{arg=Scripting.evalTwineScript("(".concat(arg,")"))}catch(ex){throw new Error('unable to parse macro argument expression "'.concat(arg,'": ').concat(ex.message))}break;case Item.String:try{arg=Scripting.evalJavaScript(arg)}catch(ex){throw new Error('unable to parse macro argument string "'.concat(arg,'": ').concat(ex.message))}break;case Item.SquareBracket:var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:arg,matchStart:0});if(markup.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'.concat(arg,'": ').concat(markup.error));if(markup.pos<arg.length)throw new Error('unable to parse macro argument "'.concat(arg,'": unexpected character(s) "').concat(arg.slice(markup.pos),'" (pos: ').concat(markup.pos,")"));markup.isLink?((arg={isLink:!0}).count=markup.hasOwnProperty("text")?2:1,arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):arg.link,arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null):markup.isImage&&(arg=function(source){var imgObj={source:source,isImage:!0};if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(imgObj.source=passage.text,imgObj.passage=passage.title)}return imgObj}(Wikifier.helpers.evalPassageId(markup.source)),markup.hasOwnProperty("align")&&(arg.align=markup.align),markup.hasOwnProperty("text")&&(arg.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("link")&&(arg.link=Wikifier.helpers.evalPassageId(markup.link),arg.external=!markup.forceInternal&&Wikifier.isExternalLink(arg.link)),arg.setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null)}args.push(arg)})),args}}()}),Wikifier.Parser.add({name:"link",profiles:["core"],match:"\\[\\[[^[]",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{w.nextMatch=markup.pos;var link=Wikifier.helpers.evalPassageId(markup.link),text=markup.hasOwnProperty("text")?Wikifier.helpers.evalText(markup.text):link,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,output=(Config.debug?new DebugView(w.output,"link-markup","[[link]]",w.source.slice(w.matchStart,w.nextMatch)):w).output;markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(output,link,text,setFn):Wikifier.createExternalLink(output,link,text)}}}),Wikifier.Parser.add({name:"urlLink",profiles:["core"],match:Patterns.url,handler:function(w){w.outputText(Wikifier.createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch)}}),Wikifier.Parser.add({name:"image",profiles:["core"],match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(w){var markup=Wikifier.helpers.parseSquareBracketedMarkup(w);if(markup.hasOwnProperty("error"))w.outputText(w.output,w.matchStart,w.nextMatch);else{var debugView;w.nextMatch=markup.pos,Config.debug&&(debugView=new DebugView(w.output,"image-markup",markup.hasOwnProperty("link")?"[img[][link]]":"[img[]]",w.source.slice(w.matchStart,w.nextMatch))).modes({block:!0});var source,setFn=markup.hasOwnProperty("setter")?Wikifier.helpers.createShadowSetterCallback(Scripting.parse(markup.setter)):null,el=(Config.debug?debugView:w).output;if(markup.hasOwnProperty("link")){var link=Wikifier.helpers.evalPassageId(markup.link);(el=markup.forceInternal||!Wikifier.isExternalLink(link)?Wikifier.createInternalLink(el,link,null,setFn):Wikifier.createExternalLink(el,link)).classList.add("link-image")}if(el=jQuery(document.createElement("img")).appendTo(el).get(0),"data:"!==(source=Wikifier.helpers.evalPassageId(markup.source)).slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(el.setAttribute("data-passage",passage.title),source=passage.text.trim())}el.src=source,markup.hasOwnProperty("text")&&(el.title=Wikifier.helpers.evalText(markup.text)),markup.hasOwnProperty("align")&&(el.align=markup.align)}}}),Wikifier.Parser.add({name:"monospacedByBlock",profiles:["block"],match:"^\\{\\{\\{\\n",lookahead:/^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){var pre=jQuery(document.createElement("pre"));jQuery(document.createElement("code")).text(match[1]).appendTo(pre),pre.appendTo(w.output),w.nextMatch=this.lookahead.lastIndex}}}),Wikifier.Parser.add({name:"formatByChar",profiles:["core"],match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(w){switch(w.matchText){case"''":w.subWikify(jQuery(document.createElement("strong")).appendTo(w.output).get(0),"''");break;case"//":w.subWikify(jQuery(document.createElement("em")).appendTo(w.output).get(0),"//");break;case"__":w.subWikify(jQuery(document.createElement("u")).appendTo(w.output).get(0),"__");break;case"^^":w.subWikify(jQuery(document.createElement("sup")).appendTo(w.output).get(0),"\\^\\^");break;case"~~":w.subWikify(jQuery(document.createElement("sub")).appendTo(w.output).get(0),"~~");break;case"==":w.subWikify(jQuery(document.createElement("s")).appendTo(w.output).get(0),"==");break;case"{{{":var lookahead=/\{\{\{((?:.|\n)*?)\}\}\}/gm;lookahead.lastIndex=w.matchStart;var match=lookahead.exec(w.source);match&&match.index===w.matchStart&&(jQuery(document.createElement("code")).text(match[1]).appendTo(w.output),w.nextMatch=lookahead.lastIndex)}}}),Wikifier.Parser.add({name:"customStyle",profiles:["core"],match:"@@",terminator:"@@",blockRe:/\s*\n/gm,handler:function(w){var css=Wikifier.helpers.inlineCss(w);this.blockRe.lastIndex=w.nextMatch;var blockMatch=this.blockRe.exec(w.source),blockLevel=blockMatch&&blockMatch.index===w.nextMatch,$el=jQuery(document.createElement(blockLevel?"div":"span")).appendTo(w.output);0===css.classes.length&&""===css.id&&0===Object.keys(css.styles).length?$el.addClass("marked"):(css.classes.forEach((function(className){return $el.addClass(className)})),""!==css.id&&$el.attr("id",css.id),$el.css(css.styles)),blockLevel?(w.nextMatch+=blockMatch[0].length,w.subWikify($el[0],"\\n?".concat(this.terminator))):w.subWikify($el[0],this.terminator)}}),Wikifier.Parser.add({name:"verbatimText",profiles:["core"],match:'"{3}|<[Nn][Oo][Ww][Ii][Kk][Ii]>',lookahead:/(?:"{3}((?:.|\n)*?)"{3})|(?:<[Nn][Oo][Ww][Ii][Kk][Ii]>((?:.|\n)*?)<\/[Nn][Oo][Ww][Ii][Kk][Ii]>)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex,jQuery(document.createElement("span")).addClass("verbatim").text(match[1]||match[2]).appendTo(w.output))}}),Wikifier.Parser.add({name:"horizontalRule",profiles:["core"],match:"^----+$\\n?|<[Hh][Rr]\\s*/?>\\n?",handler:function(w){jQuery(document.createElement("hr")).appendTo(w.output)}}),Wikifier.Parser.add({name:"emdash",profiles:["core"],match:"--",handler:function(w){jQuery(document.createTextNode("—")).appendTo(w.output)}}),Wikifier.Parser.add({name:"doubleDollarSign",profiles:["core"],match:"\\${2}",handler:function(w){jQuery(document.createTextNode("$")).appendTo(w.output)}}),Wikifier.Parser.add({name:"nakedVariable",profiles:["core"],match:"".concat(Patterns.variable,"(?:(?:\\.").concat(Patterns.identifier,")|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[").concat(Patterns.variable,"\\]))*"),handler:function(w){var result=State.getVar(w.matchText);null==result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"variable",w.matchText,w.matchText):w).output,stringFrom(result))}}),Wikifier.Parser.add({name:"template",profiles:["core"],match:"\\?".concat(Patterns.templateName),handler:function(w){var name=w.matchText.slice(1),template=Template.get(name),result=null;switch(template instanceof Array&&(template=template.random()),_typeof(template)){case"function":try{result=stringFrom(template.call({name:name}))}catch(ex){return throwError(w.output,"cannot execute function template ?".concat(name,": ").concat(ex.message),w.source.slice(w.matchStart,w.nextMatch))}break;case"string":result=template}null===result?jQuery(document.createTextNode(w.matchText)).appendTo(w.output):new Wikifier((Config.debug?new DebugView(w.output,"template",w.matchText,w.matchText):w).output,result)}}),Wikifier.Parser.add({name:"heading",profiles:["block"],match:"^!{1,6}",terminator:"\\n",handler:function(w){Wikifier.helpers.hasBlockContext(w.output.childNodes)?w.subWikify(jQuery(document.createElement("h".concat(w.matchLength))).appendTo(w.output).get(0),this.terminator):jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"table",profiles:["block"],match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:/^\|([^\n]*)\|([fhck]?)$/gm,rowTerminator:"\\|(?:[cfhk]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[cfhk]?$\\n?)",cellTerminator:"(?:\\u0020*)\\|",rowTypes:{c:"caption",f:"tfoot",h:"thead","":"tbody"},handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){var matched,table=jQuery(document.createElement("table")).appendTo(w.output).get(0),prevColumns=[],curRowType=null,$rowContainer=null,rowCount=0;w.nextMatch=w.matchStart;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var nextRowType=match[2];"k"===nextRowType?(table.className=match[1],w.nextMatch+=match[0].length+1):(nextRowType!==curRowType&&(curRowType=nextRowType,$rowContainer=jQuery(document.createElement(this.rowTypes[nextRowType])).appendTo(table)),"c"===curRowType?($rowContainer.css("caption-side",0===rowCount?"top":"bottom"),w.nextMatch+=1,w.subWikify($rowContainer[0],this.rowTerminator)):this.rowHandler(w,jQuery(document.createElement("tr")).appendTo($rowContainer).get(0),prevColumns),++rowCount)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))},rowHandler:function(w,rowEl,prevColumns){var matched,_this12=this,cellRe=new RegExp(this.cellPattern,"gm"),col=0,curColCount=1;do{cellRe.lastIndex=w.nextMatch;var cellMatch=cellRe.exec(w.source);if(matched=cellMatch&&cellMatch.index===w.nextMatch){if("~"===cellMatch[1]){var last=prevColumns[col];last&&(++last.rowCount,last.$element.attr("rowspan",last.rowCount).css("vertical-align","middle")),w.nextMatch=cellMatch.index+cellMatch[0].length-1}else if(">"===cellMatch[1])++curColCount,w.nextMatch=cellMatch.index+cellMatch[0].length-1;else{if(cellMatch[2]){w.nextMatch=cellMatch.index+cellMatch[0].length;break}!function(){++w.nextMatch;for(var css=Wikifier.helpers.inlineCss(w),spaceLeft=!1,spaceRight=!1,$cell=void 0;" "===w.source.substr(w.nextMatch,1);)spaceLeft=!0,++w.nextMatch;"!"===w.source.substr(w.nextMatch,1)?($cell=jQuery(document.createElement("th")).appendTo(rowEl),++w.nextMatch):$cell=jQuery(document.createElement("td")).appendTo(rowEl),prevColumns[col]={rowCount:1,$element:$cell},curColCount>1&&($cell.attr("colspan",curColCount),curColCount=1),w.subWikify($cell[0],_this12.cellTerminator)," "===w.matchText.substr(w.matchText.length-2,1)&&(spaceRight=!0),css.classes.forEach((function(className){return $cell.addClass(className)})),""!==css.id&&$cell.attr("id",css.id),spaceLeft&&spaceRight?css.styles["text-align"]="center":spaceLeft?css.styles["text-align"]="right":spaceRight&&(css.styles["text-align"]="left"),$cell.css(css.styles),w.nextMatch=w.nextMatch-1}()}++col}}while(matched)}}),Wikifier.Parser.add({name:"list",profiles:["block"],match:"^(?:(?:\\*+)|(?:#+))",lookahead:/^(?:(\*+)|(#+))/gm,terminator:"\\n",handler:function(w){if(Wikifier.helpers.hasBlockContext(w.output.childNodes)){w.nextMatch=w.matchStart;var matched,i,destStack=[w.output],curType=null,curLevel=0;do{this.lookahead.lastIndex=w.nextMatch;var match=this.lookahead.exec(w.source);if(matched=match&&match.index===w.nextMatch){var newType=match[2]?"ol":"ul",newLevel=match[0].length;if(w.nextMatch+=match[0].length,newLevel>curLevel)for(i=curLevel;i<newLevel;++i)destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0));else if(newLevel<curLevel)for(i=curLevel;i>newLevel;--i)destStack.pop();else newLevel===curLevel&&newType!==curType&&(destStack.pop(),destStack.push(jQuery(document.createElement(newType)).appendTo(destStack[destStack.length-1]).get(0)));curLevel=newLevel,curType=newType,w.subWikify(jQuery(document.createElement("li")).appendTo(destStack[destStack.length-1]).get(0),this.terminator)}}while(matched)}else jQuery(w.output).append(document.createTextNode(w.matchText))}}),Wikifier.Parser.add({name:"commentByBlock",profiles:["core"],match:"(?:/(?:%|\\*))|(?:\x3c!--)",lookahead:/(?:\/(%|\*)(?:(?:.|\n)*?)\1\/)|(?:<!--(?:(?:.|\n)*?)-->)/gm,handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);match&&match.index===w.matchStart&&(w.nextMatch=this.lookahead.lastIndex)}}),Wikifier.Parser.add({name:"lineContinuation",profiles:["core"],match:"\\\\".concat(Patterns.spaceNoTerminator,"*\\n|\\n").concat(Patterns.spaceNoTerminator,"*\\\\|\\n?\\\\").concat(Patterns.spaceNoTerminator,"*$|^").concat(Patterns.spaceNoTerminator,"*\\\\\\n?"),handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"lineBreak",profiles:["core"],match:"\\n|<[Bb][Rr]\\s*/?>",handler:function(w){w.options.nobr||jQuery(document.createElement("br")).appendTo(w.output)}}),Wikifier.Parser.add({name:"htmlCharacterReference",profiles:["core"],match:"(?:(?:&#?[0-9A-Za-z]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9A-Fa-f]|1D[C-Fc-f][0-9A-Fa-f]|20[D-Fd-f][0-9A-Fa-f]|FE2[0-9A-Fa-f])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[0-9A-Za-z]{2,8};)",handler:function(w){jQuery(document.createDocumentFragment()).append(w.matchText).appendTo(w.output)}}),Wikifier.Parser.add({name:"xmlProlog",profiles:["core"],match:"<\\?[Xx][Mm][Ll][^>]*\\?>",handler:function(w){w.nextMatch=w.matchStart+w.matchLength}}),Wikifier.Parser.add({name:"verbatimHtml",profiles:["core"],match:"<[Hh][Tt][Mm][Ll]>",lookahead:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"verbatimScriptTag",profiles:["core"],match:"<[Ss][Cc][Rr][Ii][Pp][Tt][^>]*>",lookahead:/(<[Ss][Cc][Rr][Ii][Pp][Tt]*>(?:.|\n)*?<\/[Ss][Cc][Rr][Ii][Pp][Tt]>)/gm,handler:_verbatimTagHandler}),Wikifier.Parser.add({name:"styleTag",profiles:["core"],match:"<[Ss][Tt][Yy][Ll][Ee][^>]*>",lookahead:/(<[Ss][Tt][Yy][Ll][Ee]*>)((?:.|\n)*?)(<\/[Ss][Tt][Yy][Ll][Ee]>)/gm,imageMarkup:new RegExp(Patterns.cssImage,"g"),hasImageMarkup:new RegExp(Patterns.cssImage),handler:function(w){this.lookahead.lastIndex=w.matchStart;var match=this.lookahead.exec(w.source);if(match&&match.index===w.matchStart){w.nextMatch=this.lookahead.lastIndex;var css=match[2];this.hasImageMarkup.test(css)&&(this.imageMarkup.lastIndex=0,css=css.replace(this.imageMarkup,(function(wikiImage){var markup=Wikifier.helpers.parseSquareBracketedMarkup({source:wikiImage,matchStart:0});if(markup.hasOwnProperty("error")||markup.pos<wikiImage.length)return wikiImage;var source=markup.source;if("data:"!==source.slice(0,5)&&Story.has(source)){var passage=Story.get(source);passage.tags.includes("Twine.image")&&(source=passage.text)}return'url("'.concat(source.replace(/"/g,"%22"),'")')}))),jQuery(document.createDocumentFragment()).append(match[1]+css+match[3]).appendTo(w.output)}}}),Wikifier.Parser.add({name:"svgTag",profiles:["core"],match:"<[Ss][Vv][Gg][^>]*>",lookahead:/<(\/?)[Ss][Vv][Gg][^>]*>/gm,namespace:"http://www.w3.org/2000/svg",handler:function(w){var _this13=this;this.lookahead.lastIndex=w.nextMatch;for(var match,depth=1;depth>0&&null!==(match=this.lookahead.exec(w.source));)depth+="/"===match[1]?-1:1;if(0===depth){w.nextMatch=this.lookahead.lastIndex;var svgTag=w.source.slice(w.matchStart,this.lookahead.lastIndex),$frag=jQuery(document.createDocumentFragment()).append(svgTag);$frag.find("a[data-passage],image[data-passage]").each((function(_,el){var tagName=el.tagName.toLowerCase();try{_this13.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"svg|<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}el.hasAttribute("data-passage")&&_this13.processDataAttributes(el,tagName)})),$frag.appendTo(w.output)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref10){var name=_ref10.name,value=_ref10.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if("image"===tagName)"data:"!==passage.slice(0,5)&&Story.has(passage)&&(passage=Story.get(passage)).tags.includes("Twine.image")&&el.setAttribute("href",passage.text.trim());else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}}),Wikifier.Parser.add({name:"htmlTag",profiles:["core"],match:"<".concat(Patterns.htmlTagName,"(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>"),tagRe:new RegExp("^<(".concat(Patterns.htmlTagName,")")),mediaTags:["audio","img","source","track","video"],nobrTags:["audio","colgroup","datalist","dl","figure","meter","ol","optgroup","picture","progress","ruby","select","table","tbody","tfoot","thead","tr","ul","video"],voidTags:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],handler:function(w){var tagMatch=this.tagRe.exec(w.matchText),tag=tagMatch&&tagMatch[1],tagName=tag&&tag.toLowerCase();if(tagName){var terminator,terminatorMatch,isVoid=this.voidTags.includes(tagName)||w.matchText.endsWith("/>"),isNobr=this.nobrTags.includes(tagName);if(!isVoid){terminator="<\\/".concat(tagName,"\\s*>");var terminatorRe=new RegExp(terminator,"gim");terminatorRe.lastIndex=w.matchStart,terminatorMatch=terminatorRe.exec(w.source)}if(!isVoid&&!terminatorMatch)return throwError(w.output,"cannot find a closing tag for HTML <".concat(tag,">"),"".concat(w.matchText,"…"));var debugView,output=w.output,el=document.createElement(w.output.tagName);for(el.innerHTML=w.matchText;el.firstChild;)el=el.firstChild;try{this.processAttributeDirectives(el)}catch(ex){return throwError(w.output,"<".concat(tagName,">: ").concat(ex.message),"".concat(w.matchText,"…"))}if(el.hasAttribute("data-passage")&&(this.processDataAttributes(el,tagName),Config.debug&&((debugView=new DebugView(w.output,"html-".concat(tagName),tagName,w.matchText)).modes({block:"img"===tagName,nonvoid:terminatorMatch}),output=debugView.output)),terminatorMatch){try{Wikifier.Option.push({nobr:isNobr}),w.subWikify(el,terminator,{ignoreTerminatorCase:!0})}finally{Wikifier.Option.pop()}debugView&&jQuery(el).find(".debug.block").length>0&&debugView.modes({block:!0})}output.appendChild("track"===tagName?el.cloneNode(!0):el)}},processAttributeDirectives:function(el){_toConsumableArray(el.attributes).forEach((function(_ref11){var name=_ref11.name,value=_ref11.value,evalShorthand="@"===name[0];if(evalShorthand||name.startsWith("sc-eval:")){var result,newName=name.slice(evalShorthand?1:8);if("data-setter"===newName)throw new Error('evaluation directive is not allowed on the data-setter attribute: "'.concat(name,'"'));try{result=Scripting.evalTwineScript(value)}catch(ex){throw new Error('bad evaluation from attribute directive "'.concat(name,'": ').concat(ex.message))}try{el.setAttribute(newName,result),el.removeAttribute(name)}catch(ex){throw new Error('cannot transform attribute directive "'.concat(name,'" into attribute "').concat(newName,'"'))}}}))},processDataAttributes:function(el,tagName){var passage=el.getAttribute("data-passage");if(null!=passage){var evaluated=Wikifier.helpers.evalPassageId(passage);if(evaluated!==passage&&(passage=evaluated,el.setAttribute("data-passage",evaluated)),""!==passage)if(this.mediaTags.includes(tagName)){if("data:"!==passage.slice(0,5)&&Story.has(passage)){var parentName,twineTag;switch(passage=Story.get(passage),tagName){case"audio":case"video":twineTag="Twine.".concat(tagName);break;case"img":twineTag="Twine.image";break;case"track":twineTag="Twine.vtt";break;case"source":var $parent=$(el).closest("audio,picture,video");$parent.length&&(parentName=$parent.get(0).tagName.toLowerCase(),twineTag="Twine.".concat("picture"===parentName?"image":parentName))}passage.tags.includes(twineTag)&&(el["picture"===parentName?"srcset":"src"]=passage.text.trim())}}else{var setFn,setter=el.getAttribute("data-setter");null!=setter&&""!==(setter=String(setter).trim())&&(setFn=Wikifier.helpers.createShadowSetterCallback(Scripting.parse(setter))),Story.has(passage)?(el.classList.add("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&el.classList.add("link-visited")):el.classList.add("link-broken"),jQuery(el).ariaClick({one:!0},(function(){"function"==typeof setFn&&setFn.call(this),Engine.play(passage)}))}}}})}();var Template=(_templates=new Map,_validNameRe=new RegExp("^(?:".concat(Patterns.templateName,")$")),_validType=function(template){var templateType=_typeof(template);return"function"===templateType||"string"===templateType},Object.freeze(Object.defineProperties({},{add:{value:function(name,template){if(!(_validType(template)||template instanceof Array&&template.length>0&&template.every(_validType)))throw new TypeError("invalid template type (".concat(name,"); templates must be: functions, strings, or an array of either"));(name instanceof Array?name:[name]).forEach((function(name){if(!_validNameRe.test(name))throw new Error('invalid template name "'.concat(name,'"'));if(_templates.has(name))throw new Error("cannot clobber existing template ?".concat(name));_templates.set(name,template)}))}},delete:{value:function(name){(name instanceof Array?name:[name]).forEach((function(name){return _templates.delete(name)}))}},get:{value:function(name){return _templates.has(name)?_templates.get(name):null}},has:{value:function(name){return _templates.has(name)}},size:{get:function(){return _templates.size}}}))),_templates,_validNameRe,_validType,Macro=function(){var _macros={},_tags={},_validNameRe=new RegExp("^(?:".concat(Patterns.macroName,")$"));function macrosHas(name){return _macros.hasOwnProperty(name)}function tagsRegister(parent,bodyTags){if(!parent)throw new Error("no parent specified");for(var endTags=["/".concat(parent),"end".concat(parent)],allTags=[].concat(endTags,Array.isArray(bodyTags)?bodyTags:[]),i=0;i<allTags.length;++i){var tag=allTags[i];if(macrosHas(tag))throw new Error("cannot register tag for an existing macro");tagsHas(tag)?_tags[tag].includes(parent)||(_tags[tag].push(parent),_tags[tag].sort()):_tags[tag]=[parent]}}function tagsUnregister(parent){if(!parent)throw new Error("no parent specified");Object.keys(_tags).forEach((function(tag){var i=_tags[tag].indexOf(parent);-1!==i&&(1===_tags[tag].length?delete _tags[tag]:_tags[tag].splice(i,1))}))}function tagsHas(name){return _tags.hasOwnProperty(name)}return Object.freeze(Object.defineProperties({},{add:{value:function macrosAdd(name,def){if(Array.isArray(name))name.forEach((function(name){return macrosAdd(name,def)}));else{if(!_validNameRe.test(name))throw new Error('invalid macro name "'.concat(name,'"'));if(macrosHas(name))throw new Error("cannot clobber existing macro <<".concat(name,">>"));if(tagsHas(name))throw new Error("cannot clobber child tag <<".concat(name,">> of parent macro").concat(1===_tags[name].length?"":"s"," <<").concat(_tags[name].join(">>, <<"),">>"));try{if("object"===_typeof(def))_macros[name]=Object.assign(Object.create(null),def,{_MACRO_API:!0});else{if(!macrosHas(def))throw new Error("cannot create alias of nonexistent macro <<".concat(def,">>"));_macros[name]=Object.create(_macros[def],{_ALIAS_OF:{enumerable:!0,value:def}})}Object.defineProperty(_macros,name,{writable:!1})}catch(ex){throw"TypeError"===ex.name?new Error("cannot clobber protected macro <<".concat(name,">>")):new Error("unknown error when attempting to add macro <<".concat(name,">>: [").concat(ex.name,"] ").concat(ex.message))}if(void 0!==_macros[name].tags)if(null==_macros[name].tags)tagsRegister(name);else{if(!Array.isArray(_macros[name].tags))throw new Error('bad value for "tags" property of macro <<'.concat(name,">>"));tagsRegister(name,_macros[name].tags)}}}},delete:{value:function macrosDelete(name){if(Array.isArray(name))name.forEach((function(name){return macrosDelete(name)}));else if(macrosHas(name)){void 0!==_macros[name].tags&&tagsUnregister(name);try{Object.defineProperty(_macros,name,{writable:!0}),delete _macros[name]}catch(ex){throw new Error("unknown error removing macro <<".concat(name,">>: ").concat(ex.message))}}else if(tagsHas(name))throw new Error("cannot remove child tag <<".concat(name,">> of parent macro <<").concat(_tags[name],">>"))}},isEmpty:{value:function(){return 0===Object.keys(_macros).length}},has:{value:macrosHas},get:{value:function(name){var macro=null;return macrosHas(name)&&"function"==typeof _macros[name].handler?macro=_macros[name]:macros.hasOwnProperty(name)&&"function"==typeof macros[name].handler&&(macro=macros[name]),macro}},init:{value:function(){var handler=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"init";Object.keys(_macros).forEach((function(name){"function"==typeof _macros[name][handler]&&_macros[name][handler](name)})),Object.keys(macros).forEach((function(name){"function"==typeof macros[name][handler]&&macros[name][handler](name)}))}},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:function(name){return tagsHas(name)?_tags[name]:null}}}))},evalStatements:{value:function(){return Scripting.evalJavaScript.apply(Scripting,arguments)}}}))}(),MacroContext=function(){var MacroContext=function(){function MacroContext(contextData){_classCallCheck(this,MacroContext);var context=Object.assign({parent:null,macro:null,name:"",displayName:"",args:null,payload:null,parser:null,source:""},contextData);if(null===context.macro||""===context.name||null===context.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{self:{value:context.macro},name:{value:void 0===context.macro._ALIAS_OF?context.name:context.macro._ALIAS_OF},displayName:{value:context.name},args:{value:context.args},payload:{value:context.payload},source:{value:context.source},parent:{value:context.parent},parser:{value:context.parser},_output:{value:context.parser.output},_shadows:{writable:!0,value:null},_debugView:{writable:!0,value:null},_debugViewEnabled:{writable:!0,value:Config.debug}})}return _createClass(MacroContext,[{key:"output",get:function(){return this._debugViewEnabled?this.debugView.output:this._output}},{key:"shadows",get:function(){return _toConsumableArray(this._shadows)}},{key:"shadowView",get:function(){var view=new Set;return this.contextSelectAll((function(ctx){return ctx._shadows})).forEach((function(ctx){return ctx._shadows.forEach((function(name){return view.add(name)}))})),_toConsumableArray(view)}},{key:"debugView",get:function(){return this._debugViewEnabled?null!==this._debugView?this._debugView:this.createDebugView():null}},{key:"contextHas",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return!0;return!1}},{key:"contextSelect",value:function(filter){for(var context=this;null!==(context=context.parent);)if(filter(context))return context;return null}},{key:"contextSelectAll",value:function(filter){for(var result=[],context=this;null!==(context=context.parent);)filter(context)&&result.push(context);return result}},{key:"addShadow",value:function(){var _this14=this;this._shadows||(this._shadows=new Set);for(var varRe=new RegExp("^".concat(Patterns.variable,"$")),_len14=arguments.length,names=new Array(_len14),_key14=0;_key14<_len14;_key14++)names[_key14]=arguments[_key14];names.flat(1/0).forEach((function(name){if("string"!=typeof name)throw new TypeError("variable name must be a string; type: ".concat(_typeof(name)));if(!varRe.test(name))throw new Error('invalid variable name "'.concat(name,'"'));_this14._shadows.add(name)}))}},{key:"createShadowWrapper",value:function(callback,doneCallback,startCallback){var shadowStore,shadowContext=this;return"function"==typeof callback&&(shadowStore={},this.shadowView.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey]}))),function(){for(var _len15=arguments.length,args=new Array(_len15),_key15=0;_key15<_len15;_key15++)args[_key15]=arguments[_key15];if("function"==typeof startCallback&&startCallback.apply(this,args),"function"==typeof callback){var contextCache,shadowNames=Object.keys(shadowStore),valueCache=shadowNames.length>0?{}:null,macroParser=Wikifier.Parser.get("macro");try{shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),store[varKey]=shadowStore[varName]})),contextCache=macroParser.context,macroParser.context=shadowContext,callback.apply(this,args)}finally{contextCache!==undefined&&(macroParser.context=contextCache),shadowNames.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;shadowStore[varName]=store[varKey],valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}"function"==typeof doneCallback&&doneCallback.apply(this,args)}}},{key:"createDebugView",value:function(name,title){return this._debugView=new DebugView(this._output,"macro",name||this.displayName,title||this.source),null!==this.payload&&this.payload.length>0&&this._debugView.modes({nonvoid:!0}),this._debugViewEnabled=!0,this._debugView}},{key:"removeDebugView",value:function(){null!==this._debugView&&(this._debugView.remove(),this._debugView=null),this._debugViewEnabled=!1}},{key:"error",value:function(message,source){return throwError(this._output,"<<".concat(this.displayName,">>: ").concat(message),source||this.source)}}]),MacroContext}();return MacroContext}();!function(){if(Macro.add("capture",{skipArgs:!0,tags:null,tsVarRe:new RegExp("(".concat(Patterns.variable,")"),"g"),handler:function(){if(0===this.args.raw.length)return this.error("no story/temporary variable list specified");var valueCache={};try{for(var match,tsVarRe=this.self.tsVarRe;null!==(match=tsVarRe.exec(this.args.raw));){var varName=match[1],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;store.hasOwnProperty(varKey)&&(valueCache[varKey]=store[varKey]),this.addShadow(varName)}new Wikifier(this.output,this.payload[0].contents)}finally{this.shadows.forEach((function(varName){var varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary;valueCache.hasOwnProperty(varKey)?store[varKey]=valueCache[varKey]:delete store[varKey]}))}}}),Macro.add("set",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("unset",{skipArgs:!0,jsVarRe:new RegExp("State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story/temporary variable list specified");for(var match,jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var store=State[match[1]],name=match[2];store.hasOwnProperty(name)&&delete store[name]}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remember",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}for(var match,remember=storage.get("remember")||{},jsVarRe=this.self.jsVarRe;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];remember[name]=State.variables[name]}if(!storage.set("remember",remember))return this.error("unknown error, cannot remember: ".concat(this.args.raw));Config.debug&&this.debugView.modes({hidden:!0})},init:function(){var remember=storage.get("remember");remember&&Object.keys(remember).forEach((function(name){return State.variables[name]=remember[name]}))}}),Macro.add("forget",{skipArgs:!0,jsVarRe:new RegExp("State\\.variables\\.(".concat(Patterns.identifier,")"),"g"),handler:function(){if(0===this.args.full.length)return this.error("no story variable list specified");for(var match,remember=storage.get("remember"),jsVarRe=this.self.jsVarRe,needStore=!1;null!==(match=jsVarRe.exec(this.args.full));){var name=match[1];State.variables.hasOwnProperty(name)&&delete State.variables[name],remember&&remember.hasOwnProperty(name)&&(needStore=!0,delete remember[name])}if(needStore)if(0===Object.keys(remember).length){if(!storage.delete("remember"))return this.error("unknown error, cannot update remember store")}else if(!storage.set("remember",remember))return this.error("unknown error, cannot update remember store");Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){var output=document.createDocumentFragment();try{Scripting.evalJavaScript(this.payload[0].contents,output)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}Config.debug&&this.createDebugView(),output.hasChildNodes()&&this.output.appendChild(output)}}),Macro.add("include",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?(Config.debug&&this.debugView.modes({block:!0}),passage=Story.get(passage),void(this.args[1]?jQuery(document.createElement(this.args[1])).addClass("".concat(passage.domId," macro-").concat(this.name)).attr("data-passage",passage.title).appendTo(this.output):jQuery(this.output)).wiki(passage.processText())):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var result=stringFrom(Scripting.evalJavaScript(this.args.full));null!==result&&new Wikifier(this.output,"-"===this.name?Util.escape(result):result)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var frag=document.createDocumentFragment();if(new Wikifier(frag,this.payload[0].contents.trim()),Config.debug)this.debugView.modes({block:!0,hidden:!0}),this.output.appendChild(frag);else{var errList=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent}));if(errList.length>0)return this.error("error".concat(1===errList.length?"":"s"," within contents (").concat(errList.join("; "),")"))}}}),Macro.add("type",{isAsync:!0,tags:null,typeId:0,handler:function(){if(0===this.args.length)return this.error("no speed specified");var cursor,speed=Util.fromCssTime(this.args[0]);if(speed<0)return this.error("speed time value must be non-negative (received: ".concat(this.args[0],")"));for(var elClass="",elId="",elTag="div",skipKey=Config.macros.typeSkipKey,start=400,options=this.args.slice(1);options.length>0;){var option=options.shift();switch(option){case"class":if(0===options.length)return this.error("class option missing required class name(s)");if(""===(elClass=options.shift()))throw new Error('class option class name(s) must be non-empty (received: "")');break;case"element":if(0===options.length)return this.error("element option missing required element tag name");if(""===(elTag=options.shift()))throw new Error('element option tag name must be non-empty (received: "")');break;case"id":if(0===options.length)return this.error("id option missing required ID");if(""===(elId=options.shift()))throw new Error('id option ID must be non-empty (received: "")');break;case"keep":cursor="keep";break;case"none":cursor="none";break;case"skipkey":if(0===options.length)return this.error("skipkey option missing required key value");if(""===(skipKey=options.shift()))throw new Error('skipkey option key value must be non-empty (received: "")');break;case"start":if(0===options.length)return this.error("start option missing required time value");var value=options.shift();if((start=Util.fromCssTime(value))<0)throw new Error("start option time value must be non-negative (received: ".concat(value,")"));break;default:return this.error("unknown option: ".concat(option))}}var contents=this.payload[0].contents;if(""!==contents.trim()){Config.debug&&this.debugView.modes({block:!0});var className="macro-".concat(this.name),namespace=".".concat(className),$target=jQuery(document.createElement(elTag)).addClass("".concat(className," ").concat(className,"-target")).appendTo(this.output);TempState.macroTypeQueue||(TempState.macroTypeQueue=[],$(document).off(namespace).one(":passageinit".concat(namespace),(function(){return $(document).off(namespace)})));var startTyping=0===TempState.macroTypeQueue.length,selfId=++this.self.typeId;TempState.macroTypeQueue.push({id:selfId,handler:function(){var $wrapper=jQuery(document.createElement(elTag)).addClass(className);elId&&$wrapper.attr("id",elId),elClass&&$wrapper.addClass(elClass),new Wikifier($wrapper,contents);var passage=State.passage,turn=State.turns;if(!Config.macros.typeVisitedPassages&&State.passages.slice(0,-1).some((function(title){return title===passage}))||$wrapper.find(".error").length>0)return $target.replaceWith($wrapper),TempState.macroTypeQueue.shift(),void(TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().handler());var typer=new NodeTyper({targetNode:$wrapper.get(0),classNames:"none"===cursor?null:"".concat(className,"-cursor")});$target.replaceWith($wrapper);var keydownAndNS="keydown".concat(namespace),typingStopAndNS="".concat(":typingstop").concat(namespace);$(document).off(keydownAndNS).on(keydownAndNS,(function(ev){Util.scrubEventKey(ev.key)!==skipKey||ev.target!==document.body&&ev.target!==document.documentElement||(ev.preventDefault(),$(document).off(keydownAndNS),typer.finish())})).one(typingStopAndNS,(function(){TempState.macroTypeQueue&&(0===TempState.macroTypeQueue.length?jQuery.event.trigger(":typingcomplete"):TempState.macroTypeQueue.first().handler())}));var typeNode=function(){var typeNodeMember=function(typeIntervalId){State.passage===passage&&State.turns===turn&&typer.type()||(typeIntervalId&&clearInterval(typeIntervalId),TempState.macroTypeQueue&&TempState.macroTypeQueue.length>0&&TempState.macroTypeQueue.first().id===selfId&&TempState.macroTypeQueue.shift(),$wrapper.trigger(":typingstop"),$wrapper.addClass("".concat(className,"-done")),"keep"===cursor&&$wrapper.addClass("".concat(className,"-cursor")))};$wrapper.trigger(":typingstart"),typeNodeMember();var typeNodeMemberId=setInterval((function(){return typeNodeMember(typeNodeMemberId)}),speed)};start?setTimeout(typeNode,start):typeNode()}}),startTyping&&(Engine.isPlaying()?$(document).one(":passageend".concat(namespace),(function(){return TempState.macroTypeQueue.first().handler()})):TempState.macroTypeQueue.first().handler())}}}),Macro.add("display","include"),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],elseifWsRe:/^\s*if\b/i,ifAssignRe:/[^!=&^|<>*/%+-]=[^=>]/,handler:function(){var i;try{var len=this.payload.length,elseifWsRe=this.self.elseifWsRe,ifAssignRe=this.self.ifAssignRe;for(i=0;i<len;++i)if("else"===this.payload[i].name){if(this.payload[i].args.raw.length>0)return elseifWsRe.test(this.payload[i].args.raw)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'.concat(i>0?" (#"+i+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<else>> must be the final clause")}else{if(0===this.payload[i].args.full.length)return this.error("no conditional expression specified for <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""));if(Config.macros.ifAssignmentError&&ifAssignRe.test(this.payload[i].args.full))return this.error("assignment operator found within <<".concat(this.payload[i].name,">> clause").concat(i>0?" (#"+i+")":""," (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: ").concat(this.payload[i].args.raw))}var evalJavaScript=Scripting.evalJavaScript,success=!1;for(i=0;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"else"===this.payload[i].name||evalJavaScript(this.payload[i].args.full)){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!success,invalid:!success})}}catch(ex){return this.error("bad conditional expression in <<".concat(0===i?"if":"elseif",">> clause").concat(i>0?" (#"+i+")":"",": ").concat("object"===_typeof(ex)?ex.message:ex))}}}),Macro.add("switch",{skipArgs:["switch"],tags:["case","default"],handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var i,result,len=this.payload.length;if(1===len)return this.error("no cases specified");for(i=1;i<len;++i)if("default"===this.payload[i].name){if(this.payload[i].args.length>0)return this.error("<<default>> does not accept values, invalid: ".concat(this.payload[i].args.raw));if(i+1!==len)return this.error("<<default>> must be the final case")}else if(0===this.payload[i].args.length)return this.error("no value(s) specified for <<".concat(this.payload[i].name,">> (#").concat(i,")"));try{result=Scripting.evalJavaScript(this.args.full)}catch(ex){return this.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}var debugView=this.debugView,success=!1;for(Config.debug&&debugView.modes({nonvoid:!1,hidden:!0}),i=1;i<len;++i){if(Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1}),"default"===this.payload[i].name||this.payload[i].args.some((function(val){return val===result}))){success=!0,new Wikifier(this.output,this.payload[i].contents);break}Config.debug&&this.debugView.modes({hidden:!0,invalid:!0})}if(Config.debug){for(++i;i<len;++i)this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0,invalid:!0});debugView.modes({nonvoid:!1,hidden:!0,invalid:!success}),this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0,invalid:!success})}}}),Macro.add("for",{skipArgs:!0,tags:null,hasRangeRe:new RegExp("^\\S".concat(Patterns.anyChar,"*?\\s+range\\s+\\S").concat(Patterns.anyChar,"*?$")),rangeRe:new RegExp("^(?:State\\.(variables|temporary)\\.(".concat(Patterns.identifier,")\\s*,\\s*)?State\\.(variables|temporary)\\.(").concat(Patterns.identifier,")\\s+range\\s+(\\S").concat(Patterns.anyChar,"*?)$")),threePartRe:/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/,forInRe:/^\S+\s+in\s+\S+/i,forOfRe:/^\S+\s+of\s+\S+/i,handler:function(){var argsStr=this.args.full.trim(),payload=this.payload[0].contents.replace(/\n$/,"");if(0===argsStr.length)this.self.handleFor.call(this,payload,null,!0,null);else if(this.self.hasRangeRe.test(argsStr)){var parts=argsStr.match(this.self.rangeRe);if(null===parts)return this.error("invalid range form syntax, format: [index ,] value range collection");this.self.handleForRange.call(this,payload,{type:parts[1],name:parts[2]},{type:parts[3],name:parts[4]},parts[5])}else{var init,condition,post;if(-1===argsStr.indexOf(";")){if(this.self.forInRe.test(argsStr))return this.error("invalid syntax, for…in is not supported; see: for…range");if(this.self.forOfRe.test(argsStr))return this.error("invalid syntax, for…of is not supported; see: for…range");condition=argsStr}else{var _parts=argsStr.match(this.self.threePartRe);if(null===_parts)return this.error("invalid 3-part conditional form syntax, format: [init] ; [condition] ; [post]");init=_parts[1],condition=_parts[2].trim(),post=_parts[3],0===condition.length&&(condition=!0)}this.self.handleFor.call(this,payload,init,condition,post)}},handleFor:function(payload,init,condition,post){var evalJavaScript=Scripting.evalJavaScript,first=!0,safety=Config.macros.maxLoopIterations;Config.debug&&this.debugView.modes({block:!0});try{if(TempState.break=null,init)try{evalJavaScript(init)}catch(ex){return this.error("bad init expression: ".concat("object"===_typeof(ex)?ex.message:ex))}for(;evalJavaScript(condition);){if(--safety<0)return this.error("exceeded configured maximum loop iterations (".concat(Config.macros.maxLoopIterations,")"));if(new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}if(post)try{evalJavaScript(post)}catch(ex){return this.error("bad post expression: ".concat("object"===_typeof(ex)?ex.message:ex))}}}catch(ex){return this.error("bad conditional expression: ".concat("object"===_typeof(ex)?ex.message:ex))}finally{TempState.break=null}},handleForRange:function(payload,indexVar,valueVar,rangeExp){var rangeList,first=!0;try{rangeList=this.self.toRangeList(rangeExp)}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});try{TempState.break=null;for(var i=0;i<rangeList.length;++i)if(indexVar.name&&(State[indexVar.type][indexVar.name]=rangeList[i][0]),State[valueVar.type][valueVar.name]=rangeList[i][1],new Wikifier(this.output,first?payload.replace(/^\n/,""):payload),first&&(first=!1),null!=TempState.break)if(1===TempState.break)TempState.break=null;else if(2===TempState.break){TempState.break=null;break}}catch(ex){return this.error("object"===_typeof(ex)?ex.message:ex)}finally{TempState.break=null}},toRangeList:function(rangeExp){var value,list,evalJavaScript=Scripting.evalJavaScript;try{value=evalJavaScript("{"===rangeExp[0]?"(".concat(rangeExp,")"):rangeExp)}catch(ex){if("object"!==_typeof(ex))throw new Error("bad range expression: ".concat(ex));throw ex.message="bad range expression: ".concat(ex.message),ex}switch(_typeof(value)){case"string":list=[];for(var i=0;i<value.length;){var obj=Util.charAndPosAt(value,i);list.push([i,obj.char]),i=1+obj.end}break;case"object":if(Array.isArray(value))list=value.map((function(val,i){return[i,val]}));else if(value instanceof Set)list=_toConsumableArray(value).map((function(val,i){return[i,val]}));else if(value instanceof Map)list=_toConsumableArray(value.entries());else{if("Object"!==Util.toStringTag(value))throw new Error("unsupported range expression type: ".concat(Util.toStringTag(value)));list=Object.keys(value).map((function(key){return[key,value[key]]}))}break;default:throw new Error("unsupported range expression type: ".concat(_typeof(value)))}return list}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){if(!this.contextHas((function(ctx){return"for"===ctx.name})))return this.error("must only be used in conjunction with its parent macro <<for>>");TempState.break="continue"===this.name?1:2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["button","link"],{isAsync:!0,tags:null,handler:function(){var _this15=this;if(0===this.args.length)return this.error("no ".concat("button"===this.name?"button":"link"," text specified"));var passage,$link=jQuery(document.createElement("button"===this.name?"button":"a"));if("object"===_typeof(this.args[0]))if(this.args[0].isImage){var $image=jQuery(document.createElement("img")).attr("src",this.args[0].source).appendTo($link);$link.addClass("link-image"),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link}else $link.append(document.createTextNode(this.args[0].text)),passage=this.args[0].link;else $link.wikiWithOptions({profile:"core"},this.args[0]),passage=this.args.length>1?this.args[1]:undefined;null!=passage?($link.attr("data-passage",passage),Story.has(passage)?($link.addClass("link-internal"),Config.addVisitedLinkClass&&State.hasPlayed(passage)&&$link.addClass("link-visited")):$link.addClass("link-broken")):$link.addClass("link-internal"),$link.addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:null!=passage?"link":"button",one:null!=passage},this.createShadowWrapper(""!==this.payload[0].contents?function(){return Wikifier.wikifyEval(_this15.payload[0].contents.trim())}:null,null!=passage?function(){return Engine.play(passage)}:null)).appendTo(this.output)}}),Macro.add("checkbox",{isAsync:!0,handler:function(){if(this.args.length<3){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("unchecked value"),this.args.length<3&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),uncheckValue=this.args[1],checkValue=this.args[2],el=document.createElement("input");switch(jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:"checkbox",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.checked?checkValue:uncheckValue)}))).appendTo(this.output),this.args[3]){case"autocheck":State.getVar(varName)===checkValue?el.checked=!0:State.setVar(varName,uncheckValue);break;case"checked":el.checked=!0,State.setVar(varName,checkValue);break;default:State.setVar(varName,uncheckValue)}}}),Macro.add(["cycle","listbox"],{isAsync:!0,skipArgs:["optionsfrom"],tags:["option","optionsfrom"],handler:function(){var _this16=this;if(0===this.args.length)return this.error("no variable name specified");if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),len=this.payload.length;if(1===len)return this.error("no options specified");for(var config={autoselect:!1,once:!1},i=1;i<this.args.length;++i){var arg=this.args[i];switch(arg){case"once":config.once=!0;break;case"autoselect":config.autoselect=!0;break;default:return this.error("unknown argument: ".concat(arg))}}for(var options=[],tagCount={option:0,optionsfrom:0},selectedIdx=-1,_i5=1;_i5<len;++_i5){var payload=this.payload[_i5];if("option"===payload.name){if(++tagCount.option,0===payload.args.length)return this.error("no arguments specified for <<".concat(payload.name,">> (#").concat(tagCount.option,")"));var option={label:String(payload.args[0])},isSelected=!1;switch(payload.args.length){case 1:option.value=payload.args[0];break;case 2:"selected"===payload.args[1]?(option.value=payload.args[0],isSelected=!0):option.value=payload.args[1];break;default:option.value=payload.args[1],"selected"===payload.args[2]&&(isSelected=!0)}if(options.push(option),isSelected){if(config.autoselect)return this.error("cannot specify both the autoselect and selected keywords");if(-1!==selectedIdx)return this.error("multiple selected keywords specified for <<".concat(payload.name,">> (#").concat(selectedIdx+1," & #").concat(tagCount.option,")"));selectedIdx=options.length-1}}else{var _ret=function(){if(++tagCount.optionsfrom,0===payload.args.full.length)return{v:_this16.error("no expression specified for <<".concat(payload.name,">> (#").concat(tagCount.optionsfrom,")"))};var result=void 0;try{var exp=payload.args.full;result=Scripting.evalJavaScript("{"===exp[0]?"(".concat(exp,")"):exp)}catch(ex){return{v:_this16.error("bad evaluation: ".concat("object"===_typeof(ex)?ex.message:ex))}}if("object"!==_typeof(result)||null===result)return{v:_this16.error("expression must yield a supported collection or generic object (type: ".concat(null===result?"null":_typeof(result),")"))};if(result instanceof Array||result instanceof Set)result.forEach((function(val){return options.push({label:String(val),value:val})}));else if(result instanceof Map)result.forEach((function(val,key){return options.push({label:String(key),value:val})}));else{var oType=Util.toStringTag(result);if("Object"!==oType)return{v:_this16.error("expression must yield a supported collection or generic object (object type: ".concat(oType,")"))};Object.keys(result).forEach((function(key){return options.push({label:key,value:result[key]})}))}}();if("object"===_typeof(_ret))return _ret.v}}if(-1===selectedIdx)if(config.autoselect){var sameValueZero=Util.sameValueZero,curValue=State.getVar(varName),curValueIdx=options.findIndex((function(opt){return sameValueZero(opt.value,curValue)}));selectedIdx=-1===curValueIdx?0:curValueIdx}else selectedIdx=0;if("cycle"===this.name){var lastIdx=options.length-1;if(config.once&&selectedIdx===lastIdx)jQuery(this.output).wikiWithOptions({profile:"core"},options[selectedIdx].label);else{var cycleIdx=selectedIdx;jQuery(document.createElement("a")).wikiWithOptions({profile:"core"},options[selectedIdx].label).attr("id","".concat(this.name,"-").concat(varId)).addClass("macro-".concat(this.name)).ariaClick({namespace:".macros",role:"button"},this.createShadowWrapper((function(){var $this=$(this);cycleIdx=(cycleIdx+1)%options.length,State.setVar(varName,options[cycleIdx].value),$this.empty().wikiWithOptions({profile:"core"},options[cycleIdx].label),config.once&&cycleIdx===lastIdx&&$this.off().contents().unwrap()}))).appendTo(this.output)}}else{var $select=jQuery(document.createElement("select"));options.forEach((function(opt,i){jQuery(document.createElement("option")).val(i).text(opt.label).appendTo($select)})),$select.attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),tabindex:0}).addClass("macro-".concat(this.name)).val(selectedIdx).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,options[Number(this.value)].value)}))).appendTo(this.output)}State.setVar(varName,options[selectedIdx].value)}}),Macro.add(["linkappend","linkprepend","linkreplace"],{isAsync:!0,tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this17=this;if(0===this.args.length)return this.error("no link text specified");var $link=jQuery(document.createElement("a")),$insert=jQuery(document.createElement("span")),transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]);$link.wikiWithOptions({profile:"core"},this.args[0]).addClass("link-internal macro-".concat(this.name)).ariaClick({namespace:".macros",one:!0},this.createShadowWrapper((function(){if("linkreplace"===_this17.name?$link.remove():$link.wrap('<span class="macro-'.concat(_this17.name,'"></span>')).replaceWith((function(){return $link.html()})),""!==_this17.payload[0].contents){var frag=document.createDocumentFragment();new Wikifier(frag,_this17.payload[0].contents),$insert.append(frag)}transition&&setTimeout((function(){return $insert.removeClass("macro-".concat(_this17.name,"-in"))}),Engine.minDomActionDelay)}))).appendTo(this.output),$insert.addClass("macro-".concat(this.name,"-insert")),transition&&$insert.addClass("macro-".concat(this.name,"-in")),"linkprepend"===this.name?$insert.insertBefore($link):$insert.insertAfter($link)}}),Macro.add(["numberbox","textbox"],{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var asNumber="numberbox"===this.name,defaultValue=asNumber?Number(this.args[1]):this.args[1];if(asNumber&&Number.isNaN(defaultValue))return this.error('default value "'.concat(this.args[1],'" is neither a number nor can it be parsed into a number'));var passage,varId=Util.slugify(varName),el=document.createElement("input"),autofocus=!1;this.args.length>3?(passage=this.args[2],autofocus="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?autofocus=!0:passage=this.args[2]),"object"===_typeof(passage)&&(passage=passage.link),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),type:asNumber?"number":"text",inputmode:asNumber?"decimal":"text",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,asNumber?Number(this.value):this.value)}))).on("keypress.macros",this.createShadowWrapper((function(ev){13===ev.which&&(ev.preventDefault(),State.setVar(varName,asNumber?Number(this.value):this.value),null!=passage&&Engine.play(passage))}))).appendTo(this.output),asNumber&&(el.step="any"),State.setVar(varName,defaultValue),el.value=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("radiobutton",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("checked value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));var varId=Util.slugify(varName),checkValue=this.args[1],el=document.createElement("input");switch(TempState.hasOwnProperty(this.name)||(TempState[this.name]={}),TempState[this.name].hasOwnProperty(varId)||(TempState[this.name][varId]=0),jQuery(el).attr({id:"".concat(this.name,"-").concat(varId,"-").concat(TempState[this.name][varId]++),name:"".concat(this.name,"-").concat(varId),type:"radio",tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){this.checked&&State.setVar(varName,checkValue)}))).appendTo(this.output),this.args[2]){case"autocheck":State.getVar(varName)===checkValue&&(el.checked=!0);break;case"checked":el.checked=!0,State.setVar(varName,checkValue)}}}),Macro.add("textarea",{isAsync:!0,handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("variable name"),this.args.length<2&&errors.push("default value"),this.error("no ".concat(errors.join(" or ")," specified"))}if("string"!=typeof this.args[0])return this.error("variable name argument is not a string");var varName=this.args[0].trim();if("$"!==varName[0]&&"_"!==varName[0])return this.error('variable name "'.concat(this.args[0],'" is missing its sigil ($ or _)'));Config.debug&&this.debugView.modes({block:!0});var varId=Util.slugify(varName),defaultValue=this.args[1],autofocus="autofocus"===this.args[2],el=document.createElement("textarea");jQuery(el).attr({id:"".concat(this.name,"-").concat(varId),name:"".concat(this.name,"-").concat(varId),rows:4,tabindex:0}).addClass("macro-".concat(this.name)).on("change.macros",this.createShadowWrapper((function(){State.setVar(varName,this.value)}))).appendTo(this.output),State.setVar(varName,defaultValue),el.textContent=defaultValue,autofocus&&(el.setAttribute("autofocus","autofocus"),postdisplay["#autofocus:".concat(el.id)]=function(task){delete postdisplay[task],setTimeout((function(){return el.focus()}),Engine.minDomActionDelay)})}}),Macro.add("click","link"),Macro.add("actions",{handler:function(){for(var $list=jQuery(document.createElement("ul")).addClass(this.name).appendTo(this.output),i=0;i<this.args.length;++i){var passage=void 0,text=void 0,$image=void 0,setFn=void 0;if("object"===_typeof(this.args[i])?this.args[i].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[i].source),this.args[i].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[i].passage),this.args[i].hasOwnProperty("title")&&$image.attr("title",this.args[i].title),this.args[i].hasOwnProperty("align")&&$image.attr("align",this.args[i].align),passage=this.args[i].link,setFn=this.args[i].setFn):(text=this.args[i].text,passage=this.args[i].link,setFn=this.args[i].setFn):text=passage=this.args[i],!(State.variables.hasOwnProperty("#actions")&&State.variables["#actions"].hasOwnProperty(passage)&&State.variables["#actions"][passage])){var $link=jQuery(Wikifier.createInternalLink(jQuery(document.createElement("li")).appendTo($list),passage,null,function(passage,fn){return function(){State.variables.hasOwnProperty("#actions")||(State.variables["#actions"]={}),State.variables["#actions"][passage]=!0,"function"==typeof fn&&fn()}}(passage,setFn))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text));$image&&$link.addClass("link-image")}}}}),Macro.add(["back","return"],{handler:function(){if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");var passage,text,$image,$link,momentIndex=-1;if(1===this.args.length&&("object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),this.args[0].hasOwnProperty("link")&&(passage=this.args[0].link)):(1===this.args[0].count||(text=this.args[0].text),passage=this.args[0].link):1===this.args.length&&(text=this.args[0])),null==passage){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){momentIndex=i,passage=State.history[i].title;break}if(null==passage&&"return"===this.name)for(var _i6=State.expired.length-1;_i6>=0;--_i6)if(State.expired[_i6]!==State.passage){passage=State.expired[_i6];break}}else{if(!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));if("back"===this.name){for(var _i7=State.length-2;_i7>=0;--_i7)if(State.history[_i7].title===passage){momentIndex=_i7;break}if(-1===momentIndex)return this.error('cannot find passage "'.concat(passage,'" in the current story history'))}}if(null==passage)return this.error("cannot find passage");"back"!==this.name||-1!==momentIndex?($link=jQuery(document.createElement("a")).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){return Engine.play(passage)}:function(){return Engine.goTo(momentIndex)}),$image&&$link.addClass("link-image")):$link=jQuery(document.createElement("span")).addClass("link-disabled"),$link.addClass("macro-".concat(this.name)).append($image||document.createTextNode(text||L10n.get("macro".concat(this.name.toUpperFirst(),"Text")))).appendTo(this.output)}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var passage,text,$image,setFn,$link,choiceId=State.passage;if(1===this.args.length?"object"===_typeof(this.args[0])?this.args[0].isImage?($image=jQuery(document.createElement("img")).attr("src",this.args[0].source),this.args[0].hasOwnProperty("passage")&&$image.attr("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&$image.attr("title",this.args[0].title),this.args[0].hasOwnProperty("align")&&$image.attr("align",this.args[0].align),passage=this.args[0].link,setFn=this.args[0].setFn):(text=this.args[0].text,passage=this.args[0].link,setFn=this.args[0].setFn):text=passage=this.args[0]:(passage=this.args[0],text=this.args[1]),State.variables.hasOwnProperty("#choice")&&State.variables["#choice"].hasOwnProperty(choiceId)&&State.variables["#choice"][choiceId])return $link=jQuery(document.createElement("span")).addClass("link-disabled macro-".concat(this.name)).attr("tabindex",-1).append($image||document.createTextNode(text)).appendTo(this.output),void($image&&$link.addClass("link-image"));$link=jQuery(Wikifier.createInternalLink(this.output,passage,null,(function(){State.variables.hasOwnProperty("#choice")||(State.variables["#choice"]={}),State.variables["#choice"][choiceId]=!0,"function"==typeof setFn&&setFn()}))).addClass("macro-".concat(this.name)).append($image||document.createTextNode(text)),$image&&$link.addClass("link-image")}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("selector"),this.args.length<2&&errors.push("class names"),this.error("no ".concat(errors.join(" or ")," specified"))}var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));switch(this.name){case"addclass":$targets.addClass(this.args[1].trim());break;case"toggleclass":$targets.toggleClass(this.args[1].trim())}Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));this.args.length>1?$targets.removeClass(this.args[1].trim()):$targets.removeClass(),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));jQuery(this.output).append($targets.html()),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add(["append","prepend","replace"],{tags:null,t8nRe:/^(?:transition|t8n)$/,handler:function(){var _this18=this;if(0===this.args.length)return this.error("no selector specified");var $insert,$targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));if(""!==this.payload[0].contents)switch(this.args.length>1&&this.self.t8nRe.test(this.args[1])?(($insert=jQuery(document.createElement("span"))).addClass("macro-".concat(this.name,"-insert macro-").concat(this.name,"-in")),setTimeout((function(){return $insert.removeClass("macro-".concat(_this18.name,"-in"))}),Engine.minDomActionDelay)):$insert=jQuery(document.createDocumentFragment()),$insert.wiki(this.payload[0].contents),this.name){case"replace":$targets.empty();case"append":$targets.append($insert);break;case"prepend":$targets.prepend($insert)}else"replace"===this.name&&$targets.empty();Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var $targets=jQuery(this.args[0]);if(0===$targets.length)return this.error('no elements matched the selector "'.concat(this.args[0],'"'));$targets.remove(),Config.debug&&this.debugView.modes({hidden:!0})}}),Has.audio){var errorOnePlaybackAction=function(cur,prev){return'only one playback action allowed per invocation, "'.concat(cur,'" cannot be combined with "').concat(prev,'"')};Macro.add("audio",{handler:function(){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track and/or group IDs"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var selected;try{selected=SimpleAudio.select(this.args[0])}catch(ex){return this.error(ex.message)}for(var action,fadeTo,loop,mute,passage,time,volume,args=this.args.slice(1),fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors=[];return args.length<1&&_errors.push("seconds"),args.length<2&&_errors.push("level"),this.error("fadeoverto missing required ".concat(_errors.join(" and ")," value").concat(_errors.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"time":if(0===args.length)return this.error("time missing required seconds value");if(raw=args.shift(),time=Number.parseFloat(raw),Number.isNaN(time)||!Number.isFinite(time))return this.error("cannot parse time: ".concat(raw));break;case"loop":case"unloop":loop="loop"===arg;break;case"goto":if(0===args.length)return this.error("goto missing required passage title");if(raw=args.shift(),passage="object"===_typeof(raw)?raw.link:raw,!Story.has(passage))return this.error('passage "'.concat(passage,'" does not exist'));break;default:return this.error("unknown action: ".concat(arg))}}try{if(null!=volume&&selected.volume(volume),null!=time&&selected.time(time),null!=mute&&selected.mute(mute),null!=loop&&selected.loop(loop),null!=passage){var nsEnded="ended.macros.macro-".concat(this.name,"_goto");selected.off(nsEnded).one(nsEnded,(function(){selected.off(nsEnded),Engine.play(passage)}))}switch(action){case"fade":selected.fade(fadeOver,fadeTo);break;case"load":selected.load();break;case"pause":selected.pause();break;case"play":selected.playWhenAllowed();break;case"stop":selected.stop();break;case"unload":selected.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("cacheaudio",{handler:function(){var _this19=this;if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("track ID"),this.args.length<2&&errors.push("sources"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim(),oldFmtRe=/^format:\s*([\w-]+)\s*;\s*/i;try{SimpleAudio.tracks.add(id,this.args.slice(1).map((function(source){if(oldFmtRe.test(source)){if(Config.debug)return _this19.error('track ID "'.concat(id,'": format specifier migration required, "format:formatId;" → "formatId|"'));source=source.replace(oldFmtRe,"$1|")}return source})))}catch(ex){return this.error(ex.message)}if(Config.debug&&!SimpleAudio.tracks.get(id).hasSource())return this.error('track ID "'.concat(id,'": no supported audio sources found'));Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("createaudiogroup",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no group ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var groupId=String(this.args[0]).trim(),trackIds=[],i=1,len=this.payload.length;i<len;++i){if(this.payload[i].args.length<1)return this.error("no track ID specified");trackIds.push(String(this.payload[i].args[0]).trim()),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.groups.add(groupId,trackIds)}catch(ex){return this.error(ex.message)}Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("createplaylist",{tags:["track"],handler:function(){if(0===this.args.length)return this.error("no list ID specified");if(1===this.payload.length)return this.error("no tracks defined via <<track>>");var playlist=Macro.get("playlist");if(null!==playlist.from&&"createplaylist"!==playlist.from)return this.error("a playlist has already been defined with <<setplaylist>>");Config.debug&&this.debugView.modes({nonvoid:!1,hidden:!0});for(var listId=String(this.args[0]).trim(),trackObjs=[],i=1,len=this.payload.length;i<len;++i){if(0===this.payload[i].args.length)return this.error("no track ID specified");for(var trackObj={id:String(this.payload[i].args[0]).trim()},args=this.payload[i].args.slice(1);args.length>0;){var arg=args.shift(),raw=void 0,parsed=void 0;switch(arg){case"copy":case"own":trackObj.own=!0;break;case"rate":args.length>0&&args.shift();break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),parsed=Number.parseFloat(raw),Number.isNaN(parsed)||!Number.isFinite(parsed))return this.error("cannot parse volume: ".concat(raw));trackObj.volume=parsed;break;default:return this.error("unknown action: ".concat(arg))}}trackObjs.push(trackObj),Config.debug&&this.createDebugView(this.payload[i].name,this.payload[i].source).modes({nonvoid:!1,hidden:!0})}try{SimpleAudio.lists.add(listId,trackObjs)}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="createplaylist"),Config.debug&&this.createDebugView("/".concat(this.name),"<</".concat(this.name,">>")).modes({nonvoid:!1,hidden:!0})}}),Macro.add("masteraudio",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var action,mute,muteOnHide,volume,args=this.args.slice(0);args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"mute":case"unmute":mute="mute"===arg;break;case"muteonhide":case"nomuteonhide":muteOnHide="muteonhide"===arg;break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=mute&&SimpleAudio.mute(mute),null!=muteOnHide&&SimpleAudio.muteOnHidden(muteOnHide),null!=volume&&SimpleAudio.volume(volume),action){case"load":SimpleAudio.load();break;case"stop":SimpleAudio.stop();break;case"unload":SimpleAudio.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("playlist",{from:null,handler:function(){var list,args,action,from=this.self.from;if(null===from)return this.error("no playlists have been created");if("createplaylist"===from){if(this.args.length<2){var errors=[];return this.args.length<1&&errors.push("list ID"),this.args.length<2&&errors.push("actions"),this.error("no ".concat(errors.join(" or ")," specified"))}var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));list=SimpleAudio.lists.get(id),args=this.args.slice(1)}else{if(0===this.args.length)return this.error("no actions specified");list=SimpleAudio.lists.get("setplaylist"),args=this.args.slice(0)}for(var fadeTo,loop,mute,shuffle,volume,fadeOver=5;args.length>0;){var arg=args.shift(),raw=void 0;switch(arg){case"load":case"pause":case"play":case"skip":case"stop":case"unload":if(action)return this.error(errorOnePlaybackAction(arg,action));action=arg;break;case"fadein":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=1;break;case"fadeout":if(action)return this.error(errorOnePlaybackAction(arg,action));action="fade",fadeTo=0;break;case"fadeto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(0===args.length)return this.error("fadeto missing required level value");if(action="fade",raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeto: ".concat(raw));break;case"fadeoverto":if(action)return this.error(errorOnePlaybackAction(arg,action));if(args.length<2){var _errors2=[];return args.length<1&&_errors2.push("seconds"),args.length<2&&_errors2.push("level"),this.error("fadeoverto missing required ".concat(_errors2.join(" and ")," value").concat(_errors2.length>1?"s":""))}if(action="fade",raw=args.shift(),fadeOver=Number.parseFloat(raw),Number.isNaN(fadeOver)||!Number.isFinite(fadeOver))return this.error("cannot parse fadeoverto: ".concat(raw));if(raw=args.shift(),fadeTo=Number.parseFloat(raw),Number.isNaN(fadeTo)||!Number.isFinite(fadeTo))return this.error("cannot parse fadeoverto: ".concat(raw));break;case"volume":if(0===args.length)return this.error("volume missing required level value");if(raw=args.shift(),volume=Number.parseFloat(raw),Number.isNaN(volume)||!Number.isFinite(volume))return this.error("cannot parse volume: ".concat(raw));break;case"mute":case"unmute":mute="mute"===arg;break;case"loop":case"unloop":loop="loop"===arg;break;case"shuffle":case"unshuffle":shuffle="shuffle"===arg;break;default:return this.error("unknown action: ".concat(arg))}}try{switch(null!=volume&&list.volume(volume),null!=mute&&list.mute(mute),null!=loop&&list.loop(loop),null!=shuffle&&list.shuffle(shuffle),action){case"fade":list.fade(fadeOver,fadeTo);break;case"load":list.load();break;case"pause":list.pause();break;case"play":list.playWhenAllowed();break;case"skip":list.skip();break;case"stop":list.stop();break;case"unload":list.unload()}Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error("error executing action: ".concat(ex.message))}}}),Macro.add("removeaudiogroup",{handler:function(){if(0===this.args.length)return this.error("no group ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.groups.has(id))return this.error('group "'.concat(id,'" does not exist'));SimpleAudio.groups.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("removeplaylist",{handler:function(){if(0===this.args.length)return this.error("no list ID specified");var id=String(this.args[0]).trim();if(!SimpleAudio.lists.has(id))return this.error('playlist "'.concat(id,'" does not exist'));SimpleAudio.lists.delete(id),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("waitforaudio",{skipArgs:!0,handler:function(){SimpleAudio.loadWithScreen()}}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");var playlist=Macro.get("playlist");if(null!==playlist.from&&"setplaylist"!==playlist.from)return this.error("playlists have already been defined with <<createplaylist>>");try{SimpleAudio.lists.add("setplaylist",this.args.slice(0))}catch(ex){return this.error(ex.message)}null===playlist.from&&(playlist.from="setplaylist"),Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("stopallaudio",{skipArgs:!0,handler:function(){SimpleAudio.select(":all").stop(),Config.debug&&this.debugView.modes({hidden:!0})}})}else Macro.add(["audio","cacheaudio","createaudiogroup","createplaylist","masteraudio","playlist","removeaudiogroup","removeplaylist","waitforaudio","setplaylist","stopallaudio"],{skipArgs:!0,handler:function(){Config.debug&&this.debugView.modes({hidden:!0})}});Macro.add("done",{skipArgs:!0,tags:null,handler:function(){var contents=this.payload[0].contents.trim();""!==contents&&setTimeout(this.createShadowWrapper((function(){return $.wiki(contents)})),Engine.minDomActionDelay)}}),Macro.add("goto",{handler:function(){return 0===this.args.length?this.error("no passage specified"):(passage="object"===_typeof(this.args[0])?this.args[0].link:this.args[0],Story.has(passage)?void setTimeout((function(){return Engine.play(passage)}),Engine.minDomActionDelay):this.error('passage "'.concat(passage,'" does not exist')));var passage}}),Macro.add("repeat",{isAsync:!0,tags:null,timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){var delay,_this20=this;if(0===this.args.length)return this.error("no time value specified");try{delay=Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0]))}catch(ex){return this.error(ex.message)}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerInterval(this.createShadowWrapper((function(){var frag=document.createDocumentFragment();new Wikifier(frag,_this20.payload[0].contents);var $output=$wrapper;transition&&($output=jQuery(document.createElement("span")).addClass("macro-repeat-insert macro-repeat-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-repeat-in")}),Engine.minDomActionDelay)})),delay)},registerInterval:function(callback,delay){var _this21=this;if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null;timerId=setInterval((function(){if(State.passage!==passage||State.turns!==turn)return clearInterval(timerId),void timers.delete(timerId);var timerIdCache;try{TempState.break=null,TempState.hasOwnProperty("repeatTimerId")&&(timerIdCache=TempState.repeatTimerId),TempState.repeatTimerId=timerId,callback.call(_this21)}finally{void 0!==timerIdCache?TempState.repeatTimerId=timerIdCache:delete TempState.repeatTimerId,TempState.break=null}}),delay),timers.add(timerId),prehistory.hasOwnProperty("#repeat-timers-cleanup")||(prehistory["#repeat-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearInterval(timerId)})),timers.clear()})}}),Macro.add("stop",{skipArgs:!0,handler:function(){if(!TempState.hasOwnProperty("repeatTimerId"))return this.error("must only be used in conjunction with its parent macro <<repeat>>");var timers=Macro.get("repeat").timers,timerId=TempState.repeatTimerId;clearInterval(timerId),timers.delete(timerId),TempState.break=2,Config.debug&&this.debugView.modes({hidden:!0})}}),Macro.add("timed",{isAsync:!0,tags:["next"],timers:new Set,t8nRe:/^(?:transition|t8n)$/,handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var i,items=[];try{items.push({name:this.name,source:this.source,delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.args[0])),content:this.payload[0].contents})}catch(ex){return this.error("".concat(ex.message," in <<timed>>"))}if(this.payload.length>1)try{var len;for(i=1,len=this.payload.length;i<len;++i)items.push({name:this.payload[i].name,source:this.payload[i].source,delay:0===this.payload[i].args.length?items[items.length-1].delay:Math.max(Engine.minDomActionDelay,Util.fromCssTime(this.payload[i].args[0])),content:this.payload[i].contents})}catch(ex){return this.error("".concat(ex.message," in <<next>> (#").concat(i,")"))}Config.debug&&this.debugView.modes({block:!0});var transition=this.args.length>1&&this.self.t8nRe.test(this.args[1]),$wrapper=jQuery(document.createElement("span")).addClass("macro-".concat(this.name)).appendTo(this.output);this.self.registerTimeout(this.createShadowWrapper((function(item){var frag=document.createDocumentFragment();new Wikifier(frag,item.content);var $output=$wrapper;Config.debug&&"next"===item.name&&($output=jQuery(new DebugView($output[0],"macro",item.name,item.source).output)),transition&&($output=jQuery(document.createElement("span")).addClass("macro-timed-insert macro-timed-in").appendTo($output)),$output.append(frag),transition&&setTimeout((function(){return $output.removeClass("macro-timed-in")}),Engine.minDomActionDelay)})),items)},registerTimeout:function(callback,items){if("function"!=typeof callback)throw new TypeError("callback parameter must be a function");var passage=State.passage,turn=State.turns,timers=this.timers,timerId=null,nextItem=items.shift();timerId=setTimeout((function worker(){if(timers.delete(timerId),State.passage===passage&&State.turns===turn){var curItem=nextItem;null!=(nextItem=items.shift())&&(timerId=setTimeout(worker,nextItem.delay),timers.add(timerId)),callback.call(this,curItem)}}),nextItem.delay),timers.add(timerId),prehistory.hasOwnProperty("#timed-timers-cleanup")||(prehistory["#timed-timers-cleanup"]=function(task){delete prehistory[task],timers.forEach((function(timerId){return clearTimeout(timerId)})),timers.clear()})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var widgetCode,widgetName=this.args[0],isNonVoid=this.args.length>1&&"container"===this.args[1];if(Macro.has(widgetName)){if(!Macro.get(widgetName).isWidget)return this.error('cannot clobber existing macro "'.concat(widgetName,'"'));Macro.delete(widgetName)}try{var widgetDef={isWidget:!0,handler:(widgetCode=this.payload[0].contents,function(){var shadowStore={};State.temporary.hasOwnProperty("args")&&(shadowStore._args=State.temporary.args),State.temporary.args=_toConsumableArray(this.args),State.temporary.args.raw=this.args.raw,State.temporary.args.full=this.args.full,this.addShadow("_args"),isNonVoid&&(State.temporary.hasOwnProperty("contents")&&(shadowStore._contents=State.temporary.contents),State.temporary.contents=this.payload[0].contents,this.addShadow("_contents")),State.variables.hasOwnProperty("args")&&(shadowStore.$args=State.variables.args),State.variables.args=State.temporary.args,this.addShadow("$args");try{var resFrag=document.createDocumentFragment(),errList=[];if(new Wikifier(resFrag,widgetCode),Array.from(resFrag.querySelectorAll(".error")).forEach((function(errEl){errList.push(errEl.textContent)})),0!==errList.length)return this.error("error".concat(errList.length>1?"s":""," within widget code (").concat(errList.join("; "),")"));this.output.appendChild(resFrag)}catch(ex){return this.error("cannot execute widget: ".concat(ex.message))}finally{shadowStore.hasOwnProperty("_args")?State.temporary.args=shadowStore._args:delete State.temporary.args,isNonVoid&&(shadowStore.hasOwnProperty("_contents")?State.temporary.contents=shadowStore._contents:delete State.temporary.contents),shadowStore.hasOwnProperty("$args")?State.variables.args=shadowStore.$args:delete State.variables.args}})};isNonVoid&&(widgetDef.tags=[]),Macro.add(widgetName,widgetDef),Config.debug&&this.debugView.modes({hidden:!0})}catch(ex){return this.error('cannot create widget macro "'.concat(widgetName,'": ').concat(ex.message))}}})}();var Dialog=function(){var _$overlay=null,_$dialog=null,_$dialogTitle=null,_$dialogBody=null,_lastActive=null,_scrollbarWidth=0,_dialogObserver=null;function dialogClose(ev){return _$dialogBody.trigger(":dialogclosing"),jQuery(document).off(".dialog-close"),_dialogObserver?(_dialogObserver.disconnect(),_dialogObserver=null):_$dialogBody.off(".dialog-resize"),jQuery(window).off(".dialog-resize"),_$dialog.removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),_$overlay.removeClass("open"),jQuery(document.documentElement).removeAttr("data-dialog"),_$dialogTitle.empty(),_$dialogBody.empty().removeClass(),null!==_lastActive&&(jQuery(_lastActive).focus(),_lastActive=null),ev&&ev.data&&"function"==typeof ev.data.closeFn&&ev.data.closeFn(ev),_$dialogBody.trigger(":dialogclose"),_$dialogBody.trigger(":dialogclosed"),Dialog}function dialogIsOpen(classNames){return _$dialog.hasClass("open")&&(!classNames||classNames.splitOrEmpty(/\s+/).every((function(cn){return _$dialogBody.hasClass(cn)})))}function dialogOpen(options,closeFn){_$dialogBody.trigger(":dialogopening");var top=jQuery.extend({top:50},options).top;return dialogIsOpen()||(_lastActive=safeActiveElement()),jQuery(document.documentElement).attr("data-dialog","open"),_$overlay.addClass("open"),null!==_$dialogBody[0].querySelector("img")&&_$dialogBody.imagesLoaded().always((function(){return _resizeHandler({data:{top:top}})})),jQuery("body>:not(script,#store-area,tw-storydata,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0),_$dialog.css(_calcPosition(top)).addClass("open").focus(),jQuery(window).on("resize.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),Has.mutationObserver?(_dialogObserver=new MutationObserver((function(mutations){for(var i=0;i<mutations.length;++i)if("childList"===mutations[i].type){_resizeHandler({data:{top:top}});break}}))).observe(_$dialogBody[0],{childList:!0,subtree:!0}):_$dialogBody.on("DOMNodeInserted.dialog-resize DOMNodeRemoved.dialog-resize",null,{top:top},jQuery.throttle(40,_resizeHandler)),jQuery(document).one("click.dialog-close",".ui-close",{closeFn:closeFn},(function(ev){dialogClose(ev)})).one("keypress.dialog-close",".ui-close",(function(ev){13!==ev.which&&32!==ev.which||jQuery(this).trigger("click")})),_$dialogBody.trigger(":dialogopen"),_$dialogBody.trigger(":dialogopened"),Dialog}function _calcPosition(topPos){var top=null!=topPos?topPos:50,$parent=jQuery(window),dialogPos={left:"",right:"",top:"",bottom:""};_$dialog.css(dialogPos);var horzSpace=$parent.width()-_$dialog.outerWidth(!0)-1,vertSpace=$parent.height()-_$dialog.outerHeight(!0)-1;return horzSpace<=32+_scrollbarWidth&&(vertSpace-=_scrollbarWidth),vertSpace<=32+_scrollbarWidth&&(horzSpace-=_scrollbarWidth),dialogPos.left=dialogPos.right=horzSpace<=32?16:horzSpace/2>>0,dialogPos.top=vertSpace<=32?dialogPos.bottom=16:vertSpace/2>top?top:dialogPos.bottom=vertSpace/2>>0,Object.keys(dialogPos).forEach((function(key){""!==dialogPos[key]&&(dialogPos[key]+="px")})),dialogPos}function _resizeHandler(ev){var top=ev&&ev.data&&void 0!==ev.data.top?ev.data.top:50;"block"===_$dialog.css("display")&&(_$dialog.css({display:"none"}),_$dialog.css(jQuery.extend({display:""},_calcPosition(top))))}return Object.freeze(Object.defineProperties({},{append:{value:function(){var _$dialogBody2;return(_$dialogBody2=_$dialogBody).append.apply(_$dialogBody2,arguments),Dialog}},body:{value:function(){return _$dialogBody.get(0)}},close:{value:dialogClose},init:{value:function(){if(!document.getElementById("ui-dialog")){_scrollbarWidth=function(){var scrollbarWidth;try{var inner=document.createElement("p"),outer=document.createElement("div");inner.style.width="100%",inner.style.height="200px",outer.style.position="absolute",outer.style.left="0px",outer.style.top="0px",outer.style.width="100px",outer.style.height="100px",outer.style.visibility="hidden",outer.style.overflow="hidden",outer.appendChild(inner),document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="auto";var w2=inner.offsetWidth;w1===w2&&(w2=outer.clientWidth),document.body.removeChild(outer),scrollbarWidth=w1-w2}catch(ex){}return scrollbarWidth||17}();var $elems=jQuery(document.createDocumentFragment()).append('<div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1>'+'<button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'.concat(L10n.get("close"),'"></button>')+'</div><div id="ui-dialog-body"></div></div>');_$overlay=jQuery($elems.find("#ui-overlay").get(0)),_$dialog=jQuery($elems.find("#ui-dialog").get(0)),_$dialogTitle=jQuery($elems.find("#ui-dialog-title").get(0)),_$dialogBody=jQuery($elems.find("#ui-dialog-body").get(0)),$elems.insertBefore("body>script#script-sugarcube")}}},isOpen:{value:dialogIsOpen},open:{value:dialogOpen},resize:{value:function(data){return _resizeHandler("object"===_typeof(data)?{data:data}:undefined)}},setup:{value:function(title,classNames){return _$dialogBody.empty().removeClass(),null!=classNames&&_$dialogBody.addClass(classNames),_$dialogTitle.empty().append((null!=title?String(title):"")||" "),_$dialogBody.get(0)}},wiki:{value:function(){var _$dialogBody3;return(_$dialogBody3=_$dialogBody).wiki.apply(_$dialogBody3,arguments),Dialog}},addClickHandler:{value:function(targets,options,startFn,doneFn,closeFn){return jQuery(targets).ariaClick((function(ev){ev.preventDefault(),"function"==typeof startFn&&startFn(ev),dialogOpen(options,closeFn),"function"==typeof doneFn&&doneFn(ev)}))}}}))}(),Engine=function(){var States=Util.toEnum({Idle:"idle",Playing:"playing",Rendering:"rendering"}),_initDebugViews=[],_state=States.Idle,_lastPlay=null,_outlinePatch=null,_updating=null;function engineGo(offset){var succeded=State.go(offset);return succeded&&engineShow(),succeded}function engineShow(){return enginePlay(State.passage,!0)}function enginePlay(title,noHistory){var passageReadyOutput,passageDoneOutput,passageTitle=title;if(_state=States.Playing,TempState={},State.clearTemporary(),"function"==typeof Config.navigation.override)try{var overrideTitle=Config.navigation.override(passageTitle);overrideTitle&&(passageTitle=overrideTitle)}catch(ex){}var passage=Story.get(passageTitle);if(jQuery.event.trigger({type:":passageinit",passage:passage}),Object.keys(prehistory).forEach((function(task){"function"==typeof prehistory[task]&&prehistory[task].call(passage,task)})),noHistory||State.create(passage.title),document.body.className&&(document.body.className=""),_lastPlay=Util.now(),Object.keys(predisplay).forEach((function(task){"function"==typeof predisplay[task]&&predisplay[task].call(passage,task)})),Story.has("PassageReady"))try{passageReadyOutput=Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(ex){console.error(ex),Alert.error("PassageReady",ex.message)}_state=States.Rendering;var dataTags=passage.tags.length>0?passage.tags.join(" "):null,passageEl=document.createElement("div");jQuery(passageEl).attr({id:passage.domId,"data-passage":passage.title,"data-tags":dataTags}).addClass("passage ".concat(passage.className)),jQuery(document.body).attr("data-tags",dataTags).addClass(passage.className),jQuery(document.documentElement).attr("data-tags",dataTags),jQuery.event.trigger({type:":passagestart",content:passageEl,passage:passage}),Object.keys(prerender).forEach((function(task){"function"==typeof prerender[task]&&prerender[task].call(passage,passageEl,task)})),Story.has("PassageHeader")&&new Wikifier(passageEl,Story.get("PassageHeader").processText()),passageEl.appendChild(passage.render()),Story.has("PassageFooter")&&new Wikifier(passageEl,Story.get("PassageFooter").processText()),jQuery.event.trigger({type:":passagerender",content:passageEl,passage:passage}),Object.keys(postrender).forEach((function(task){"function"==typeof postrender[task]&&postrender[task].call(passage,passageEl,task)}));var debugView,containerEl=document.getElementById("passages");if(containerEl.hasChildNodes()&&("number"==typeof Config.passages.transitionOut||"string"==typeof Config.passages.transitionOut&&""!==Config.passages.transitionOut&&Has.transitionEndEvent?_toConsumableArray(containerEl.childNodes).forEach((function(outgoing){var $outgoing=jQuery(outgoing);if(outgoing.nodeType===Node.ELEMENT_NODE&&$outgoing.hasClass("passage")){if($outgoing.hasClass("passage-out"))return;$outgoing.attr({id:"out-".concat($outgoing.attr("id")),"aria-live":"off"}).addClass("passage-out"),"string"==typeof Config.passages.transitionOut?$outgoing.on(Has.transitionEndEvent,(function(ev){ev.propertyName===Config.passages.transitionOut&&$outgoing.remove()})):setTimeout((function(){return $outgoing.remove()}),Math.max(40,Config.passages.transitionOut))}else $outgoing.remove()})):jQuery(containerEl).empty()),jQuery(passageEl).addClass("passage-in").appendTo(containerEl),setTimeout((function(){return jQuery(passageEl).removeClass("passage-in")}),40),Story.has("StoryDisplayTitle")?null===_updating&&Config.ui.updateStoryElements||setDisplayTitle(Story.get("StoryDisplayTitle").processText()):Config.passages.displayTitles&&passage.title!==Config.passages.start&&(document.title="".concat(passage.title," | ").concat(Story.title)),window.scroll(0,0),_state=States.Playing,Story.has("PassageDone"))try{passageDoneOutput=Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(ex){console.error(ex),Alert.error("PassageDone",ex.message)}(jQuery.event.trigger({type:":passagedisplay",content:passageEl,passage:passage}),Object.keys(postdisplay).forEach((function(task){"function"==typeof postdisplay[task]&&postdisplay[task].call(passage,task)})),null!==_updating?_updating.forEach((function(pair){jQuery(pair.element).empty(),new Wikifier(pair.element,Story.get(pair.passage).processText().trim())})):Config.ui.updateStoryElements&&UIBar.update(),Config.debug)&&(null!=passageReadyOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageReady","PassageReady")).modes({hidden:!0}),debugView.append(passageReadyOutput),jQuery(passageEl).prepend(debugView.output)),null!=passageDoneOutput&&((debugView=new DebugView(document.createDocumentFragment(),"special","PassageDone","PassageDone")).modes({hidden:!0}),debugView.append(passageDoneOutput),jQuery(passageEl).append(debugView.output)),1===State.turns&&_initDebugViews.length>0&&jQuery(passageEl).prepend(_initDebugViews));switch(jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),_typeof(Config.saves.autosave)){case"boolean":Config.saves.autosave&&Save.autosave.save();break;case"object":passage.tags.some((function(tag){return Config.saves.autosave.includes(tag)}))&&Save.autosave.save();break;case"function":Config.saves.autosave()&&Save.autosave.save()}return jQuery.event.trigger({type:":passageend",content:passageEl,passage:passage}),_state=States.Idle,_lastPlay=Util.now(),passageEl}function _hideOutlines(){_outlinePatch.set("*:focus{outline:none;}")}return Object.freeze(Object.defineProperties({},{States:{value:States},minDomActionDelay:{value:40},init:{value:function(){var _lastOutlineEvent;jQuery("#init-no-js,#init-lacking").remove(),function(){var $elems=jQuery(document.createDocumentFragment()),markup=Story.has("StoryInterface")&&Story.get("StoryInterface").text.trim();if(markup){UIBar.destroy(),jQuery(document.head).find("#style-core-display").remove(),$elems.append(markup);var $passages=$elems.find("#passages");if(0===$passages.length)throw new Error('no element with ID "passages" found within "StoryInterface" special passage');$passages.empty().not("[aria-live]").attr("aria-live","polite").end(),$elems.find("[data-init-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-init-passage" content attribute'));var passage=el.getAttribute("data-init-passage").trim();if(el.hasAttribute("data-passage"))throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> must not contain a "data-passage" content attribute'));if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-init-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&jQuery(el).empty().wiki(Story.get(passage).processText().trim())}));var updating=[];$elems.find("[data-passage]").each((function(i,el){if("passages"===el.id)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' id="passages"> must not contain a "data-passage" content attribute'));var passage=el.getAttribute("data-passage").trim();if(null!==el.firstElementChild)throw new Error('"StoryInterface" element <'.concat(el.nodeName.toLowerCase(),' data-passage="').concat(passage,'"> contains child elements'));Story.has(passage)&&updating.push({passage:passage,element:el})})),updating.length>0&&(_updating=updating),Config.ui.updateStoryElements=!1}else $elems.append('<div id="story" role="main"><div id="passages" aria-live="polite"></div></div>');$elems.insertBefore("body>script#script-sugarcube")}(),_outlinePatch=new StyleWrapper(jQuery(document.createElement("style")).attr({id:"style-aria-outlines",type:"text/css"}).appendTo(document.head).get(0)),_hideOutlines(),jQuery(document).on("mousedown.aria-outlines keydown.aria-outlines",(function(ev){ev.type!==_lastOutlineEvent&&(_lastOutlineEvent=ev.type,"keydown"===ev.type?_outlinePatch.clear():_hideOutlines())}))}},start:{value:function(){if(Story.getAllInit().forEach((function(passage){try{var debugBuffer=Wikifier.wikifyEval(passage.text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","".concat(passage.title," [init-tagged]"),"".concat(passage.title," [init-tagged]"));debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("".concat(passage.title," [init-tagged]"),"object"===_typeof(ex)?ex.message:ex)}})),Story.has("StoryInit"))try{var debugBuffer=Wikifier.wikifyEval(Story.get("StoryInit").text);if(Config.debug){var debugView=new DebugView(document.createDocumentFragment(),"special","StoryInit","StoryInit");debugView.modes({hidden:!0}),debugView.append(debugBuffer),_initDebugViews.push(debugView.output)}}catch(ex){console.error(ex),Alert.error("StoryInit","object"===_typeof(ex)?ex.message:ex)}if(null==Config.passages.start)throw new Error("starting passage not selected");if(!Story.has(Config.passages.start))throw new Error('starting passage ("'.concat(Config.passages.start,'") not found'));if(jQuery(document.documentElement).focus(),State.restore())engineShow();else{var loadStart=!0;switch(_typeof(Config.saves.autoload)){case"boolean":Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!Save.autosave.load());break;case"string":"prompt"===Config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(loadStart=!1,UI.buildAutoload(),Dialog.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&Config.saves.autoload()&&(loadStart=!Save.autosave.load())}loadStart&&enginePlay(Config.passages.start)}}},restart:{value:function(){LoadScreen.show(),window.scroll(0,0),State.reset(),jQuery.event.trigger(":enginerestart"),window.location.reload()}},state:{get:function(){return _state}},isIdle:{value:function(){return _state===States.Idle}},isPlaying:{value:function(){return _state!==States.Idle}},isRendering:{value:function(){return _state===States.Rendering}},lastPlay:{get:function(){return _lastPlay}},goTo:{value:function(idx){var succeded=State.goTo(idx);return succeded&&engineShow(),succeded}},go:{value:engineGo},backward:{value:function(){return engineGo(-1)}},forward:{value:function(){return engineGo(1)}},show:{value:engineShow},play:{value:enginePlay},display:{value:function(title,link,option){var noHistory=!1;switch(option){case undefined:break;case"replace":case"back":noHistory=!0;break;default:throw new Error('Engine.display option parameter called with obsolete value "'.concat(option,'"; please notify the developer'))}enginePlay(title,noHistory)}}}))}(),Passage=(_tagsToSkip=/^(?:debug|nobr|passage|widget|twine\..*)$/i,function(){function Passage(title,el){var _this22=this;_classCallCheck(this,Passage),Object.defineProperties(this,{title:{value:Util.unescape(title)},element:{value:el||null},tags:{value:Object.freeze(el&&el.hasAttribute("tags")?Array.from(new Set(el.getAttribute("tags").trim().splitOrEmpty(/\s+/))):[])},_excerpt:{writable:!0,value:null}}),Object.defineProperties(this,{domId:{value:"passage-".concat(Util.slugify(this.title))},classes:{value:Object.freeze(0===this.tags.length?[]:_this22.tags.filter((function(tag){return!_tagsToSkip.test(tag)})).map((function(tag){return Util.slugify(tag)})))}})}return _createClass(Passage,[{key:"className",get:function(){return this.classes.join(" ")}},{key:"text",get:function(){if(null==this.element){var passage=Util.escapeMarkup(this.title),mesg="".concat(L10n.get("errorTitle"),": ").concat(L10n.get("errorNonexistentPassage",{passage:passage}));return'<div class="error-view"><span class="error">'.concat(mesg,"</span></div>")}return this.element.textContent.replace(/\r/g,"")}},{key:"description",value:function(){var descriptions=Config.passages.descriptions;switch(_typeof(descriptions)){case"boolean":if(descriptions)return this.title;break;case"object":if(descriptions.hasOwnProperty(this.title))return descriptions[this.title];break;case"function":var result=descriptions.call(this);if(result)return result}return null===this._excerpt&&(this._excerpt=Passage.getExcerptFromText(this.text)),this._excerpt}},{key:"processText",value:function(){if(null==this.element)return this.text;if(this.tags.includes("Twine.image"))return"[img[".concat(this.text,"]]");var processed=this.text;return Config.passages.onProcess&&(processed=Config.passages.onProcess.call(null,{title:this.title,tags:this.tags,text:processed})),(Config.passages.nobr||this.tags.includes("nobr"))&&(processed=processed.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),processed}},{key:"render",value:function(options){var frag=document.createDocumentFragment();return new Wikifier(frag,this.processText(),options),this._excerpt=Passage.getExcerptFromNode(frag),frag}}],[{key:"getExcerptFromNode",value:function(node,count){if(!node.hasChildNodes())return"";var excerpt=node.textContent.trim();if(""!==excerpt){var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})"));excerpt=excerpt.replace(/\s+/g," ").match(excerptRe)}return excerpt?"".concat(excerpt[1],"…"):"…"}},{key:"getExcerptFromText",value:function(text,count){if(""===text)return"";var excerptRe=new RegExp("(\\S+(?:\\s+\\S+){0,".concat(count>0?count-1:7,"})")),excerpt=text.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*?)(?:(?:\||->|<-)[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(excerptRe);return excerpt?"".concat(excerpt[1],"…"):"…"}}]),Passage}()),_tagsToSkip,Save=function(){var Type=Util.toEnum({Autosave:"autosave",Disk:"disk",Serialize:"serialize",Slot:"slot"}),_slotsUBound=-1,_onLoadHandlers=new Set,_onSaveHandlers=new Set;function savesObjGet(){var saves=storage.get("saves");return null===saves?{autosave:null,slots:_appendSlots([],Config.saves.slots)}:saves}function savesObjClear(){return storage.delete("saves"),!0}function autosaveOk(){return"cookie"!==storage.name&&void 0!==Config.saves.autosave}function slotsOk(){return"cookie"!==storage.name&&-1!==_slotsUBound}function slotsCount(){if(!slotsOk())return 0;for(var saves=savesObjGet(),count=0,i=0,iend=saves.slots.length;i<iend;++i)null!==saves.slots[i]&&++count;return count}function _appendSlots(array,num){for(var i=0;i<num;++i)array.push(null);return array}function _savesObjIsEmpty(saves){for(var slots=saves.slots,isSlotsEmpty=!0,i=0,iend=slots.length;i<iend;++i)if(null!==slots[i]){isSlotsEmpty=!1;break}return null===saves.autosave&&isSlotsEmpty}function _savesObjSave(saves){return _savesObjIsEmpty(saves)?(storage.delete("saves"),!0):storage.set("saves",saves)}function _savesObjUpdate(saveObj){if(null==saveObj||"object"!==_typeof(saveObj))return!1;var updated=!1;return saveObj.hasOwnProperty("state")&&saveObj.state.hasOwnProperty("delta")&&saveObj.state.hasOwnProperty("index")||(saveObj.hasOwnProperty("data")?(delete saveObj.mode,saveObj.state={delta:State.deltaEncode(saveObj.data)},delete saveObj.data):saveObj.state.hasOwnProperty("delta")?saveObj.state.hasOwnProperty("index")||delete saveObj.state.mode:(delete saveObj.state.mode,saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history),saveObj.state.index=saveObj.state.delta.length-1,updated=!0),saveObj.state.hasOwnProperty("rseed")&&(saveObj.state.seed=saveObj.state.rseed,delete saveObj.state.rseed,saveObj.state.delta.forEach((function(_,i,delta){delta[i].hasOwnProperty("rcount")&&(delta[i].pull=delta[i].rcount,delete delta[i].rcount)})),updated=!0),(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired||saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.hasOwnProperty("expired")&&"number"==typeof saveObj.state.expired&&delete saveObj.state.expired,(saveObj.state.hasOwnProperty("unique")||saveObj.state.hasOwnProperty("last"))&&(saveObj.state.expired=[],saveObj.state.hasOwnProperty("unique")&&(saveObj.state.expired.push(saveObj.state.unique),delete saveObj.state.unique),saveObj.state.hasOwnProperty("last")&&(saveObj.state.expired.push(saveObj.state.last),delete saveObj.state.last)),updated=!0),updated}function _marshal(supplemental,details){if(null!=supplemental&&"object"!==_typeof(supplemental))throw new Error("supplemental parameter must be an object");var saveObj=Object.assign({},supplemental,{id:Config.saves.id,state:State.marshalForSave()});return Config.saves.version&&(saveObj.version=Config.saves.version),_onSaveHandlers.forEach((function(fn){return fn(saveObj,details)})),saveObj.state.delta=State.deltaEncode(saveObj.state.history),delete saveObj.state.history,saveObj}function _unmarshal(saveObj){try{if(_savesObjUpdate(saveObj),!saveObj||!saveObj.hasOwnProperty("id")||!saveObj.hasOwnProperty("state"))throw new Error(L10n.get("errorSaveMissingData"));if(saveObj.state.history=State.deltaDecode(saveObj.state.delta),delete saveObj.state.delta,_onLoadHandlers.forEach((function(fn){return fn(saveObj)})),saveObj.id!==Config.saves.id)throw new Error(L10n.get("errorSaveIdMismatch"));State.unmarshalForSave(saveObj.state),Engine.show()}catch(ex){return UI.alert("".concat(ex.message.toUpperFirst(),".</p><p>").concat(L10n.get("aborting"),".")),!1}return!0}return Object.freeze(Object.defineProperties({},{init:{value:function(){if("cookie"===storage.name)return savesObjClear(),Config.saves.autoload=undefined,Config.saves.autosave=undefined,Config.saves.slots=0,!1;var saves=savesObjGet(),updated=!1;Array.isArray(saves)&&(saves={autosave:null,slots:saves},updated=!0),Config.saves.slots!==saves.slots.length&&(Config.saves.slots<saves.slots.length?(saves.slots.reverse(),saves.slots=saves.slots.filter((function(val){return!(null===val&&this.count>0)||(--this.count,!1)}),{count:saves.slots.length-Config.saves.slots}),saves.slots.reverse()):Config.saves.slots>saves.slots.length&&_appendSlots(saves.slots,Config.saves.slots-saves.slots.length),updated=!0),_savesObjUpdate(saves.autosave)&&(updated=!0);for(var i=0;i<saves.slots.length;++i)_savesObjUpdate(saves.slots[i])&&(updated=!0);return _savesObjIsEmpty(saves)&&(storage.delete("saves"),updated=!1),updated&&_savesObjSave(saves),_slotsUBound=saves.slots.length-1,!0}},get:{value:savesObjGet},clear:{value:savesObjClear},ok:{value:function(){return autosaveOk()||slotsOk()}},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:autosaveOk},has:{value:function(){return null!==savesObjGet().autosave}},get:{value:function(){return savesObjGet().autosave}},load:{value:function(){var saves=savesObjGet();return null!==saves.autosave&&_unmarshal(saves.autosave)}},save:{value:function(title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return!1;var saves=savesObjGet(),supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.autosave=_marshal(supplemental,{type:Type.Autosave}),_savesObjSave(saves)}},delete:{value:function(){var saves=savesObjGet();return saves.autosave=null,_savesObjSave(saves)}}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:slotsOk},length:{get:function(){return _slotsUBound+1}},isEmpty:{value:function(){return 0===slotsCount()}},count:{value:slotsCount},has:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])}},get:{value:function(slot){if(slot<0||slot>_slotsUBound)return null;var saves=savesObjGet();return slot>=saves.slots.length?null:saves.slots[slot]}},load:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length||null===saves.slots[slot])&&_unmarshal(saves.slots[slot])}},save:{value:function(slot,title,metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),!1;if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();if(slot>=saves.slots.length)return!1;var supplemental={title:title||Story.get(State.passage).description(),date:Date.now()};return null!=metadata&&(supplemental.metadata=metadata),saves.slots[slot]=_marshal(supplemental,{type:Type.Slot}),_savesObjSave(saves)}},delete:{value:function(slot){if(slot<0||slot>_slotsUBound)return!1;var saves=savesObjGet();return!(slot>=saves.slots.length)&&(saves.slots[slot]=null,_savesObjSave(saves))}}}))},export:{value:function(filename,metadata){if("function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed()){var str,now,MM,DD,hh,mm,ss,baseName=null==filename?Story.domId:(str=filename,Util.sanitizeFilename(str).replace(/[_\s\u2013\u2014-]+/g,"-")),saveName="".concat(baseName,"-").concat((now=new Date,MM=now.getMonth()+1,DD=now.getDate(),hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),MM<10&&(MM="0".concat(MM)),DD<10&&(DD="0".concat(DD)),hh<10&&(hh="0".concat(hh)),mm<10&&(mm="0".concat(mm)),ss<10&&(ss="0".concat(ss)),"".concat(now.getFullYear()).concat(MM).concat(DD,"-").concat(hh).concat(mm).concat(ss)),".save"),supplemental=null==metadata?{}:{metadata:metadata},saveObj=LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Disk})));saveAs(new Blob([saveObj],{type:"text/plain;charset=UTF-8"}),saveName)}else Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed"))}},import:{value:function(event){var file=event.target.files[0],reader=new FileReader;jQuery(reader).one("loadend",(function(){if(reader.error){var ex=reader.error;UI.alert("".concat(L10n.get("errorSaveDiskLoadFailed").toUpperFirst()," (").concat(ex.name,": ").concat(ex.message,").</p><p>").concat(L10n.get("aborting"),"."))}else{var saveObj;try{saveObj=JSON.parse(/\.json$/i.test(file.name)||/^\{/.test(reader.result)?reader.result:LZString.decompressFromBase64(reader.result))}catch(ex){}_unmarshal(saveObj)}})),reader.readAsText(file)}},serialize:{value:function(metadata){if("function"==typeof Config.saves.isAllowed&&!Config.saves.isAllowed())return Dialog.isOpen()?$(document).one(":dialogclosed",(function(){return UI.alert(L10n.get("savesDisallowed"))})):UI.alert(L10n.get("savesDisallowed")),null;var supplemental=null==metadata?{}:{metadata:metadata};return LZString.compressToBase64(JSON.stringify(_marshal(supplemental,{type:Type.Serialize})))}},deserialize:{value:function(base64Str){var saveObj;try{saveObj=JSON.parse(LZString.decompressFromBase64(base64Str))}catch(ex){}return _unmarshal(saveObj)?saveObj.metadata:null}},onLoad:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onLoad.add handler parameter must be a function (received: ".concat(valueType,")"));_onLoadHandlers.add(handler)}},clear:{value:function(){_onLoadHandlers.clear()}},delete:{value:function(handler){return _onLoadHandlers.delete(handler)}},size:{get:function(){return _onLoadHandlers.size}}}))},onSave:{value:Object.freeze(Object.defineProperties({},{add:{value:function(handler){var valueType=Util.getType(handler);if("function"!==valueType)throw new TypeError("Save.onSave.add handler parameter must be a function (received: ".concat(valueType,")"));_onSaveHandlers.add(handler)}},clear:{value:function(){_onSaveHandlers.clear()}},delete:{value:function(handler){return _onSaveHandlers.delete(handler)}},size:{get:function(){return _onSaveHandlers.size}}}))}}))}(),Setting=function(){var Types=Util.toEnum({Header:0,Toggle:1,List:2,Range:3}),_definitions=[];function settingsCreate(){return Object.create(null)}function settingsSave(){var savedSettings=settingsCreate();return Object.keys(settings).length>0&&_definitions.filter((function(def){return def.type!==Types.Header&&settings[def.name]!==def.default})).forEach((function(def){return savedSettings[def.name]=settings[def.name]})),0===Object.keys(savedSettings).length?(storage.delete("settings"),!0):storage.set("settings",savedSettings)}function settingsLoad(){var defaultSettings=settingsCreate(),loadedSettings=storage.get("settings")||settingsCreate();_definitions.filter((function(def){return def.type!==Types.Header})).forEach((function(def){return defaultSettings[def.name]=def.default})),window.SugarCube.settings=settings=Object.assign(defaultSettings,loadedSettings)}function settingsClear(){return window.SugarCube.settings=settings=settingsCreate(),storage.delete("settings"),!0}function definitionsAdd(type,name,def){if(arguments.length<3){var errors=[];throw arguments.length<1&&errors.push("type"),arguments.length<2&&errors.push("name"),arguments.length<3&&errors.push("definition"),new Error("missing parameters, no ".concat(errors.join(" or ")," specified"))}if("object"!==_typeof(def))throw new TypeError("definition parameter must be an object");if(definitionsHas(name))throw new Error('cannot clobber existing setting "'.concat(name,'"'));var str,pos,definition={type:type,name:name,label:"string"==typeof def.label?def.label.trim():""};if("string"==typeof def.desc){var desc=def.desc.trim();""!==desc&&(definition.desc=desc)}switch(type){case Types.Header:break;case Types.Toggle:definition.default=!!def.default;break;case Types.List:if(!def.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(def.list))throw new TypeError("list must be an array");if(0===def.list.length)throw new Error("list must not be empty");if(definition.list=Object.freeze(def.list),null==def.default)definition.default=def.list[0];else{var defaultIndex=def.list.indexOf(def.default);if(-1===defaultIndex)throw new Error("list does not contain default");definition.default=def.list[defaultIndex]}break;case Types.Range:if(!def.hasOwnProperty("min"))throw new Error("no min specified");if("number"!=typeof def.min||Number.isNaN(def.min)||!Number.isFinite(def.min))throw new TypeError("min must be a finite number");if(!def.hasOwnProperty("max"))throw new Error("no max specified");if("number"!=typeof def.max||Number.isNaN(def.max)||!Number.isFinite(def.max))throw new TypeError("max must be a finite number");if(!def.hasOwnProperty("step"))throw new Error("no step specified");if("number"!=typeof def.step||Number.isNaN(def.step)||!Number.isFinite(def.step)||def.step<=0)throw new TypeError("step must be a finite number greater than zero");var stepValidate=function(value){if(fracDigits>0){var ma=Number("".concat(def.min,"e").concat(fracDigits)),sa=Number("".concat(def.step,"e").concat(fracDigits)),_va=Number("".concat(value,"e").concat(fracDigits))-ma;return Number("".concat(_va-_va%sa+ma,"e-").concat(fracDigits))}var va=value-def.min;return va-va%def.step+def.min},fracDigits=(str=String(def.step),-1===(pos=str.lastIndexOf("."))?0:str.length-pos-1);if(stepValidate(def.max)!==def.max)throw new RangeError("max (".concat(def.max,") is not a multiple of the step (").concat(def.step,") plus the min (").concat(def.min,")"));if(definition.max=def.max,definition.min=def.min,definition.step=def.step,null==def.default)definition.default=def.max;else{if("number"!=typeof def.default||Number.isNaN(def.default)||!Number.isFinite(def.default))throw new TypeError("default must be a finite number");if(def.default<def.min)throw new RangeError("default (".concat(def.default,") is less than min (").concat(def.min,")"));if(def.default>def.max)throw new RangeError("default (".concat(def.default,") is greater than max (").concat(def.max,")"));definition.default=def.default}break;default:throw new Error("unknown Setting type: ".concat(type))}"function"==typeof def.onInit&&(definition.onInit=Object.freeze(def.onInit)),"function"==typeof def.onChange&&(definition.onChange=Object.freeze(def.onChange)),_definitions.push(Object.freeze(definition))}function definitionsHas(name){return _definitions.some((function(definition){return definition.name===name}))}function definitionsGet(name){return _definitions.find((function(definition){return definition.name===name}))}return Object.freeze(Object.defineProperties({},{Types:{value:Types},init:{value:function(){if(storage.has("options")){var old=storage.get("options");null!==old&&(window.SugarCube.settings=settings=Object.assign(settingsCreate(),old)),settingsSave(),storage.delete("options")}settingsLoad(),_definitions.forEach((function(def){if(def.hasOwnProperty("onInit")){var thisArg={name:def.name,value:settings[def.name],default:def.default};def.hasOwnProperty("list")&&(thisArg.list=def.list),def.onInit.call(thisArg)}}))}},create:{value:settingsCreate},save:{value:settingsSave},load:{value:settingsLoad},clear:{value:settingsClear},reset:{value:function(name){if(0===arguments.length)settingsClear(),settingsLoad();else{if(null==name||!definitionsHas(name))throw new Error('nonexistent setting "'.concat(name,'"'));var def=definitionsGet(name);def.type!==Types.Header&&(settings[name]=def.default)}return settingsSave()}},forEach:{value:function(callback,thisArg){_definitions.forEach(callback,thisArg)}},add:{value:definitionsAdd},addHeader:{value:function(name,desc){definitionsAdd(Types.Header,name,{desc:desc})}},addToggle:{value:function(){for(var _len16=arguments.length,args=new Array(_len16),_key16=0;_key16<_len16;_key16++)args[_key16]=arguments[_key16];definitionsAdd.apply(void 0,[Types.Toggle].concat(args))}},addList:{value:function(){for(var _len17=arguments.length,args=new Array(_len17),_key17=0;_key17<_len17;_key17++)args[_key17]=arguments[_key17];definitionsAdd.apply(void 0,[Types.List].concat(args))}},addRange:{value:function(){for(var _len18=arguments.length,args=new Array(_len18),_key18=0;_key18<_len18;_key18++)args[_key18]=arguments[_key18];definitionsAdd.apply(void 0,[Types.Range].concat(args))}},isEmpty:{value:function(){return 0===_definitions.length}},has:{value:definitionsHas},get:{value:definitionsGet},delete:{value:function definitionsDelete(name){definitionsHas(name)&&delete settings[name];for(var i=0;i<_definitions.length;++i)if(_definitions[i].name===name){_definitions.splice(i,1),definitionsDelete(name);break}}}}))}(),Story=function(){var _passages={},_inits=[],_scripts=[],_styles=[],_widgets=[],_title="",_ifId="",_domId="";function _storySetTitle(rawTitle){if(null==rawTitle)throw new Error("story title must not be null or undefined");var title=Util.unescape(String(rawTitle)).trim();if(""===title)throw new Error("story title must not be empty or consist solely of whitespace");if(document.title=_title=title,""===(_domId=Util.slugify(_title)))if(""!==_ifId)_domId=_ifId;else for(var i=0,len=_title.length;i<len;++i){var _Util$charAndPosAt2=Util.charAndPosAt(_title,i),char=_Util$charAndPosAt2.char,start=_Util$charAndPosAt2.start,end=_Util$charAndPosAt2.end;_domId+=char.codePointAt(0).toString(16),i+=end-start}}return Object.freeze(Object.defineProperties({},{load:{value:function(){var validationCodeTags=["init","widget"],validationNoCodeTagPassages=["PassageDone","PassageFooter","PassageHeader","PassageReady","StoryAuthor","StoryBanner","StoryCaption","StoryInit","StoryMenu","StoryShare","StorySubtitle"];function validateStartingPassage(passage){if(passage.tags.includesAny(validationCodeTags))throw new Error('starting passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(passage.tags.filter((function(tag){return validationCodeTags.includes(tag)})).sort().join('", "'),'"'))}function validateSpecialPassages(passage){if(validationNoCodeTagPassages.includes(passage.title)){for(var _len19=arguments.length,tags=new Array(_len19>1?_len19-1:0),_key19=1;_key19<_len19;_key19++)tags[_key19-1]=arguments[_key19];throw new Error('special passage "'.concat(passage.title,'" contains special tags; invalid: "').concat(tags.sort().join('", "'),'"'))}var codeTags=[].concat(validationCodeTags),foundTags=[];if(passage.tags.forEach((function(tag){codeTags.includes(tag)&&foundTags.push.apply(foundTags,_toConsumableArray(codeTags.delete(tag)))})),foundTags.length>1)throw new Error('passage "'.concat(passage.title,'" contains multiple special tags; invalid: "').concat(foundTags.sort().join('", "'),'"'))}var $storydata=jQuery("tw-storydata"),startNode=$storydata.attr("startnode")||"";Config.passages.start=null,Config.debug=/\bdebug\b/.test($storydata.attr("options")),$storydata.children("style").each((function(i){_styles.push(new Passage("tw-user-style-".concat(i),this))})),$storydata.children("script").each((function(i){_scripts.push(new Passage("tw-user-script-".concat(i),this))})),$storydata.children('tw-passagedata:not([tags~="Twine.private"],[tags~="annotation"])').each((function(){var $this=jQuery(this),pid=$this.attr("pid")||"",passage=new Passage($this.attr("name"),this);pid===startNode&&""!==startNode?(Config.passages.start=passage.title,validateStartingPassage(passage),_passages[passage.title]=passage):passage.tags.includes("init")?(validateSpecialPassages(passage,"init"),_inits.push(passage)):passage.tags.includes("widget")?(validateSpecialPassages(passage,"widget"),_widgets.push(passage)):_passages[passage.title]=passage})),_ifId=$storydata.attr("ifid"),_storySetTitle("Abyss Diver"),Config.saves.id=Story.domId}},init:{value:function(){var storyStyle;storyStyle=document.createElement("style"),new StyleWrapper(storyStyle).add(_styles.map((function(style){return style.text.trim()})).join("\n")),jQuery(storyStyle).appendTo(document.head).attr({id:"style-story",type:"text/css"});for(var i=0;i<_scripts.length;++i)try{Scripting.evalJavaScript(_scripts[i].text)}catch(ex){console.error(ex),Alert.error(_scripts[i].title,"object"===_typeof(ex)?ex.message:ex)}for(var _i8=0;_i8<_widgets.length;++_i8)try{Wikifier.wikifyEval(_widgets[_i8].processText())}catch(ex){console.error(ex),Alert.error(_widgets[_i8].title,"object"===_typeof(ex)?ex.message:ex)}}},title:{get:function(){return _title}},domId:{get:function(){return _domId}},ifId:{get:function(){return _ifId}},add:{value:function(passage){if(!(passage instanceof Passage))throw new TypeError("Story.add passage parameter must be an instance of Passage");var title=passage.title;return!_passages.hasOwnProperty(title)&&(_passages[title]=passage,!0)}},has:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":return _passages.hasOwnProperty(String(title));case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.has title parameter cannot be ".concat(type))}},get:{value:function(title){var type=_typeof(title);switch(type){case"number":case"string":var id=String(title);return _passages.hasOwnProperty(id)?_passages[id]:new Passage(id||"(unknown)");case"undefined":break;case"object":type=null===title?"null":"an object";break;default:type="a ".concat(type)}throw new TypeError("Story.get title parameter cannot be ".concat(type))}},getAllInit:{value:function(){return Object.freeze(Array.from(_inits))}},getAllRegular:{value:function(){return Object.freeze(Object.assign({},_passages))}},getAllScript:{value:function(){return Object.freeze(Array.from(_scripts))}},getAllStylesheet:{value:function(){return Object.freeze(Array.from(_styles))}},getAllWidget:{value:function(){return Object.freeze(Array.from(_widgets))}},lookup:{value:function(key,value){var sortKey=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"title",results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];"object"===_typeof(passage[key])&&null!==passage[key]?passage[key]instanceof Array&&passage[key].some((function(m){return Util.sameValueZero(m,value)}))&&results.push(passage):Util.sameValueZero(passage[key],value)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}},lookupWith:{value:function(predicate){var sortKey=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"title";if("function"!=typeof predicate)throw new TypeError("Story.lookupWith predicate parameter must be a function");var results=[];return Object.keys(_passages).forEach((function(name){var passage=_passages[name];predicate(passage)&&results.push(passage)})),results.sort((function(a,b){return a[sortKey]==b[sortKey]?0:a[sortKey]<b[sortKey]?-1:1})),results}}}))}(),UI=function(){function uiAssembleLinkList(passage,listEl){var list=listEl,debugState=Config.debug,cleanState=Config.cleanupWikifierOutput;Config.debug=!1,Config.cleanupWikifierOutput=!1;try{null==list&&(list=document.createElement("ul"));var frag=document.createDocumentFragment();new Wikifier(frag,Story.get(passage).processText().trim());var errors=_toConsumableArray(frag.querySelectorAll(".error")).map((function(errEl){return errEl.textContent.replace(errorPrologRegExp,"")}));if(errors.length>0)throw new Error(errors.join("; "));for(;frag.hasChildNodes();){var node=frag.firstChild;if(node.nodeType===Node.ELEMENT_NODE&&"A"===node.nodeName.toUpperCase()){var li=document.createElement("li");list.appendChild(li),li.appendChild(node)}else frag.removeChild(node)}}finally{Config.cleanupWikifierOutput=cleanState,Config.debug=debugState}return list}function uiOpenAlert(message){jQuery(Dialog.setup(L10n.get("alertTitle"),"alert")).append("<p>".concat(message,'</p><ul class="buttons">')+'<li><button id="alert-ok" class="ui-close">'.concat(L10n.get(["alertOk","ok"]),"</button></li>")+"</ul>");for(var _len20=arguments.length,args=new Array(_len20>1?_len20-1:0),_key20=1;_key20<_len20;_key20++)args[_key20-1]=arguments[_key20];Dialog.open.apply(Dialog,args)}function uiBuildAutoload(){return jQuery(Dialog.setup(L10n.get("autoloadTitle"),"autoload")).append("<p>".concat(L10n.get("autoloadPrompt"),'</p><ul class="buttons">')+'<li><button id="autoload-ok" class="ui-close">'.concat(L10n.get(["autoloadOk","ok"]),"</button></li>")+'<li><button id="autoload-cancel" class="ui-close">'.concat(L10n.get(["autoloadCancel","cancel"]),"</button></li>")+"</ul>"),jQuery(document).one("click.autoload",".ui-close",(function(ev){var isAutoloadOk="autoload-ok"===ev.target.id;jQuery(document).one(":dialogclosed",(function(){isAutoloadOk&&Save.autosave.load()||Engine.play(Config.passages.start)}))})),!0}function uiBuildJumpto(){var list=document.createElement("ul");jQuery(Dialog.setup(L10n.get("jumptoTitle"),"jumpto list")).append(list);for(var expired=State.expired.length,i=State.size-1;i>=0;--i)if(i!==State.activeIndex){var passage=Story.get(State.history[i].title);passage&&passage.tags.includes("bookmark")&&jQuery(document.createElement("li")).append(jQuery(document.createElement("a")).ariaClick({one:!0},function(idx){return function(){return jQuery(document).one(":dialogclosed",(function(){return Engine.goTo(idx)}))}}(i)).addClass("ui-close").text("".concat(L10n.get("jumptoTurn")," ").concat(expired+i+1,": ").concat(passage.description()))).appendTo(list)}list.hasChildNodes()||jQuery(list).append("<li><a><em>".concat(L10n.get("jumptoUnavailable"),"</em></a></li>"))}function uiBuildRestart(){return jQuery(Dialog.setup(L10n.get("restartTitle"),"restart")).append("<p>".concat(L10n.get("restartPrompt"),'</p><ul class="buttons">')+'<li><button id="restart-ok">'.concat(L10n.get(["restartOk","ok"]),"</button></li>")+'<li><button id="restart-cancel" class="ui-close">'.concat(L10n.get(["restartCancel","cancel"]),"</button></li>")+"</ul>").find("#restart-ok").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){return Engine.restart()})),Dialog.close()})),!0}function uiBuildSaves(){var savesAllowed="function"!=typeof Config.saves.isAllowed||Config.saves.isAllowed();function createActionItem(bId,bClass,bText,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId)).html(bText);return bClass&&$btn.addClass(bClass),bAction?$btn.ariaClick(bAction):$btn.ariaDisabled(!0),jQuery(document.createElement("li")).append($btn)}var $dialogBody=jQuery(Dialog.setup(L10n.get("savesTitle"),"saves")),savesOk=Save.ok(),fileOk=Has.fileAPI&&(Config.saves.tryDiskOnMobile||!Browser.isMobile.any());if(savesOk&&$dialogBody.append(function(){function createButton(bId,bClass,bText,bSlot,bAction){var $btn=jQuery(document.createElement("button")).attr("id","saves-".concat(bId,"-").concat(bSlot)).addClass(bId).html(bText);return bClass&&$btn.addClass(bClass),bAction?"auto"===bSlot?$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelAuto"))},(function(){return bAction()})):$btn.ariaClick({label:"".concat(bText," ").concat(L10n.get("savesLabelSlot")," ").concat(bSlot+1)},(function(){return bAction(bSlot)})):$btn.ariaDisabled(!0),$btn}var saves=Save.get(),$tbody=jQuery(document.createElement("tbody"));if(Save.autosave.ok()){var $tdSlot=jQuery(document.createElement("td")),$tdLoad=jQuery(document.createElement("td")),$tdDesc=jQuery(document.createElement("td")),$tdDele=jQuery(document.createElement("td"));jQuery(document.createElement("b")).attr({title:L10n.get("savesLabelAuto"),"aria-label":L10n.get("savesLabelAuto")}).text("A").appendTo($tdSlot),saves.autosave?($tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),"auto",(function(){jQuery(document).one(":dialogclosed",(function(){return Save.autosave.load()}))}))),jQuery(document.createElement("div")).text(saves.autosave.title).appendTo($tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.autosave.date?"".concat(new Date(saves.autosave.date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo($tdDesc),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto",(function(){Save.autosave.delete(),uiBuildSaves()})))):($tdLoad.append(createButton("load",null,L10n.get("savesLabelLoad"),"auto")),$tdDesc.addClass("empty").text("•  •  •"),$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),"auto"))),jQuery(document.createElement("tr")).append($tdSlot).append($tdLoad).append($tdDesc).append($tdDele).appendTo($tbody)}for(var i=0,iend=saves.slots.length;i<iend;++i){var _$tdSlot=jQuery(document.createElement("td")),_$tdLoad=jQuery(document.createElement("td")),_$tdDesc=jQuery(document.createElement("td")),_$tdDele=jQuery(document.createElement("td"));_$tdSlot.append(document.createTextNode(i+1)),saves.slots[i]?(_$tdLoad.append(createButton("load","ui-close",L10n.get("savesLabelLoad"),i,(function(slot){jQuery(document).one(":dialogclosed",(function(){return Save.slots.load(slot)}))}))),jQuery(document.createElement("div")).text(saves.slots[i].title).appendTo(_$tdDesc),jQuery(document.createElement("div")).addClass("datestamp").html(saves.slots[i].date?"".concat(new Date(saves.slots[i].date).toLocaleString()):"<em>".concat(L10n.get("savesUnknownDate"),"</em>")).appendTo(_$tdDesc),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i,(function(slot){Save.slots.delete(slot),uiBuildSaves()})))):(_$tdLoad.append(createButton("save","ui-close",L10n.get("savesLabelSave"),i,savesAllowed?Save.slots.save:null)),_$tdDesc.addClass("empty").text("•  •  •"),_$tdDele.append(createButton("delete",null,L10n.get("savesLabelDelete"),i))),jQuery(document.createElement("tr")).append(_$tdSlot).append(_$tdLoad).append(_$tdDesc).append(_$tdDele).appendTo($tbody)}return jQuery(document.createElement("table")).attr("id","saves-list").append($tbody)}()),savesOk||fileOk){var $btnBar=jQuery(document.createElement("ul")).addClass("buttons").appendTo($dialogBody);return fileOk&&($btnBar.append(createActionItem("export","ui-close",L10n.get("savesLabelExport"),savesAllowed?function(){return Save.export()}:null)),$btnBar.append(createActionItem("import",null,L10n.get("savesLabelImport"),(function(){return $dialogBody.find("#saves-import-file").trigger("click")}))),jQuery(document.createElement("input")).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr({type:"file",id:"saves-import-file",tabindex:-1,"aria-hidden":!0}).on("change",(function(ev){jQuery(document).one(":dialogclosed",(function(){return Save.import(ev)})),Dialog.close()})).appendTo($dialogBody)),savesOk&&$btnBar.append(createActionItem("clear",null,L10n.get("savesLabelClear"),Save.autosave.has()||!Save.slots.isEmpty()?function(){Save.clear(),uiBuildSaves()}:null)),!0}return uiOpenAlert(L10n.get("savesIncapable")),!1}function uiBuildSettings(){var $dialogBody=jQuery(Dialog.setup(L10n.get("settingsTitle"),"settings"));return Setting.forEach((function(control){if(control.type===Setting.Types.Header){var _name=control.name,_id=Util.slugify(_name),$header=jQuery(document.createElement("div")),$heading=jQuery(document.createElement("h2"));return $header.attr("id","header-body-".concat(_id)).append($heading).appendTo($dialogBody),$heading.attr("id","header-heading-".concat(_id)).wiki(_name),void(control.desc&&jQuery(document.createElement("p")).attr("id","header-desc-".concat(_id)).wiki(control.desc).appendTo($header))}var $control,name=control.name,id=Util.slugify(name),$setting=jQuery(document.createElement("div")),$label=jQuery(document.createElement("label")),$controlBox=jQuery(document.createElement("div"));switch(jQuery(document.createElement("div")).append($label).append($controlBox).appendTo($setting),control.desc&&jQuery(document.createElement("p")).attr("id","setting-desc-".concat(id)).wiki(control.desc).appendTo($setting),$label.attr({id:"setting-label-".concat(id),for:"setting-control-".concat(id)}).wiki(control.label),null==settings[name]&&(settings[name]=control.default),control.type){case Setting.Types.Toggle:$control=jQuery(document.createElement("button")),settings[name]?$control.addClass("enabled").text(L10n.get("settingsOn")):$control.text(L10n.get("settingsOff")),$control.ariaClick((function(){settings[name]?(jQuery(this).removeClass("enabled").text(L10n.get("settingsOff")),settings[name]=!1):(jQuery(this).addClass("enabled").text(L10n.get("settingsOn")),settings[name]=!0),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default})}));break;case Setting.Types.List:$control=jQuery(document.createElement("select"));for(var i=0,iend=control.list.length;i<iend;++i)jQuery(document.createElement("option")).val(i).text(control.list[i]).appendTo($control);$control.val(control.list.indexOf(settings[name])).attr("tabindex",0).on("change",(function(){settings[name]=control.list[Number(this.value)],Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,list:control.list})}));break;case Setting.Types.Range:($control=jQuery(document.createElement("input"))).attr({type:"range",min:control.min,max:control.max,step:control.step,value:settings[name],tabindex:0}).on("change input",(function(){settings[name]=Number(this.value),Setting.save(),control.hasOwnProperty("onChange")&&control.onChange.call({name:name,value:settings[name],default:control.default,min:control.min,max:control.max,step:control.step})})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$control.trigger("change"))}))}$control.attr("id","setting-control-".concat(id)).appendTo($controlBox),$setting.attr("id","setting-body-".concat(id)).appendTo($dialogBody)})),$dialogBody.append('<ul class="buttons">'+'<li><button id="settings-ok" class="ui-close">'.concat(L10n.get(["settingsOk","ok"]),"</button></li>")+'<li><button id="settings-reset">'.concat(L10n.get("settingsReset"),"</button></li>")+"</ul>").find("#settings-reset").ariaClick({one:!0},(function(){jQuery(document).one(":dialogclosed",(function(){Setting.reset(),window.location.reload()})),Dialog.close()})),!0}function uiBuildShare(){try{jQuery(Dialog.setup(L10n.get("shareTitle"),"share list")).append(uiAssembleLinkList("StoryShare"))}catch(ex){return console.error(ex),Alert.error("StoryShare",ex.message),!1}return!0}return Object.freeze(Object.defineProperties({},{assembleLinkList:{value:uiAssembleLinkList},alert:{value:uiOpenAlert},jumpto:{value:function(){uiBuildJumpto(),Dialog.open.apply(Dialog,arguments)}},restart:{value:function(){uiBuildRestart(),Dialog.open.apply(Dialog,arguments)}},saves:{value:function(){uiBuildSaves(),Dialog.open.apply(Dialog,arguments)}},settings:{value:function(){uiBuildSettings(),Dialog.open.apply(Dialog,arguments)}},share:{value:function(){uiBuildShare(),Dialog.open.apply(Dialog,arguments)}},buildAutoload:{value:uiBuildAutoload},buildJumpto:{value:uiBuildJumpto},buildRestart:{value:uiBuildRestart},buildSaves:{value:uiBuildSaves},buildSettings:{value:uiBuildSettings},buildShare:{value:uiBuildShare},stow:{value:function(){return UIBar.stow()}},unstow:{value:function(){return UIBar.unstow()}},setStoryElements:{value:function(){return UIBar.update()}},isOpen:{value:function(){return Dialog.isOpen.apply(Dialog,arguments)}},body:{value:function(){return Dialog.body()}},setup:{value:function(){return Dialog.setup.apply(Dialog,arguments)}},addClickHandler:{value:function(){return Dialog.addClickHandler.apply(Dialog,arguments)}},open:{value:function(){return Dialog.open.apply(Dialog,arguments)}},close:{value:function(){return Dialog.close.apply(Dialog,arguments)}},resize:{value:function(){return Dialog.resize()}},buildDialogAutoload:{value:uiBuildAutoload},buildDialogJumpto:{value:uiBuildJumpto},buildDialogRestart:{value:uiBuildRestart},buildDialogSaves:{value:uiBuildSaves},buildDialogSettings:{value:uiBuildSettings},buildDialogShare:{value:uiBuildShare},buildLinkListFromPassage:{value:uiAssembleLinkList}}))}(),UIBar=function(){var _$uiBar=null;function uiBarStow(noAnimation){var $story;_$uiBar&&!_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.addClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay));return this}function uiBarUpdate(){if(Story.has("StoryDisplayTitle")&&setDisplayTitle(Story.get("StoryDisplayTitle").processText()),_$uiBar){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var menuStory=document.getElementById("menu-story");if(null!==menuStory&&(jQuery(menuStory).empty(),Story.has("StoryMenu")))try{UI.assembleLinkList("StoryMenu",menuStory)}catch(ex){console.error(ex),Alert.error("StoryMenu",ex.message)}}}return Object.freeze(Object.defineProperties({},{destroy:{value:function(){_$uiBar&&(_$uiBar.hide(),jQuery(document).off(".ui-bar"),jQuery(document.head).find("#style-ui-bar").remove(),_$uiBar.remove(),_$uiBar=null)}},hide:{value:function(){return _$uiBar&&_$uiBar.hide(),this}},init:{value:function(){if(!document.getElementById("ui-bar")){var toggleLabel,backwardLabel,jumptoLabel,forwardLabel,$backward,$forward,$elems=(toggleLabel=L10n.get("uiBarToggle"),backwardLabel=L10n.get("uiBarBackward"),jumptoLabel=L10n.get("uiBarJumpto"),forwardLabel=L10n.get("uiBarForward"),jQuery(document.createDocumentFragment()).append('<div id="ui-bar" aria-live="polite"><div id="ui-bar-tray">'+'<button id="ui-bar-toggle" tabindex="0" title="'.concat(toggleLabel,'" aria-label="').concat(toggleLabel,'"></button>')+'<div id="ui-bar-history">'+'<button id="history-backward" tabindex="0" title="'.concat(backwardLabel,'" aria-label="').concat(backwardLabel,'"></button>')+'<button id="history-jumpto" tabindex="0" title="'.concat(jumptoLabel,'" aria-label="').concat(jumptoLabel,'"></button>')+'<button id="history-forward" tabindex="0" title="'.concat(forwardLabel,'" aria-label="').concat(forwardLabel,'"></button>')+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core">'+'<li id="menu-item-saves"><a tabindex="0">'.concat(L10n.get("savesTitle"),"</a></li>")+'<li id="menu-item-settings"><a tabindex="0">'.concat(L10n.get("settingsTitle"),"</a></li>")+'<li id="menu-item-restart"><a tabindex="0">'.concat(L10n.get("restartTitle"),"</a></li>")+'<li id="menu-item-share"><a tabindex="0">'.concat(L10n.get("shareTitle"),"</a></li>")+"</ul></nav></div></div>"));_$uiBar=jQuery($elems.find("#ui-bar").get(0)),$elems.insertBefore("body>script#script-sugarcube"),jQuery(document).on(":historyupdate.ui-bar",($backward=jQuery("#history-backward"),$forward=jQuery("#history-forward"),function(){$backward.ariaDisabled(State.length<2),$forward.ariaDisabled(State.length===State.size)}))}}},isHidden:{value:function(){return _$uiBar&&"none"===_$uiBar.css("display")}},isStowed:{value:function(){return _$uiBar&&_$uiBar.hasClass("stowed")}},show:{value:function(){return _$uiBar&&_$uiBar.show(),this}},start:{value:function(){_$uiBar&&(("boolean"==typeof Config.ui.stowBarInitially?Config.ui.stowBarInitially:jQuery(window).width()<=Config.ui.stowBarInitially)&&uiBarStow(!0),jQuery("#ui-bar-toggle").ariaClick({label:L10n.get("uiBarToggle")},(function(){return _$uiBar.toggleClass("stowed")})),Config.history.controls?(jQuery("#history-backward").ariaDisabled(State.length<2).ariaClick({label:L10n.get("uiBarBackward")},(function(){return Engine.backward()})),Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:L10n.get("uiBarJumpto")},(function(){return UI.jumpto()})):jQuery("#history-jumpto").remove(),jQuery("#history-forward").ariaDisabled(State.length===State.size).ariaClick({label:L10n.get("uiBarForward")},(function(){return Engine.forward()}))):jQuery("#ui-bar-history").remove(),Story.has("StoryDisplayTitle")?setDisplayTitle(Story.get("StoryDisplayTitle").processText()):jQuery("#story-title").text(Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),Config.ui.updateStoryElements||uiBarUpdate(),jQuery("#menu-item-saves a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSaves(),Dialog.open()})).text(L10n.get("savesTitle")),Setting.isEmpty()?jQuery("#menu-item-settings").remove():jQuery("#menu-item-settings a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildSettings(),Dialog.open()})).text(L10n.get("settingsTitle")),jQuery("#menu-item-restart a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildRestart(),Dialog.open()})).text(L10n.get("restartTitle")),Story.has("StoryShare")?jQuery("#menu-item-share a").ariaClick({role:"button"},(function(ev){ev.preventDefault(),UI.buildShare(),Dialog.open()})).text(L10n.get("shareTitle")):jQuery("#menu-item-share").remove())}},stow:{value:uiBarStow},unstow:{value:function(noAnimation){var $story;return _$uiBar&&_$uiBar.hasClass("stowed")&&(noAnimation&&(($story=jQuery("#story")).addClass("no-transition"),_$uiBar.addClass("no-transition")),_$uiBar.removeClass("stowed"),noAnimation&&setTimeout((function(){$story.removeClass("no-transition"),_$uiBar.removeClass("no-transition")}),Engine.minDomActionDelay)),this}},update:{value:uiBarUpdate},setStoryElements:{value:uiBarUpdate}}))}(),DebugBar=function(){var _variableRe=new RegExp("^".concat(Patterns.variable,"$")),_numericKeyRe=/^\d+$/,_watchList=[],_$debugBar=null,_$watchBody=null,_$watchList=null,_$turnSelect=null,_stowed=!0;function debugBarStow(){_$debugBar.css("right","-".concat(_$debugBar.outerWidth(),"px")),_stowed=!0,_updateSession()}function debugBarUnstow(){_$debugBar.css("right",0),_stowed=!1,_updateSession()}function debugBarToggle(){_stowed?debugBarUnstow():debugBarStow()}function debugBarWatchAdd(varName){_variableRe.test(varName)&&(_watchList.pushUnique(varName),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession())}function debugBarWatchAddAll(){Object.keys(State.variables).map((function(name){return _watchList.pushUnique("$".concat(name))})),Object.keys(State.temporary).map((function(name){return _watchList.pushUnique("_".concat(name))})),_watchList.sort(),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchClear(){for(var i=_watchList.length-1;i>=0;--i)_watchList.pop();_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDelete(varName){_watchList.delete(varName),_updateWatchBody(),_updateWatchList(),_updateSession()}function debugBarWatchDisable(){_debugBarWatchDisableNoUpdate(),_updateSession()}function debugBarWatchEnable(){_debugBarWatchEnableNoUpdate(),_updateSession()}function debugBarWatchIsEnabled(){return!_$watchBody.attr("hidden")}function debugBarWatchToggle(){_$watchBody.attr("hidden")?debugBarWatchEnable():debugBarWatchDisable()}function _debugBarWatchDisableNoUpdate(){_$watchBody.attr({"aria-hidden":!0,hidden:"hidden"})}function _debugBarWatchEnableNoUpdate(){_$watchBody.removeAttr("aria-hidden hidden")}function _clearSession(){session.delete("debugState")}function _hasSession(){return session.has("debugState")}function _updateSession(){session.set("debugState",{stowed:_stowed,watchList:_watchList,watchEnabled:debugBarWatchIsEnabled(),viewsEnabled:DebugView.isEnabled()})}function _updateWatchBody(){if(0!==_watchList.length){for(var delLabel=L10n.get("debugBarDeleteWatch"),$table=jQuery(document.createElement("table")),$tbody=jQuery(document.createElement("tbody")),_loop4=function(i,len){var varName=_watchList[i],varKey=varName.slice(1),store="$"===varName[0]?State.variables:State.temporary,$row=jQuery(document.createElement("tr")),$delBtn=jQuery(document.createElement("button")),$code=jQuery(document.createElement("code"));$delBtn.addClass("watch-delete").attr("data-name",varName).ariaClick({one:!0,label:delLabel},(function(){return debugBarWatchDelete(varName)})),$code.text(_toWatchString(store[varKey])),jQuery(document.createElement("td")).append($delBtn).appendTo($row),jQuery(document.createElement("td")).text(varName).appendTo($row),jQuery(document.createElement("td")).append($code).appendTo($row),$row.appendTo($tbody)},i=0,len=_watchList.length;i<len;++i)_loop4(i);$table.append($tbody),_$watchBody.empty().append($table)}else _$watchBody.empty().append("<div>".concat(L10n.get("debugBarNoWatches"),"</div>"))}function _updateWatchList(){var svn=Object.keys(State.variables),tvn=Object.keys(State.temporary);if(0!==svn.length||0!==tvn.length){var names=[].concat(_toConsumableArray(svn.map((function(name){return"$".concat(name)}))),_toConsumableArray(tvn.map((function(name){return"_".concat(name)})))).sort(),options=document.createDocumentFragment();names.delete(_watchList);for(var i=0,len=names.length;i<len;++i)jQuery(document.createElement("option")).val(names[i]).appendTo(options);_$watchList.empty().append(options)}else _$watchList.empty()}function _updateTurnSelect(){for(var histLen=State.size,expLen=State.expired.length,options=document.createDocumentFragment(),i=0;i<histLen;++i)jQuery(document.createElement("option")).val(i).text("".concat(expLen+i+1,". ").concat(Util.escape(State.history[i].title))).appendTo(options);_$turnSelect.empty().ariaDisabled(histLen<2).append(options).val(State.activeIndex)}function _toWatchString(value){if(null===value)return"null";switch(_typeof(value)){case"number":if(Number.isNaN(value))return"NaN";if(!Number.isFinite(value))return"Infinity";case"boolean":case"symbol":case"undefined":return String(value);case"string":return JSON.stringify(value);case"function":return"Function"}var objType=Util.toStringTag(value);if("Date"===objType)return"Date {".concat(value.toLocaleString(),"}");if("RegExp"===objType)return"RegExp ".concat(value.toString());var result=[];if(value instanceof Array||value instanceof Set){for(var list=value instanceof Array?value:Array.from(value),i=0,len=list.length;i<len;++i)result.push(list.hasOwnProperty(i)?_toWatchString(list[i]):"<empty>");return Object.keys(list).filter((function(key){return!_numericKeyRe.test(key)})).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(list[key])))})),"".concat(objType,"(").concat(list.length,") [").concat(result.join(", "),"]")}return value instanceof Map?(value.forEach((function(val,key){return result.push("".concat(_toWatchString(key)," → ").concat(_toWatchString(val)))})),"".concat(objType,"(").concat(value.size,") {").concat(result.join(", "),"}")):(Object.keys(value).forEach((function(key){return result.push("".concat(_toWatchString(key),": ").concat(_toWatchString(value[key])))})),"".concat(objType," {").concat(result.join(", "),"}"))}return Object.freeze(Object.defineProperties({},{init:{value:function(){var barToggleLabel=L10n.get("debugBarToggle"),watchAddLabel=L10n.get("debugBarAddWatch"),watchAllLabel=L10n.get("debugBarWatchAll"),watchNoneLabel=L10n.get("debugBarWatchNone"),watchToggleLabel=L10n.get("debugBarWatchToggle"),viewsToggleLabel=L10n.get("debugBarViewsToggle");jQuery(document.createDocumentFragment()).append('<div id="debug-bar"><div id="debug-bar-watch">'+"<div>".concat(L10n.get("debugBarNoWatches"),"</div>>")+"</div><div>"+'<button id="debug-bar-watch-toggle" tabindex="0" title="'.concat(watchToggleLabel,'" aria-label="').concat(watchToggleLabel,'">').concat(L10n.get("debugBarLabelWatch"),"</button>")+'<label id="debug-bar-watch-label" for="debug-bar-watch-input">'.concat(L10n.get("debugBarLabelAdd"),"</label>")+'<input id="debug-bar-watch-input" name="debug-bar-watch-input" type="text" list="debug-bar-watch-list" tabindex="0"><datalist id="debug-bar-watch-list" aria-hidden="true" hidden="hidden"></datalist>'+'<button id="debug-bar-watch-add" tabindex="0" title="'.concat(watchAddLabel,'" aria-label="').concat(watchAddLabel,'"></button>')+'<button id="debug-bar-watch-all" tabindex="0" title="'.concat(watchAllLabel,'" aria-label="').concat(watchAllLabel,'"></button>')+'<button id="debug-bar-watch-none" tabindex="0" title="'.concat(watchNoneLabel,'" aria-label="').concat(watchNoneLabel,'"></button>')+"</div><div>"+'<button id="debug-bar-views-toggle" tabindex="0" title="'.concat(viewsToggleLabel,'" aria-label="').concat(viewsToggleLabel,'">').concat(L10n.get("debugBarLabelViews"),"</button>")+'<label id="debug-bar-turn-label" for="debug-bar-turn-select">'.concat(L10n.get("debugBarLabelTurn"),"</label>")+'<select id="debug-bar-turn-select" tabindex="0"></select></div>'+'<button id="debug-bar-toggle" tabindex="0" title="'.concat(barToggleLabel,'" aria-label="').concat(barToggleLabel,'"></button>')+'</div><div id="debug-bar-hint"></div>').appendTo("body"),_$debugBar=jQuery("#debug-bar"),_$watchBody=jQuery(_$debugBar.find("#debug-bar-watch").get(0)),_$watchList=jQuery(_$debugBar.find("#debug-bar-watch-list").get(0)),_$turnSelect=jQuery(_$debugBar.find("#debug-bar-turn-select").get(0));var $barToggle=jQuery(_$debugBar.find("#debug-bar-toggle").get(0)),$watchToggle=jQuery(_$debugBar.find("#debug-bar-watch-toggle").get(0)),$watchInput=jQuery(_$debugBar.find("#debug-bar-watch-input").get(0)),$watchAdd=jQuery(_$debugBar.find("#debug-bar-watch-add").get(0)),$watchAll=jQuery(_$debugBar.find("#debug-bar-watch-all").get(0)),$watchNone=jQuery(_$debugBar.find("#debug-bar-watch-none").get(0)),$viewsToggle=jQuery(_$debugBar.find("#debug-bar-views-toggle").get(0));$barToggle.ariaClick(debugBarToggle),$watchToggle.ariaClick(debugBarWatchToggle),$watchInput.on(":addwatch",(function(){debugBarWatchAdd(this.value.trim()),this.value=""})).on("keypress",(function(ev){13===ev.which&&(ev.preventDefault(),$watchInput.trigger(":addwatch"))})),$watchAdd.ariaClick((function(){return $watchInput.trigger(":addwatch")})),$watchAll.ariaClick(debugBarWatchAddAll),$watchNone.ariaClick(debugBarWatchClear),_$turnSelect.on("change",(function(){Engine.goTo(Number(this.value))})),$viewsToggle.ariaClick((function(){DebugView.toggle(),_updateSession()})),jQuery(document).on(":historyupdate.debug-bar",_updateTurnSelect).on(":passageend.debug-bar",(function(){_updateWatchBody(),_updateWatchList()})).on(":enginerestart.debug-bar",_clearSession),_hasSession()||DebugView.enable()}},isStowed:{value:function(){return _stowed}},start:{value:function(){(function(){if(!_hasSession())return!1;var debugState=session.get("debugState");_stowed=debugState.stowed,_watchList.push.apply(_watchList,_toConsumableArray(debugState.watchList)),debugState.watchEnabled?_debugBarWatchEnableNoUpdate():_debugBarWatchDisableNoUpdate();debugState.viewsEnabled?DebugView.enable():DebugView.disable()})(),_stowed?debugBarStow():debugBarUnstow(),_updateTurnSelect(),_updateWatchBody(),_updateWatchList()}},stow:{value:debugBarStow},toggle:{value:debugBarToggle},unstow:{value:debugBarUnstow},watch:{value:Object.freeze(Object.defineProperties({},{add:{value:debugBarWatchAdd},all:{value:debugBarWatchAddAll},clear:{value:debugBarWatchClear},delete:{value:debugBarWatchDelete},disable:{value:debugBarWatchDisable},enable:{value:debugBarWatchEnable},isEnabled:{value:debugBarWatchIsEnabled},toggle:{value:debugBarWatchToggle}}))}}))}(),LoadScreen=function(){var _locks=new Set,_autoId=0;function loadScreenHide(){jQuery(document.documentElement).removeAttr("data-init")}function loadScreenShow(){jQuery(document.documentElement).attr("data-init","loading")}return Object.freeze(Object.defineProperties({},{init:{value:function(){jQuery(document).on("readystatechange.SugarCube",(function(){_locks.size>0||("complete"===document.readyState?"loading"===jQuery(document.documentElement).attr("data-init")&&(Config.loadDelay>0?setTimeout((function(){0===_locks.size&&loadScreenHide()}),Math.max(Engine.minDomActionDelay,Config.loadDelay)):loadScreenHide()):loadScreenShow())}))}},clear:{value:function(){jQuery(document).off("readystatechange.SugarCube"),_locks.clear(),loadScreenHide()}},hide:{value:loadScreenHide},show:{value:loadScreenShow},lock:{value:function(){return++_autoId,_locks.add(_autoId),loadScreenShow(),_autoId}},unlock:{value:function(id){if(null==id)throw new Error("LoadScreen.unlock called with a null or undefined ID");_locks.has(id)&&_locks.delete(id),0===_locks.size&&jQuery(document).trigger("readystatechange")}}}))}(),version=Object.freeze({title:"SugarCube",major:2,minor:36,patch:1,prerelease:null,build:9717,date:new Date("2021-12-22T05:37:33.467Z"),extensions:{},toString:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,"+").concat(this.build)},short:function(){var prerelease=this.prerelease?"-".concat(this.prerelease):"";return"".concat(this.title," (v").concat(this.major,".").concat(this.minor,".").concat(this.patch).concat(prerelease,")")},long:function(){return"".concat(this.title," v").concat(this.toString()," (").concat(this.date.toUTCString(),")")}}),TempState={},macros={},postdisplay={},postrender={},predisplay={},prehistory={},prerender={},session=null,settings={},setup={},storage=null,browser=Browser,config=Config,has=Has,History=State,state=State,tale=Story,TempVariables=State.temporary;window.SugarCube={},jQuery((function(){try{var lockId=LoadScreen.lock();LoadScreen.init(),document.normalize&&document.normalize(),Story.load(),storage=SimpleStore.create(Story.domId,!0),session=SimpleStore.create(Story.domId,!1),Dialog.init(),UIBar.init(),Engine.init(),Story.init(),L10n.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(L10n.get("warningNoWebStorage"))),Save.init(),Setting.init(),Macro.init(),Engine.start(),Config.debug&&DebugBar.init();var $window=$(window),vprCheckId=setInterval((function(){$window.width()&&(clearInterval(vprCheckId),UIBar.start(),Config.debug&&DebugBar.start(),jQuery.event.trigger({type:":storyready"}),setTimeout((function(){return LoadScreen.unlock(lockId)}),2*Engine.minDomActionDelay))}),Engine.minDomActionDelay);Object.defineProperty(window,"SugarCube",{value:Object.seal(Object.assign(Object.create(null),{Browser:Browser,Config:Config,Dialog:Dialog,Engine:Engine,Fullscreen:Fullscreen,Has:Has,L10n:L10n,Macro:Macro,Passage:Passage,Save:Save,Scripting:Scripting,Setting:Setting,SimpleAudio:SimpleAudio,State:State,Story:Story,UI:UI,UIBar:UIBar,DebugBar:DebugBar,Util:Util,Visibility:Visibility,Wikifier:Wikifier,session:session,settings:settings,setup:setup,storage:storage,version:version}))})}catch(ex){return console.error(ex),LoadScreen.clear(),Alert.fatal(null,ex.message,ex)}}))})(window,window.document,jQuery);}
	</script>
</body>
</html>
